{
  "version": 3,
  "sources": ["../node_server/server_settings.js", "../node_modules/fragelement/DOMElement.js", "../node_modules/acyclicgraph/acyclicgraph.js", "../src/components/other/acyclicgraph/graph.node.js", "../src/components/other/acyclicgraph/acyclic.graph.js", "../src/components/other/canvas/canvas.node.js", "../src/components/other/input/button.node.js", "../src/components/other/input/input.node.js", "../src/components/template/component.js", "../src/components/other/logger/logger.node.js", "../src/components/other/server/socket.component.js", "../src/components/other/server/sse.component.js", "../src/components/other/canvas/circlecanvas.node.js", "../src/components/other/canvas/place.node.js", "../node_modules/dynamicparticles/DynamicParticles.js", "../src/components/other/space/space.node.js", "../src/components/other/space/physicsbody.node.js", "../src/components/spectrometer/spectrometer.node.js", "../src/app.js"],
  "sourcesContent": ["const settings = {\r\n    debug:false, //print debog messages?\r\n    protocol:'http', //'http' or 'https'. HTTPS required for Nodejs <---> Python sockets. If using http, set production to False in python/server.py as well\r\n    host: 'localhost', //'localhost' or '127.0.0.1' etc.\r\n    port: 8080, //e.g. port 80, 443, 8000\r\n    socket_protocol: 'ws', //frontend socket protocol, wss for served, ws for localhost\r\n    hotreload: 5000, //hotreload websocket server port\r\n    python: 7000,  //quart server port\r\n    python_node:7001, //websocket relay port (relays messages to client from nodejs that were sent to it by python)\r\n    startpage: 'spectrometer.html',  //home page\r\n    errpage: 'src/other/404.html', //error page, etc.\r\n    certpath:'node_server/ssl/cert.pem',//if using https, this is required. See cert.pfx.md for instructions\r\n    keypath:'node_server/ssl/key.pem'//if using https, this is required. See cert.pfx.md for instructions\r\n}\r\n\r\nexports.settings = settings;", "\r\nexport class DOMElement extends HTMLElement { \r\n\r\n    template = (props) => {\r\n        return `<div> Custom Fragment Props: ${JSON.stringify(props)} </div>`\r\n    }; //override the default template string by extending the class, or use options.template if calling the base class\r\n    props = {test:true};\r\n    useShadow = false; //can set to attach a shadow DOM instead (local styles)\r\n  \r\n    oncreate=undefined //(props) => {}  fires on element creation (e.g. to set up logic)\r\n    onresize=undefined //(props) => {} fires on window resize\r\n    ondelete=undefined //(props) => {} fires after element is deleted\r\n    onchanged=undefined //(props) => {} fires when props change\r\n\r\n    FRAGMENT = undefined;\r\n    attachedShadow = false;\r\n\r\n    obsAttributes=[\"props\",\"options\",\"onchanged\",\"onresize\",\"ondelete\",\"oncreate\",\"template\"]\r\n \r\n    get observedAttributes() {\r\n        return this.obsAttributes;\r\n    }\r\n\r\n    get obsAttributes() {\r\n        return this.obsAttributes;\r\n    }\r\n\r\n    set obsAttributes(att) {\r\n        if(typeof att === 'string') {\r\n            this.obsAttributes.push(att);\r\n        } else if (Array.isArray(att)) this.obsAttributes=att;\r\n    }\r\n\r\n    static get tag(){return this.name.toLowerCase()+'-'} //tagName, default 'classname-'. Set as a static variable for the internal addElement to reference\r\n\r\n    //add self or a specified class to the window which can be used via html like <custom-tag></custom-tag>\r\n    //will default be the classname with a '-' at the end if no tag supplied\r\n    static addElement(tag=this.tag,cls=this,extend=undefined) {\r\n        addCustomElement(cls,tag,extend);\r\n    }\r\n\r\n    attributeChangedCallback(name, old, val) {\r\n        if(name === 'onchanged') {\r\n            let onchanged = val;\r\n            if(typeof onchanged === 'string') onchanged = parseFunctionFromText(onchanged);\r\n            if(typeof onchanged === 'function') { \r\n                this.onchanged =  onchanged;\r\n                this.state.data.props = this.props;\r\n                this.state.unsubscribeTrigger('props'); //remove any previous subs\r\n                this.state.subscribeTrigger('props',this.onchanged);\r\n                let changed = new CustomEvent('changed', {detail: { props:this.props }});\r\n                this.state.subscribeTrigger('props',()=>{this.dispatchEvent(changed)});\r\n            }\r\n        }\r\n        else if(name === 'onresize') {\r\n            let onresize = val;\r\n            if(typeof onresize === 'string')  onresize = parseFunctionFromText(onresize);\r\n            if(typeof onresize === 'function') {\r\n                if(this.ONRESIZE) {\r\n                    try { window.removeEventListener('resize',this.ONRESIZE); } catch(err) {}\r\n                }\r\n                this.ONRESIZE = (ev) => { this.onresize(this.props); } \r\n                this.onresize = onresize;\r\n                window.addEventListener('resize',this.ONRESIZE);\r\n            }\r\n        }\r\n        else if(name === 'ondelete') {\r\n            let ondelete = val;\r\n            if(typeof ondelete === 'string') ondelete = parseFunctionFromText(ondelete);\r\n            if(typeof ondelete === 'function') { \r\n                this.ondelete = () => {\r\n                    if(this.ONRESIZE) window.removeEventListener('resize',this.ONRESIZE);\r\n                    this.state.unsubscribeTrigger('props');\r\n                    if(ondelete) ondelete(this.props);\r\n                }\r\n            }\r\n        }\r\n        else if(name === 'oncreate') { \r\n            let oncreate = val;\r\n            if(typeof oncreate === 'string') oncreate = parseFunctionFromText(oncreate);\r\n            if(typeof oncreate === 'function') { \r\n                this.oncreate = oncreate;\r\n            }\r\n        }\r\n        else if(name === 'props') { //update the props, fires any onchanged stuff\r\n            let newProps = val;\r\n            if(typeof newProps === 'string') newProps = JSON.parse(newProps);\r\n\r\n            Object.assign(this.props,newProps);\r\n            this.state.setState({props:this.props});\r\n        }\r\n        else if(name === 'template') { //change the html template\r\n\r\n            let template = val;\r\n\r\n            this.template = options.template; //function or string;\r\n\r\n            if(typeof template === 'function') this.templateString = this.template(this.props); //can pass a function\r\n            else this.templateString = template;\r\n            \r\n            //render the new template\r\n            this.render(this.props);\r\n            let created = new CustomEvent('created', {detail: { props:this.props }});\r\n            this.dispatchEvent(created);\r\n\r\n        }\r\n        else { //arbitrary attributes\r\n            let parsed = val;\r\n            if(name.includes('eval_')) { // e.g. <custom-  eval_loginput=\"(input)=>{console.log(input);}\"></custom-> //now elm.loginput(input) should work\r\n                name = name.split('_')\r\n                name.shift()\r\n                name = name.join();\r\n                parsed = parseFunctionFromText(val);  \r\n            }\r\n            else if (typeof val === 'string') {\r\n                try {\r\n                    parsed = JSON.parse(val)\r\n                } catch (err) {\r\n                    parsed = val;\r\n                }\r\n            }\r\n            this[name] = parsed; // set arbitrary props \r\n            this.props[name] = parsed; //reflect it in the props object (to set props via attributes more easily)\r\n            //this.props[name] = val; //set arbitrary props via attributes\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n\r\n        // set initial props\r\n        let newProps = this.getAttribute('props');\r\n        if(typeof newProps === 'string') newProps = JSON.parse(newProps);\r\n\r\n        Object.assign(this.props,newProps);\r\n        this.state.setState({props:this.props});\r\n\r\n        //Observe arbitrary attributes\r\n        Array.from(this.attributes).forEach((att) => {\r\n            let name = att.name;\r\n            //console.log(name,this.getAttribute(name),this[name])\r\n            //get/set/observe arbitrary attributes\r\n            let parsed = att.value;\r\n            if(name.includes('eval_')) { // e.g. <custom-  eval_loginput=\"(input)=>{console.log(input);}\"></custom-> //now elm.loginput(input) should work\r\n                name = name.split('_')\r\n                name.shift()\r\n                name = name.join();\r\n                parsed = parseFunctionFromText(att.value);  \r\n            }\r\n            else if (typeof att.value === 'string') {\r\n                try {\r\n                    parsed = JSON.parse(att.value)\r\n                } catch (err) {\r\n                    parsed = att.value;\r\n                }\r\n            }\r\n            if(!this[name]) {\r\n                Object.defineProperties(\r\n                    this, att, {\r\n                        value:parsed,\r\n                        writable:true,\r\n                        get() { return this[name]; },\r\n                        set(val) { this.setAttribute(name, val); }\r\n                    }\r\n                )\r\n            }\r\n            this[name] = parsed;\r\n            this.props[name] = parsed; //set on props too (e.g. to more easily modify initial conditions without stringifying an object)\r\n            this.obsAttributes.push(name);\r\n            \r\n            //console.log(this.observedAttributes);\r\n        });\r\n\r\n        let resizeevent = new CustomEvent('resized', {detail: { props:this.props }});\r\n        let changed = new CustomEvent('changed', {detail: { props:this.props }});\r\n        let deleted = new CustomEvent('deleted', {detail: { props:this.props }});\r\n        let created = new CustomEvent('created', {detail: { props:this.props }});\r\n        //now we can add event listeners for our custom events\r\n\r\n        this.render(this.props);\r\n        this.dispatchEvent(created);\r\n\r\n        this.state.subscribeTrigger('props',()=>{this.dispatchEvent(changed)});\r\n\r\n        if(typeof this.onresize === 'function') {\r\n            if(this.ONRESIZE) {\r\n                try { window.removeEventListener('resize',this.ONRESIZE); } catch(err) {}\r\n            }\r\n            this.ONRESIZE = (ev) => { this.onresize(this.props); } \r\n            window.addEventListener('resize',this.ONRESIZE);       \r\n        }\r\n\r\n        if(typeof this.ondelete === 'function') {\r\n            let ondelete = this.ondelete;\r\n            this.ondelete = (props=this.props) => {\r\n                if(this.ONRESIZE) window.removeEventListener('resize',this.ONRESIZE);\r\n                this.state.unsubscribeTrigger('props');\r\n                ondelete(props);\r\n            }\r\n        }\r\n\r\n        if(typeof this.onchanged === 'function') {\r\n            this.state.data.props = this.props;\r\n            this.state.subscribeTrigger('props',this.onchanged);\r\n        }\r\n\r\n    }\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    delete = () => { //deletes self from the DOM\r\n        this.remove();\r\n        if(typeof this.ondelete === 'function') this.ondelete(this.props);\r\n    };\r\n\r\n    render = (props=this.props) => {\r\n\r\n        if(typeof this.template === 'function') this.templateString = this.template(props); //can pass a function\r\n        else this.templateString = this.template;\r\n\r\n        //this.innerHTML = this.templateString;\r\n\r\n        const t = document.createElement('template');\r\n        t.innerHTML = this.templateString;\r\n        const fragment = t.content;\r\n\r\n        if(this.FRAGMENT) { //will reappend the fragment without reappending the whole node if already rendered once\r\n            if(this.useShadow) {\r\n                this.shadowRoot.removeChild(this.FRAGMENT);\r\n            }   \r\n            else this.removeChild(this.FRAGMENT); \r\n        }\r\n        if(this.useShadow) {\r\n            if(!this.attachedShadow) this.attachShadow({mode:'open'});\r\n            this.shadowRoot.appendChild(fragment); //now you need to use the shadowRoot.querySelector etc.\r\n            this.FRAGMENT = this.shadowRoot.childNodes[this.shadowRoot.childNodes.length-1]\r\n        }   \r\n        else this.appendChild(fragment);\r\n        this.FRAGMENT = this.childNodes[this.childNodes.length-1]\r\n        \r\n        if(this.oncreate) this.oncreate(props); //set scripted behaviors\r\n    }\r\n\r\n    state = {\r\n        pushToState:{},\r\n        data:{},\r\n        triggers:{},\r\n        setState(updateObj){\r\n            Object.assign(this.pushToState,updateObj);\r\n\r\n            if(Object.keys(this.triggers).length > 0) {\r\n                // Object.assign(this.data,this.pushToState);\r\n                for (const prop of Object.getOwnPropertyNames(this.triggers)) {\r\n                    if(this.pushToState[prop]) {\r\n                        this.data[prop] = this.pushToState[prop]\r\n                        delete this.pushToState[prop];\r\n                        this.triggers[prop].forEach((obj)=>{\r\n                            obj.onchanged(this.data[prop]);\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            return this.pushToState;\r\n        },\r\n        subscribeTrigger(key,onchanged=(res)=>{}){\r\n            if(key) {\r\n                if(!this.triggers[key]) {\r\n                    this.triggers[key] = [];\r\n                }\r\n                let l = this.triggers[key].length;\r\n                this.triggers[key].push({idx:l, onchanged:onchanged});\r\n                return this.triggers[key].length-1;\r\n            } else return undefined;\r\n        },\r\n        unsubscribeTrigger(key,sub){\r\n            let idx = undefined;\r\n            let triggers = this.triggers[key]\r\n            if (triggers){\r\n                if(!sub) delete this.triggers[key];\r\n                else {\r\n                    let obj = triggers.find((o)=>{\r\n                        if(o.idx===sub) {return true;}\r\n                    });\r\n                    if(obj) triggers.splice(idx,1);\r\n                    return true;\r\n                }\r\n            }\r\n        },\r\n        subscribeTriggerOnce(key=undefined,onchanged=(value)=>{}) {\r\n            let sub;\r\n            let changed = (value) => {\r\n                onchanged(value);\r\n                this.unsubscribeTrigger(key,sub);\r\n            }\r\n\r\n            sub = this.subscribeTrigger(key,changed);\r\n        }\r\n    }\r\n\r\n    get props() {\r\n        return this.props;\r\n    } \r\n\r\n    set props(newProps={}) {\r\n        this.setAttribute('props',newProps);\r\n    }\r\n\r\n    get template() {\r\n        return this.template;\r\n    } \r\n\r\n    set template(template) {\r\n        this.setAttribute('template',template);\r\n    }\r\n\r\n    get render() {\r\n        return this.render;\r\n    }\r\n\r\n    get delete() {\r\n        return this.delete;\r\n    }\r\n\r\n    get state() {\r\n        return this.state;\r\n    }\r\n\r\n    //past tense just so it can't conflict with onchange\r\n    get onchanged() {\r\n        return this.onchanged;\r\n    } \r\n\r\n    set onchanged(onchanged) {\r\n        this.setAttribute('onchanged',onchanged);\r\n    }\r\n\r\n    get onresize() {\r\n        return this.props;\r\n    } \r\n\r\n    set onresize(onresize) {\r\n        this.setAttribute('onresize',onresize);\r\n    }\r\n\r\n    get ondelete() {\r\n        return this.props;\r\n    } \r\n\r\n    set ondelete(ondelete) {\r\n        this.setAttribute('ondelete',ondelete);\r\n    }\r\n\r\n    get oncreate() {\r\n        return this.oncreate;\r\n    } \r\n\r\n    set oncreate(oncreate) {\r\n        this.setAttribute('oncreated',oncreate);\r\n    }\r\n}\r\n\r\n//extend the DOMElement class with an new name, this name determines the element name (always lower case in the html regardless of class name cases)\r\nexport function addCustomElement(cls, tag, extend=null) {\r\n    try {\r\n        if(extend) {\r\n            if(tag) window.customElements.define(tag, cls, {extends:extend});\r\n            else window.customElements.define(cls.name.toLowerCase()+'-',cls, {extends:extend});\r\n        }\r\n        else {\r\n            if(tag) window.customElements.define(tag, cls);\r\n            else window.customElements.define(cls.name.toLowerCase()+'-',cls);\r\n        }\r\n    }\r\n    catch(err) {\r\n\r\n    }\r\n}\r\n\r\nexport function randomId(tag='') {\r\n    return tag+Math.floor(Math.random()*1000000000000000);\r\n}\r\n\r\n// Proper DOM fragment implementation which also creates customElements you can use like <so></so>. High HTML5 performance via template fragments\r\nexport function parseFunctionFromText(method) {\r\n    //Get the text inside of a function (regular or arrow);\r\n    let getFunctionBody = (methodString) => {\r\n    return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i, '$2$3$4');\r\n    }\r\n\r\n    let getFunctionHead = (methodString) => {\r\n    let startindex = methodString.indexOf(')');\r\n    return methodString.slice(0, methodString.indexOf('{',startindex) + 1);\r\n    }\r\n\r\n    let newFuncHead = getFunctionHead(method);\r\n    let newFuncBody = getFunctionBody(method);\r\n\r\n    let newFunc;\r\n    try{\r\n        if (newFuncHead.includes('function ')) {\r\n            let varName = newFuncHead.split('(')[1].split(')')[0]\r\n            newFunc = new Function(varName, newFuncBody);\r\n        } else {\r\n            if(newFuncHead.substring(0,6) === newFuncBody.substring(0,6)) {\r\n                //newFuncBody = newFuncBody.substring(newFuncHead.length);\r\n                let varName = newFuncHead.split('(')[1].split(')')[0]\r\n                //console.log(varName, newFuncHead ,newFuncBody);\r\n                newFunc = new Function(varName, newFuncBody.substring(newFuncBody.indexOf('{')+1,newFuncBody.length-1));\r\n            }\r\n            else {\r\n                try {\r\n                    newFunc = eval(newFuncHead + newFuncBody + \"}\");\r\n                } catch(err) {\r\n                    newFunc = eval(method); //try just evaluating the method\r\n                }\r\n            }\r\n        }\r\n    }\r\n    catch (err) {}\r\n\r\n    return newFunc;\r\n\r\n}\r\n\r\n", "//just a more typical hierarchical graph tree with back and forward prop and arbitrary \r\n// go-here-do-that utilities. Create an object node tree and make it do... things \r\n// same setup as sequencer but object/array/tag only (no functions), and can add arbitrary properties to mutate on objects\r\n// or propagate to children/parents with utility calls that get added to the objects\r\n//Joshua Brewster and Garrett Flynn AGPLv3.0\r\n\r\n\r\n/*\r\n\r\nlet tree = { //top level should be an object, children can be arrays of objects\r\n    tag:'top',\r\n    operator:(input,node,origin)=>{\r\n        if(typeof input === 'object') {\r\n            if(input?.x) node.x = input.x; \r\n            if(input?.y) node.y = input.y;\r\n            if(input?.z) node.z = input.z;\r\n            console.log('top node, input:', input);\r\n        }\r\n        return input;\r\n    }, //input is the previous result if passed from another node. node is 'this' node, origin is the previous node if passed\r\n    forward:true, //forward prop: returned outputs from the operator are passed to children operator(s)\r\n    //backward:true, //backprop: returned outputs from the operator are passed to the parent operator\r\n    x:3, //arbitrary properties available on the node variable in the operator \r\n    y:2,\r\n    z:1,\r\n    children:{ //object, array, or tag. Same as the 'next' tag in Sequencer.js\r\n        tag:'next', //tagged nodes get added to the node map by name, they must be unique! non-tagged nodes are only referenced internally e.g. in call trees\r\n        operator:(input,node,origin)=>{\r\n            if(origin.x) { //copy over the coordinates\r\n                node.x = origin.x;\r\n                node.y = origin.y;\r\n                node.z = origin.z;\r\n            }\r\n            console.log('next node \\n parent node:',node,'\\ninput',input);\r\n        }, // if you use a normal function operator(input,node,origin){} then you can use 'this' reference instead of 'node', while 'node' is more flexible for arrow functions etc.\r\n        //etc..\r\n        delay:500,\r\n        repeat:3\r\n    },\r\n    delay:1000//, //can timeout the operation\r\n    //frame:true //can have the operation run via requestAnimationFrame (throttling)\r\n    //repeat:3 //can repeat an operator, or use \"recursive\" for the same but passing the node's result back in\r\n};\r\n\r\n\r\nlet graph = new AcyclicGraph();\r\ngraph.addNode(tree);\r\n\r\ngraph.run(tree.tag,{x:4,y:5,z:6});\r\n\r\neach node in the tree becomes a GraphNode object\r\n\r\n*/\r\n//TODO: try to reduce the async stack a bit for better optimization, though in general it is advantageous matter as long as node propagation isn't \r\n//   relied on for absolute maximal performance concerns, those generally require custom solutions e.g. matrix math or clever indexing, but this can be used as a step toward that.\r\n\r\n//a graph representing a callstack of nodes which can be arranged arbitrarily with forward and backprop or propagation to wherever\r\nexport const state = {\r\n    pushToState:{},\r\n    data:{},\r\n    triggers:{},\r\n    setState(updateObj){\r\n        Object.assign(this.pushToState,updateObj);\r\n\r\n        if(Object.keys(this.triggers).length > 0) {\r\n            // Object.assign(this.data,this.pushToState);\r\n            for (const prop of Object.getOwnPropertyNames(this.triggers)) {\r\n                if(this.pushToState[prop]) {\r\n                    this.data[prop] = this.pushToState[prop]\r\n                    delete this.pushToState[prop];\r\n                    this.triggers[prop].forEach((obj)=>{\r\n                        obj.onchange(this.data[prop]);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        return this.pushToState;\r\n    },\r\n    subscribeTrigger(key,onchange=(res)=>{}){\r\n        if(key) {\r\n            if(!this.triggers[key]) {\r\n                this.triggers[key] = [];\r\n            }\r\n            let l = this.triggers[key].length;\r\n            this.triggers[key].push({idx:l, onchange:onchange});\r\n            return this.triggers[key].length-1;\r\n        } else return undefined;\r\n    },\r\n    unsubscribeTrigger(key,sub){\r\n        let idx = undefined;\r\n        let triggers = this.triggers[key]\r\n        if (triggers){\r\n            if(!sub) delete this.triggers[key];\r\n            else {\r\n                let obj = triggers.find((o)=>{\r\n                    if(o.idx===sub) {return true;}\r\n                });\r\n                if(obj) triggers.splice(idx,1);\r\n                return true;\r\n            }\r\n        }\r\n    },\r\n    subscribeTriggerOnce(key=undefined,onchange=(value)=>{}) {\r\n        let sub;\r\n        let changed = (value) => {\r\n            onchange(value);\r\n            this.unsubscribeTrigger(key,sub);\r\n        }\r\n\r\n        sub = this.subscribeTrigger(key,changed);\r\n    }\r\n}\r\n\r\n\r\nexport class AcyclicGraph {\r\n    state = state;\r\n    nodes = new Map()\r\n    nNodes = 0\r\n\r\n    constructor() {}\r\n\r\n    //convert child objects to nodes\r\n    convertChildrenToNodes(n) {\r\n        n.convertChildrenToNodes(n);\r\n    }\r\n\r\n    //converts all children nodes and tag references to graphnodes also\r\n    addNode(node={}) {\r\n        let converted = new GraphNode(node,undefined,this); \r\n        return converted;\r\n    }\r\n\r\n    getNode(tag) {\r\n        return this.nodes.get(tag);\r\n    }\r\n\r\n    //Should create a sync version with no promises (will block but be faster)\r\n    run(node,input,origin) {\r\n        if(typeof node === 'string') node = this.nodes.get(node);\r\n        if(node)\r\n            return node.run(input,node,origin)\r\n        else return undefined;\r\n    }\r\n    \r\n    //Should create a sync version with no promises (will block but be faster)\r\n    runNode=this.run;\r\n\r\n    removeTree(node) {\r\n        if(typeof node === 'string') node = this.nodes.get(node);\r\n        if(node) {\r\n            function recursivelyRemove(node) {\r\n                if(node.children) {\r\n                    if(Array.isArray(node.children)) {\r\n                        node.children.forEach((c)=>{\r\n                            if(c.stopNode) c.stopNode();\r\n                            if(c.tag) {\r\n                                if(this.nodes.get(c.tag)) this.nodes.delete(c.tag);\r\n                            }\r\n                            this.nodes.forEach((n) => {\r\n                                if(n.nodes.get(c.tag)) n.nodes.delete(c.tag);\r\n                            });\r\n                            recursivelyRemove(c);\r\n                        })\r\n                    }\r\n                    else if(typeof node.children === 'object') {\r\n                        if(node.stopNode) node.stopNode();\r\n                        if(node.tag) {\r\n                            if(this.nodes.get(node.tag)) this.nodes.delete(node.tag);\r\n                        }\r\n                        this.nodes.forEach((n) => {\r\n                            if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n                        });\r\n                        recursivelyRemove(node);\r\n                    }\r\n                }\r\n            }\r\n            if(node.stopNode) node.stopNode();\r\n            if(node.tag) {\r\n                this.nodes.delete(node.tag);\r\n                this.nodes.forEach((n) => {\r\n                    if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n                });\r\n                recursivelyRemove(node);\r\n            }\r\n        }\r\n    }\r\n\r\n    removeNode(node) {\r\n        if(typeof node === 'string') node = this.nodes.get(node);\r\n        if(node?.tag) this.nodes.delete(node.tag);\r\n        if(node?.tag) {\r\n            if(this.nodes.get(node.tag)) \r\n            {\r\n                this.nodes.delete(node.tag);\r\n                this.nodes.forEach((n) => {\r\n                    if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    appendNode(node={}, parentNode) {\r\n        parentNode.addChildren(node);\r\n    }\r\n\r\n    async callParent(node, input, origin=node, cmd) {\r\n        if(node?.parent) {\r\n            return await node.callParent(input, node.parent, origin, cmd);\r\n        }\r\n    }\r\n\r\n    async callChildren(node, input, origin=node, cmd, idx) {\r\n        if(node?.children) {\r\n            return await node.callChildren(input, origin, cmd, idx);\r\n        }\r\n    }\r\n\r\n    subscribe(tag,callback=(res)=>{}) {\r\n        return this.state.subscribeTrigger(tag,callback);\r\n    }\r\n\r\n    unsubscribe(tag,sub) {\r\n        this.state.unsubscribeTrigger(tag,sub);\r\n    }\r\n    \r\n    //subscribe a node to this node that isn't a child of this node\r\n    subscribeNode(inputNode, outputNode) {\r\n        return this.state.subscribeTrigger(inputNode.tag,(res)=>{this.run(outputNode,res,this);})\r\n    }\r\n\r\n    create(operator=(input,node,origin,cmd)=>{},parentNode,props) {\r\n        return createNode(operator,parentNode,props,this);\r\n    }\r\n\r\n    print(node,printChildren=true) {\r\n        if(node instanceof GraphNode)\r\n            return node.print(node,printChildren);\r\n    }\r\n\r\n    //reconstruct a node hierarchy (incl. stringified functions) into a GraphNode set\r\n    reconstruct(json='{}') {\r\n        let parsed = reconstructObject(json);\r\n        if(parsed) this.addNode(parsed);\r\n    }\r\n\r\n}\r\n\r\n//the utilities in this class can be referenced in the operator after setup for more complex functionality\r\n//node functionality is self-contained, use a graph for organization\r\nexport class GraphNode {\r\ntag;\r\nparent;\r\nchildren;\r\ngraph;\r\nstate = state; //shared trigger state\r\nnodes = new Map();\r\nANIMATE = 'animate'; //operator is running on the animation loop (cmd = 'animate')\r\nLOOP = 'loop'; //operator is running on a setTimeout loop (cmd = 'loop')\r\nlooper = undefined; //loop function, uses operator if undefined (with cmd 'loop');\r\nanimation = undefined; //animation function, uses operator if undefined (with cmd 'animate')\r\n\r\n\r\nconstructor(properties={}, parentNode, graph) {\r\n    if(!properties.tag && graph) properties.tag = `node${graph.nNodes}`; //add a sequential id to find the node in the tree \r\n    else if(!properties.tag) properties.tag = `node${Math.floor(Math.random()*10000000000)}`; //add a random id for the top index if none supplied\r\n    Object.assign(this,properties); //set the node's props as this\r\n    this.parent=parentNode;\r\n    this.graph=graph;\r\n\r\n    if(graph) {\r\n        graph.nNodes++;\r\n        graph.nodes.set(properties.tag,this);\r\n    }\r\n\r\n    if(this.children) this.convertChildrenToNodes(this);\r\n}\r\n\r\n//I/O scheme for this node\r\noperator(input,node=this,origin,cmd){\r\n    return input;\r\n}\r\n\r\n//run the operator\r\nasync runOp(input,node=this,origin,cmd) {\r\n    let result = await this.operator(input,node,origin,cmd);\r\n    if(this.tag) this.state.setState({[this.tag]:result});\r\n    return result;\r\n}\r\n\r\n//Should create a sync version with no promises (will block but be faster)\r\nrunNode(node,input,origin) {\r\n    if(typeof node === 'string') node = this.nodes.get(node);\r\n    if(node)\r\n        return node.run(input,node,origin)\r\n    else return undefined;\r\n}\r\n\r\n//runs the node sequence\r\n//Should create a sync version with no promises (will block but be faster)\r\nrun(input,node=this,origin) {\r\n    if(typeof node === 'string') \r\n        {\r\n            let fnd;\r\n            if(this.graph) fnd = this.graph.nodes.get(node);\r\n            if(!fnd) fnd = this.nodes.get(node);\r\n            node = fnd;\r\n            if(!node) return undefined;\r\n        }\r\n\r\n    return new Promise(async (resolve) => {\r\n        if(node) {\r\n            let run = (node, inp, tick=0) => {\r\n                return new Promise (async (r) => {\r\n                    tick++;\r\n                    let res = await node.runOp(inp,node,origin,tick);\r\n                    if(typeof node.repeat === 'number') {\r\n                        while(tick < node.repeat) {\r\n                            if(node.delay) {\r\n                                setTimeout(async ()=>{\r\n                                    r(await run(node,inp,tick));\r\n                                },node.delay);\r\n                                break;\r\n                            } else if (node.frame && requestAnimationFrame) {\r\n                                requestAnimationFrame(async ()=>{\r\n                                    r(await run(node,inp,tick));\r\n                                });\r\n                                break;\r\n                            }\r\n                            else res = await node.runOp(inp,node,origin,tick);\r\n                            tick++;\r\n                        }\r\n                        if(tick === node.repeat) {\r\n                            r(res);\r\n                            return;\r\n                        }\r\n                    } else if(typeof node.recursive === 'number') {\r\n                        \r\n                        while(tick < node.recursive) {\r\n                            if(node.delay) {\r\n                                setTimeout(async ()=>{\r\n                                    r(await run(node,res,tick));\r\n                                },node.delay);\r\n                                break;\r\n                            } else if (node.frame && requestAnimationFrame) {\r\n                                requestAnimationFrame(async ()=>{\r\n                                    r(await run(node,res,tick));\r\n                                });\r\n                                break;\r\n                            }\r\n                            else res = await node.runOp(res,node,origin,tick);\r\n                            tick++;\r\n                        }\r\n                        if(tick === node.recursive) {\r\n                            r(res);\r\n                            return;\r\n                        }\r\n                    } else {\r\n                        r(res);\r\n                        return;\r\n                    }\r\n                });\r\n            }\r\n\r\n\r\n            let runnode = async () => {\r\n\r\n                let res = await run(node,input); //repeat/recurse before moving on to the parent/child\r\n\r\n                if(node.backward && node.parent) {\r\n                    await this.runNode(node.parent,res,node);\r\n                }\r\n                if(node.children && node.forward) {\r\n                    if(Array.isArray(node.children)) {\r\n                        for(let i = 0; i < node.children.length; i++) {\r\n                            await this.runNode(node.children[i],res,node);\r\n                        }\r\n                    }\r\n                    else await this.runNode(node.children,res,node);\r\n                }\r\n\r\n                //can add an animationFrame coroutine, one per node //because why not\r\n                if(node.animate && !node.isAnimating) {\r\n                    this.runAnimation(this.animation,input,node,origin);\r\n                }\r\n\r\n                //can add an infinite loop coroutine, one per node, e.g. an internal subroutine\r\n                if(typeof node.loop === 'number' && !node.isLooping) {\r\n                    this.runLoop(this.looper,input,node,origin);\r\n                }\r\n                \r\n                return res;\r\n            }\r\n\r\n            if(node.delay) {\r\n                setTimeout(async ()=>{\r\n                    resolve(await runnode());\r\n                },node.delay);\r\n            } else if (node.frame && requestAnimationFrame) {\r\n                requestAnimationFrame(async ()=>{\r\n                    resolve(await runnode());\r\n                });\r\n            } else {\r\n                resolve(await runnode());\r\n            }\r\n            \r\n        }\r\n        else resolve(undefined);\r\n    });\r\n}\r\n\r\nrunAnimation(animation=this.animation,input,node=this,origin) {\r\n    //can add an animationFrame coroutine, one per node //because why not\r\n    this.animation = animation;\r\n    if(!animation) this.animation = this.operator;\r\n    if(node.animate && !node.isAnimating) {\r\n        node.isAnimating = true;\r\n        let anim = async () => {\r\n            if(node.isAnimating) {\r\n                let result = await this.animation( \r\n                    input,\r\n                    node,\r\n                    origin,\r\n                    this.ANIMATE\r\n                );\r\n                if(this.tag && typeof result !== 'undefined') {\r\n                    this.state.setState({[this.tag]:result}); //if the anim returns it can trigger state\r\n                    if(node.backward && node.parent) {\r\n                        await this.runNode(node.parent,result,node);\r\n                    }\r\n                    if(node.children && node.forward) {\r\n                        if(Array.isArray(node.children)) {\r\n                            for(let i = 0; i < node.children.length; i++) {\r\n                                await this.runNode(node.children[i],result,node);\r\n                            }\r\n                        }\r\n                        else await this.runNode(node.children,result,node);\r\n                    }\r\n                }\r\n                requestAnimationFrame(async ()=>{await anim();});\r\n            }\r\n        }\r\n        requestAnimationFrame(anim);\r\n    }\r\n}\r\n\r\nrunLoop(loop=this.looper,input,node=this,origin) {\r\n    //can add an infinite loop coroutine, one per node, e.g. an internal subroutine\r\n    this.looper = loop;\r\n    if(!loop) this.looper = this.operator;\r\n    if(typeof node.loop === 'number' && !node.isLooping) {\r\n        node.isLooping = true;\r\n        let looping = async () => {\r\n            if(node.looping)  {\r\n                let result = await this.looper(input,node,origin);\r\n                if(this.tag && typeof result !== 'undefined') {\r\n                    this.state.setState({[this.tag]:result}); //if the loop returns it can trigger state\r\n                    if(node.backward && node.parent) {\r\n                        await this.runNode(node.parent,result,node);\r\n                    }\r\n                    if(node.children && node.forward) {\r\n                        if(Array.isArray(node.children)) {\r\n                            for(let i = 0; i < node.children.length; i++) {\r\n                                await this.runNode(node.children[i],result,node);\r\n                            }\r\n                        }\r\n                        else await this.runNode(node.children,result,node);\r\n                    }\r\n                }\r\n                setTimeout(async ()=>{await looping();},node.loop);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n//this is the i/o handler, or the 'main' function for this node to propagate results. The origin is the node the data was propagated from\r\nsetOperator(operator=function operator(input,node=this,origin,cmd){return input;}) {\r\n    this.operator = operator;\r\n}\r\n\r\nsetParent(parent) { \r\n    this.parent = parent;\r\n}\r\n\r\nsetChildren(children) {\r\n    this.children = children;\r\n}\r\n\r\nremoveTree(node) {\r\n    if(typeof node === 'string') node = this.nodes.get(node);\r\n    if(node) {\r\n        function recursivelyRemove(node) {\r\n            if(node.children) {\r\n                if(Array.isArray(node.children)) {\r\n                    node.children.forEach((c)=>{\r\n                        if(c.stopNode) c.stopNode();\r\n                        if(c.tag) {\r\n                            if(this.nodes.get(c.tag)) this.nodes.delete(c.tag);\r\n                        }\r\n                        this.nodes.forEach((n) => {\r\n                            if(n.nodes.get(c.tag)) n.nodes.delete(c.tag);\r\n                        });\r\n                        recursivelyRemove(c);\r\n                    })\r\n                }\r\n                else if(typeof node.children === 'object') {\r\n                    if(node.stopNode) node.stopNode();\r\n                    if(node.tag) {\r\n                        if(this.nodes.get(node.tag)) this.nodes.delete(node.tag);\r\n                    }\r\n                    this.nodes.forEach((n) => {\r\n                        if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n                    });\r\n                    recursivelyRemove(node);\r\n                }\r\n            }\r\n        }\r\n        if(node.stopNode) node.stopNode();\r\n        if(node.tag) {\r\n            this.nodes.delete(node.tag);\r\n            this.nodes.forEach((n) => {\r\n                if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n            });\r\n            recursivelyRemove(node);\r\n            if(this.graph) this.graph.nodes.removeTree(node); //remove from parent graph too \r\n        }\r\n    }\r\n}\r\n\r\n//converts all children nodes and tag references to graphnodes also\r\naddNode(node={}) {\r\n    let converted = new GraphNode(node,this,this.graph); \r\n    this.nodes.set(convertedtag,converted);\r\n    if(this.graph) this.graph.nodes.set(converted.tag,converted);\r\n    return converted;\r\n}\r\n\r\n\r\nremoveNode(node) {\r\n    if(typeof node === 'string') node = this.nodes.get(node);\r\n    if(node?.tag) this.nodes.delete(node.tag);\r\n    if(node?.tag) {\r\n        if(this.nodes.get(node.tag)) \r\n        {\r\n            this.nodes.delete(node.tag);\r\n            if(this.graph) this.graph.nodes.delete(node.tag);\r\n            this.nodes.forEach((n) => {\r\n                if(n.nodes.get(node.tag)) n.nodes.delete(node.tag);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nappendNode(node, parentNode=this) {\r\n    if(typeof node === 'string') node = this.nodes.get(node);\r\n    if(node) parentNode.addChildren(node);\r\n}\r\n\r\ngetNode(tag) {\r\n    return this.nodes.get(tag);\r\n}\r\n\r\n//stop any loops\r\nstopLooping(node=this) {\r\n    node.isLooping = false;\r\n}\r\n\r\nstopAnimating(node=this) {\r\n    node.isAnimating = false;\r\n}\r\n\r\nstopNode(node=this) {\r\n    node.stopAnimating(node);\r\n    node.stopLooping(node);\r\n}\r\n\r\n\r\n//append child\r\naddChildren(children) {\r\n    if(!this.children) this.children = [];\r\n    if(!Array.isArray(this.children) && this.children) this.children = [this.children];\r\n    else if(Array.isArray(children)) this.children.push(...children);\r\n    else this.children.push(children);\r\n}\r\n\r\nconvertChildrenToNodes(n=this) {\r\n    if(n.children?.name === 'GraphNode') { \r\n        if(!this.graph?.nodes.get(n.tag)) this.graph.nodes.set(n.tag,n);\r\n        if(!this.nodes.get(n.tag)) this.nodes.set(n.tag,n); \r\n    }\r\n    else if (Array.isArray(n.children)) {\r\n        for(let i = 0; i < n.children.length; i++) {\r\n            if(n.children[i].name === 'GraphNode') { \r\n                if(!this.graph?.nodes.get(n.children[i].tag)) this.graph.nodes.set(n.children[i].tag,n.children[i]);\r\n                if(!this.nodes.get(n.children[i].tag)) this.nodes.set(n.children[i].tag,n.children[i]);\r\n                continue; \r\n            }\r\n            else if(typeof n.children[i] === 'object') {\r\n                n.children[i] = new GraphNode(n.children[i],n,this.graph);\r\n                this.nodes.set(n.children[i].tag,n.children[i]);\r\n                this.convertChildrenToNodes(n.children[i]);\r\n            } \r\n            else if (typeof n.children[i] === 'string') {\r\n                if(this.graph) {\r\n                    n.children[i] = this.graph.getNode(n.children[i]); //try graph scope\r\n                    if(!this.nodes.get(n.children[i].tag)) this.nodes.set(n.children[i].tag,n.children[i]);\r\n                }\r\n                if(!n.children[i]) n.children[i] = this.nodes.get(n.children[i]); //try local scope\r\n            }\r\n            \r\n        }\r\n    }\r\n    else if(typeof n.children === 'object') {\r\n        n.children = new GraphNode(n.children,n,this.graph);\r\n        this.nodes.set(n.children.tag,n.children);\r\n        this.convertChildrenToNodes(n.children);\r\n    } \r\n    else if (typeof n.children === 'string') {\r\n        if(this.graph) {\r\n            n.children = this.graph.getNode(n.children); //try graph scope\r\n            if(!this.nodes.get(n.children.tag)) this.nodes.set(n.children.tag,n.children);\r\n        }\r\n        if(!n.children) n.children = this.nodes.get(n.children); //try local scope\r\n    }\r\n    return n.children;\r\n}\r\n\r\n//Call parent node operator directly\r\nasync callParent(input, origin=this, cmd){\r\n    if(typeof this.parent?.operator === 'function') return await this.parent.runOp(input,this.parent,origin, cmd);\r\n}\r\n\r\nasync callChildren(input, origin=this, cmd, idx){\r\n    let result;\r\n    if(Array.isArray(this.children)) {\r\n        if(idx) result = await this.children[idx]?.runOp(input,this.children[idx],origin,cmd);\r\n        else {\r\n            result = [];\r\n            for(let i = 0; i < this.children.length; i++) {\r\n                result.push(await this.children[i]?.runOp(input,this.children[i],origin,cmd));\r\n            } \r\n        }\r\n    } else if(this.children) {\r\n        result = await this.children.runOp(input,this.children,origin,cmd);\r\n    }\r\n    return result;\r\n}\r\n\r\nsetProps(props={}) {\r\n    Object.assign(this,props);\r\n}\r\n\r\nsubscribe(callback=(res)=>{},tag=this.tag) {\r\n    if(callback instanceof GraphNode) return this.subscribeNode(callback);\r\n    return this.state.subscribeTrigger(tag,callback);\r\n}\r\n\r\nunsubscribe(sub,tag=this.tag) {\r\n    this.state.unsubscribeTrigger(tag,sub);\r\n}\r\n\r\n//subscribe a node to this node that isn't a child of this node\r\nsubscribeNode(node,tag=this.tag) {\r\n    return this.state.subscribeTrigger(tag,(res)=>{this.runNode(node,res,this);})\r\n}\r\n\r\n//recursively print a reconstructible json hierarchy of the node and the children. \r\n// Start at the top/initially called nodes to print the whole hierarchy in one go\r\nprint(node=this,printChildren=true,nodesPrinted=[]) {\r\n\r\n    let dummyNode = new GraphNode(); //test against this for adding props\r\n\r\n    nodesPrinted.push(node.tag);\r\n\r\n    let jsonToPrint = {\r\n        tag:node.tag,\r\n        operator:node.operator.toString()\r\n    };\r\n\r\n    if(node.parent) jsonToPrint.parent = node.parent.tag;\r\n    //step through the children\r\n    if(node.children) {\r\n        if(Array.isArray(node.children)) {\r\n            node.children = node.children.map((c) => {\r\n                if(typeof c === 'string') return c;\r\n                if(nodesPrinted.includes(c.tag)) return c.tag;   \r\n                else if(!printChildren) {\r\n                    return c.tag;\r\n                }\r\n                else return c.print(c,printChildren,nodesPrinted);\r\n            });\r\n        } else if (typeof node.children === 'object') { \r\n            if(!printChildren) {\r\n                jsonToPrint.children = [node.children.tag];\r\n            }\r\n            if(nodesPrinted.includes(node.children.tag))  jsonToPrint.children = [node.children.tag];\r\n                else  jsonToPrint.children = [node.children.print(node.children,printChildren,nodesPrinted)];\r\n        } else if (typeof node.children === 'string') jsonToPrint.children = [node.children];\r\n        \r\n    }\r\n\r\n    for(const prop in node) {\r\n        if(prop === 'parent' || prop === 'children') continue; //skip these as they are dealt with as special cases\r\n        if(typeof dummyNode[prop] === 'undefined') {\r\n            if(typeof node[prop] === 'function') {\r\n                jsonToPrint[prop] = node[prop].toString()\r\n            } else if (typeof node[prop] === 'object') {\r\n                jsonToPrint[prop] = JSON.stringifyWithCircularRefs(node[prop]); //circular references won't work, nested nodes already printed elsewhere in the tree will be kept as their tags\r\n            } \r\n            else {\r\n                jsonToPrint[prop] = node[prop];\r\n            }\r\n        }\r\n    }\r\n\r\n    return JSON.stringify(jsonToPrint);\r\n\r\n}\r\n\r\n//reconstruct a node hierarchy (incl. stringified functions) into a GraphNode set\r\nreconstruct(json='{}') {\r\n    let parsed = reconstructObject(json);\r\n    if(parsed) this.addNode(parsed);\r\n}\r\n\r\n\r\n\r\n}\r\n\r\n\r\nexport function createNode(operator,parentNode,props,graph) {\r\n    if(typeof props === 'object') {\r\n        props.operator = operator;\r\n        return new GraphNode(props,parentNode,graph);\r\n    }\r\n    return new GraphNode({operator:operator},parentNode,graph);\r\n}\r\n\r\n//macro\r\nexport function reconstructNode(json='{}',parentNode,graph) {\r\n    let reconstructed = reconstructObject(json);\r\n    if(reconstructed) return new GraphNode(reconstructed,parentNode,graph);\r\n    else return undefined;\r\n}\r\n\r\n// exports.AcyclicGraph = AcyclicGraph;\r\n// exports.GraphNode = GraphNode;\r\n\r\n//parse stringified object with stringified functions\r\nexport function reconstructObject(json='{}') {\r\n    try{\r\n        let parsed = JSON.parse(json);\r\n\r\n        function parseObj(obj) {\r\n            for(const prop in obj) {\r\n                if(typeof obj[prop] === 'string') {\r\n                    let funcParsed = parseFunctionFromText(obj[prop]);\r\n                    if(typeof funcParsed === 'function') {\r\n                        obj[prop] = funcParsed;\r\n                    }\r\n                } else if (typeof obj[prop] === 'object') {\r\n                    parseObj(obj[prop]);\r\n                }\r\n            }\r\n            return obj;\r\n        }\r\n\r\n        return parseObj(parsed);\r\n    } catch(err) {console.error(err); return undefined;}\r\n\r\n}\r\n\r\n\r\nif(JSON.stringifyWithCircularRefs === undefined) {\r\n    //Workaround for objects containing DOM nodes, which can't be stringified with JSON. From: https://stackoverflow.com/questions/4816099/chrome-sendrequest-error-typeerror-converting-circular-structure-to-json\r\n    JSON.stringifyWithCircularRefs = (function() {\r\n        const refs = new Map();\r\n        const parents = [];\r\n        const path = [\"this\"];\r\n\r\n        function clear() {\r\n        refs.clear();\r\n        parents.length = 0;\r\n        path.length = 1;\r\n        }\r\n\r\n        function updateParents(key, value) {\r\n            var idx = parents.length - 1;\r\n            var prev = parents[idx];\r\n            if(typeof prev === 'object') {\r\n                if (prev[key] === value || idx === 0) {\r\n                    path.push(key);\r\n                    parents.push(value.pushed);\r\n                } else {\r\n                    while (idx-- >= 0) {\r\n                        prev = parents[idx];\r\n                        if(typeof prev === 'object') {\r\n                            if (prev[key] === value) {\r\n                                idx += 2;\r\n                                parents.length = idx;\r\n                                path.length = idx;\r\n                                --idx;\r\n                                parents[idx] = value;\r\n                                path[idx] = key;\r\n                                break;\r\n                            }\r\n                        }\r\n                        idx--;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function checkCircular(key, value) {\r\n        if (value != null) {\r\n            if (typeof value === \"object\") {\r\n            if (key) { updateParents(key, value); }\r\n\r\n            let other = refs.get(value);\r\n            if (other) {\r\n                return '[Circular Reference]' + other;\r\n            } else {\r\n                refs.set(value, path.join('.'));\r\n            }\r\n            }\r\n        }\r\n        return value;\r\n        }\r\n\r\n        return function stringifyWithCircularRefs(obj, space) {\r\n        try {\r\n            parents.push(obj);\r\n            return JSON.stringify(obj, checkCircular, space);\r\n        } finally {\r\n            clear();\r\n        }\r\n        }\r\n    })();\r\n}\r\n\r\nexport function parseFunctionFromText(method='') {\r\n    //Get the text inside of a function (regular or arrow);\r\n    let getFunctionBody = (methodString) => {\r\n      return methodString.replace(/^\\W*(function[^{]+\\{([\\s\\S]*)\\}|[^=]+=>[^{]*\\{([\\s\\S]*)\\}|[^=]+=>(.+))/i, '$2$3$4');\r\n    }\r\n  \r\n    let getFunctionHead = (methodString) => {\r\n      let startindex = methodString.indexOf(')');\r\n      return methodString.slice(0, methodString.indexOf('{',startindex) + 1);\r\n    }\r\n  \r\n    let newFuncHead = getFunctionHead(method);\r\n    let newFuncBody = getFunctionBody(method);\r\n  \r\n    let newFunc;\r\n    if (newFuncHead.includes('function ')) {\r\n      let varName = newFuncHead.split('(')[1].split(')')[0]\r\n      newFunc = new Function(varName, newFuncBody);\r\n    } else {\r\n      if(newFuncHead.substring(0,6) === newFuncBody.substring(0,6)) {\r\n        //newFuncBody = newFuncBody.substring(newFuncHead.length);\r\n        let varName = newFuncHead.split('(')[1].split(')')[0]\r\n        //console.log(varName, newFuncHead ,newFuncBody);\r\n        newFunc = new Function(varName, newFuncBody.substring(newFuncBody.indexOf('{')+1,newFuncBody.length-1));\r\n      }\r\n      else newFunc = eval(newFuncHead + newFuncBody + \"}\");\r\n    }\r\n  \r\n    return newFunc;\r\n  \r\n  }\r\n", "\r\nimport {DOMElement, addCustomElement} from 'fragelement';\r\n\r\nimport {GraphNode} from 'acyclicgraph'\r\n\r\nlet component = require('./graph.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class NodeDiv extends DOMElement {\r\n    props={\r\n        operator:(\r\n            input, //input, e.g. output from another node\r\n            node,  //'this' node\r\n            origin, //origin node\r\n            cmd    //e.g. 'loop' or 'animate' will be defined if the operator is running on the loop or animate routines, needed something. Can define more commands but you might as well use an object in input for that. \r\n        )=>{ console.log(input); return input; }, //Operator to handle I/O on this node. Returned inputs can propagate according to below settings\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:false, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    input_delay=1 //onload runNode delay for graph nodes to run operations on inputs, they will not recognize their children otherwise as the DOM loads\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    //gotta customize this a little from the default DOMElement\r\n    render = (props=this.props) => {\r\n\r\n        if(typeof this.template === 'function') this.templateString = this.template(props); //can pass a function\r\n        else this.templateString = this.template;\r\n\r\n        //this.innerHTML = this.templateString;\r\n\r\n        const t = document.createElement('template');\r\n        t.innerHTML = this.templateString;\r\n        const fragment = t.content;\r\n        if(this.fragment) { //will reappend the fragment without reappending the whole node if already rendered once\r\n            this.removeChild(this.fragment); \r\n        }\r\n        this.fragment = fragment;\r\n        this.appendChild(fragment);\r\n        \r\n        \r\n        //add this here which will run a routine AFTER rendering so the elements can be updated\r\n        this.setupNode(this.props);\r\n        if(this.props.input) { //e.g. run the node on input\r\n            setTimeout(async()=>{\r\n                this.props.node.runNode(this.props.node,this.props.input,this.props.graph); //run the inputs on the nodes once the children are loaded on the DOM so things propagate correctly\r\n            },\r\n            this.input_delay //makes sure children are loaded (e.g. on a DOM with a lot of loading, should add some execution delay to anticipate it as initial nodes are not aware of later-rendered nodes on the DOM)\r\n            );\r\n        }\r\n        if(this.oncreate) this.oncreate(props); //set scripted behaviors\r\n    }\r\n\r\n    setupNode(props) {\r\n        let parent = this.parentNode;\r\n        if(parent.props?.operator) { //has operator, this is a graph-node (in case you extend it with a new tagName)\r\n            if(parent.props?.node) props.parent = parent.props.node;\r\n        }\r\n        if(!props.graph) {   \r\n            while(!parent.props?.nodes) { //has nodes prop, is an acyclic-graph\r\n                // console.log(parent)\r\n                // console.log(parent.tagName)\r\n                if(parent.constructor.name === 'HTMLBodyElement' || parent.constructor.name === 'HTMLHeadElement' || parent.constructor.name === 'HTMLHtmlElement' || parent.constructor.name === 'HTMLDocument') {\r\n                    //console.error(\"No AcyclicGraph Found\")\r\n                    break;\r\n                }\r\n                parent = parent.parentNode;\r\n            }\r\n            if(parent.props?.nodes) {\r\n                props.graph = parent.props.graph;\r\n                props.input_delay = parent.props.input_delay;\r\n            }\r\n        }\r\n        if(this.id && !props.tag) props.tag = this.id;\r\n\r\n        if(props.graph && !props.node && props.tag) props.node = props.graph.nodes.get(props.tag); //can try to get graph nodes by id or tag\r\n        else if(props.graph && typeof props.node === 'string') props.node = props.graph.nodes.get(props.node); //can try to get graph nodes by id or tag\r\n        \r\n        if(!props.node) props.node = new GraphNode(props, props.parent, props.graph); //you could pass a graphnode \r\n\r\n        props.tag = props.node.tag;\r\n        if(!this.id) this.id = props.tag;\r\n\r\n        if(props.parent) {\r\n            props.parent.addChildren(props.node);\r\n        }\r\n    }\r\n\r\n    \r\n    //DOMElement custom callbacks:\r\n    //oncreate=(props)=>{} //after rendering\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nNodeDiv.addElement('graph-node');\r\n", "\r\nimport {DOMElement} from 'fragelement';\r\n\r\nimport {AcyclicGraph} from 'acyclicgraph'\r\n\r\nlet component = require('./acyclic.graph.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class Graph extends DOMElement {\r\n    props={\r\n        graph:new AcyclicGraph(),\r\n        nodes:[]\r\n    } //can specify properties of the element which can be subscribed to for changes.\r\n    \r\n    input_delay=1 //onload delay to give the children nodes enough time to get ready with their slight delays to work around the DOM a bit\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        setTimeout(\r\n            ()=> { //timeout ensures everything is on the DOM before pairing/creating graphnode objects as each is constructed sequentially and run before the next one exists\r\n                //get the child nodes from nested graph-node divs\r\n                let children = Array.from(this.children);\r\n                let top_children = [];\r\n                if(children?.length > 0) {\r\n                    children.forEach((n)=>{\r\n                        if(n.props) this.props.nodes.push(n.props.node);\r\n                        if(n.props && n.parentNode.tagName === this.tagName) top_children.push(n)\r\n                    });\r\n                }\r\n\r\n                this.children_ready(children,top_children);\r\n                \r\n            }, \r\n            this.input_delay\r\n        );\r\n    }\r\n\r\n    //like oncreate but once all of the child nodes should be loaded in the DOM, so you don't need to change the constructor\r\n    children_ready(all_children=[],top_children=[]) {\r\n        this.querySelector('button').onclick = () => { //test \r\n            top_children.forEach((c)=>{\r\n                c.props.node.runNode(c.props.node)\r\n            });\r\n        }\r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    //oncreate=(props)=>{}\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nGraph.addElement('acyclic-graph');\r\n", "import {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./canvas.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class CanvasNode extends NodeDiv {\r\n    props={\r\n        \r\n\r\n        operator:(\r\n            input,\r\n            node,\r\n            origin,\r\n            cmd\r\n        )=>{ \r\n\r\n            if(cmd === 'animate') {\r\n                //draw loop\r\n                this.draw(input,node,origin,cmd);\r\n                for(let i = 0; i < this.drawFuncs.length; i++) { //lets use other nodes to send draw functions to the canvas\r\n                    let f = this.drawFuncs[i];\r\n                    if(typeof f === 'function') {\r\n                        f(input,node,origin,cmd); //pass the args in (need these if you pass arrow functions)\r\n                    }\r\n                }\r\n            } else {\r\n                //e.g. input commands\r\n                if(typeof input === 'object') {\r\n                    \r\n                } else if (typeof input === 'number') {\r\n                    \r\n                } else if (typeof input === 'string') {\r\n                    \r\n                } else {\r\n                    \r\n                }\r\n            }\r\n        },\r\n\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:true, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    draw(input,node,origin,cmd) {\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n    }\r\n\r\n    addDraw(f) {\r\n        if(typeof f === 'function') this.drawFuncs.push(f);\r\n    }\r\n\r\n    drawFuncs = []; // draw(input,args,origin,cmd){} <--- passes operator args\r\n    \r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        this.canvas = this.querySelector('canvas');\r\n        if(props.width) {\r\n            this.canvas.width = props.width;\r\n            this.canvas.style.width = props.width;\r\n        }\r\n        if(props.height) {\r\n            this.canvas.height = props.height;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.style) {\r\n            this.canvas.style = props.style;\r\n            setTimeout(()=>{\r\n                this.canvas.height = this.canvas.clientHeight;\r\n                this.canvas.width = this.canvas.clientWidth;\r\n            },10); //slight recalculation delay time\r\n        }\r\n\r\n        props.canvas = this.canvas;\r\n        if(props.context) props.context = this.canvas.getContext(props.context);\r\n        else props.context = this.canvas.getContext('2d');\r\n        this.context = props.context;\r\n        this.ctx = this.context;\r\n        props.ctx = this.context;\r\n\r\n        setTimeout(()=>{if(props.animate) props.node.runAnimation();},10)\r\n\r\n    }\r\n\r\n    //after rendering\r\n    onresize=(props)=>{\r\n        if(this.canvas) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            this.canvas.style.width = this.canvas.clientWidth;\r\n            this.canvas.style.height = this.canvas.clientHeight;\r\n        }\r\n    } //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nCanvasNode.addElement('canvas-node');\r\n", "import {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./button.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class ButtonNode extends NodeDiv {\r\n    props={\r\n        operator:(input,node,origin,cmd)=>{ \r\n            if(input) this.props.input = input;\r\n            return this.props.input; \r\n        }, //Operator to handle I/O on this node. Returned inputs can propagate according to below settings\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:false, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n    \r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        let button = this.querySelector('button');\r\n\r\n        button.onclick = (ev) => {\r\n            props.node.run(props.input);\r\n        }\r\n    } //after rendering\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nButtonNode.addElement('button-node');\r\n", "\r\nimport {addCustomElement} from 'fragelement';\r\n\r\nimport {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./input.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class InputNode extends NodeDiv {\r\n    props={\r\n        operator:(input,node,origin,cmd)=>{ \r\n            this.props.input = input;\r\n            return input; \r\n        }, //Operator to handle I/O on this node. Returned inputs can propagate according to below settings\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:false, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n    \r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        let input = this.querySelector('input');\r\n        input.type = this.type;\r\n\r\n        input.oninput = (ev) => {\r\n            if(props.node) props.node.callChildren(ev.target.value); \r\n            //passes inputs to child nodes without triggering them to pass on\r\n        }\r\n    } //after rendering\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nInputNode.addElement('input-node');\r\n", "\r\nimport {DOMElement} from 'fragelement';\r\n\r\nlet component = require('./component.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class Custom extends DOMElement {\r\n    props={} //can specify properties of the element which can be subscribed to for changes.\r\n    \r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        //set up the business logic for the component\r\n        let button = this.querySelector('button');\r\n        let div = this.querySelector('div');\r\n        if(button) button.onclick = (ev)=>{\r\n            div.innerHTML = 'Clicked!'\r\n        };\r\n    }\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nCustom.addElement('custom-');\r\n", "\r\nimport {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./logger.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class LoggerDiv extends NodeDiv {\r\n\r\n    log = (\r\n        message,  //the message\r\n        templateString=`<tr><td>${message}</td></tr>` //can apply any template string you want per-line\r\n    ) => {\r\n\r\n        const t = document.createElement('template');\r\n        t.innerHTML = templateString;\r\n        const fragment = t.content;\r\n\r\n        if(!this.props.div) {     \r\n            this.props.div = this.querySelector('table');\r\n            if(this.props.scrollable) this.props.div.style.overflow = 'hidden';\r\n        }\r\n\r\n        if(this.props.messages.length >= this.props.max) {\r\n            this.props.messages.shift();\r\n            this.props.messagedivs[0].remove();\r\n            this.props.messagedivs.shift();\r\n        }\r\n        \r\n        this.props.messages.push(message);\r\n\r\n        this.props.div.appendChild(fragment);\r\n\r\n        let children = this.querySelectorAll('tr');\r\n        this.props.messagedivs.push(children[children.length-1]);\r\n\r\n        \r\n        if(this.props.messagedivs.length+2 >= this.props.max) {\r\n            if(this.props.messagedivs[this.props.max-3]) {\r\n                if(this.props.messagedivs.length === this.props.max)\r\n                    this.props.messagedivs[0].style.opacity = '0.25'; //add some fade out                }\r\n            }\r\n            if(this.props.messagedivs[this.props.max-2]) {\r\n                if(this.props.messagedivs.length === this.props.max) {\r\n                    this.props.messagedivs[1].style.opacity = '0.5'; \r\n                } else {    \r\n                    this.props.messagedivs[0].style.opacity = '0.5';\r\n                }\r\n            }\r\n            if (this.props.messagedivs.length === this.props.max) {\r\n                this.props.messagedivs[2].style.opacity = '0.75';\r\n            }\r\n            else if(this.props.messagedivs.length+1 >= this.props.max) {\r\n                this.props.messagedivs[1].style.opacity = '0.75'; \r\n            } else{\r\n                this.props.messagedivs[0].style.opacity = '0.75';\r\n            } \r\n        }\r\n\r\n    }\r\n    \r\n\r\n    props={\r\n        messages:[],\r\n        messagedivs:[],\r\n        max:5, //max messages in div\r\n        scrollable:false,\r\n        div:undefined,\r\n        log:this.log,\r\n\r\n        operator:(\r\n            input, //input, e.g. output from another node\r\n            node,  //'this' node\r\n            origin, //origin node\r\n            cmd    //e.g. 'loop' or 'animate' will be defined if the operator is running on the loop or animate routines, needed something. Can define more commands but you might as well use an object in input for that. \r\n        )=>{ console.log(input); return input; }, //Operator to handle I/O on this node. Returned inputs can propagate according to below settings\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:false, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n    } //after rendering\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nLoggerDiv.addElement('logger-');\r\n", "\r\nimport {DOMElement, addCustomElement} from 'fragelement';\r\nimport {settings} from '../../../../node_server/server_settings'\r\n\r\nlet component = require('./socket.component.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class Socket extends DOMElement {\r\n    props={\r\n        protocol:settings.socket_protocol,\r\n        host:settings.host, \r\n        port:settings.python, //settings.python_node \r\n        subdomain:'',\r\n        ws:undefined,\r\n        logger:undefined //logger node\r\n    } //can specify properties of the element which can be subscribed to for changes.\r\n    \r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    constructor(){\r\n        super();\r\n\r\n        //if(settings.protocol === 'http') this.props.protocol = 'ws'; //still ws for node sockets in https\r\n    }\r\n\r\n    //default\r\n    onmessage = async (event) => {\r\n\r\n        let ts = new Date(Date.now());\r\n        let tsm = ts.getHours()+':'+ts.getMinutes()+':'+ts.getSeconds();\r\n\r\n        let msg = event.data;\r\n\r\n        if(event.data.constructor.name === 'Blob') msg = await event.data.text();\r\n\r\n        let message = `${tsm}:: WS ${this.props.host}:${this.props.port} message:\\n ${msg}`;\r\n        let template = `<tr><td style='color:lightgreen;'>${message}</tr></td>`;\r\n\r\n        if(this.props.logger) this.props.logger.props.log(message,template);\r\n        else console.log(message);\r\n    }\r\n\r\n    onopen=undefined;\r\n    onclose=undefined;\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        //let host = 'localhost';\r\n        //let port = 7000;\r\n\r\n        if(!props.logger) props.logger = document.querySelector('logger-');\r\n        else if(typeof props.logger === 'string') props.logger = document.getElementById(props.logger);\r\n\r\n        try {\r\n            props.ws = new WebSocket(`${props.protocol}://${props.host}:${props.port}/${props.subdomain}`);  \r\n            props.ws.onmessage = this.onmessage;\r\n            this.ws = props.ws;\r\n\r\n            if(this.onopen) props.ws.addEventListener('open', this.onopen);\r\n            if(this.onclose) props.ws.addEventListener('close', this.onclose);\r\n\r\n            props.ws.onerror = (er) => {\r\n                props.ws.close();\r\n            };\r\n        } catch (err) {}\r\n      \r\n    }\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    ondelete=(props)=>{\r\n        props.ws.close();\r\n    } //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\naddCustomElement(Socket,'socket-');\r\n", "\r\nimport {DOMElement, addCustomElement} from 'fragelement';\r\nimport {settings} from '../../../../node_server/server_settings'\r\n\r\nlet component = require('./sse.component.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class SSE extends DOMElement {\r\n    props={\r\n        protocol:settings.protocol,\r\n        host:settings.host, \r\n        port:settings.python, \r\n        subdomain:'sse',\r\n        sse:undefined,\r\n        logger:undefined //logger node\r\n    } //can specify properties of the element which can be subscribed to for changes.\r\n    \r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    constructor(){\r\n        super();\r\n    }\r\n\r\n    onmessage = async (event) => {\r\n\r\n        let ts = new Date(Date.now());\r\n        let tsm = ts.getHours()+':'+ts.getMinutes()+':'+ts.getSeconds();\r\n\r\n        let msg = event.data;\r\n        if(event.data.constructor.name === 'Blob') msg = await event.data.text();\r\n\r\n        let message = `${tsm}:: SSE ${this.props.host}:${this.props.port} message:\\n ${msg}`;\r\n        let template = `<tr><td style='color:yellow;'>${message}</tr></td>`;\r\n\r\n        if(this.props.logger) this.props.logger.props.log(message,template);\r\n        else console.log(message);\r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        //let host = 'localhost';\r\n        //let port = 7000;\r\n\r\n        if(!props.logger) props.logger = document.querySelector('logger-');\r\n        else if(typeof props.logger === 'string') props.logger = document.getElementById(props.logger);\r\n\r\n        try {\r\n            props.sse = new EventSource(`${props.protocol}://${props.host}:${props.port}/${props.subdomain}`);\r\n            this.sse = props.sse;\r\n\r\n            if(props.sse) props.sse.onmessage = this.onmessage;\r\n\r\n            props.sse.onerror = (er) => { \r\n                console.error(er);\r\n                props.sse.close(); \r\n            }\r\n            \r\n        }\r\n        catch(err) {\r\n            console.error(err);\r\n        }\r\n    }\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    ondelete=(props)=>{\r\n        props.sse.close()\r\n    } //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\naddCustomElement(SSE,'sse-');\r\n", "\r\nimport {addCustomElement} from 'fragelement';\r\n\r\nimport {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./circlecanvas.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class CircleCanvasNode extends NodeDiv {\r\n    props={\r\n        radius:20,\r\n        triggered:false,\r\n\r\n        operator:(\r\n            input,\r\n            node,\r\n            origin,\r\n            cmd\r\n        )=>{ \r\n            \r\n            if(!this.props.triggered) {\r\n                this.props.radius += Math.random()-0.5;\r\n            }\r\n\r\n            if(cmd === 'animate') {\r\n                this.draw();\r\n                for(let i = 0; i < this.drawFuncs.length; i++) { //lets use other nodes to send draw functions to the canvas\r\n                    let f = this.drawFuncs[i];\r\n                    if(typeof f === 'function') {\r\n                        f(input,node,origin,cmd); //pass the args in (need these if you pass arrow functions)\r\n                    }\r\n                }\r\n            } else {\r\n                if(typeof input === 'object') {\r\n                    if(input.radius) this.props.radius += input.radius;\r\n                    this.props.triggered = true;\r\n                } else if (typeof input === 'number') {\r\n                    this.props.radius += input;\r\n                    this.props.triggered = true;\r\n                } else if (typeof input === 'string') {\r\n                    this.props.radius += parseFloat(input);\r\n                    this.props.triggered = true;\r\n                } else {\r\n                    this.props.radius += Math.random()-0.5;\r\n                    this.props.triggered = true;\r\n                }\r\n            }\r\n        },\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:true, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    draw(input,node,origin,cmd) {\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n        if(this.props.radius <= 1) this.props.radius = 1;\r\n        ctx.clearRect(0,0,canvas.width,canvas.height);\r\n        this.drawCircle(\r\n            canvas.width*0.5,\r\n            canvas.height*0.5,\r\n            this.props.radius,\r\n            'green',\r\n            5,\r\n            '#003300'\r\n        );\r\n    }\r\n\r\n    addDraw(f) {\r\n        if(typeof f === 'function') this.drawFuncs.push(f);\r\n    }\r\n\r\n    drawFuncs = []; // draw(input,args,origin,cmd){} <--- passes operator args\r\n        \r\n    drawCircle(centerX, centerY, radius, fill='green', strokewidth=5, strokestyle='#003300') {\r\n        this.props.ctx.beginPath();\r\n        this.props.ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);\r\n        this.props.ctx.fillStyle = fill;\r\n        this.props.ctx.fill();\r\n        this.props.ctx.lineWidth = strokewidth;\r\n        this.props.ctx.strokeStyle = strokestyle;\r\n        this.props.ctx.stroke();\r\n    }\r\n\r\n    drawLine(\r\n        from={x:0,y:0},\r\n        to={x:1,y:1},\r\n        strokewidth=5,\r\n        strokestyle='#003300'\r\n    ) {\r\n        this.props.ctx.beginPath();\r\n        this.props.ctx.lineWidth = strokewidth;\r\n        this.props.ctx.strokeStyle = strokestyle;\r\n        this.props.ctx.moveTo(from.x, from.y);\r\n        this.props.ctx.lineTo(to.x, to.y);\r\n        this.props.ctx.stroke();\r\n    }\r\n    \r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        this.canvas = this.querySelector('canvas');\r\n        if(props.width) {\r\n            this.canvas.width = props.width;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.height) {\r\n            this.canvas.height = props.height;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.style) {\r\n            this.canvas.style = props.style;\r\n            setTimeout(()=>{\r\n                this.canvas.height = this.canvas.clientHeight;\r\n                this.canvas.width = this.canvas.clientWidth;\r\n            },10); //slight recalculation delay time\r\n        }\r\n\r\n        props.canvas = this.canvas;\r\n        if(props.context) props.context = this.canvas.getContext(props.context);\r\n        else props.context = this.canvas.getContext('2d');\r\n        this.context = props.context;\r\n        this.ctx = this.context;\r\n        props.ctx = this.context;\r\n\r\n        setTimeout(()=>{if(props.animate) props.node.runAnimation();},10)\r\n\r\n    }\r\n\r\n    //after rendering\r\n    onresize=(props)=>{\r\n        if(this.canvas) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            this.canvas.style.width = this.canvas.clientWidth;\r\n            this.canvas.style.height = this.canvas.clientHeight;\r\n        }\r\n    } //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nCircleCanvasNode.addElement('circlecanvas-node');\r\n", "import {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nlet component = require('./place.node.html');\r\n\r\n// /r/place ripoff\r\nexport class PlaceNode extends NodeDiv {\r\n    props={\r\n        colorPicked:'red',\r\n        xSize:128,\r\n        ySize:128,\r\n        xPosition:1, //we'll use absolute positions on the grid independent of canvas size\r\n        yPosition:1,\r\n        xPixelSize:5,\r\n        yPixelSize:5,\r\n        zoom:1,\r\n        data:{},\r\n        canvasClicked: this.canvasClicked, //reference\r\n        //keys:[],\r\n        updated:{}, //indices of updated data\r\n        operator:(\r\n            input,\r\n            node,\r\n            origin,\r\n            cmd\r\n        )=>{ \r\n\r\n            if(cmd === 'update') {\r\n                Object.assign(this.props.data,input);\r\n                //this.props.keys = Object.keys(this.props.data);\r\n            }\r\n\r\n            if(cmd === 'animate') {\r\n\r\n                //should sync this.props.updated between users right here if doing multiplayer\r\n\r\n                //draw loop\r\n                this.draw(input,node,origin,cmd);\r\n                for(let i = 0; i < this.drawFuncs.length; i++) { //lets use other nodes to send draw functions to the canvas\r\n                    let f = this.drawFuncs[i];\r\n                    if(typeof f === 'function') {\r\n                        f(input,node,origin,cmd); //pass the args in (need these if you pass arrow functions)\r\n                    }\r\n                }\r\n            } else {\r\n                //e.g. input commands\r\n                if(typeof input === 'object') {\r\n                    \r\n                } else if (typeof input === 'number') {\r\n                    \r\n                } else if (typeof input === 'string') {\r\n                    \r\n                } else {\r\n                    \r\n                }\r\n            }\r\n        },\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:true, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    draw(input,node,origin,cmd) {\r\n\r\n        //only draws updated pixels\r\n\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n\r\n        //xp/yp in canvas coordinates\r\n        let centerX = canvas.width*0.5;\r\n        let centerY = canvas.height*0.5;\r\n\r\n        let xPWidth = this.props.xPixelSize*this.props.zoom;\r\n        let yPHeight = this.props.yPixelSize*this.props.zoom;\r\n\r\n        //calculate the visible area based on zoom \r\n        let nPixelsX = Math.ceil(canvas.width/xPWidth); if(nPixelsX > this.props.xSize) nPixelsX = this.props.xSize;\r\n        let nPixelsY = Math.ceil(canvas.height/yPHeight); if(nPixelsY > this.props.ySize) nPixelsY = this.props.ySize;\r\n        \r\n        //first find where we are inside the current pixel based on xP,yP and zoom\r\n        //let gridRelX = this.props.xPosition / this.props.xPixelSize*this.props.xSize; //relative position inside the current pixel (in units)\r\n        //let gridRelY = this.props.yPosition / this.props.yPixelSize*this.props.ySize;\r\n\r\n        let currPixelRelX = this.props.xPosition % this.props.xPixelSize;\r\n        let currPixelRelY = this.props.yPosition % this.props.yPixelSize;\r\n\r\n        let centerPixelX = Math.floor(this.props.xPosition/this.props.xPixelSize);\r\n        let centerPixelY = Math.floor(this.props.yPosition/this.props.yPixelSize);\r\n\r\n        //let curPixelIdx = centerPixelX + this.props.xSize*centerPixelY;\r\n            \r\n        let nPixelsLeft = currPixelRelX;\r\n        while(nPixelsLeft < centerX && nPixelsLeft < xPWidth*this.props.xSize*0.5) {\r\n            nPixelsLeft += xPWidth;\r\n        }\r\n        nPixelsLeft = nPixelsLeft/xPWidth;\r\n        \r\n        let nPixelsUp = currPixelRelY;\r\n\r\n        while(nPixelsUp < centerY && nPixelsUp < yPHeight*this.props.ySize*0.5) {\r\n            nPixelsUp += yPHeight;\r\n        }\r\n        nPixelsUp = nPixelsUp/yPHeight;\r\n\r\n        let x0 = centerPixelX - Math.floor(nPixelsLeft); // = Math.floor(this.props.xPosition - nPixelsX*0.5);\r\n        let y0 = centerPixelY - Math.floor(nPixelsUp); // = Math.floor(this.props.yPosition - nPixelsY*0.5);\r\n\r\n        //ending indices to render against\r\n        let xn = x0+nPixelsX;\r\n        let yn = y0+nPixelsY;\r\n\r\n        //now calculate the view window to render rects according to the index colors\r\n        let startingX = centerX - nPixelsLeft*xPWidth;\r\n        let startingY = centerY - nPixelsUp*yPHeight;\r\n        \r\n        //console.log(centerPixelX,centerPixelY,nPixelsLeft,nPixelsUp,x0,y0,xn,yn,startingX,startingY,);\r\n\r\n        //need to start at the x0,y0 position of the blown up pixel and then step along \r\n        // the modified height/width to render the squares in the viewport\r\n        for(let i = x0; i < xn; i++) {\r\n            for(let j = y0; j < yn; j++) {\r\n                let dataidx = i+j*this.props.xSize;\r\n\r\n                if(!this.props.data[dataidx]) continue; //OOB\r\n                if(!this.props.updated[dataidx]) continue;\r\n\r\n                this.props.data[dataidx] = this.props.updated[dataidx];\r\n                delete this.props.updated[dataidx]; \r\n\r\n                ctx.fillStyle = this.props.data[dataidx];\r\n\r\n                let rx0 = startingX+(i-x0)*xPWidth;\r\n                let ry0 = startingY+(j-y0)*yPHeight;\r\n\r\n                //no need to draw out of bounds\r\n                if(rx0 < 0) rx0 = 0;\r\n                else if (rx0 > canvas.width) continue;\r\n                if(ry0 < 0) ry0 = 0;\r\n                else if (ry0 > canvas.height) continue;\r\n\r\n                ctx.fillRect(\r\n                    rx0,\r\n                    ry0,\r\n                    xPWidth,\r\n                    yPHeight\r\n                );\r\n                \r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    addDraw(f) {\r\n        if(typeof f === 'function') this.drawFuncs.push(f);\r\n    }\r\n\r\n    drawFuncs = []; // draw(input,args,origin,cmd){} <--- passes operator args\r\n    \r\n    drawSquare() {\r\n        \r\n        console.time('square');\r\n\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n\r\n        ctx.clearRect(0,0,canvas.width,canvas.height);\r\n\r\n        //xp/yp in canvas coordinates\r\n        let centerX = canvas.width*0.5;\r\n        let centerY = canvas.height*0.5;\r\n\r\n        let xPWidth = this.props.xPixelSize*this.props.zoom;\r\n        let yPHeight = this.props.yPixelSize*this.props.zoom;\r\n\r\n        //calculate the visible area based on zoom \r\n        let nPixelsX = Math.ceil(canvas.width/xPWidth); if(nPixelsX > this.props.xSize) nPixelsX = this.props.xSize;\r\n        let nPixelsY = Math.ceil(canvas.height/yPHeight); if(nPixelsY > this.props.ySize) nPixelsY = this.props.ySize;\r\n        \r\n        //first find where we are inside the current pixel based on xP,yP and zoom\r\n        //let gridRelX = this.props.xPosition / this.props.xPixelSize*this.props.xSize; //relative position inside the current pixel (in units)\r\n        //let gridRelY = this.props.yPosition / this.props.yPixelSize*this.props.ySize;\r\n\r\n        let currPixelRelX = this.props.xPosition % this.props.xPixelSize;\r\n        let currPixelRelY = this.props.yPosition % this.props.yPixelSize;\r\n\r\n        let centerPixelX = Math.floor(this.props.xPosition/this.props.xPixelSize);\r\n        let centerPixelY = Math.floor(this.props.yPosition/this.props.yPixelSize);\r\n\r\n        //let curPixelIdx = centerPixelX + this.props.xSize*centerPixelY;\r\n            \r\n        let nPixelsLeft = currPixelRelX;\r\n        while(nPixelsLeft < centerX && nPixelsLeft < xPWidth*this.props.xSize*0.5) {\r\n            nPixelsLeft += xPWidth;\r\n        }\r\n        nPixelsLeft = nPixelsLeft/xPWidth;\r\n        \r\n        let nPixelsUp = currPixelRelY;\r\n\r\n        while(nPixelsUp < centerY && nPixelsUp < yPHeight*this.props.ySize*0.5) {\r\n            nPixelsUp += yPHeight;\r\n        }\r\n        nPixelsUp = nPixelsUp/yPHeight;\r\n\r\n        let x0 = centerPixelX - Math.floor(nPixelsLeft); // = Math.floor(this.props.xPosition - nPixelsX*0.5);\r\n        let y0 = centerPixelY - Math.floor(nPixelsUp); // = Math.floor(this.props.yPosition - nPixelsY*0.5);\r\n\r\n        //ending indices to render against\r\n        let xn = x0+nPixelsX;\r\n        let yn = y0+nPixelsY;\r\n\r\n        //now calculate the view window to render rects according to the index colors\r\n        let startingX = centerX - nPixelsLeft*xPWidth;\r\n        let startingY = centerY - nPixelsUp*yPHeight;\r\n        \r\n        //console.log(centerPixelX,centerPixelY,nPixelsLeft,nPixelsUp,x0,y0,xn,yn,startingX,startingY,);\r\n\r\n        //need to start at the x0,y0 position of the blown up pixel and then step along \r\n        // the modified height/width to render the squares in the viewport\r\n        for(let i = x0; i < xn; i++) {\r\n            for(let j = y0; j < yn; j++) {\r\n                let dataidx = i+j*this.props.xSize;\r\n\r\n                if(!this.props.data[dataidx]) continue; //OOB\r\n\r\n                ctx.fillStyle = this.props.data[dataidx];\r\n\r\n                let rx0 = startingX+(i-x0)*xPWidth;\r\n                let ry0 = startingY+(j-y0)*yPHeight;\r\n\r\n                //no need to draw out of bounds\r\n                if(rx0 < 0) rx0 = 0;\r\n                else if (rx0 > canvas.width) continue;\r\n                if(ry0 < 0) ry0 = 0;\r\n                else if (ry0 > canvas.height) continue;\r\n\r\n                ctx.fillRect(\r\n                    rx0,\r\n                    ry0,\r\n                    xPWidth,\r\n                    yPHeight\r\n                );\r\n                \r\n\r\n            }\r\n        }\r\n\r\n        console.timeEnd('square');\r\n    }\r\n\r\n    canvasClicked = (x,y) => {\r\n        let canvasx = x;\r\n        let canvasy = y;\r\n\r\n        //xp/yp in canvas coordinates\r\n        let centerX = this.canvas.width*0.5;\r\n        let centerY = this.canvas.height*0.5;\r\n\r\n        let xPWidth = this.props.xPixelSize*this.props.zoom;\r\n        let yPHeight = this.props.yPixelSize*this.props.zoom;\r\n        \r\n        let currPixelRelX = this.props.xPosition % this.props.xPixelSize;\r\n        let currPixelRelY = this.props.yPosition % this.props.yPixelSize;\r\n\r\n        //let centerPixelX = Math.floor(this.props.xPosition/this.props.xPixelSize);\r\n        //let centerPixelY = Math.floor(this.props.yPosition/this.props.yPixelSize);\r\n\r\n        let clickCenterOffsetX = canvasx-this.canvas.width*0.5;\r\n        let clickCenterOffsetY = canvasy-this.canvas.height*0.5;\r\n\r\n        //find the pixel that was clicked\r\n        //console.log(canvasx,canvasy);\r\n\r\n        let nPixelsLeft = currPixelRelX;\r\n        while(nPixelsLeft < centerX+clickCenterOffsetX) {\r\n            nPixelsLeft += xPWidth;\r\n        }\r\n        nPixelsLeft = (nPixelsLeft - 0.5*(this.canvas.width - xPWidth * this.props.xSize))/xPWidth;\r\n\r\n        let nPixelsUp = currPixelRelY;\r\n\r\n        while(nPixelsUp < centerY+clickCenterOffsetY) {\r\n            nPixelsUp += yPHeight;\r\n        }\r\n        nPixelsUp = (nPixelsUp - 0.5*(this.canvas.height - yPHeight * this.props.ySize))/yPHeight;\r\n\r\n        //console.log(nPixelsLeft,nPixelsUp);\r\n\r\n        let idx = nPixelsLeft + nPixelsUp * this.props.xSize;\r\n\r\n        if(this.props.data[idx]) {\r\n            this.props.updated[idx] = this.props.colorPicked;\r\n        }\r\n\r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        this.canvas = this.querySelector('canvas');\r\n        if(props.width) {\r\n            this.canvas.width = props.width;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.height) {\r\n            this.canvas.height = props.height;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.style) {\r\n            this.canvas.style = props.style;\r\n            setTimeout(()=>{\r\n                this.canvas.height = this.canvas.clientHeight;\r\n                this.canvas.width = this.canvas.clientWidth;\r\n                        \r\n                this.generateDataStructure();\r\n\r\n                this.props.xPosition = this.props.xPixelSize*this.props.xSize * 0.5;\r\n                this.props.yPosition = this.props.yPixelSize*this.props.ySize * 0.5;\r\n\r\n                this.drawSquare();\r\n                \r\n            },10); //slight recalculation delay time\r\n        }\r\n\r\n        props.canvas = this.canvas;\r\n        if(props.context) props.context = this.canvas.getContext(props.context);\r\n        else props.context = this.canvas.getContext('2d');\r\n        this.context = props.context;\r\n        this.ctx = this.context;\r\n        props.ctx = this.context;\r\n\r\n        this.canvas.onmousedown = (ev) => {\r\n            this.canvasClicked(ev.pageX - this.canvas.offsetLeft,ev.pageY - this.canvas.offsetTop);\r\n            this.canvas.onmousemove = (ev) => {\r\n                this.canvasClicked(ev.pageX - this.canvas.offsetLeft,ev.pageY - this.canvas.offsetTop);\r\n            }\r\n            this.canvas.onmouseup = (ev) => {\r\n                this.canvas.onmousemove = undefined;\r\n            }\r\n        };\r\n\r\n        //setup menus\r\n\r\n        this.querySelector('#zoomin').onclick = (ev) => {\r\n            this.props.zoom += 0.1;\r\n            this.drawSquare();\r\n        }\r\n\r\n        this.querySelector('#zoomout').onclick = (ev) => {\r\n            this.props.zoom -= 0.1;\r\n            this.drawSquare();\r\n        }\r\n\r\n        this.querySelector('#panleft').onclick = (ev) => {\r\n            this.props.xPosition += this.props.xPixelSize;\r\n            this.drawSquare();\r\n        }\r\n\r\n        this.querySelector('#panright').onclick = (ev) => {\r\n            this.props.xPosition -= this.props.xPixelSize;\r\n            this.drawSquare();\r\n        }\r\n\r\n        this.querySelector('#panup').onclick = (ev) => {\r\n            this.props.yPosition -= this.props.yPixelSize;\r\n            this.drawSquare();\r\n        }\r\n        \r\n        this.querySelector('#pandown').onclick = (ev) => {\r\n            this.props.yPosition += this.props.yPixelSize;\r\n            this.drawSquare();\r\n        }\r\n\r\n        this.querySelector('#colorwheel').onchange = (ev) => {\r\n            console.log(ev.target.value);\r\n            this.props.colorPicked = ev.target.value;\r\n        }\r\n\r\n        setTimeout(()=>{if(props.animate) props.node.runAnimation();},10)\r\n\r\n    }\r\n\r\n    //after rendering\r\n    onresize=(props)=>{\r\n        if(this.canvas) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            this.canvas.style.width = this.canvas.clientWidth;\r\n            this.canvas.style.height = this.canvas.clientHeight;\r\n\r\n            this.drawSquare();\r\n        }\r\n    } //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n\r\n    //generate a color map indexed with ints corresponding to hex values\r\n    generateDataStructure(\r\n        defaultColor=(xCoord,yCoord)=>{\r\n            return `rgb(${255*xCoord/this.props.xSize},0,${255*yCoord/this.props.ySize})`;\r\n        }\r\n    ) {\r\n\r\n        for(let i = 0; i < this.props.xSize; i++) {\r\n            for(let j = 0; j < this.props.ySize; j++) {\r\n                let index = i+j*this.props.xSize;\r\n                if(!this.props.data[index]) {\r\n                    if(typeof defaultColor === 'function') this.props.data[index] = defaultColor(i,j);\r\n                    else if (defaultColor) this.data[index] = defaultColor;\r\n                    else this.props.data[index] = `0xFFFFFF`;\r\n                }\r\n            }\r\n        }\r\n\r\n        //this.props.keys = Object.keys(this.props.data);\r\n    }\r\n\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nPlaceNode.addElement('place-node');\r\n", "//By Joshua Brewster (MIT License)\r\nexport class DynamicParticles {\r\n    constructor(\r\n        rules=[\r\n        ['boids',100],\r\n        ['boids',50]\r\n        ], \r\n        canvas=undefined,\r\n        defaultCanvas=true,\r\n        init=true\r\n    ) {\r\n        \r\n        this.canvas = canvas;\r\n        this.defaultCanvas=defaultCanvas;\r\n        this.ctx = undefined;\r\n        this.looping = false;\r\n        this.currFrame = performance.now()*0.001; \r\n        this.frameOffset = undefined;\r\n        this.ticks = 0;\r\n\r\n        this.startingRules = rules;\r\n\r\n        /*\r\n            Rule format:\r\n            [\r\n                [ //group 1 rule\r\n                    'type', //named group type. Use addRule(...) to generate rulesets\r\n                    maxcount,  //max number of particles\r\n                    boundingBox[x,y,z], //bounding box for the group. Scales calculations accordingly. Can also use the canvas dimensions passed in by default\r\n                    spawnRate, //number of particles added per frame (respawns all if undefined)\r\n                    initialCount //initial count of particles (spawns all if undefined) \r\n                    useBoids, //use boids? mainly applies to the default function unless you integrate this into your own rules\r\n                    timestepFunc, (per particle timestep, groups have additional rules for efficient scoping)\r\n                    \r\n                ], etc...\r\n            ]\r\n        */\r\n\r\n        this.nGroups = this.startingRules.length;\r\n\r\n        this.particles = [];\r\n        this.maxParticles = 0; //max possible particles based on rulesets\r\n\r\n        this.colorScale = ['#000000', '#030106', '#06010c', '#090211', '#0c0215', '#0e0318', '#10031b', '#12041f', '#130522', '#140525', '#150628', '#15072c', '#16082f', '#160832', '#160936', '#160939', '#17093d', '#170a40', '#170a44', '#170a48', '#17094b', '#17094f', '#170953', '#170956', '#16085a', '#16085e', '#150762', '#140766', '#140669', '#13066d', '#110571', '#100475', '#0e0479', '#0b037d', '#080281', '#050185', '#020089', '#00008d', '#000090', '#000093', '#000096', '#000099', '#00009c', '#00009f', '#0000a2', '#0000a5', '#0000a8', '#0000ab', '#0000ae', '#0000b2', '#0000b5', '#0000b8', '#0000bb', '#0000be', '#0000c1', '#0000c5', '#0000c8', '#0000cb', '#0000ce', '#0000d1', '#0000d5', '#0000d8', '#0000db', '#0000de', '#0000e2', '#0000e5', '#0000e8', '#0000ec', '#0000ef', '#0000f2', '#0000f5', '#0000f9', '#0000fc', '#0803fe', '#2615f9', '#3520f4', '#3f29ef', '#4830eb', '#4e37e6', '#543ee1', '#5944dc', '#5e49d7', '#614fd2', '#6554cd', '#6759c8', '#6a5ec3', '#6c63be', '#6e68b9', '#6f6db4', '#7072af', '#7177aa', '#717ba5', '#7180a0', '#71859b', '#718996', '#708e91', '#6f928b', '#6e9786', '#6c9b80', '#6aa07b', '#68a475', '#65a96f', '#62ad69', '#5eb163', '#5ab65d', '#55ba56', '#4fbf4f', '#48c347', '#40c73f', '#36cc35', '#34ce32', '#37cf31', '#3ad130', '#3cd230', '#3fd32f', '#41d52f', '#44d62e', '#46d72d', '#48d92c', '#4bda2c', '#4ddc2b', '#4fdd2a', '#51de29', '#53e029', '#55e128', '#58e227', '#5ae426', '#5ce525', '#5ee624', '#60e823', '#62e922', '#64eb20', '#66ec1f', '#67ed1e', '#69ef1d', '#6bf01b', '#6df11a', '#6ff318', '#71f416', '#73f614', '#75f712', '#76f810', '#78fa0d', '#7afb0a', '#7cfd06', '#7efe03', '#80ff00', '#85ff00', '#89ff00', '#8eff00', '#92ff00', '#96ff00', '#9aff00', '#9eff00', '#a2ff00', '#a6ff00', '#aaff00', '#adff00', '#b1ff00', '#b5ff00', '#b8ff00', '#bcff00', '#bfff00', '#c3ff00', '#c6ff00', '#c9ff00', '#cdff00', '#d0ff00', '#d3ff00', '#d6ff00', '#daff00', '#ddff00', '#e0ff00', '#e3ff00', '#e6ff00', '#e9ff00', '#ecff00', '#efff00', '#f3ff00', '#f6ff00', '#f9ff00', '#fcff00', '#ffff00', '#fffb00', '#fff600', '#fff100', '#ffec00', '#ffe700', '#ffe200', '#ffdd00', '#ffd800', '#ffd300', '#ffcd00', '#ffc800', '#ffc300', '#ffbe00', '#ffb900', '#ffb300', '#ffae00', '#ffa900', '#ffa300', '#ff9e00', '#ff9800', '#ff9300', '#ff8d00', '#ff8700', '#ff8100', '#ff7b00', '#ff7500', '#ff6f00', '#ff6800', '#ff6100', '#ff5a00', '#ff5200', '#ff4900', '#ff4000', '#ff3600', '#ff2800', '#ff1500', '#ff0004', '#ff000c', '#ff0013', '#ff0019', '#ff001e', '#ff0023', '#ff0027', '#ff002b', '#ff012f', '#ff0133', '#ff0137', '#ff013b', '#ff023e', '#ff0242', '#ff0246', '#ff0349', '#ff034d', '#ff0450', '#ff0454', '#ff0557', '#ff065b', '#ff065e', '#ff0762', '#ff0865', '#ff0969', '#ff0a6c', '#ff0a70', '#ff0b73', '#ff0c77', '#ff0d7a', '#ff0e7e', '#ff0f81', '#ff1085', '#ff1188', '#ff128c', '#ff138f', '#ff1493'];\r\n\r\n        this.rules = [\r\n            {type:'default',groupRuleGen:this.defaultGroupRule, timestepFunc:this.defaultTimestepFunc, animateParticle:this.defaultAnimation},\r\n            {type:'boids',groupRuleGen:this.defaultGroupRule, timestepFunc:this.defaultTimestepFunc, animateParticle:this.defaultAnimation }\r\n        ]\r\n\r\n        this.prototype = {\r\n            position:{x:0,y:0,z:0},\r\n            velocity:{x:0,y:0,z:0},\r\n            acceleration:{x:0,y:0,z:0},\r\n            force:{x:0,y:0,z:0},\r\n            timestepFunc: undefined,//(group,particle,timeStep)=>{} per-particle step function you can customize\r\n            type:\"boids\", //Behavior trees: boids, predators, plant cell, animal cell, algae, bacteria, atom, proton, neutron, electron, conway, can combine\r\n            particleSize: 5,\r\n            startingX: 0.5, \r\n            startingY: 0.5,\r\n            maxSpeed: 40, \r\n            xBounce: -1,\r\n            yBounce: -1,\r\n            gravity: 0.0, //Downward z acceleration (-9.81m/s^2 = Earth gravity)\r\n            mass:1,\r\n            drag:0.033, //Drag coefficient applied to v(t-1)\r\n            life:0, //Seconds since spawn\r\n            lifeTime: 100000000, //Number of seconds before the particle despawns\r\n            boundingBox:{left:0,right:1,bot:1,top:0,front:0,back:1}, //bounding box, 1 = max height/width of render window\r\n            boid:{\r\n                boundingBox:{left:0,right:1,bot:1,top:0,front:0,back:1}, //bounding box, 1 = max height/width of render window\r\n                cohesion:0.00001,\r\n                separation:0.0001,\r\n                alignment:0.006,\r\n                swirl:{x:0.5,y:0.5,z:0.5,mul:0.006},\r\n                attractor:{x:0.5,y:0.5,z:0.5,mul:0.002},\r\n                avoidance:{groups:[],mul:0.1},\r\n                useCohesion:true,\r\n                useSeparation:true,\r\n                useAlignment:true,\r\n                useSwirl:true,\r\n                useAttractor:true,\r\n                useAvoidance:true,\r\n                attraction: 0.00000000006674, //Newton's gravitational constant by default\r\n                useAttraction:false, //particles can attract each other on a curve\r\n                groupRadius:200,\r\n                groupSize:10,\r\n                searchLimit:10\r\n            },\r\n            plant:{\r\n                diet:\"photosynthetic\", //if plant or animal cell: herbivore, carnivore, omnivore, photosynthetic, dead, dead_animal, dead_plant. Determines what other particles they will consume/trend toward\r\n            },\r\n            animal:{\r\n                diet:\"omnivore\", //if plant or animal cell: herbivore, carnivore, omnivore, photosynthetic, dead, dead_animal, dead_plant. Determines what other particles they will consume/trend toward\r\n            },\r\n            bacteria:{},\r\n            atom:{},\r\n            proton:{},\r\n            neutron:{},\r\n            electron:{},\r\n            conway:{\r\n                survivalRange:[2,3], //nCell neighbors range for survival & reproduction\r\n                reproductionRange:[3,3], //nCell neighbors range required to produce a living cell\r\n                groupRadius:10 //pixel distance for grouping \r\n            }\r\n            \r\n        };\r\n\r\n        if(init) this.init();\r\n        \r\n    }\r\n\r\n    init = (rules=this.startingRules) => {\r\n        if(this.canvas && this.defaultCanvas) {\r\n            this.ctx = this.canvas.getContext(\"2d\");\r\n        }\r\n        if(this.canvas) {\r\n            window.addEventListener('resize',this.onresize);\r\n        }\r\n\r\n        this.setupRules(rules);\r\n        this.startingRules = rules;\r\n\r\n        if(!this.looping) {\r\n            this.currFrame = performance.now()*0.001;\r\n            this.looping = true;\r\n            this.loop();\r\n        }\r\n    }\r\n\r\n    setupRules(rules=this.startingRules) {\r\n        rules.forEach((rule,i) => {\r\n            //console.log(rule)\r\n            let group = this.addGroup(rule);\r\n        });\r\n        return this.particles;\r\n    }\r\n\r\n    deinit = () => {\r\n        this.looping = false;\r\n        if(this.canvas) {\r\n            window.removeEventListener('resize',this.onresize());\r\n        } \r\n    }\r\n    \r\n    defaultAnimation = (particle) => {\r\n        this.ctx.beginPath();\r\n        let magnitude = Math.sqrt(particle.velocity.x*particle.velocity.x + particle.velocity.y*particle.velocity.y + particle.velocity.z*particle.velocity.z)\r\n        \r\n        var value = Math.floor(magnitude*255/(particle.maxSpeed*1.2));\r\n        if(value > 255) { value = 255; }\r\n        else if (value < 0) { value = 0; }\r\n        this.ctx.fillStyle = this.colorScale[value];\r\n\r\n        // Draws a circle of radius 20 at the coordinates 100,100 on the canvas\r\n        this.ctx.arc(particle.position.x, particle.position.y, particle.particleSize, 0, Math.PI*2, true); \r\n        this.ctx.closePath();\r\n        this.ctx.fill();\r\n\r\n    }\r\n\r\n    distance3D(a,b) //assumes you're passing two Array(3) i.e. [x,y,z]\r\n    {\r\n        if(Array.isArray(a)) { \r\n            return Math.sqrt((b[0]-a[0])*(b[0]-a[0]) + (b[1]-a[1])*(b[1]-a[1]) + (b[2]-a[2])*(b[2]-a[2]));\r\n        }\r\n        else {\r\n            return Math.sqrt((b.x-a.x)*(b.x-a.x) + (b.y-a.y)*(b.y-a.y) + (b.z-a.z)*(b.z-a.z));\r\n        }\r\n    }  \r\n\r\n    normalize3D(vec3 = []) {\r\n        let normal;\r\n        if(Array.isArray(vec3)) {\r\n            normal = Math.sqrt(vec3[0]*vec3[0]+vec3[1]*vec3[1]+vec3[2]*vec3[2]);\r\n            return [vec3[0]/normal,vec3[1]/normal,vec3[2]/normal];\r\n        }\r\n        else  {\r\n            normal = Math.sqrt(vec3.x*vec3.x+vec3.y*vec3.y+vec3.z*vec3.z);\r\n            return {x:vec3.x/normal,y:vec3.y/normal,z:vec3.z/normal};\r\n        }\r\n            \r\n    }\r\n\r\n    //Assign new properties to a group by index\r\n    updateGroupProperties=(groupIdx,properties={},key=undefined,subkey=undefined)=>{\r\n        if(key) {\r\n            if(subkey)\r\n            this.particles[groupIdx].particles.map(p=>Object.assign(p[key][subkey],properties));\r\n            else\r\n                this.particles[groupIdx].particles.map(p=>Object.assign(p[key],properties));\r\n        \r\n        }    else\r\n            this.particles[groupIdx].particles.map(p=>Object.assign(p,properties));\r\n    }\r\n\r\n    defaultGroupRule = (particle,rule) =>{\r\n\r\n        particle.type = rule[0];\r\n\r\n        if(rule[1] > 3000 && rule[1] < 5000) {particle.boid.searchLimit = 3;}\r\n        else if (rule[1]>=5000) {particle.boid.searchLimit = 1;}\r\n\r\n        let avoidanceGroups = rule[7];\r\n        if(avoidanceGroups){\r\n            particle.boid.avoidance.groups = avoidanceGroups;\r\n        } \r\n\r\n        let h=1,w=1,d=1;\r\n        if(rule[2]){\r\n             h = rule[2][0];\r\n             w = rule[2][1];\r\n             d = rule[2][2];\r\n            particle.boid.separation *= (h+w+d)/3;\r\n        }\r\n        else if(this.canvas) {\r\n             h = this.canvas.height;\r\n             w = this.canvas.width;\r\n             d = this.canvas.width;\r\n        } else {\r\n             h = 1;\r\n             w = 1;\r\n             d = 1;\r\n        }\r\n        let startX =  Math.random()*w;\r\n        let startY =  Math.random()*h;\r\n        let startZ =  Math.random()*d;\r\n        particle.startingX = Math.random();\r\n        particle.startingY = Math.random();\r\n        particle.startingZ = Math.random();\r\n        particle.position = {x:startX,y:startY,z:startZ};\r\n        particle.boundingBox = {\r\n            left:particle.boundingBox.left*w,\r\n            right:particle.boundingBox.right*w,\r\n            bot:particle.boundingBox.bot*h,\r\n            top:particle.boundingBox.top*h,\r\n            front:particle.boundingBox.front*d,\r\n            back:particle.boundingBox.back*d\r\n        };\r\n        particle.boid.boundingBox = {\r\n            left:particle.boid.boundingBox.left*w,\r\n            right:particle.boid.boundingBox.right*w,\r\n            bot:particle.boid.boundingBox.bot*h,\r\n            top:particle.boid.boundingBox.top*h,\r\n            front:particle.boid.boundingBox.front*d,\r\n            back:particle.boid.boundingBox.back*d\r\n        };\r\n        particle.boid.attractor = {\r\n            x:0.5*w,\r\n            y:0.5*h,\r\n            z:0.5*d,\r\n            mul:particle.boid.attractor.mul\r\n        };\r\n        particle.boid.swirl = {\r\n            x:0.5*w,\r\n            y:0.5*h,\r\n            z:0.5*d,\r\n            mul:particle.boid.swirl.mul\r\n        };\r\n    } //can dynamically allocate particle group properties\r\n\r\n    checkParticleBounds = (particle) => {\r\n        \r\n        if((particle.velocity.x > particle.maxSpeed) || (particle.velocity.y > particle.maxSpeed) || (particle.velocity.z > particle.maxSpeed) || (particle.velocity.x < -particle.maxSpeed) || (particle.velocity.y < -particle.maxSpeed) || (particle.velocity.z < -particle.maxSpeed)) {\r\n            let normalized = this.normalize3D([particle.velocity.x,particle.velocity.y,particle.velocity.z]);\r\n            particle.velocity.x = normalized[0]*particle.maxSpeed;\r\n            particle.velocity.y = normalized[1]*particle.maxSpeed;\r\n            particle.velocity.z = normalized[2]*particle.maxSpeed;\r\n        }\r\n        \r\n        // Give the particle some bounce\r\n        if ((particle.position.y - particle.particleSize) <= particle.boundingBox.top) {\r\n            particle.velocity.y *= particle.yBounce;\r\n            particle.position.y = particle.boundingBox.top + particle.particleSize;\r\n        }\r\n        if ((particle.position.y + particle.particleSize) >= particle.boundingBox.bot) {\r\n            particle.velocity.y *= particle.yBounce;\r\n            particle.position.y = particle.boundingBox.bot - particle.particleSize;\r\n        }\r\n\r\n        if (particle.position.x - (particle.particleSize) <= particle.boundingBox.left) {\r\n            particle.velocity.x *= particle.xBounce;\r\n            particle.position.x = particle.boundingBox.left + (particle.particleSize);\r\n        }\r\n\r\n        if (particle.position.x + (particle.particleSize) >= particle.boundingBox.right) {\r\n            particle.velocity.x *= particle.xBounce;\r\n            particle.position.x = particle.boundingBox.right - particle.particleSize;\r\n        }\r\n\r\n        if (particle.position.z - (particle.particleSize) <= particle.boundingBox.front) {\r\n            particle.velocity.z *= particle.xBounce;\r\n            particle.position.z = particle.boundingBox.front + (particle.particleSize);\r\n        }\r\n\r\n        if (particle.position.z + (particle.particleSize) >= particle.boundingBox.back) {\r\n            particle.velocity.z *= particle.xBounce;\r\n            particle.position.z = particle.boundingBox.back - particle.particleSize;\r\n        }\r\n    }\r\n\r\n\r\n    defaultTimestepFunc = (group,timeStep)=>{ //what happens on each time step?\r\n\r\n        if(group.particles.length < group.max) {\r\n            let max = group.max;\r\n            let count = group.particles.length;\r\n            if(group.spawnRate) {\r\n                count=0;\r\n                max = group.spawnRate;\r\n            \r\n            }\r\n            while(count < max) {\r\n                //add a new particle\r\n                group.particles.push(this.newParticle());\r\n                group.groupRuleGen(group.particles[group.particles.length-1],group.rule);\r\n                count++;\r\n            }\r\n        } else if (group.particles.length > group.max) {\r\n            group.particles.splice(group.max);\r\n        }\r\n\r\n        if(group.useBoids) {\r\n            let success = this.calcBoids(group.particles,timeStep);\r\n            if(!success) console.error('boids error');\r\n        }\r\n\r\n        let expiredidx = [];\r\n        group.particles.forEach((p,i) => {\r\n            \r\n            if(p.timestepFunc) p.timestepFunc(group, p, timeStep);\r\n\r\n            if(p.gravity !== 0) p.velocity.y += p.gravity*timeStep;\r\n            \r\n            if(p.force.x !== 0){ \r\n                p.velocity.x += p.force.x*timeStep/p.mass;\r\n            }\r\n            if(p.force.y !== 0){\r\n                p.velocity.y += p.force.y*timeStep/p.mass;\r\n            }\r\n            if(p.force.z !== 0){\r\n                p.velocity.z += p.force.z*timeStep/p.mass;\r\n            }\r\n\r\n            if(p.acceleration.x !== 0){ \r\n                p.velocity.x += p.acceleration.x*timeStep;\r\n            }\r\n            if(p.acceleration.y !== 0){\r\n                p.velocity.y += p.acceleration.y*timeStep;\r\n            }\r\n            if(p.acceleration.z !== 0){\r\n                p.velocity.z += p.acceleration.z*timeStep;\r\n            }\r\n\r\n            if(p.velocity.x !== 0){\r\n                p.position.x += p.velocity.x*timeStep;\r\n            }\r\n            if(p.velocity.y !== 0){\r\n                p.position.y += p.velocity.y*timeStep;\r\n            }\r\n            if(p.velocity.z !== 0){\r\n                p.position.z += p.velocity.z*timeStep;\r\n            }\r\n\r\n            //if(i === 0) console.log(p.velocity,p.position,timeStep);\r\n\r\n            this.checkParticleBounds(p);\r\n\r\n            // Age the particle\r\n            p.life+=timeStep;\r\n\r\n            if(this.defaultCanvas) {\r\n                group.animateParticle(p);\r\n            }\r\n\r\n            // If Particle is old, it goes in the chamber for renewal\r\n            if (p.life >= p.lifeTime) {\r\n                expiredidx.push(i);\r\n            }\r\n\r\n        });\r\n\r\n        expiredidx.reverse().forEach((x)=>{\r\n          group.particles.splice(x,1);\r\n        });\r\n    \r\n    }\r\n\r\n    calcAttraction = (particle1,particle2,distance,timeStep) => { \r\n        let deltax = particle2.position.x-particle1.position.x,\r\n            deltay = particle2.position.y-particle1.position.y,\r\n            deltaz = particle2.position.z-particle1.position.z;\r\n\r\n        let Fg =  particle1.attraction * particle1.mass*particle2.mass/(distance*distance);\r\n\r\n        let FgOnBody1x = Fg*deltax,\r\n            FgOnBody1y = Fg*deltay,\r\n            FgOnBody1z = Fg*deltaz;\r\n\r\n        let v1x = timeStep*FgOnBody1x/particle1.mass,\r\n            v1y = timeStep*FgOnBody1y/particle1.mass,\r\n            v1z = timeStep*FgOnBody1z/particle1.mass;\r\n\r\n        particle1.velocity.x += v1x;\r\n        particle1.velocity.y += v1y;\r\n        particle1.velocity.z += v1z;\r\n\r\n        let v2x = -timeStep*FgOnBody1x/particle2.mass,\r\n            v2y = -timeStep*FgOnBody1y/particle2.mass,\r\n            v2z = -timeStep*FgOnBody1z/particle2.mass;\r\n\r\n        particle2.velocity.x += v2x;\r\n        particle2.velocity.y += v2y;\r\n        particle2.velocity.z += v2z;\r\n\r\n        return v1x, v1y, v1z, v2x, v2y, v2z;\r\n\r\n    }\r\n\r\n    //pass a particle group in, will add to particle velocities and return true if successful\r\n    calcBoids = (particles=[],timeStep, from=0, to=particles.length) => {\r\n        \r\n        const newVelocities = [];\r\n        let _timeStep = 1/timeStep;\r\n        outer:\r\n        for(var i = from; i < to; i++) {\r\n            let p0 = particles[i];\r\n            const inRange = []; //indices of in-range boids\r\n            const distances = []; //Distances of in-range boids\r\n            const boidVelocities = [p0.position.x,p0.position.y,p0.position.z,0,0,0,p0.velocity.x,p0.velocity.y,p0.velocity.z,0,0,0,0,0,0,0,0,0]; //Velocity mods of in-range boids, representing each type of modifier\r\n            /*\r\n                cohesion, separation, alignment, attraction, avoidance\r\n            */\r\n            \r\n           let groupCount = 1;\r\n    \r\n            nested:\r\n            for(let j = 0; j < particles.length; j++) {\r\n                let p = particles[j];\r\n                if(distances.length > p0.boid.groupSize || j >= p0.boid.searchLimit) { break nested; }\r\n\r\n                let randj = Math.floor(Math.random()*particles.length); // Get random index\r\n                if(j===i || randj === i || inRange.indexOf(randj) > -1) {  } else {\r\n                    let pr = particles[randj];\r\n                    let disttemp = this.distance3D(p0.position,pr.position);\r\n                    \r\n                    if(disttemp > p0.boid.groupRadius) { } else {\r\n                        distances.push(disttemp);\r\n                        inRange.push(randj);\r\n\r\n                        let distInv;\r\n                        if(p0.boid.useSeparation || p0.boid.useAlignment) {\r\n                            distInv = (p0.boid.groupRadius/(disttemp*disttemp));\r\n                            if(distInv == Infinity) distInv = p.maxSpeed;\r\n                            else if (distInv == -Infinity) distInv = -p.maxSpeed;\r\n                        }\r\n                \r\n                        if(p0.boid.useCohesion){\r\n                            boidVelocities[0] += (pr.position.x - p0.position.x)*0.5*disttemp*_timeStep;\r\n                            boidVelocities[1] += (pr.position.y - p0.position.y)*0.5*disttemp*_timeStep;\r\n                            boidVelocities[2] += (pr.position.z - p0.position.z)*0.5*disttemp*_timeStep;\r\n                        }\r\n\r\n                        if(isNaN(disttemp) || isNaN(boidVelocities[0]) || isNaN(pr.position.x)) {\r\n                            console.log(disttemp, i, randj, p0.position, pr.position, boidVelocities); p0.position.x = NaN; \r\n                            return;\r\n                        }\r\n\r\n                        if(p0.boid.useSeparation){\r\n                            boidVelocities[3] = boidVelocities[3] + (p0.position.x-pr.position.x)*distInv;\r\n                            boidVelocities[4] = boidVelocities[4] + (p0.position.y-pr.position.y)*distInv; \r\n                            boidVelocities[5] = boidVelocities[5] + (p0.position.z-pr.position.z)*distInv;\r\n                        }\r\n\r\n                        if(p0.boid.useAttraction) {\r\n                            this.calcAttraction(p0,pr,disttemp,timeStep);\r\n                        }\r\n\r\n                        if(p0.boid.useAlignment){\r\n                            //console.log(separationVec);\r\n                            boidVelocities[6] = boidVelocities[6] + pr.velocity.x*distInv; \r\n                            boidVelocities[7] = boidVelocities[7] + pr.velocity.y*distInv;\r\n                            boidVelocities[8] = boidVelocities[8] + pr.velocity.z*distInv;\r\n                        }\r\n\r\n                        groupCount++;\r\n                    }\r\n                }\r\n            }\r\n            \r\n            if(p0.boid.useAvoidance && p0.boid.avoidance.groups.length > 0) {\r\n                let searchidx = Math.floor(Math.random()*p0.boid.avoidanceGroups.length);\r\n                const inRange2 = [];\r\n                nested2:\r\n                for(let k = 0; k < p0.searchLimit; k++) {\r\n                    searchidx++;\r\n                    let group = p0.boid.avoidanceGroups[searchidx%p0.boid.avoidanceGroups.length];\r\n                    if(inRange2 > p0.boid.groupSize) { break nested2; }\r\n\r\n                    let randj = Math.floor(Math.random()*group.length); // Get random index\r\n                    if(j===i || randj === i || inRange2.indexOf(randj) > -1) {  } else {\r\n                        let pr = group[randj];\r\n                        let disttemp = this.distance3D(p0.position,pr.position);\r\n                        \r\n                        if(disttemp > p0.boid.groupRadius) { } else {\r\n                            inRange2.push(randj);\r\n                            let distInv = (p0.boid.groupRadius/(disttemp*disttemp));\r\n                            if(distInv == Infinity) distInv = p.maxSpeed;\r\n                            else if (distInv == -Infinity) distInv = -p.maxSpeed;\r\n                            boidVelocities[15] = boidVelocities[15] + (p0.position.x-pr.position.x)*distInv;\r\n                            boidVelocities[16] = boidVelocities[16] + (p0.position.y-pr.position.y)*distInv; \r\n                            boidVelocities[17] = boidVelocities[17] + (p0.position.z-pr.position.z)*distInv;\r\n                        }\r\n                    }\r\n                } \r\n\r\n                let _len = inRange2.length;\r\n                boidVelocities[15] = boidVelocities[15]*_len;\r\n                boidVelocities[16] = boidVelocities[16]*_len;\r\n                boidVelocities[17] = boidVelocities[17]*_len;\r\n\r\n            }\r\n\r\n\r\n            let _groupCount = 1/groupCount;\r\n    \r\n            if(p0.boid.useCohesion){\r\n                boidVelocities[0] = p0.boid.cohesion*(boidVelocities[0]*_groupCount);\r\n                boidVelocities[1] = p0.boid.cohesion*(boidVelocities[1]*_groupCount);\r\n                boidVelocities[2] = p0.boid.cohesion*(boidVelocities[2]*_groupCount);\r\n            } else { boidVelocities[0] = 0; boidVelocities[1] = 0; boidVelocities[2] = 0; }\r\n\r\n            if(p0.boid.useSeparation){\r\n                boidVelocities[3] = p0.boid.separation*boidVelocities[3];\r\n                boidVelocities[4] = p0.boid.separation*boidVelocities[4];\r\n                boidVelocities[5] = p0.boid.separation*boidVelocities[5];\r\n            } else { boidVelocities[3] = 0; boidVelocities[4] = 0; boidVelocities[5] = 0; }\r\n\r\n            if(p0.boid.useAlignment){\r\n                boidVelocities[6] = -(p0.boid.alignment*boidVelocities[6]*_groupCount);\r\n                boidVelocities[7] = p0.boid.alignment*boidVelocities[7]*_groupCount;\r\n                boidVelocities[8] = p0.boid.alignment*boidVelocities[8]*_groupCount;//Use a perpendicular vector [-y,x,z]\r\n            } else { boidVelocities[6] = 0; boidVelocities[7] = 0; boidVelocities[8] = 0; }    \r\n\r\n            const swirlVec = [0,0,0];\r\n            if(p0.boid.useSwirl == true){\r\n                boidVelocities[9] = -(p0.position.y-p0.boid.swirl.y)*p0.boid.swirl.mul;\r\n                boidVelocities[10] = (p0.position.z-p0.boid.swirl.z)*p0.boid.swirl.mul;\r\n                boidVelocities[11] = (p0.position.x-p0.boid.swirl.x)*p0.boid.swirl.mul\r\n            }\r\n            const attractorVec = [0,0,0];\r\n\r\n            if(p0.boid.useAttractor == true){\r\n                boidVelocities[12] = (p0.boid.attractor.x-p0.position.x)*p0.boid.attractor.mul;\r\n                if(p0.position.x > p0.boid.boundingBox.left || p0.position.x < p0.boid.boundingBox.right) {\r\n                    boidVelocities[12] *= 3; //attractor should be in the bounding box for this to work properly \r\n                }\r\n                boidVelocities[13] = (p0.boid.attractor.y-p0.position.y)*p0.boid.attractor.mul;\r\n                if(p0.position.y > p0.boid.boundingBox.top || p0.position.y < p0.boid.boundingBox.bottom) {\r\n                    boidVelocities[13] *= 3;\r\n                }\r\n                boidVelocities[14] = (p0.boid.attractor.z-p0.position.z)*p0.boid.attractor.mul;\r\n                if(p0.position.z > p0.boid.boundingBox.front || p0.position.z < p0.boid.boundingBox.back) {\r\n                    boidVelocities[14] *= 3;\r\n                }\r\n            }\r\n        \r\n            //console.log(attractorVec)\r\n\r\n            //if(i===0) console.log(p0, p0.position, p0.velocity, cohesionVec,separationVec,alignmentVec,swirlVec,attractorVec)\r\n\r\n            newVelocities.push([\r\n                p0.velocity.x*p0.drag+boidVelocities[0]+boidVelocities[3]+boidVelocities[6]+boidVelocities[9]+boidVelocities[12]+boidVelocities[15],\r\n                p0.velocity.y*p0.drag+boidVelocities[1]+boidVelocities[4]+boidVelocities[7]+boidVelocities[10]+boidVelocities[13]+boidVelocities[16],\r\n                p0.velocity.z*p0.drag+boidVelocities[2]+boidVelocities[5]+boidVelocities[8]+boidVelocities[11]+boidVelocities[14]+boidVelocities[17]\r\n            ]);\r\n            //console.log(i,groupCount)\r\n            if(isNaN(newVelocities[newVelocities.length-1][0])) console.log(p0, i, groupCount, p0.position, p0.velocity, cohesionVec,separationVec,alignmentVec,swirlVec,attractorVec)\r\n        }\r\n    \r\n        if(newVelocities.length === particles.length){ // Update particle velocities if newVelocities updated completely, else there was likely an error\r\n            //console.log(newVelocities);\r\n            \r\n            \r\n            particles.forEach((p,i) => {\r\n                p.velocity.x += newVelocities[i][0];\r\n                p.velocity.y += newVelocities[i][1];\r\n                p.velocity.z += newVelocities[i][2];\r\n            })\r\n            //console.timeEnd(\"boid\");\r\n            return true;\r\n        }\r\n        else { console.error(\"Boids error\"); return false; }\r\n    \r\n    }    \r\n\r\n    addRule(\r\n        type='',\r\n        groupRuleGen=(particle,rule)=>{},\r\n        groupTimestepFunc=(group,timestep)=>{},\r\n        animateParticle=(particle)=>{}\r\n    ) {\r\n        if(type.length > 0 && typeof groupRuleGen === 'function' && typeof timestepFunc === 'function' && typeof animateParticle === 'function'){\r\n            this.rules.push({\r\n                type:type,\r\n                groupRuleGen:groupRuleGen,\r\n                timestepFunc:groupTimestepFunc,\r\n                animateParticle:animateParticle\r\n            });\r\n        } else return false;\r\n    }\r\n\r\n    removeGroup(groupIdx=0) {\r\n        if(!this.particles[groupIdx]) return false;\r\n\r\n        this.maxParticles -= this.particles[groupIdx].max;\r\n        this.particles.slice(groupIdx,1);\r\n        return true;\r\n    }\r\n\r\n    addGroup( //type, count, bounding box, particle timestepFunc\r\n        rule=['boids',50]\r\n    ) \r\n        {\r\n        \r\n        if(!Array.isArray(rule)) return false;\r\n        \r\n        let type = rule[0];\r\n        let maxcount = rule[1];\r\n        let boundingBox = rule[2]; //passed to groupRuleGen\r\n        let spawnCount = rule[3];\r\n        let respawnRate = rule[4];\r\n        let useBoids = rule[5]; //for the default function\r\n        if(type === 'boids') useBoids = true; //default true for this rule\r\n        let pTimestepFunc = rule[6];\r\n        \r\n\r\n        if(!rule[0] || !rule[1]) return false;\r\n\r\n        this.maxParticles += rule[1];\r\n\r\n        let timestepFunc, groupRuleGen, animateParticle;\r\n        \r\n        this.rules.forEach((rule)=> {\r\n            if(type === rule.type) {\r\n                timestepFunc = rule.timestepFunc;\r\n                groupRuleGen = rule.groupRuleGen;\r\n                animateParticle = rule.animateParticle;\r\n            }\r\n        });\r\n\r\n        if(!timestepFunc || !groupRuleGen || (this.defaultCanvas && !animateParticle)) return false;\r\n\r\n        let newGroup = new Array(maxcount).fill(0);\r\n\r\n        let attractorx = Math.random()*0.4+0.35;\r\n        let attractory = Math.random()*0.4+0.35;\r\n        let attractorz = Math.random()*0.4+0.35;\r\n\r\n\r\n        if(spawnCount){\r\n            for(let i = 0; i < spawnCount; i++){\r\n                newGroup[i] = this.newParticle();\r\n                groupRuleGen(newGroup[i],rule);\r\n                if(pTimestepFunc) newGroup[i].timestepFunc = timestepFunc;\r\n                if(type === 'boids') {\r\n                    newGroup[i].boid.attractor.x = newGroup[i].boid.boundingBox.right*attractorx;\r\n                    newGroup[i].boid.attractor.y = newGroup[i].boid.boundingBox.bot*attractory;\r\n                    newGroup[i].boid.attractor.z = newGroup[i].boid.boundingBox.back*attractorz;\r\n                    if(attractorx < 0.5) newGroup[i].boid.swirl.mul = -newGroup[i].boid.swirl.mul;\r\n                }\r\n            }\r\n        } else {\r\n            newGroup.forEach((p,i)=>{\r\n                newGroup[i] = this.newParticle();\r\n                groupRuleGen(newGroup[i],rule);\r\n                if(type === 'boids'){\r\n                    if(pTimestepFunc) newGroup[i].timestepFunc = timestepFunc;\r\n                    newGroup[i].boid.attractor.x = newGroup[i].boid.boundingBox.right*attractorx;\r\n                    newGroup[i].boid.attractor.y = newGroup[i].boid.boundingBox.bot*attractory;\r\n                    newGroup[i].boid.attractor.z = newGroup[i].boid.boundingBox.back*attractorz;\r\n                    if(attractorx < 0.5) newGroup[i].boid.swirl.mul = -newGroup[i].boid.swirl.mul;\r\n                }\r\n            });\r\n        }\r\n        this.particles.push(\r\n        {\r\n            rule:rule,\r\n            type:type, \r\n            max:maxcount, \r\n            particles:newGroup, \r\n            timestepFunc:timestepFunc, \r\n            groupRuleGen:groupRuleGen,\r\n            animateParticle:animateParticle,\r\n            spawnRate:respawnRate, //respawn rate\r\n            useBoids:useBoids,\r\n            groupId:\"id\"+Math.floor(Math.random()*99999999)\r\n        });\r\n\r\n        return newGroup;\r\n\r\n    }\r\n\r\n    removeGroup = (idx) => {\r\n        this.particles.splice(idx,1);\r\n    }\r\n\r\n    newParticle(assignments=undefined) {\r\n        let proto = JSON.parse(JSON.stringify(this.prototype));\r\n        if(assignments) Object.assign(proto,assignments);\r\n        return proto;\r\n    }\r\n\r\n    setParticle(particle,assignments={}) {\r\n        Object.assign(particle,assignments);\r\n        return particle;\r\n    }\r\n\r\n    onresize = () => {\r\n        if(this.canvas) {\r\n            if(this.defaultCanvas) {\r\n                this.canvas.width = this.canvas.parentNode.clientWidth;\r\n                this.canvas.height = this.canvas.parentNode.clientHeight;\r\n\r\n                this.canvas.style.width = this.canvas.parentNode.clientWidth;\r\n                this.canvas.style.height = this.canvas.parentNode.clientHeight;\r\n            }\r\n            let h = this.canvas.clientHeight;\r\n            let w = this.canvas.clientWidth;\r\n            let proto = JSON.parse(JSON.stringify(this.prototype));\r\n            let bb = { //Auto resize based on default bounding box settings\r\n                left:proto.boundingBox.left*w,\r\n                right:proto.boundingBox.right*w,\r\n                bot:proto.boundingBox.bot*h,\r\n                top:proto.boundingBox.top*h,\r\n                front:proto.boundingBox.front*h,\r\n                back:proto.boundingBox.back*h\r\n            };\r\n            let bbb = {\r\n                left:proto.boid.boundingBox.left*w,\r\n                right:proto.boid.boundingBox.right*w,\r\n                bot:proto.boid.boundingBox.bot*h,\r\n                top:proto.boid.boundingBox.top*h,\r\n                front:proto.boid.boundingBox.front*h,\r\n                back:proto.boid.boundingBox.back*h\r\n            };;\r\n            this.particles.forEach((g) => {\r\n                g.particles.forEach((p) => {\r\n                    p.boundingBox = JSON.parse(JSON.stringify(bb));\r\n                    p.boid.boundingBox = JSON.parse(JSON.stringify(bbb));\r\n                })\r\n            });\r\n        }\r\n    }\r\n\r\n    frame = (lastFrame) => {\r\n        if(!this.frameOffset) this.frameOffset = lastFrame;\r\n        this.currFrame = performance.now()*0.001+this.frameOffset;\r\n        let timeStep = (this.currFrame - lastFrame);\r\n        if(timeStep > 1) timeStep = 1; //no more than 1s updates\r\n\r\n        if(this.defaultCanvas) {\r\n            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n        }\r\n\r\n        this.particles.forEach((group) => {\r\n            group.timestepFunc(group,timeStep);\r\n            \r\n            if(isNaN(group.particles[0].position.x)) {\r\n                console.log(timeStep,this.ticks,group.particles[0]);\r\n                this.looping = false;\r\n                return;\r\n            }\r\n        });\r\n\r\n        // console.log(\r\n        //     timeStep,\r\n        //     this.particles[0].particles[0].position,\r\n        //     this.particles[0].particles[0].velocity\r\n        //     );\r\n\r\n        this.ticks++;\r\n        //console.log('frame time (s)', (performance.now()*0.001+this.frameOffset) - this.currFrame)\r\n        return this.currFrame;\r\n    }\r\n\r\n    loop = () => {\r\n        if(this.looping === false) return; \r\n        this.frame(this.currFrame);\r\n        setTimeout(()=>{requestAnimationFrame(()=>{this.loop()})},15);\r\n    }\r\n\r\n}", "\r\nimport {addCustomElement} from 'fragelement';\r\n\r\nimport {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\nimport { DynamicParticles } from 'dynamicparticles'\r\n\r\nlet component = require('./space.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class SpaceNode extends NodeDiv {\r\n    props={\r\n        bodies:{}, //the orbital body nodes we're updating\r\n        speed:300000, //time multiplier\r\n        lastTime:undefined,\r\n        now:undefined,\r\n        canvas:undefined,\r\n        ctx:undefined,\r\n        useCanvas:true,\r\n        useHTML:true,\r\n        meter_per_px: 1e9, //viewport scales according to this\r\n        px_per_meter: 1/1e9,\r\n        zind:0,\r\n\r\n        stars:[],\r\n        boids:undefined,\r\n        nstars:undefined,\r\n        nboids:undefined,\r\n         \r\n        operator:(\r\n            input,\r\n            node,\r\n            origin,\r\n            cmd\r\n        )=>{ \r\n\r\n            if(cmd === 'animate') {\r\n                this.props.lastTime = this.props.now;\r\n                this.props.now = Date.now();\r\n\r\n                let tstep;\r\n                let tminus = (this.props.now - this.props.lastTime)*0.001;\r\n                if(tminus > 0.1) tminus = 0.1; //prevent overly long time jumps  \r\n\r\n                tstep = tminus*this.props.speed; //seconds                \r\n               \r\n                let bodies = this.props.bodies;\r\n\r\n                let keys = Object.keys(bodies);\r\n\r\n                for(let i = 0; i < keys.length; i++) {\r\n                    for(let j = 0; j < keys.length; j++) {\r\n                        if(i !== j && !bodies[keys[i]].fixed && !bodies[keys[j]].fixed) {\r\n                            this.newtonianMechanics(bodies[keys[i]],bodies[keys[j]],tstep);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.props.node.callChildren(tstep); // this will update positions\r\n\r\n                //draw loop\r\n                if(this.props.useCanvas) {\r\n                    this.draw(input,node,origin,cmd);\r\n                    for(let i = 0; i < this.drawFuncs.length; i++) { //lets use other nodes to send draw functions to the canvas\r\n                        let f = this.drawFuncs[i];\r\n                        if(typeof f === 'function') {\r\n                            f(input,node,origin,cmd); //pass the args in (need these if you pass arrow functions)\r\n                        }\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                //e.g. input commands\r\n                if(typeof input === 'object') {\r\n                    \r\n                } else if (typeof input === 'number') {\r\n                    \r\n                } else if (typeof input === 'string') {\r\n                    \r\n                } else {\r\n                    \r\n                }\r\n            }\r\n        },\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:true, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    draw(input,node,origin,cmd) {\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n\r\n        //draw a star map on the base canvas\r\n        ctx.clearRect(0,0,canvas.width,canvas.height);\r\n        ctx.fillStyle = '#111111';\r\n        ctx.fillRect(0,0,canvas.width,canvas.height);\r\n\r\n        this.props.stars.forEach((p,i) => {   \r\n            ctx.fillStyle = p.color;\r\n            ctx.fillRect(\r\n                p.x*canvas.width,\r\n                p.y*canvas.height,\r\n                2,  //p.position.x+1, //adds some funk\r\n                2  //p.position.y+1,\r\n            );\r\n        });\r\n\r\n        this.props.boids.particles.forEach((group,j) => {\r\n\r\n            if(j === 0)  {\r\n                group.particles.forEach((p,i) => {\r\n                    if(this.props.bodies.saturn) {\r\n                        //console.log(p)\r\n                        p.boid.attractor.x = this.canvas.clientWidth*0.5  + this.props.bodies.saturn.position.x*this.props.px_per_meter;\r\n                        p.boid.attractor.y = this.canvas.clientHeight*0.5 - this.props.bodies.saturn.position.y*this.props.px_per_meter;\r\n                        p.boid.attractor.z = this.canvas.clientWidth*0.5  + this.props.bodies.saturn.position.z*this.props.px_per_meter;\r\n                    }\r\n                    p.boid.swirl.x = p.boid.attractor.x;\r\n                    p.boid.swirl.y = p.boid.attractor.y;\r\n                    p.boid.swirl.z = p.boid.attractor.z;\r\n                    \r\n                    //instead we could find the nearest neighbor planet and attract to that\r\n\r\n                    let r = Math.floor(10+(i/group.particles.length)*90);\r\n\r\n                    ctx.fillStyle = p.color;\r\n                    ctx.fillRect(\r\n                        p.position.x,\r\n                        p.position.y,\r\n                        2,  //p.position.x+1, //adds some funk\r\n                        2  //p.position.y+1,\r\n                    );\r\n                });\r\n            }\r\n            if(j === 1) {\r\n                group.particles.forEach((p,i) => {   \r\n                    ctx.fillStyle = p.color;\r\n                    ctx.fillRect(\r\n                        p.position.x,\r\n                        p.position.y,\r\n                        2,  //p.position.x+1, //adds some funk\r\n                        2  //p.position.y+1,\r\n                    );\r\n                });\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    addDraw(f) {\r\n        if(typeof f === 'function') this.drawFuncs.push(f);\r\n    }\r\n\r\n    drawFuncs = []; // draw(input,args,origin,cmd){} <--- passes operator args\r\n\r\n    magnitude(vec={}) { //nDimensional magnitude\r\n        let sqrd = 0;\r\n        Object.keys(vec).forEach((c) => {\r\n            sqrd+=vec[c]*vec[c];\r\n        })\r\n        return Math.sqrt(sqrd);\r\n    }\r\n\r\n    distance(point1={}, point2={}) { //nDimensional vector distance function\r\n        let dsqrd = 0;\r\n        Object.keys(point1).forEach((c,i) => {\r\n            let pp = (point2[c] - point1[c]);\r\n            dsqrd += pp*pp;\r\n        })\r\n        return Math.sqrt(dsqrd);\r\n    }\r\n\r\n    makeVec(point1={},point2={}) {  //Make vector from two nDimensional points (arrays)\r\n        var vec = {};\r\n        Object.keys(point1).forEach((c,i) => {\r\n            vec[c] = point2[c] - point1[c];\r\n        })\r\n        return vec;\r\n    }\r\n\r\n    normalize(vec={}) { //nDimensional normalization\r\n        let _mag = 1/this.magnitude(vec);\r\n        let vecn = {};\r\n        Object.keys(vec).forEach((c,i) => {\r\n            vecn[c] = vec[c]*_mag;\r\n        })\r\n        return vecn;\r\n    }\r\n    \r\n    //angle in xy plane from positive x-axis\r\n    calcAzimuth(position={x:1,y:1,z:0}) {\r\n        return Math.atan2(position.x,position.y);\r\n    }\r\n    \r\n    //z angle from origin\r\n    calcZenith(position={x:1,y:0,z:1}) {\r\n        return Math.acos(position.z/this.magnitude(position));\r\n    }\r\n\r\n    sphereCollision(body1,body2) {\r\n        let dist = this.distance(body1.position,body2.position);\r\n        if(dist < body1.radius + body2.radius) {\r\n            return (body1.radius + body2.radius) - dist; //overlap dist\r\n        } \r\n        return false; //no overlap\r\n    }\r\n    \r\n    //newton's gravity and third law for spherical masses\r\n    newtonianMechanics(body1,body2,tstep) {\r\n        if(!body1.mass || !body2.mass) return;\r\n        if(body1.mass == 0 && body2.mass === 0) return;\r\n        \r\n        //Gravitational pull of nBodies\r\n        \r\n        let dist = this.distance(body1.position,body2.position);\r\n        let vecn = this.normalize(this.makeVec(body1.position,body2.position)); // a to b\r\n\r\n        let isColliding = this.sphereCollision(body1,body2); //This will miss if the bodies move past each other faster than a frame (have to do curr/prev comparison method instead or a faster dynamic model)\r\n     \r\n        if(isColliding) { //add a displaceent if there is overlap\r\n            let sumMass = body1.mass+body2.mass;\r\n            let ratio = body1.mass/sumMass; //displace proportional to mass\r\n            let rmin = 1-ratio;\r\n\r\n            if(body1.fixed === false) {\r\n                body1.position.x += vecn.x*isColliding*rmin*1.01;\r\n                body1.position.y += vecn.y*isColliding*rmin*1.01;\r\n                body1.position.z += vecn.z*isColliding*rmin*1.001;\r\n            } else {\r\n                body2.position.x -= vecn.x*isColliding*1.01;\r\n                body2.position.y -= vecn.y*isColliding*1.01;\r\n                body2.position.z -= vecn.z*isColliding*1.01;\r\n            }\r\n            if(body2.fixed === false) {\r\n                body2.position.x += vecn.x*isColliding*ratio*1.01;\r\n                body2.position.y += vecn.y*isColliding*ratio*1.01;\r\n                body2.position.z += vecn.z*isColliding*ratio*1.01;\r\n            } else {\r\n                body1.position.x += vecn.x*isColliding*1.01;\r\n                body1.position.y += vecn.y*isColliding*1.01;\r\n                body1.position.z += vecn.z*isColliding*1.01;\r\n            }\r\n\r\n            dist = this.distance(body1.position,body2.position);\r\n\r\n            let vrel = {\r\n                x:body1.velocity.x - body2.velocity.x,\r\n                y:body1.velocity.y - body2.velocity.y,\r\n                z:body1.velocity.z - body2.velocity.z\r\n            };\r\n\r\n            let speed = vrel.x*vecn.x + vrel.y*vecn.y + vrel.z*vecn.z;\r\n\r\n            if(speed > 0) {\r\n                let impulse = 2*speed/sumMass;\r\n                if(body1.fixed === false) {\r\n                    body1.velocity.x -= impulse*vecn.x*body2.mass*body1.restitution///body1.mass;\r\n                    body1.velocity.y -= impulse*vecn.y*body2.mass*body1.restitution///body1.mass;\r\n                    body1.velocity.z -= impulse*vecn.z*body2.mass*body1.restitution///body1.mass;\r\n                }\r\n\r\n                if(body2.fixed === false) {\r\n                    body2.velocity.x += impulse*vecn.x*body2.mass*body2.restitution/body2.mass;\r\n                    body2.velocity.y += impulse*vecn.y*body2.mass*body2.restitution/body2.mass;\r\n                    body2.velocity.z += impulse*vecn.z*body2.mass*body2.restitution/body2.mass;\r\n                }\r\n            }\r\n            //if(!body1.collidedWith[body2.tag] && !body1.prevCollidedWith[body2.tag]) {\r\n            //}\r\n            // body1.collidedWith[body2.tag] = body2.tag;\r\n            // body2.collidedWith[body1.tag] = body1.tag;\r\n            \r\n        }\r\n\r\n        let mass1Inv = 1/body1.mass;\r\n        let mass2Inv = 1/body2.mass;\r\n    \r\n        //Newton's law of gravitation\r\n        let Fg = 0.00000000006674 * body1.mass * body2.mass / (dist*dist);\r\n\r\n        //Get force vectors\r\n        let FgOnBody1 = {x: vecn.x*Fg, y: vecn.y*Fg, z: vecn.z*Fg};\r\n        let FgOnBody2 = {x:-vecn.x*Fg, y:-vecn.y*Fg, z:-vecn.z*Fg};\r\n        \r\n        if(!body1.fixed) {\r\n            body1.velocity.x += tstep*FgOnBody1.x*mass1Inv;\r\n            body1.velocity.y += tstep*FgOnBody1.y*mass1Inv;\r\n            body1.velocity.z += tstep*FgOnBody1.z*mass1Inv;\r\n        }\r\n            \r\n        if(!body2.fixed) {\r\n            body2.velocity.x += tstep*FgOnBody2.x*mass2Inv;\r\n            body2.velocity.y += tstep*FgOnBody2.y*mass2Inv;\r\n            body2.velocity.z += tstep*FgOnBody2.z*mass2Inv;\r\n        }\r\n\r\n\r\n        //need to limit the number of collisions\r\n        \r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n\r\n        this.canvas = this.querySelector('canvas');\r\n\r\n        if(props.meter_per_px) props.px_per_meter = 1/props.meter_per_px;\r\n\r\n        if(props.width) {\r\n            this.canvas.width = props.width;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.height) {\r\n            this.canvas.height = props.height;\r\n            this.canvas.style.height = props.height;\r\n        }\r\n        if(props.style) {\r\n            this.canvas.style = props.style;\r\n            setTimeout(()=>{\r\n                this.canvas.height = this.canvas.clientHeight;\r\n                this.canvas.width = this.canvas.clientWidth;\r\n\r\n                if(props.useCanvas) {\r\n                    //do some setup\r\n                    if(!props.nstars) {\r\n                        props.nstars = 200;\r\n                    }\r\n                    if(!props.nboids) {\r\n                        props.nboids = 100;\r\n                    }\r\n\r\n                    props.stars = [];\r\n                    let ct = 0;\r\n                    while(ct < props.nstars) {\r\n                        let white = Math.floor(Math.random()*100);\r\n                        if(white < 20) white = 20;\r\n                        props.stars.push({\r\n                            x:Math.random(),\r\n                            y:Math.random(),\r\n                            z:Math.random(),\r\n                            color:`#${white}${white}${white}`\r\n                        });\r\n                        ct++;\r\n                    }\r\n\r\n                    let rules = [['boids',props.nboids],['default',200]];\r\n                    props.boids = new DynamicParticles(rules,this.canvas,false);\r\n                    this.props.boids.particles.forEach((group,j) => {\r\n                        if(j === 0) {\r\n                            group.particles.forEach((p,i) => {\r\n                                p.maxSpeed = 70;\r\n                                p.boid.separation = 0.1;\r\n                                p.boid.attractor.mul = 0.02;\r\n                                p.boid.swirl.mul = 0.1;\r\n                                let r = Math.floor(Math.random()*100);\r\n                                if(r < 10) r = 10;\r\n                                p.color=`#${r}DDFF`;\r\n                                \r\n                            });\r\n                        }\r\n                        if(j === 1) {\r\n                            group.particles.forEach((p,i) => {\r\n                                p.velocity = {\r\n                                    x:Math.random()*10-5,\r\n                                    y:Math.random()*10-5,\r\n                                    z:Math.random()*10-5\r\n                                }\r\n                                let r = Math.floor(Math.random()*100);\r\n                                if(r < 30) r = 30;\r\n                                let g = Math.floor(Math.random()*100);\r\n                                if(g < 30) g = 30;\r\n                                let b = Math.floor(Math.random()*100);\r\n                                if(b < 30) b = 30;\r\n                                p.color = `#${r}${g}${b}`;\r\n                            });\r\n                        }\r\n                    })\r\n                }\r\n\r\n            },10); //slight recalculation delay time\r\n        }\r\n\r\n        props.canvas = this.canvas;\r\n        if(props.context) props.context = this.canvas.getContext(props.context);\r\n        else props.context = this.canvas.getContext('2d');\r\n        this.context = props.context;\r\n        this.ctx = this.context;\r\n        props.ctx = this.context;\r\n\r\n        setTimeout(()=>{\r\n            if(props.animate) {\r\n                props.now = Date.now();\r\n                props.node.runAnimation();\r\n            }\r\n        },10)\r\n\r\n    }\r\n\r\n    //after rendering\r\n    onresize=(props)=>{\r\n        if(this.canvas) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            this.canvas.style.width = this.canvas.clientWidth;\r\n            this.canvas.style.height = this.canvas.clientHeight;\r\n            props.width = this.canvas.clientWidth;\r\n            props.height = this.canvas.clientHeight;\r\n        }\r\n\r\n        let bodies = props.bodies;\r\n        let keys = Object.keys(bodies);\r\n\r\n        for(let i = 0; i < bodies.length; i++) {\r\n            if(bodies[keys[i]].props.display === false && bodies[keys[i]].props.display === 'none') //scale the html elements\r\n            {\r\n                bodies[keys[i]].div.style.height = 2*bodies[keys[i]].radius/props.meter_per_px;\r\n                bodies[keys[i]].div.style.width = 2*bodies[keys[i]].radius/props.meter_per_px;\r\n                bodies[keys[i]].div.style.borderRadius = bodies[keys[i]].radius/props.meter_per_px;\r\n            }\r\n        }\r\n\r\n    } //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\naddCustomElement(SpaceNode,'space-node');\r\n", "\r\nimport {addCustomElement} from 'fragelement';\r\n\r\nimport {NodeDiv} from '../acyclicgraph/graph.node'\r\n\r\n//let component = require('./physicsbody.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class PhysicsBodyNode extends NodeDiv {\r\n\r\n    \r\n    operator = (input,node,origin,cmd) => {\r\n        \r\n        let tstep;\r\n\r\n        if(typeof input === 'object') {\r\n            if(input.position) this.props.position = input.position;\r\n            if(input.velocity) this.props.velocity = input.velocity;\r\n            if(input.acceleration) this.props.acceleration = input.acceleration;\r\n            if(input.force) this.props.force = input.force;\r\n            if(input.tstep) tstep = input.tstep;\r\n        } else if (typeof input === 'number') {\r\n            tstep = input;\r\n        } else if (typeof input === 'string') {\r\n            tstep = parseInt(input);\r\n        } else {\r\n            \r\n        }\r\n\r\n        let f = this.props.force;\r\n        let a = this.props.acceleration;\r\n        let v = this.props.velocity;\r\n        let p = this.props.position;\r\n        \r\n        if(tstep && this.props.fixed === false) {\r\n            if(f.x) { \r\n                a.x+=f.x/this.props.mass;\r\n                f.x = 0;\r\n            }\r\n            if(f.y) {\r\n                a.y+=f.y/this.props.mass;\r\n                f.y = 0;\r\n            }\r\n            if(f.z) {\r\n                a.z+=f.z/this.props.mass;\r\n                f.z = 0;\r\n            }\r\n\r\n            // let vxn = v.x*tstep;\r\n            // let vyn = v.y*tstep;\r\n            // let vzn = v.z*tstep;\r\n\r\n            if(a.x) v.x+=a.x*tstep;//-this.props.vloss*vxn;\r\n            if(a.y) v.y+=a.y*tstep;//-this.props.vloss*vyn;\r\n            if(a.z) v.z+=a.z*tstep;//-this.props.vloss*vzn;\r\n            if(v.x) p.x+=v.x*tstep;\r\n            if(v.y) p.y+=v.y*tstep;\r\n            if(v.z) p.z+=v.z*tstep;\r\n\r\n            if(this.props.bounded) this.checkBoundaries(p,v);\r\n\r\n            // this.props.prevCollidedWith = this.props.collidedWith; //prevent overlapping collisions from adding too many forces etc on.\r\n            // this.props.collidedWith = {};                \r\n\r\n            //update reference values\r\n            this.props.distance = this.magnitude(this.props.position);\r\n            this.props.azimuth = this.calcAzimuth(this.props.position);\r\n            this.props.zenith = this.calcZenith(this.props.position,this.props.distance);\r\n\r\n            if(this.parentNode.props?.useHTML  || !this.parentNode.props) {\r\n                this.props.div.style.left = (this.parentNode.clientWidth*0.5+this.props.position.x/this.parentNode.props.meter_per_px)+'px';\r\n                this.props.div.style.top = (this.parentNode.clientHeight*0.5-this.props.position.y/this.parentNode.props.meter_per_px)+'px';\r\n                let z = Math.floor(this.props.position.z/this.parentNode.props.meter_per_px);\r\n                if(this.parentNode.props.zind > z) {this.parentNode.props.zind = z;}\r\n                let pind = parseInt(this.parentNode.props.canvas.style.zIndex);\r\n                if(!pind) pind = 1;\r\n                this.props.div.style.zIndex = z + pind - this.parentNode.props.zind;\r\n            }\r\n        }\r\n\r\n        return input; \r\n\r\n    }\r\n\r\n    props={\r\n        mass:5.972e24,              //kg  //e.g. earth's mass\r\n        radius:6.3781e9,            //body radius (m)   //e.g. earth's radius\r\n        distance:undefined, //distance from origin, can be used to set initial position with theta and azimuth\r\n        theta:undefined,   //xy circular angle (0-365 deg), can set this instead of initial position\r\n        azimuth:undefined, //z angle (0 - 180 deg), can set this instead of initial position coordinates \r\n        position:{x:150e9,y:0,z:0}, //center is origin (0,0,0), position represents distance from center (m)\r\n        velocity:{x:0,y:0,z:0}, //m/s\r\n        acceleration:{x:0,y:0,z:0}, //m/s^2\r\n        force:{x:0,y:0,z:0},        //Newtons \r\n        restitution:0.01,\r\n        vloss:0.00000000000001,                  //velocity loss multiplier (loss = 1-vloss), this causes more loss at higher speeds\r\n        fixed:false,\r\n        bounded:true, //bounded by parentNode clientRect\r\n        // collidedWith:{}, //last tick \r\n        // prevCollidedWith:{}, //last last tick\r\n        operator:this.operator, //Operator to handle I/O on this node. Returned inputs can propagate according to below settings\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:false, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined, //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=(props)=>{\r\n        let display = `''`;\r\n        if(props.display === false || props.display === 'none' || this.parentNode.props?.useHTML === false) display = `'none'`; //can not display the html element (e.g. to use canvas)\r\n\r\n        if(this.parentNode.props?.useHTML === false) return ``;\r\n\r\n        let style;\r\n        if(props.img) \r\n            return `\r\n                <div>\r\n                    <img src=${props.img} height=\"100%\" width=\"100%\" style=\"position:absolute;\"></img>\r\n                </div>\r\n            `;\r\n        else if (props.style) style = props.style;\r\n        else style = `\"display:${display}; background-color:blue;\"`;\r\n\r\n        return `\r\n            <div style=${style}></div>\r\n        `;\r\n    };\r\n\r\n\r\n    d2r(d) {\r\n        return Math.PI*d/180;\r\n    }\r\n\r\n    r2d(r) {\r\n        return 180*r/Math.PI;\r\n    }\r\n\r\n    magnitude(vec={}) { //nDimensional magnitude\r\n        let sqrd = 0;\r\n        Object.keys(vec).forEach((c) => {\r\n            sqrd+=vec[c]*vec[c];\r\n        })\r\n        return Math.sqrt(sqrd);\r\n    }\r\n\r\n    distance(point1={}, point2={}) { //nDimensional vector distance function\r\n        let dsqrd = 0;\r\n        Object.keys(point1).forEach((c,i) => {\r\n            let pp = (point2[c] - point1[c]);\r\n            dsqrd += pp*pp;\r\n        })\r\n        return Math.sqrt(dsqrd);\r\n    }\r\n\r\n    makeVec(point1={},point2={}) {  //Make vector from two nDimensional points (arrays)\r\n        var vec = {};\r\n        Object.keys(point1).forEach((c,i) => {\r\n            vec[c] = point2[c] - point1[c];\r\n        })\r\n        return vec;\r\n    }\r\n\r\n    normalize(vec={}) { //nDimensional normalization\r\n        let _mag = 1/this.magnitude(vec);\r\n        let vecn = {};\r\n        Object.keys(vec).forEach((c,i) => {\r\n            vecn[c] = vec[c]*_mag;\r\n        })\r\n        return vecn;\r\n    }\r\n\r\n    //angle in xy plane from positive x-axis\r\n    calcAzimuth(position={x:1,y:1,z:0}) {\r\n        return Math.atan2(position.x,position.y);\r\n    }\r\n    \r\n    //z angle from origin\r\n    calcZenith(position={x:1,y:0,z:1}, magnitude=this.magnitude(position)) {\r\n        if(magnitude) return Math.acos(position.z/magnitude);\r\n        let mag = this.magnitude(position)\r\n        if(mag = 0) return 0;\r\n        return Math.acos(position.z/mag);\r\n    }\r\n\r\n    //set azimuth xy-plane angle from +x-axis (rad)\r\n    setAzimuth(az) {\r\n        this.props.azimuth = az;\r\n        props.position.z = props.distance*Math.sin(2*props.azimuth);\r\n    }\r\n\r\n    //zenith z-angle from +z-axis (rad)\r\n    setZenith(zen) {\r\n        this.props.theta = zen;\r\n        this.props.position.x = this.props.distance*Math.cos(this.props.theta);\r\n        this.props.position.y = this.props.distance*Math.sin(this.props.theta);\r\n    }\r\n\r\n    checkBoundaries = (position, velocity) => {\r\n        //this.props.position.x \r\n        let prect = this.parentNode.getBoundingClientRect();\r\n        //let rect = this.getBoundingClientRect();\r\n\r\n        let _mpx = 1/this.parentNode.props.meter_per_px;\r\n\r\n        //absolute pixel values of position\r\n        let pxx = prect.left+this.parentNode.clientWidth*0.5 - position.x*_mpx;\r\n        let pxy = prect.top+this.parentNode.clientHeight*0.5 - position.y*_mpx;\r\n        let pxz = prect.left+this.parentNode.clientWidth*0.5 - position.z*_mpx;\r\n\r\n        let rs = this.props.radius*_mpx;\r\n\r\n        //if(this.props.tag === 'sun') console.log(pxx+rs,prect.left,prect.right);\r\n\r\n        if(pxx+rs >= prect.right) {\r\n            position.x = -(this.parentNode.clientWidth*0.5)*this.parentNode.props.meter_per_px + this.props.radius;\r\n            if(velocity.x < 0) velocity.x = -velocity.x;\r\n        }\r\n        if(pxx-rs <= prect.left) {\r\n            position.x = (this.parentNode.clientWidth*0.5)*this.parentNode.props.meter_per_px - this.props.radius;\r\n            if(velocity.x > 0) velocity.x = -velocity.x;\r\n        }\r\n\r\n        //if(this.props.tag === 'sun') console.log(pxy-rs,prect.bottom)\r\n        if(pxy-rs <= prect.top) {\r\n            position.y = (this.parentNode.clientHeight*0.5)*this.parentNode.props.meter_per_px - this.props.radius;\r\n            if(velocity.y > 0) velocity.y = -velocity.y;\r\n        }\r\n        if(pxy+rs >= prect.bottom) {\r\n            position.y = (this.parentNode.clientHeight*0.5 - (prect.bottom-prect.top))*this.parentNode.props.meter_per_px + this.props.radius;\r\n            if(velocity.y < 0) velocity.y = -velocity.y;\r\n        }\r\n\r\n        if(pxz+rs >= prect.right) {\r\n            position.z = -(this.parentNode.clientWidth*0.5)*this.parentNode.props.meter_per_px + this.props.radius;\r\n            if(velocity.z < 0) velocity.z = -velocity.z;\r\n        }\r\n        if(pxz-rs <= prect.left) {\r\n            position.z = (this.parentNode.clientWidth*0.5)*this.parentNode.props.meter_per_px - this.props.radius;\r\n            if(velocity.z > 0) velocity.z = -velocity.z;\r\n        }\r\n    }\r\n\r\n    //set position using the spherical coordinats\r\n    setPositionFromSpherical(props) {\r\n        \r\n        if(!props.distance) {\r\n            props.distance = this.magnitude(props.position);\r\n            \r\n            if(props.azimuth) {\r\n                props.position.z = props.distance*Math.sin(2*props.azimuth);\r\n                props.div.style.top = (this.parentNode.clientHeight*0.5-props.position.y/this.parentNode.props.meter_per_px)+'px';\r\n            } else {\r\n                props.azimuth = this.calcZenith(props.position);\r\n            }\r\n            if(props.theta) {\r\n                props.position.x = props.distance*Math.cos(props.theta);\r\n                props.position.y = props.distance*Math.sin(props.theta);\r\n                props.div.style.left = (this.parentNode.clientWidth*0.5-props.position.x/this.parentNode.props.meter_per_px)+'px';\r\n            } else {\r\n                props.theta = this.calcAzimuth(props.position);\r\n            }\r\n        } else {\r\n            if(!props.azimuth) {\r\n                props.azimuth = this.calcZenith(props.position);\r\n            }\r\n            props.position.z = props.distance*Math.sin(2*props.azimuth);\r\n            if(!props.theta) {\r\n                props.theta = this.calcAzimuth(props.position);\r\n            }\r\n            props.position.x = props.distance*Math.cos(props.theta);\r\n            props.position.y = props.distance*Math.sin(props.theta);\r\n            \r\n            if(this.parentNode.props?.useHTML || !this.parentNode.props) {\r\n                props.div.style.left = (this.parentNode.clientWidth*0.5+props.position.x/this.parentNode.props.meter_per_px)+'px';\r\n                props.div.style.top = (this.parentNode.clientHeight*0.5-props.position.y/this.parentNode.props.meter_per_px)+'px';\r\n                let z = Math.floor(props.position.z/this.parentNode.props.meter_per_px);\r\n                if(Math.abs(this.parentNode.props.zind) > z) {this.parentNode.props.zind = z}\r\n                props.div.style.zIndex = z + parseInt(this.parentNode.props.canvas.style.zIndex) + this.parentNode.props.zind;\r\n            }\r\n        }\r\n    }\r\n\r\n    //gotta customize this a little from the default DOMElement\r\n    render = (props=this.props) => {\r\n\r\n        if(typeof this.template === 'function') this.templateString = this.template(props); //can pass a function\r\n        else this.templateString = this.template;\r\n\r\n        //this.innerHTML = this.templateString;\r\n\r\n        const t = document.createElement('template');\r\n        t.innerHTML = this.templateString;\r\n        const fragment = t.content;\r\n        if(this.fragment) { //will reappend the fragment without reappending the whole node if already rendered once\r\n            this.removeChild(this.fragment); \r\n        }\r\n        this.fragment = fragment;\r\n        this.appendChild(fragment);\r\n        \r\n        \r\n        //add this here which will run a routine AFTER rendering so the elements can be updated\r\n        this.setupNode(this.props);\r\n        if(this.props.input) { //e.g. run the node on input\r\n            setTimeout(async()=>{\r\n                this.props.node.runNode(this.props.node,this.props.input,this.props.graph); //run the inputs on the nodes once the children are loaded on the DOM so things propagate correctly\r\n            },\r\n            this.input_delay //makes sure children are loaded (e.g. on a DOM with a lot of loading, should add some execution delay to anticipate it as initial nodes are not aware of later-rendered nodes on the DOM)\r\n            );\r\n        }\r\n\r\n        this.setupPhysicsBody(props); //setup the physics logic\r\n        \r\n        if(this.oncreate) this.oncreate(props); //set scripted behaviors\r\n    }\r\n\r\n    setupPhysicsBody(props) {\r\n        \r\n        if(typeof props.px === 'number') props.position.x = props.px;\r\n        if(typeof props.py === 'number') props.position.y = props.py;\r\n        if(typeof props.pz === 'number') props.position.z = props.pz;\r\n        if(typeof props.vx === 'number') props.velocity.x = props.vx;\r\n        if(typeof props.vy === 'number') props.velocity.y = props.vy;\r\n        if(typeof props.vz === 'number') props.velocity.z = props.vz;\r\n\r\n        let div = this.querySelector('div');\r\n        props.div = div;\r\n\r\n        let rad = props.radius;\r\n        if(this.parentNode?.props?.meter_per_px) {\r\n            rad = rad/this.parentNode.props.meter_per_px;\r\n        }\r\n\r\n        if(this.parentNode.props?.useHTML || !this.parentNode.props) {\r\n            let left = this.parentNode.clientWidth*0.5+props.position.x/this.parentNode.props.meter_per_px;\r\n            let top = this.parentNode.clientHeight*0.5-props.position.y/this.parentNode.props.meter_per_px;\r\n\r\n            div.style.position = 'absolute';\r\n            div.style.height = 2*rad+'px';\r\n            div.style.width = 2*rad+'px';\r\n            div.style.borderRadius = rad+'px';\r\n            div.style.left = left+'px';\r\n            div.style.top = top+'px';\r\n            div.style.transform = 'translate(-'+rad+'px,-'+rad+'px)';\r\n\r\n            if(this.style.backgroundColor) div.style.backgroundColor = this.style.backgroundColor;\r\n        }\r\n        this.setPositionFromSpherical(props);\r\n\r\n        this.dragElement(div);\r\n\r\n        if(this.parentNode.props?.bodies) this.parentNode.props.bodies[props.tag] = props;\r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n\r\n    } //after rendering\r\n    //onresize=(props)=>{} //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n\r\n    dragElement = (elmnt) => {\r\n      \r\n        const dragMouseDown = (e) => {\r\n          e = e || window.event;\r\n          e.preventDefault();\r\n          // get the mouse cursor position at startup:\r\n\r\n          // call a function whenever the cursor moves:\r\n          let cancel = false;\r\n          setTimeout(() => {\r\n            if(!cancel) {\r\n                document.onmouseup = closeDragElement;\r\n                document.onmousemove = elementDrag;\r\n            }\r\n          },200); //don't accidentally drag if you want to just click\r\n          document.onmouseup = () => {\r\n            cancel = true;\r\n          }\r\n        }\r\n      \r\n        const elementDrag = (e) => {\r\n          e = e || window.event;\r\n          e.preventDefault();\r\n          // calculate the new cursor position:\r\n\r\n          if(this.parentNode.props?.meter_per_px) {\r\n              let rect = this.parentNode.getBoundingClientRect()\r\n            this.props.position.x = -(this.parentNode.clientWidth*0.5 + rect.x - e.clientX)*this.parentNode.props.meter_per_px;\r\n            this.props.position.y = (this.parentNode.clientHeight*0.5 + rect.y - e.clientY)*this.parentNode.props.meter_per_px;\r\n            this.props.velocity.x = 0;\r\n            this.props.velocity.y = 0;\r\n          }\r\n          // set the element's new position:\r\n          if(this.parentNode.props?.useHTML || !this.parentNode.props) {\r\n            elmnt.style.top =  e.clientY + \"px\";\r\n            elmnt.style.left = e.clientX + \"px\";\r\n          }\r\n        }\r\n      \r\n        const closeDragElement = () => {\r\n          // stop moving when mouse button is released:\r\n          document.onmouseup = null;\r\n          document.onmousemove = null;\r\n        }\r\n    \r\n\r\n        if (elmnt) {\r\n            // otherwise, move the DIV from anywhere inside the DIV:\r\n            elmnt.style.cursor = 'pointer';\r\n            elmnt.onmousedown = dragMouseDown;\r\n        }\r\n    }\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\naddCustomElement(PhysicsBodyNode,'physics-body');\r\n", "import {NodeDiv} from '../other/acyclicgraph/graph.node'\r\n\r\nlet component = require('./spectrometer.node.html');\r\n\r\n//See: https://github.com/brainsatplay/domelement\r\nexport class Spectrometer extends NodeDiv {\r\n\r\n    bitmap; //raw image data\r\n    bitslice; //slice of bitmap in picked area\r\n    canvas; //draw a capture area \r\n    ctx;\r\n    offscreen;\r\n    offscreenctx;\r\n    capture;\r\n    capturectx;\r\n    graph;\r\n    graphctx;\r\n    img; //img tag\r\n    video; //video tag\r\n    imgselect; //select options\r\n    \r\n\r\n    props={\r\n        picking:0,\r\n        picked:{x0:0,x1:100,y0:0,y1:100},\r\n        mode:'img',\r\n        operator:(\r\n            input,\r\n            node,\r\n            origin,\r\n            cmd\r\n        )=>{ \r\n\r\n            if(cmd === 'animate') {\r\n                //draw loop\r\n                this.draw(input,node,origin,cmd);\r\n                for(let i = 0; i < this.drawFuncs.length; i++) { //lets use other nodes to send draw functions to the canvas\r\n                    let f = this.drawFuncs[i];\r\n                    if(typeof f === 'function') {\r\n                        f(input,node,origin,cmd); //pass the args in (need these if you pass arrow functions)\r\n                    }\r\n                }\r\n            } else {\r\n                //e.g. input commands\r\n                if(typeof input === 'object') {\r\n                    \r\n                } else if (typeof input === 'number') {\r\n                    \r\n                } else if (typeof input === 'string') {\r\n                    \r\n                } else {\r\n                    \r\n                }\r\n            }\r\n        },\r\n\r\n        forward:true, //pass output to child nodes\r\n        backward:false, //pass output to parent node\r\n        children:undefined, //child node(s), can be tags of other nodes, properties objects like this, or graphnodes, or null\r\n        parent:undefined, //parent graph node\r\n        delay:false, //ms delay to fire the node\r\n        repeat:false, // set repeat as an integer to repeat the input n times\r\n        recursive:false, //or set recursive with an integer to pass the output back in as the next input n times\r\n        animate:true, //true or false\r\n        loop:undefined, //milliseconds or false\r\n        tag:undefined, //generated if not specified, or use to get another node by tag instead of generating a new one\r\n        input:undefined,// can set on the attribute etc\r\n        graph:undefined, //parent AcyclicGraph instance, can set manually or via enclosing acyclic-graph div\r\n        node:undefined //GraphNode instance, can set manually or as a string to grab a node by tag (or use tag)\r\n    }; //can specify properties of the element which can be subscribed to for changes.\r\n\r\n    //set the template string or function (which can input props to return a modified string)\r\n    template=component;\r\n\r\n    draw(input,node,origin,cmd) {\r\n        let canvas = this.props.canvas;\r\n        let ctx = this.props.ctx;\r\n    }\r\n\r\n    addDraw(f) {\r\n        if(typeof f === 'function') this.drawFuncs.push(f);\r\n    }\r\n\r\n    drawFuncs = []; // draw(input,node,origin,cmd){} <--- passes operator args\r\n    \r\n    useWebcam = () => {\r\n\r\n        this.img.style.display = 'none';\r\n        this.video.style.display = '';\r\n\r\n        if(navigator.getUserMedia) {\r\n            navigator.getUserMedia({video:true},(stream) => {\r\n                this.video.srcObject = stream;\r\n                this.video.play();\r\n                this.video.width = this.canvas.width;\r\n                this.video.height = this.canvas.height;\r\n                this.props.mode = 'video';\r\n                //     this.canvas.height = this.video.height;\r\n                //     this.canvas.width = this.video.width;\r\n                //     this.canvas.style.width = this.video.style.width;\r\n                //     this.canvas.style.height = this.video.style.height;\r\n                // this.offscreen.height = this.canvas.height;\r\n                // this.offscreen.width = this.canvas.width;\r\n            },console.error);\r\n        }\r\n\r\n    }\r\n\r\n    useImage = () => {\r\n        if(this.video.src) {\r\n            this.video.pause();;\r\n            this.video.src = '';\r\n            this.video.style.display = 'none';\r\n        }\r\n        this.img.src = this.select.value;\r\n        this.img.style.display = '';\r\n        this.props.mode = 'img';\r\n\r\n        this.canvas.height = this.img.height;\r\n        this.canvas.width = this.img.width;\r\n        this.canvas.style.width = this.img.style.width;\r\n        this.canvas.style.height = this.img.style.height;\r\n        // this.offscreen.height = this.canvas.height;\r\n        // this.offscreen.width = this.canvas.width;\r\n    }\r\n\r\n    inputImgUrl() {\r\n        let input = this.querySelector('#imgurl').value;\r\n        if(input) {\r\n            if(this.video.src) {\r\n                this.video.pause();;\r\n                this.video.src = '';\r\n                this.video.style.display = 'none';\r\n            }\r\n            this.img.src = input;\r\n            this.img.style.display = '';\r\n            this.props.mode = 'img';\r\n    \r\n            this.canvas.height = this.img.height;\r\n            this.canvas.width = this.canvas.width;\r\n            this.canvas.style.width = this.img.style.width;\r\n            this.canvas.style.height = this.img.style.height;\r\n            // this.offscreen.height = this.canvas.height;\r\n            // this.offscreen.width = this.canvas.width;\r\n        }\r\n    }\r\n\r\n    inputVideoSrc() {\r\n        this.img.style.display = 'none';\r\n        this.video.style.display = '';\r\n        \r\n        let input = this.querySelector('#videourl').value;\r\n\r\n        if(input) {\r\n            this.video.src = input;\r\n            this.video.play();\r\n            this.props.mode = 'video';\r\n            this.canvas.height = this.video.height;\r\n            this.canvas.width = this.video.width;\r\n            this.canvas.style.width = this.video.style.width;\r\n            this.canvas.style.height = this.video.style.height;\r\n            // this.offscreen.height = this.canvas.height;\r\n            // this.offscreen.width = this.canvas.width;\r\n        }\r\n    }\r\n\r\n            \r\n    drawCircle(centerX, centerY, radius, fill='green', strokewidth=5, strokestyle='#003300', ctx=this.ctx) {\r\n        ctx.beginPath();\r\n        ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI, false);\r\n        ctx.fillStyle = fill;\r\n        ctx.fill();\r\n        ctx.lineWidth = strokewidth;\r\n        ctx.strokeStyle = strokestyle;\r\n        ctx.stroke();\r\n    }\r\n\r\n    drawLine(\r\n        from={x:0,y:0},\r\n        to={x:1,y:1},\r\n        strokewidth=5,\r\n        strokestyle='#003300',\r\n        ctx=this.ctx\r\n    ) {\r\n        ctx.beginPath();\r\n        ctx.lineWidth = strokewidth;\r\n        ctx.strokeStyle = strokestyle;\r\n        ctx.moveTo(from.x, from.y);\r\n        ctx.lineTo(to.x, to.y);\r\n        ctx.stroke();\r\n    }\r\n\r\n    canvasClicked = (ev) => {\r\n        this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);\r\n        if(this.props.picking === 0) {\r\n            \r\n            this.props.picked.x0 = ev.pageX - this.canvas.offsetLeft;\r\n            this.props.picked.y0 = ev.pageY - this.canvas.offsetTop;\r\n\r\n            this.drawCircle(this.props.picked.x0, this.props.picked.y0, 2.5, 'orange', 1, 'orange'); //show targeted point\r\n            \r\n            this.props.picking = 1;\r\n        }\r\n        else {\r\n             \r\n            this.props.picked.x1 = ev.pageX  - this.canvas.offsetLeft;\r\n            this.props.picked.y1 = ev.pageY  - this.canvas.offsetTop;\r\n\r\n            if(this.props.picked.x1 < this.props.picked.x0) {\r\n                let temp = this.props.picked.x1;\r\n                this.props.picked.x1 = this.props.picked.x0;\r\n                this.props.picked.x0 = temp;\r\n            }\r\n            if(this.props.picked.y1 < this.props.picked.y0) {\r\n                let temp = this.props.picked.y1;\r\n                this.props.picked.y1 = this.props.picked.y0;\r\n                this.props.picked.y0 = temp;\r\n            }\r\n\r\n            this.props.picking = 0;\r\n\r\n            this.ctx.lineWidth = 3;\r\n            this.ctx.strokeStyle = 'orange';\r\n            this.ctx.rect(this.props.picked.x0,this.props.picked.y0,this.props.picked.x1-this.props.picked.x0,this.props.picked.y1-this.props.picked.y0);\r\n            this.ctx.stroke();\r\n   \r\n            this.canvasCapture(ev); //new rectangle, capture new image\r\n        }\r\n        \r\n    }\r\n\r\n    processCapture = (img) => {\r\n            \r\n        //this.offscreen.width = img.width;\r\n        //this.offscreen.height = img.height;\r\n\r\n        //this.offscreenctx.drawImage(img,0,0);\r\n        \r\n        this.capturectx.clearRect(0,0,this.capture.width,this.capture.height);\r\n        this.graphctx.fillStyle = 'gray'\r\n        this.graphctx.fillRect(0,0,this.graph.width,this.graph.height);\r\n\r\n        this.capture.width = img.width;\r\n        this.capture.height = img.height;\r\n        this.graph.width = img.width;\r\n        this.graph.height = img.height;\r\n\r\n\r\n        this.capturectx.drawImage(img,0,0);\r\n\r\n        this.bitmap = this.capturectx.getImageData(0,0,this.capture.width,this.capture.height);\r\n\r\n        let bitarr = Array.from(this.bitmap.data);\r\n        console.log(bitarr)\r\n\r\n        //intensities along the x axis (summing the y column image data)\r\n        let xintensities = [];\r\n        let xrgbintensities = [];\r\n\r\n        let x = 0;\r\n\r\n        for(let i = 0; i < bitarr.length; i+=4) {\r\n            if((i/4) % img.width === 0) x = 0;\r\n\r\n            if(!xintensities[x]) {\r\n                xintensities[x] = (bitarr[i+1]+bitarr[i+2]+bitarr[i+3]);\r\n                xrgbintensities[x] = {\r\n                    r:bitarr[i+1],\r\n                    g:bitarr[i+2],\r\n                    b:bitarr[i+3]\r\n                }\r\n            }\r\n            else {\r\n                xintensities[x] += (bitarr[i+1]+bitarr[i+2]+bitarr[i+3]);\r\n                xrgbintensities[x].r += bitarr[i+1];\r\n                xrgbintensities[x].g += bitarr[i+2];\r\n                xrgbintensities[x].b += bitarr[i+3];\r\n            }\r\n            x++;\r\n        }\r\n\r\n        let xintmax = Math.max(...xintensities.map((x) => {if(!typeof x !== 'number') { return parseFloat(x);}}));\r\n        console.log(xintmax);\r\n        this.graphctx.fillStyle = 'white';\r\n\r\n        this.graphctx.fillText(`Max summed value: ${xintmax}`,10,10,100);\r\n\r\n        this.graphctx.strokeStyle = 'orange';\r\n\r\n        xintensities.forEach((y,i) => {\r\n            if(i === 0) {\r\n                this.graphctx.moveTo(0,this.graph.height*(1-y/xintmax));\r\n            }\r\n            else {\r\n                this.graphctx.lineTo(i,this.graph.height*(1-y/xintmax));\r\n            }\r\n        });\r\n\r\n        this.graphctx.stroke();\r\n        //update the plot from the bitmap\r\n        \r\n       // console.log(this.bitmap, xintensities, xrgbintensities);\r\n\r\n \r\n    }\r\n\r\n    //pull the bitmap into canvas;\r\n    canvasCapture(ev) {\r\n\r\n        if(this.props.mode === 'img') {\r\n\r\n            if(!this.img.src) return;\r\n            \r\n            let pickedArea = { //project the canvas rectangle pick coordinates into the image \r\n                x0:this.img.width * this.props.picked.x0/this.canvas.width,\r\n                y0:this.img.height * this.props.picked.y0/this.canvas.height,\r\n                x1:this.img.width * this.props.picked.x1/this.canvas.width,\r\n                y1:this.img.height * this.props.picked.y1/this.canvas.height\r\n            };\r\n\r\n            createImageBitmap(\r\n                this.img, \r\n                pickedArea.x0 - this.img.offsetLeft,\r\n                pickedArea.y0 - this.img.offsetTop, \r\n                pickedArea.x1-pickedArea.x0,\r\n                pickedArea.y1-pickedArea.y0\r\n            ).then(this.processCapture);\r\n\r\n        }   \r\n        else if(this.props.mode === 'video') {\r\n            \r\n            if(!this.video.src) return;\r\n\r\n            let pickedArea = {\r\n                x0:this.video.width*this.props.picked.x0/this.canvas.width,\r\n                y0:this.video.height*this.props.picked.y0/this.canvas.height,\r\n                x1:this.video.width*this.props.picked.x1/this.canvas.width,\r\n                y1:this.video.height*this.props.picked.y1/this.canvas.height\r\n            };\r\n\r\n            createImageBitmap(\r\n                this.video,\r\n                pickedArea.x0 - this.img.offsetLeft,\r\n                pickedArea.y0 - this.img.offsetTop, \r\n                pickedArea.x1-pickedArea.x0,\r\n                pickedArea.y1-pickedArea.y0\r\n            ).then(this.processCapture);\r\n        }\r\n    }\r\n\r\n    //DOMElement custom callbacks:\r\n    oncreate=(props)=>{\r\n        this.canvas = this.querySelector('#picker');\r\n        this.img = this.querySelector('img');\r\n        this.video = this.querySelector('video');\r\n        this.select = this.querySelector('#imgselect');\r\n        this.capture = this.querySelector('#capture');\r\n        this.graph = this.querySelector('#graph');\r\n\r\n        this.select.onchange = (ev) => {\r\n            if(this.mode === 'img') this.useImage();\r\n        }\r\n        \r\n        this.querySelector('#webcam').onclick = this.useWebcam;\r\n        this.querySelector('#image').onclick = this.useImage;\r\n        this.querySelector('#setImgUrl').onclick = this.inputImgUrl;\r\n        this.querySelector('#setVideoUrl').onclick = this.inputVideoSrc;\r\n\r\n        if(props.width) {\r\n            this.canvas.width = props.width;\r\n            this.canvas.style.width = props.width;\r\n            this.video.width = props.width;\r\n            this.video.style.width = props.width;\r\n            this.img.width = props.width;\r\n            this.img.style.width = props.width;\r\n        }\r\n        if(props.height) {\r\n            this.canvas.height = props.height;\r\n            this.canvas.style.height = props.height;\r\n            this.video.height = props.height;\r\n            this.video.style.height = props.height;\r\n            this.img.height = props.height;\r\n            this.img.style.height = props.height;\r\n        }\r\n        if(props.style) {\r\n            this.canvas.style = props.style;\r\n            this.canvas.zIndex = 3;\r\n            this.video.style = props.style;\r\n            this.video.zIndex = 2;\r\n            this.img.style = props.style;\r\n            this.img.zIndex = 1;\r\n            setTimeout(()=>{\r\n                this.canvas.height = this.canvas.clientHeight;\r\n                this.canvas.width = this.canvas.clientWidth;\r\n                this.img.width = props.width;\r\n                this.img.height = props.height;\r\n                this.video.width = props.width;\r\n                this.video.height = props.height;\r\n            },10); //slight recalculation delay time\r\n        }\r\n\r\n        \r\n        // this.offscreen.height = this.canvas.height;\r\n        // this.offscreen.width = this.canvas.width;\r\n\r\n        props.canvas = this.canvas;\r\n        if(props.context) props.context = this.canvas.getContext(props.context);\r\n        else props.context = this.canvas.getContext('2d');\r\n        this.context = props.context;\r\n        this.ctx = this.context;\r\n        props.ctx = this.context;\r\n\r\n\r\n        this.offscreen = new OffscreenCanvas(this.canvas.width,this.canvas.height);\r\n        this.offscreenctx = this.offscreen.getContext('2d');\r\n        \r\n        this.capturectx = this.capture.getContext('2d');\r\n        this.graphctx = this.capture.getContext('2d');\r\n\r\n        this.useImage();\r\n\r\n        this.props.picked.x1 = this.canvas.width;\r\n        this.props.picked.y1 = this.canvas.height;\r\n\r\n        this.canvas.onclick = this.canvasClicked;\r\n\r\n        setTimeout(()=>{if(props.animate) props.node.runAnimation();},10)\r\n\r\n    }\r\n\r\n    //after rendering\r\n    onresize=(props)=>{\r\n        if(this.canvas) {\r\n            this.canvas.width = this.canvas.clientWidth;\r\n            this.canvas.height = this.canvas.clientHeight;\r\n            this.canvas.style.width = this.canvas.clientWidth;\r\n            this.canvas.style.height = this.canvas.clientHeight;\r\n        }\r\n    } //on window resize\r\n    //onchanged=(props)=>{} //on props changed\r\n    //ondelete=(props)=>{} //on element deleted. Can remove with this.delete() which runs cleanup functions\r\n}\r\n\r\n//window.customElements.define('custom-', Custom);\r\n\r\nSpectrometer.addElement('spectrometer-node');\r\n", "import './components/components.index'\r\n\r\nlet elm = document.createElement('spectrometer-node');\r\n\r\ndocument.body.appendChild(elm);"],
  "mappings": "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",
  "names": []
}
