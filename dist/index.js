(()=>{var iu=Object.create;var uo=Object.defineProperty;var nu=Object.getOwnPropertyDescriptor;var ou=Object.getOwnPropertyNames;var su=Object.getPrototypeOf,au=Object.prototype.hasOwnProperty;var yr=(h,o)=>()=>(o||h((o={exports:{}}).exports,o),o.exports);var uu=(h,o,s,f)=>{if(o&&typeof o=="object"||typeof o=="function")for(let y of ou(o))!au.call(h,y)&&y!==s&&uo(h,y,{get:()=>o[y],enumerable:!(f=nu(o,y))||f.enumerable});return h};var fo=(h,o,s)=>(s=h!=null?iu(su(h)):{},uu(o||!h||!h.__esModule?uo(s,"default",{value:h,enumerable:!0}):s,h));var co=yr((Cr,Ii)=>{(function(o,s){typeof Cr=="object"&&typeof Ii=="object"?Ii.exports=s():typeof define=="function"&&define.amd?define([],s):typeof Cr=="object"?Cr.BrowserFS=s():o.BrowserFS=s()})(Cr,function(){return function(h){var o={};function s(f){if(o[f])return o[f].exports;var y=o[f]={exports:{},id:f,loaded:!1};return h[f].call(y.exports,y,y.exports,s),y.loaded=!0,y.exports}return s.m=h,s.c=o,s.p="",s(0)}([function(h,o,s){(function(f,y,d,m){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var E=s(2),w=s(9),c;(function(i){i[i.EPERM=1]="EPERM",i[i.ENOENT=2]="ENOENT",i[i.EIO=5]="EIO",i[i.EBADF=9]="EBADF",i[i.EACCES=13]="EACCES",i[i.EBUSY=16]="EBUSY",i[i.EEXIST=17]="EEXIST",i[i.ENOTDIR=20]="ENOTDIR",i[i.EISDIR=21]="EISDIR",i[i.EINVAL=22]="EINVAL",i[i.EFBIG=27]="EFBIG",i[i.ENOSPC=28]="ENOSPC",i[i.EROFS=30]="EROFS",i[i.ENOTEMPTY=39]="ENOTEMPTY",i[i.ENOTSUP=95]="ENOTSUP"})(c||(c={}));var _={};_[c.EPERM]="Operation not permitted.",_[c.ENOENT]="No such file or directory.",_[c.EIO]="Input/output error.",_[c.EBADF]="Bad file descriptor.",_[c.EACCES]="Permission denied.",_[c.EBUSY]="Resource busy or locked.",_[c.EEXIST]="File exists.",_[c.ENOTDIR]="File is not a directory.",_[c.EISDIR]="File is a directory.",_[c.EINVAL]="Invalid argument.",_[c.EFBIG]="File is too big.",_[c.ENOSPC]="No space left on disk.",_[c.EROFS]="Cannot modify a read-only file system.",_[c.ENOTEMPTY]="Directory is not empty.",_[c.ENOTSUP]="Operation is not supported.";var p=function(i){function t(r,e,n){e===void 0&&(e=_[r]),i.call(this,e),this.syscall="",this.errno=r,this.code=c[r],this.path=n,this.stack=new i().stack,this.message="Error: "+this.code+": "+e+(this.path?", '"+this.path+"'":"")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.fromJSON=function(e){var n=new t(0);return n.errno=e.errno,n.code=e.code,n.path=e.path,n.stack=e.stack,n.message=e.message,n},t.fromBuffer=function(e,n){return n===void 0&&(n=0),t.fromJSON(JSON.parse(e.toString("utf8",n+4,n+4+e.readUInt32LE(n))))},t.FileError=function(e,n){return new t(e,_[e],n)},t.ENOENT=function(e){return this.FileError(c.ENOENT,e)},t.EEXIST=function(e){return this.FileError(c.EEXIST,e)},t.EISDIR=function(e){return this.FileError(c.EISDIR,e)},t.ENOTDIR=function(e){return this.FileError(c.ENOTDIR,e)},t.EPERM=function(e){return this.FileError(c.EPERM,e)},t.ENOTEMPTY=function(e){return this.FileError(c.ENOTEMPTY,e)},t.prototype.toString=function(){return this.message},t.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},t.prototype.writeToBuffer=function(e,n){e===void 0&&(e=f.alloc(this.bufferSize())),n===void 0&&(n=0);var a=e.write(JSON.stringify(this.toJSON()),n+4);return e.writeUInt32LE(a,n),e},t.prototype.bufferSize=function(){return 4+f.byteLength(JSON.stringify(this.toJSON()))},t}(Error),T=Object.freeze({get ErrorCode(){return c},ErrorStrings:_,ApiError:p}),A;(function(i){i[i.NOP=0]="NOP",i[i.THROW_EXCEPTION=1]="THROW_EXCEPTION",i[i.TRUNCATE_FILE=2]="TRUNCATE_FILE",i[i.CREATE_FILE=3]="CREATE_FILE"})(A||(A={}));var b=function i(t){if(this.flagStr=t,i.validFlagStrs.indexOf(t)<0)throw new p(c.EINVAL,"Invalid flag: "+t)};b.getFileFlag=function(t){return b.flagCache.hasOwnProperty(t)?b.flagCache[t]:b.flagCache[t]=new b(t)},b.prototype.getFlagString=function(){return this.flagStr},b.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},b.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},b.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},b.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},b.prototype.pathExistsAction=function(){return this.isExclusive()?A.THROW_EXCEPTION:this.isTruncating()?A.TRUNCATE_FILE:A.NOP},b.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?A.CREATE_FILE:A.THROW_EXCEPTION},b.flagCache={},b.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var L;(function(i){i[i.FILE=32768]="FILE",i[i.DIRECTORY=16384]="DIRECTORY",i[i.SYMLINK=40960]="SYMLINK"})(L||(L={}));var C=function(t,r,e,n,a,u){if(n===void 0&&(n=new Date),a===void 0&&(a=new Date),u===void 0&&(u=new Date),this.size=r,this.atime=n,this.mtime=a,this.ctime=u,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,e)this.mode=e;else switch(t){case L.FILE:this.mode=420;break;case L.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(r/512),this.mode<4096&&(this.mode|=t)};C.fromBuffer=function(t){var r=t.readUInt32LE(0),e=t.readUInt32LE(4),n=t.readDoubleLE(8),a=t.readDoubleLE(16),u=t.readDoubleLE(24);return new C(e&61440,r,e&4095,new Date(n),new Date(a),new Date(u))},C.prototype.toBuffer=function(){var t=f.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},C.prototype.clone=function(){return new C(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},C.prototype.isFile=function(){return(this.mode&61440)===L.FILE},C.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY},C.prototype.isSymbolicLink=function(){return(this.mode&61440)===L.SYMLINK},C.prototype.chmod=function(t){this.mode=this.mode&61440|t},C.prototype.isSocket=function(){return!1},C.prototype.isBlockDevice=function(){return!1},C.prototype.isCharacterDevice=function(){return!1},C.prototype.isFIFO=function(){return!1};var G=function(i,t){return i};function W(i){if(i)return i;throw new p(c.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function U(i,t){switch(typeof i){case"number":return i;case"string":var r=parseInt(i,8);return isNaN(r)?t:r;default:return t}}function Et(i){if(i instanceof Date)return i;if(typeof i=="number")return new Date(i*1e3);throw new p(c.EINVAL,"Invalid time.")}function et(i){if(i.indexOf("\0")>=0)throw new p(c.EINVAL,"Path must be a string without null bytes.");if(i==="")throw new p(c.EINVAL,"Path must not be empty.");return w.resolve(i)}function wt(i,t,r,e){switch(typeof i){case"object":return{encoding:typeof i.encoding<"u"?i.encoding:t,flag:typeof i.flag<"u"?i.flag:r,mode:U(i.mode,e)};case"string":return{encoding:i,flag:r,mode:e};default:return{encoding:t,flag:r,mode:e}}}function pt(){}var M=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};M.prototype.initialize=function(t){if(!t.constructor.isAvailable())throw new p(c.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=t},M.prototype._toUnixTimestamp=function(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},M.prototype.getRootFS=function(){return this.root?this.root:null},M.prototype.rename=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{W(this.root).rename(et(t),et(r),n)}catch(a){n(a)}},M.prototype.renameSync=function(t,r){W(this.root).renameSync(et(t),et(r))},M.prototype.exists=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).exists(et(t),e)}catch{return e(!1)}},M.prototype.existsSync=function(t){try{return W(this.root).existsSync(et(t))}catch{return!1}},M.prototype.stat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!1,e)}catch(n){return e(n)}},M.prototype.statSync=function(t){return W(this.root).statSync(et(t),!1)},M.prototype.lstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!0,e)}catch(n){return e(n)}},M.prototype.lstatSync=function(t){return W(this.root).statSync(et(t),!0)},M.prototype.truncate=function(t,r,e){r===void 0&&(r=0),e===void 0&&(e=pt);var n=0;typeof r=="function"?e=r:typeof r=="number"&&(n=r);var a=G(e,1);try{if(n<0)throw new p(c.EINVAL);return W(this.root).truncate(et(t),n,a)}catch(u){return a(u)}},M.prototype.truncateSync=function(t,r){if(r===void 0&&(r=0),r<0)throw new p(c.EINVAL);return W(this.root).truncateSync(et(t),r)},M.prototype.unlink=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).unlink(et(t),e)}catch(n){return e(n)}},M.prototype.unlinkSync=function(t){return W(this.root).unlinkSync(et(t))},M.prototype.open=function(t,r,e,n){var a=this;n===void 0&&(n=pt);var u=U(e,420);n=typeof e=="function"?e:n;var l=G(n,2);try{W(this.root).open(et(t),b.getFileFlag(r),u,function(S,x){x?l(S,a.getFdForFile(x)):l(S)})}catch(S){l(S)}},M.prototype.openSync=function(t,r,e){return e===void 0&&(e=420),this.getFdForFile(W(this.root).openSync(et(t),b.getFileFlag(r),U(e,420)))},M.prototype.readFile=function(t,r,e){r===void 0&&(r={}),e===void 0&&(e=pt);var n=wt(r,null,"r",null);e=typeof r=="function"?r:e;var a=G(e,2);try{var u=b.getFileFlag(n.flag);return u.isReadable()?W(this.root).readFile(et(t),n.encoding,u,a):a(new p(c.EINVAL,"Flag passed to readFile must allow for reading."))}catch(l){return a(l)}},M.prototype.readFileSync=function(t,r){r===void 0&&(r={});var e=wt(r,null,"r",null),n=b.getFileFlag(e.flag);if(!n.isReadable())throw new p(c.EINVAL,"Flag passed to readFile must allow for reading.");return W(this.root).readFileSync(et(t),e.encoding,n)},M.prototype.writeFile=function(t,r,e,n){e===void 0&&(e={}),n===void 0&&(n=pt);var a=wt(e,"utf8","w",420);n=typeof e=="function"?e:n;var u=G(n,1);try{var l=b.getFileFlag(a.flag);return l.isWriteable()?W(this.root).writeFile(et(t),r,a.encoding,l,a.mode,u):u(new p(c.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(S){return u(S)}},M.prototype.writeFileSync=function(t,r,e){var n=wt(e,"utf8","w",420),a=b.getFileFlag(n.flag);if(!a.isWriteable())throw new p(c.EINVAL,"Flag passed to writeFile must allow for writing.");return W(this.root).writeFileSync(et(t),r,n.encoding,a,n.mode)},M.prototype.appendFile=function(t,r,e,n){n===void 0&&(n=pt);var a=wt(e,"utf8","a",420);n=typeof e=="function"?e:n;var u=G(n,1);try{var l=b.getFileFlag(a.flag);if(!l.isAppendable())return u(new p(c.EINVAL,"Flag passed to appendFile must allow for appending."));W(this.root).appendFile(et(t),r,a.encoding,l,a.mode,u)}catch(S){u(S)}},M.prototype.appendFileSync=function(t,r,e){var n=wt(e,"utf8","a",420),a=b.getFileFlag(n.flag);if(!a.isAppendable())throw new p(c.EINVAL,"Flag passed to appendFile must allow for appending.");return W(this.root).appendFileSync(et(t),r,n.encoding,a,n.mode)},M.prototype.fstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{var n=this.fd2file(t);n.stat(e)}catch(a){e(a)}},M.prototype.fstatSync=function(t){return this.fd2file(t).statSync()},M.prototype.close=function(t,r){var e=this;r===void 0&&(r=pt);var n=G(r,1);try{this.fd2file(t).close(function(a){a||e.closeFd(t),n(a)})}catch(a){n(a)}},M.prototype.closeSync=function(t){this.fd2file(t).closeSync(),this.closeFd(t)},M.prototype.ftruncate=function(t,r,e){e===void 0&&(e=pt);var n=typeof r=="number"?r:0;e=typeof r=="function"?r:e;var a=G(e,1);try{var u=this.fd2file(t);if(n<0)throw new p(c.EINVAL);u.truncate(n,a)}catch(l){a(l)}},M.prototype.ftruncateSync=function(t,r){r===void 0&&(r=0);var e=this.fd2file(t);if(r<0)throw new p(c.EINVAL);e.truncateSync(r)},M.prototype.fsync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).sync(e)}catch(n){e(n)}},M.prototype.fsyncSync=function(t){this.fd2file(t).syncSync()},M.prototype.fdatasync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).datasync(e)}catch(n){e(n)}},M.prototype.fdatasyncSync=function(t){this.fd2file(t).datasyncSync()},M.prototype.write=function(t,r,e,n,a,u){u===void 0&&(u=pt);var l,S,x,O=null;if(typeof r=="string"){var D="utf8";switch(typeof e){case"function":u=e;break;case"number":O=e,D=typeof n=="string"?n:"utf8",u=typeof a=="function"?a:u;break;default:return u=typeof n=="function"?n:typeof a=="function"?a:u,u(new p(c.EINVAL,"Invalid arguments."))}l=f.from(r,D),S=0,x=l.length}else l=r,S=e,x=n,O=typeof a=="number"?a:null,u=typeof a=="function"?a:u;var V=G(u,3);try{var $=this.fd2file(t);O==null&&(O=$.getPos()),$.write(l,S,x,O,V)}catch(rt){V(rt)}},M.prototype.writeSync=function(t,r,e,n,a){var u,l=0,S,x;if(typeof r=="string"){x=typeof e=="number"?e:null;var O=typeof n=="string"?n:"utf8";l=0,u=f.from(r,O),S=u.length}else u=r,l=e,S=n,x=typeof a=="number"?a:null;var D=this.fd2file(t);return x==null&&(x=D.getPos()),D.writeSync(u,l,S,x)},M.prototype.read=function(t,r,e,n,a,u){u===void 0&&(u=pt);var l,S,x,O,D;if(typeof r=="number"){x=r,l=e;var V=n;u=typeof a=="function"?a:u,S=0,O=f.alloc(x),D=G(function(rt,ft,yt){if(rt)return u(rt);u(rt,yt.toString(V),ft)},3)}else O=r,S=e,x=n,l=a,D=G(u,3);try{var $=this.fd2file(t);l==null&&(l=$.getPos()),$.read(O,S,x,l,D)}catch(rt){D(rt)}},M.prototype.readSync=function(t,r,e,n,a){var u=!1,l,S,x,O,D="utf8";typeof r=="number"?(x=r,O=e,D=n,S=0,l=f.alloc(x),u=!0):(l=r,S=e,x=n,O=a);var V=this.fd2file(t);O==null&&(O=V.getPos());var $=V.readSync(l,S,x,O);return u?[l.toString(D),$]:$},M.prototype.fchown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{this.fd2file(t).chown(r,e,a)}catch(u){a(u)}},M.prototype.fchownSync=function(t,r,e){this.fd2file(t).chownSync(r,e)},M.prototype.fchmod=function(t,r,e){var n=G(e,1);try{var a=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmod(a,n)}catch(u){n(u)}},M.prototype.fchmodSync=function(t,r){var e=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmodSync(e)},M.prototype.futimes=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{var u=this.fd2file(t);typeof r=="number"&&(r=new Date(r*1e3)),typeof e=="number"&&(e=new Date(e*1e3)),u.utimes(r,e,a)}catch(l){a(l)}},M.prototype.futimesSync=function(t,r,e){this.fd2file(t).utimesSync(Et(r),Et(e))},M.prototype.rmdir=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{t=et(t),W(this.root).rmdir(t,e)}catch(n){e(n)}},M.prototype.rmdirSync=function(t){return t=et(t),W(this.root).rmdirSync(t)},M.prototype.mkdir=function(t,r,e){e===void 0&&(e=pt),typeof r=="function"&&(e=r,r=511);var n=G(e,1);try{t=et(t),W(this.root).mkdir(t,r,n)}catch(a){n(a)}},M.prototype.mkdirSync=function(t,r){W(this.root).mkdirSync(et(t),U(r,511))},M.prototype.readdir=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readdir(t,e)}catch(n){e(n)}},M.prototype.readdirSync=function(t){return t=et(t),W(this.root).readdirSync(t)},M.prototype.link=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{t=et(t),r=et(r),W(this.root).link(t,r,n)}catch(a){n(a)}},M.prototype.linkSync=function(t,r){return t=et(t),r=et(r),W(this.root).linkSync(t,r)},M.prototype.symlink=function(t,r,e,n){n===void 0&&(n=pt);var a=typeof e=="string"?e:"file";n=typeof e=="function"?e:n;var u=G(n,1);try{if(a!=="file"&&a!=="dir")return u(new p(c.EINVAL,"Invalid type: "+a));t=et(t),r=et(r),W(this.root).symlink(t,r,a,u)}catch(l){u(l)}},M.prototype.symlinkSync=function(t,r,e){if(!e)e="file";else if(e!=="file"&&e!=="dir")throw new p(c.EINVAL,"Invalid type: "+e);return t=et(t),r=et(r),W(this.root).symlinkSync(t,r,e)},M.prototype.readlink=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readlink(t,e)}catch(n){e(n)}},M.prototype.readlinkSync=function(t){return t=et(t),W(this.root).readlinkSync(t)},M.prototype.chown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{t=et(t),W(this.root).chown(t,!1,r,e,a)}catch(u){a(u)}},M.prototype.chownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!1,r,e)},M.prototype.lchown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{t=et(t),W(this.root).chown(t,!0,r,e,a)}catch(u){a(u)}},M.prototype.lchownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!0,r,e)},M.prototype.chmod=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{var a=U(r,-1);if(a<0)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!1,a,n)}catch(u){n(u)}},M.prototype.chmodSync=function(t,r){var e=U(r,-1);if(e<0)throw new p(c.EINVAL,"Invalid mode.");t=et(t),W(this.root).chmodSync(t,!1,e)},M.prototype.lchmod=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{var a=U(r,-1);if(a<0)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!0,a,n)}catch(u){n(u)}},M.prototype.lchmodSync=function(t,r){var e=U(r,-1);if(e<1)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmodSync(et(t),!0,e)},M.prototype.utimes=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{W(this.root).utimes(et(t),Et(r),Et(e),a)}catch(u){a(u)}},M.prototype.utimesSync=function(t,r,e){W(this.root).utimesSync(et(t),Et(r),Et(e))},M.prototype.realpath=function(t,r,e){e===void 0&&(e=pt);var n=typeof r=="object"?r:{};e=typeof r=="function"?r:pt;var a=G(e,2);try{t=et(t),W(this.root).realpath(t,n,a)}catch(u){a(u)}},M.prototype.realpathSync=function(t,r){return r===void 0&&(r={}),t=et(t),W(this.root).realpathSync(t,r)},M.prototype.watchFile=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.unwatchFile=function(t,r){throw r===void 0&&(r=pt),new p(c.ENOTSUP)},M.prototype.watch=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.access=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.accessSync=function(t,r){throw new p(c.ENOTSUP)},M.prototype.createReadStream=function(t,r){throw new p(c.ENOTSUP)},M.prototype.createWriteStream=function(t,r){throw new p(c.ENOTSUP)},M.prototype.wrapCallbacks=function(t){G=t},M.prototype.getFdForFile=function(t){var r=this.nextFd++;return this.fdMap[r]=t,r},M.prototype.fd2file=function(t){var r=this.fdMap[t];if(r)return r;throw new p(c.EBADF,"Invalid file descriptor.")},M.prototype.closeFd=function(t){delete this.fdMap[t]},M.Stats=C;var tt=new M,ct={},Nt=M.prototype;Object.keys(Nt).forEach(function(i){typeof tt[i]=="function"?ct[i]=function(){return tt[i].apply(tt,arguments)}:ct[i]=tt[i]}),ct.changeFSModule=function(i){tt=i},ct.getFSModule=function(){return tt},ct.FS=M;function dt(i,t,r,e,n){return i<t||r<t?i>r?r+1:i+1:e===n?t:t+1}function Lt(i,t){if(i===t)return 0;if(i.length>t.length){var r=i;i=t,t=r}for(var e=i.length,n=t.length;e>0&&i.charCodeAt(e-1)===t.charCodeAt(n-1);)e--,n--;for(var a=0;a<e&&i.charCodeAt(a)===t.charCodeAt(a);)a++;if(e-=a,n-=a,e===0||n===1)return n;for(var u=new Array(e<<1),l=0;l<e;)u[e+l]=i.charCodeAt(a+l),u[l]=++l;var S,x,O,D,V;for(S=0;S+3<n;)for(var $=t.charCodeAt(a+(x=S)),rt=t.charCodeAt(a+(O=S+1)),ft=t.charCodeAt(a+(D=S+2)),yt=t.charCodeAt(a+(V=S+3)),Ft=S+=4,Vt=0;Vt<e;){var se=u[e+Vt],Te=u[Vt];x=dt(Te,x,O,$,se),O=dt(x,O,D,rt,se),D=dt(O,D,V,ft,se),Ft=dt(D,V,Ft,yt,se),u[Vt++]=Ft,V=D,D=O,O=x,x=Te}for(var Oe=0;S<n;){var dr=t.charCodeAt(a+(x=S));Oe=++S;for(var Me=0;Me<e;Me++){var Pe=u[Me];u[Me]=Oe=Pe<x||Oe<x?Pe>Oe?Oe+1:Pe+1:dr===u[e+Me]?x:x+1,x=Pe}}return Oe}function kt(i,t,r){i&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(r)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var St=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Xt=typeof window>"u";function P(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function z(i,t,r){r.existsSync(i)||(z(w.dirname(i),t,r),r.mkdirSync(i,t))}function K(i){var t=ut(i),r=t.byteOffset,e=t.byteLength;return r===0&&e===t.buffer.byteLength?t.buffer:t.buffer.slice(r,r+e)}function ut(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function It(i){return i instanceof f?i:i instanceof Uint8Array?vt(i):f.from(i)}function vt(i){return i instanceof f?i:i.byteOffset===0&&i.byteLength===i.buffer.byteLength?xt(i.buffer):f.from(i.buffer,i.byteOffset,i.byteLength)}function xt(i){return f.from(i)}function Rt(i,t,r){if(t===void 0&&(t=0),r===void 0&&(r=i.length),t<0||r<0||r>i.length||t>r)throw new TypeError("Invalid slice bounds on buffer of length "+i.length+": ["+t+", "+r+"]");if(i.length===0)return Ct();var e=ut(i),n=i[0],a=(n+1)%255;return i[0]=a,e[0]===a?(e[0]=n,vt(e.slice(t,r))):(i[0]=n,vt(e.subarray(t,r)))}var jt=null;function Ct(){return jt||(jt=f.alloc(0))}function te(i,t){f.isBuffer(i)?t():t(new p(c.EINVAL,"option must be a Buffer."))}function N(i,t,r){var e=i.Options,n=i.Name,a=0,u=!1,l=!1;function S(V){u||(V&&(u=!0,r(V)),a--,a===0&&l&&r())}var x=function(V){if(e.hasOwnProperty(V)){var $=e[V],rt=t[V];if(rt==null){if(!$.optional){var ft=Object.keys(t).filter(function(Ft){return!(Ft in e)}).map(function(Ft){return{str:Ft,distance:Lt(V,Ft)}}).filter(function(Ft){return Ft.distance<5}).sort(function(Ft,Vt){return Ft.distance-Vt.distance});return u?{}:(u=!0,{v:r(new p(c.EINVAL,"["+n+"] Required option '"+V+"' not provided."+(ft.length>0?" You provided unrecognized option '"+ft[0].str+"'; perhaps you meant to type '"+V+"'.":"")+`
Option description: `+$.description))})}}else{var yt=!1;if(Array.isArray($.type)?yt=$.type.indexOf(typeof rt)!==-1:yt=typeof rt===$.type,yt)$.validator&&(a++,$.validator(rt,S));else return u?{}:(u=!0,{v:r(new p(c.EINVAL,"["+n+"] Value provided for option "+V+" is not the proper type. Expected "+(Array.isArray($.type)?"one of {"+$.type.join(", ")+"}":$.type)+", but received "+typeof rt+`
Option description: `+$.description))})}}};for(var O in e){var D=x(O);if(D)return D.v}l=!0,a===0&&!u&&r()}var R=Object.freeze({deprecationMessage:kt,isIE:St,isWebWorker:Xt,fail:P,mkdirpSync:z,buffer2ArrayBuffer:K,buffer2Uint8array:ut,arrayish2Buffer:It,uint8Array2Buffer:vt,arrayBuffer2Buffer:xt,copyingSlice:Rt,emptyBuffer:Ct,bufferValidator:te,checkOptions:N}),Y=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Y.prototype.open=function(t){var r=this.fs.realPath(t.node),e=this.FS;try{e.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(r,this.fs.flagsToPermissionString(t.flags)))}catch(n){throw n.code?new e.ErrnoError(this.ERRNO_CODES[n.code]):n}},Y.prototype.close=function(t){var r=this.FS;try{r.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(e){throw e.code?new r.ErrnoError(this.ERRNO_CODES[e.code]):e}},Y.prototype.read=function(t,r,e,n,a){try{return this.nodefs.readSync(t.nfd,vt(r),e,n,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.write=function(t,r,e,n,a){try{return this.nodefs.writeSync(t.nfd,vt(r),e,n,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.llseek=function(t,r,e){var n=r;if(e===1)n+=t.position;else if(e===2&&this.FS.isFile(t.node.mode))try{var a=this.nodefs.fstatSync(t.nfd);n+=a.size}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}if(n<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=n,n};var Q=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Q.prototype.getattr=function(t){var r=this.fs.realPath(t),e;try{e=this.nodefs.lstatSync(r)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},Q.prototype.setattr=function(t,r){var e=this.fs.realPath(t);try{if(r.mode!==void 0&&(this.nodefs.chmodSync(e,r.mode),t.mode=r.mode),r.timestamp!==void 0){var n=new Date(r.timestamp);this.nodefs.utimesSync(e,n,n)}}catch(a){if(!a.code)throw a;if(a.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}if(r.size!==void 0)try{this.nodefs.truncateSync(e,r.size)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.lookup=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r),n=this.fs.getMode(e);return this.fs.createNode(t,r,n)},Q.prototype.mknod=function(t,r,e,n){var a=this.fs.createNode(t,r,e,n),u=this.fs.realPath(a);try{this.FS.isDir(a.mode)?this.nodefs.mkdirSync(u,a.mode):this.nodefs.writeFileSync(u,"",{mode:a.mode})}catch(l){throw l.code?new this.FS.ErrnoError(this.ERRNO_CODES[l.code]):l}return a},Q.prototype.rename=function(t,r,e){var n=this.fs.realPath(t),a=this.PATH.join2(this.fs.realPath(r),e);try{this.nodefs.renameSync(n,a),t.name=e,t.parent=r}catch(u){throw u.code?new this.FS.ErrnoError(this.ERRNO_CODES[u.code]):u}},Q.prototype.unlink=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.unlinkSync(e)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.rmdir=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.rmdirSync(e)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.readdir=function(t){var r=this.fs.realPath(t);try{var e=this.nodefs.readdirSync(r);return e.push(".",".."),e}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.symlink=function(t,r,e){var n=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.symlinkSync(e,n)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.readlink=function(t){var r=this.fs.realPath(t);try{return this.nodefs.readlinkSync(r)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}};var lt=function(t,r,e,n){t===void 0&&(t=self.FS),r===void 0&&(r=self.PATH),e===void 0&&(e=self.ERRNO_CODES),n===void 0&&(n=ct),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=n,this.FS=t,this.PATH=r,this.ERRNO_CODES=e,this.node_ops=new Q(this),this.stream_ops=new Y(this)};lt.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},lt.prototype.createNode=function(t,r,e,n){var a=this.FS;if(!a.isDir(e)&&!a.isFile(e)&&!a.isLink(e))throw new a.ErrnoError(this.ERRNO_CODES.EINVAL);var u=a.createNode(t,r,e);return u.node_ops=this.node_ops,u.stream_ops=this.stream_ops,u},lt.prototype.getMode=function(t){var r;try{r=this.nodefs.lstatSync(t)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}return r.mode},lt.prototype.realPath=function(t){for(var r=[];t.parent!==t;)r.push(t.name),t=t.parent;return r.push(t.mount.opts.root),r.reverse(),this.PATH.join.apply(null,r)},lt.prototype.flagsToPermissionString=function(t){var r=typeof t=="string"?parseInt(t,10):t;return r&=8191,r in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[r]:t},lt.prototype.getNodeFS=function(){return this.nodefs},lt.prototype.getFS=function(){return this.FS},lt.prototype.getPATH=function(){return this.PATH},lt.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var it=function(){};it.prototype.supportsLinks=function(){return!1},it.prototype.diskSpace=function(t,r){r(0,0)},it.prototype.openFile=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.createFile=function(t,r,e,n){throw new p(c.ENOTSUP)},it.prototype.open=function(t,r,e,n){var a=this,u=function(l,S){if(l)switch(r.pathNotExistsAction()){case A.CREATE_FILE:return a.stat(w.dirname(t),!1,function(x,O){x?n(x):O&&!O.isDirectory()?n(p.ENOTDIR(w.dirname(t))):a.createFile(t,r,e,n)});case A.THROW_EXCEPTION:return n(p.ENOENT(t));default:return n(new p(c.EINVAL,"Invalid FileFlag object."))}else{if(S&&S.isDirectory())return n(p.EISDIR(t));switch(r.pathExistsAction()){case A.THROW_EXCEPTION:return n(p.EEXIST(t));case A.TRUNCATE_FILE:return a.openFile(t,r,function(x,O){x?n(x):O?O.truncate(0,function(){O.sync(function(){n(null,O)})}):P()});case A.NOP:return a.openFile(t,r,n);default:return n(new p(c.EINVAL,"Invalid FileFlag object."))}}};this.stat(t,!1,u)},it.prototype.rename=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.renameSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.stat=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.statSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.openFileSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.createFileSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.openSync=function(t,r,e){var n;try{n=this.statSync(t,!1)}catch{switch(r.pathNotExistsAction()){case A.CREATE_FILE:var a=this.statSync(w.dirname(t),!1);if(!a.isDirectory())throw p.ENOTDIR(w.dirname(t));return this.createFileSync(t,r,e);case A.THROW_EXCEPTION:throw p.ENOENT(t);default:throw new p(c.EINVAL,"Invalid FileFlag object.")}}if(n.isDirectory())throw p.EISDIR(t);switch(r.pathExistsAction()){case A.THROW_EXCEPTION:throw p.EEXIST(t);case A.TRUNCATE_FILE:return this.unlinkSync(t),this.createFileSync(t,r,n.mode);case A.NOP:return this.openFileSync(t,r,e);default:throw new p(c.EINVAL,"Invalid FileFlag object.")}},it.prototype.unlink=function(t,r){r(new p(c.ENOTSUP))},it.prototype.unlinkSync=function(t){throw new p(c.ENOTSUP)},it.prototype.rmdir=function(t,r){r(new p(c.ENOTSUP))},it.prototype.rmdirSync=function(t){throw new p(c.ENOTSUP)},it.prototype.mkdir=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.mkdirSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.readdir=function(t,r){r(new p(c.ENOTSUP))},it.prototype.readdirSync=function(t){throw new p(c.ENOTSUP)},it.prototype.exists=function(t,r){this.stat(t,null,function(e){r(!e)})},it.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch{return!1}},it.prototype.realpath=function(t,r,e){if(this.supportsLinks())for(var n=t.split(w.sep),a=0;a<n.length;a++){var u=n.slice(0,a+1);n[a]=w.join.apply(null,u)}else this.exists(t,function(l){l?e(null,t):e(p.ENOENT(t))})},it.prototype.realpathSync=function(t,r){if(this.supportsLinks()){for(var e=t.split(w.sep),n=0;n<e.length;n++){var a=e.slice(0,n+1);e[n]=w.join.apply(w,a)}return e.join(w.sep)}else{if(this.existsSync(t))return t;throw p.ENOENT(t)}},it.prototype.truncate=function(t,r,e){this.open(t,b.getFileFlag("r+"),420,function(n,a){if(n)return e(n);a.truncate(r,function(u){a.close(function(l){e(u||l)})})})},it.prototype.truncateSync=function(t,r){var e=this.openSync(t,b.getFileFlag("r+"),420);try{e.truncateSync(r)}catch(n){throw n}finally{e.closeSync()}},it.prototype.readFile=function(t,r,e,n){var a=n;this.open(t,e,420,function(u,l){if(u)return n(u);n=function(S,x){l.close(function(O){return S||(S=O),a(S,x)})},l.stat(function(S,x){if(S)return n(S);var O=f.alloc(x.size);l.read(O,0,x.size,0,function(D){if(D)return n(D);if(r===null)return n(D,O);try{n(null,O.toString(r))}catch(V){n(V)}})})})},it.prototype.readFileSync=function(t,r,e){var n=this.openSync(t,e,420);try{var a=n.statSync(),u=f.alloc(a.size);return n.readSync(u,0,a.size,0),n.closeSync(),r===null?u:u.toString(r)}finally{n.closeSync()}},it.prototype.writeFile=function(t,r,e,n,a,u){var l=u;this.open(t,n,420,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){l(O||D)})};try{typeof r=="string"&&(r=f.from(r,e))}catch(O){return u(O)}x.write(r,0,r.length,0,u)})},it.prototype.writeFileSync=function(t,r,e,n,a){var u=this.openSync(t,n,a);try{typeof r=="string"&&(r=f.from(r,e)),u.writeSync(r,0,r.length,0)}finally{u.closeSync()}},it.prototype.appendFile=function(t,r,e,n,a,u){var l=u;this.open(t,n,a,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){l(O||D)})},typeof r=="string"&&(r=f.from(r,e)),x.write(r,0,r.length,null,u)})},it.prototype.appendFileSync=function(t,r,e,n,a){var u=this.openSync(t,n,a);try{typeof r=="string"&&(r=f.from(r,e)),u.writeSync(r,0,r.length,null)}finally{u.closeSync()}},it.prototype.chmod=function(t,r,e,n){n(new p(c.ENOTSUP))},it.prototype.chmodSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.chown=function(t,r,e,n,a){a(new p(c.ENOTSUP))},it.prototype.chownSync=function(t,r,e,n){throw new p(c.ENOTSUP)},it.prototype.utimes=function(t,r,e,n){n(new p(c.ENOTSUP))},it.prototype.utimesSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.link=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.linkSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.symlink=function(t,r,e,n){n(new p(c.ENOTSUP))},it.prototype.symlinkSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.readlink=function(t,r){r(new p(c.ENOTSUP))},it.prototype.readlinkSync=function(t){throw new p(c.ENOTSUP)};var _t=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,n,a){try{this.renameSync(e,n),a()}catch(u){a(u)}},t.prototype.stat=function(e,n,a){try{a(null,this.statSync(e,n))}catch(u){a(u)}},t.prototype.open=function(e,n,a,u){try{u(null,this.openSync(e,n,a))}catch(l){u(l)}},t.prototype.unlink=function(e,n){try{this.unlinkSync(e),n()}catch(a){n(a)}},t.prototype.rmdir=function(e,n){try{this.rmdirSync(e),n()}catch(a){n(a)}},t.prototype.mkdir=function(e,n,a){try{this.mkdirSync(e,n),a()}catch(u){a(u)}},t.prototype.readdir=function(e,n){try{n(null,this.readdirSync(e))}catch(a){n(a)}},t.prototype.chmod=function(e,n,a,u){try{this.chmodSync(e,n,a),u()}catch(l){u(l)}},t.prototype.chown=function(e,n,a,u,l){try{this.chownSync(e,n,a,u),l()}catch(S){l(S)}},t.prototype.utimes=function(e,n,a,u){try{this.utimesSync(e,n,a),u()}catch(l){u(l)}},t.prototype.link=function(e,n,a){try{this.linkSync(e,n),a()}catch(u){a(u)}},t.prototype.symlink=function(e,n,a,u){try{this.symlinkSync(e,n,a),u()}catch(l){u(l)}},t.prototype.readlink=function(e,n){try{n(null,this.readlinkSync(e))}catch(a){n(a)}},t}(it),gt=function(){};gt.prototype.sync=function(t){t(new p(c.ENOTSUP))},gt.prototype.syncSync=function(){throw new p(c.ENOTSUP)},gt.prototype.datasync=function(t){this.sync(t)},gt.prototype.datasyncSync=function(){return this.syncSync()},gt.prototype.chown=function(t,r,e){e(new p(c.ENOTSUP))},gt.prototype.chownSync=function(t,r){throw new p(c.ENOTSUP)},gt.prototype.chmod=function(t,r){r(new p(c.ENOTSUP))},gt.prototype.chmodSync=function(t){throw new p(c.ENOTSUP)},gt.prototype.utimes=function(t,r,e){e(new p(c.ENOTSUP))},gt.prototype.utimesSync=function(t,r){throw new p(c.ENOTSUP)};var Yt=function(i){function t(r,e,n,a,u){if(i.call(this),this._pos=0,this._dirty=!1,this._fs=r,this._path=e,this._flag=n,this._stat=a,u?this._buffer=u:this._buffer=Ct(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStats=function(){return this._stat},t.prototype.getFlag=function(){return this._flag},t.prototype.getPath=function(){return this._path},t.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},t.prototype.advancePos=function(e){return this._pos+=e},t.prototype.setPos=function(e){return this._pos=e},t.prototype.sync=function(e){try{this.syncSync(),e()}catch(n){e(n)}},t.prototype.syncSync=function(){throw new p(c.ENOTSUP)},t.prototype.close=function(e){try{this.closeSync(),e()}catch(n){e(n)}},t.prototype.closeSync=function(){throw new p(c.ENOTSUP)},t.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(n){e(n)}},t.prototype.statSync=function(){return this._stat.clone()},t.prototype.truncate=function(e,n){try{this.truncateSync(e),this._flag.isSynchronous()&&!ct.getRootFS().supportsSynch()&&this.sync(n),n()}catch(a){return n(a)}},t.prototype.truncateSync=function(e){if(this._dirty=!0,!this._flag.isWriteable())throw new p(c.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,e>this._buffer.length){var n=f.alloc(e-this._buffer.length,0);this.writeSync(n,0,n.length,this._buffer.length),this._flag.isSynchronous()&&ct.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;var a=f.alloc(e);this._buffer.copy(a,0,0,e),this._buffer=a,this._flag.isSynchronous()&&ct.getRootFS().supportsSynch()&&this.syncSync()},t.prototype.write=function(e,n,a,u,l){try{l(null,this.writeSync(e,n,a,u),e)}catch(S){l(S)}},t.prototype.writeSync=function(e,n,a,u){if(this._dirty=!0,u==null&&(u=this.getPos()),!this._flag.isWriteable())throw new p(c.EPERM,"File not opened with a writeable mode.");var l=u+a;if(l>this._stat.size&&(this._stat.size=l,l>this._buffer.length)){var S=f.alloc(l);this._buffer.copy(S),this._buffer=S}var x=e.copy(this._buffer,u,n,n+a);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),x):(this.setPos(u+x),x)},t.prototype.read=function(e,n,a,u,l){try{l(null,this.readSync(e,n,a,u),e)}catch(S){l(S)}},t.prototype.readSync=function(e,n,a,u){if(!this._flag.isReadable())throw new p(c.EPERM,"File not opened with a readable mode.");u==null&&(u=this.getPos());var l=u+a;l>this._stat.size&&(a=this._stat.size-u);var S=this._buffer.copy(e,n,u,u+a);return this._stat.atime=new Date,this._pos=u+a,S},t.prototype.chmod=function(e,n){try{this.chmodSync(e),n()}catch(a){n(a)}},t.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new p(c.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},t.prototype.isDirty=function(){return this._dirty},t.prototype.resetDirty=function(){this._dirty=!1},t}(gt),ue=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t}(Yt),Fe=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),I=function(i){function t(r,e,n){if(n===void 0&&(n=!0),i.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=r,this._async=e,!r.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");kt(n,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{var a=new t(e.sync,e.async,!1);a.initialize(function(u){u?n(u):n(null,a)},!1)}catch(u){n(u)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,b.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,n){var a=this;n===void 0&&(n=!0),n&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var u=this._initializeCallbacks,l=function(D){a._isInitialized=!D,a._initializeCallbacks=[],u.forEach(function(V){return V(D)})};if(this._isInitialized)e();else if(u.push(e)===1){var S=function(D,V,$){D!=="/"&&a._sync.mkdirSync(D,V),a._async.readdir(D,function(rt,ft){var yt=0;function Ft(Vt){Vt?$(Vt):yt<ft.length?(O(w.join(D,ft[yt]),Ft),yt++):$()}rt?$(rt):Ft()})},x=function(D,V,$){a._async.readFile(D,null,b.getFileFlag("r"),function(rt,ft){if(rt)$(rt);else try{a._sync.writeFileSync(D,ft,null,b.getFileFlag("w"),V)}catch(yt){rt=yt}finally{$(rt)}})},O=function(D,V){a._async.stat(D,!1,function($,rt){$?V($):rt.isDirectory()?S(D,rt.mode,V):x(D,rt.mode,V)})};S("/",0,l)}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,n){this.checkInitialized(),this._sync.renameSync(e,n),this.enqueueOp({apiMethod:"rename",arguments:[e,n]})},t.prototype.statSync=function(e,n){return this.checkInitialized(),this._sync.statSync(e,n)},t.prototype.openSync=function(e,n,a){this.checkInitialized();var u=this._sync.openSync(e,n,a);return u.closeSync(),new Fe(this,e,n,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,b.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,n){this.checkInitialized(),this._sync.mkdirSync(e,n),this.enqueueOp({apiMethod:"mkdir",arguments:[e,n]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,n,a){this.checkInitialized(),this._sync.chmodSync(e,n,a),this.enqueueOp({apiMethod:"chmod",arguments:[e,n,a]})},t.prototype.chownSync=function(e,n,a,u){this.checkInitialized(),this._sync.chownSync(e,n,a,u),this.enqueueOp({apiMethod:"chown",arguments:[e,n,a,u]})},t.prototype.utimesSync=function(e,n,a){this.checkInitialized(),this._sync.utimesSync(e,n,a),this.enqueueOp({apiMethod:"utimes",arguments:[e,n,a]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new p(c.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var n=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var a=function(u){if(u&&console.error("WARNING: File system has desynchronized. Received following error: "+u+`
$`),n._queue.length>0){var l=n._queue.shift(),S=l.arguments;S.push(a),n._async[l.apiMethod].apply(n._async,S)}else n._queueRunning=!1};a()}},t}(_t);I.Name="AsyncMirror",I.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function g(i,t,r){switch(r.length){case 0:return i.call(t);case 1:return i.call(t,r[0]);case 2:return i.call(t,r[0],r[1]);case 3:return i.call(t,r[0],r[1],r[2])}return i.apply(t,r)}var v=Math.max;function k(i,t,r){return t=v(t===void 0?i.length-1:t,0),function(){for(var e=arguments,n=-1,a=v(e.length-t,0),u=Array(a);++n<a;)u[n]=e[t+n];n=-1;for(var l=Array(t+1);++n<t;)l[n]=e[n];return l[t]=r(u),g(i,this,l)}}function B(i){return i}function Z(i,t){return k(i,t,B)}var J=function(i){return Z(function(t){var r=t.pop();i.call(this,t,r)})};function bt(i){return Z(function(t,r){var e=J(function(n,a){var u=this;return i(t,function(l,S){l.apply(u,n.concat(S))},a)});return r.length?e.apply(this,r):e})}var At=typeof y=="object"&&y&&y.Object===Object&&y,Bt=typeof self=="object"&&self&&self.Object===Object&&self,Gt=At||Bt||Function("return this")(),Dt=Gt.Symbol,Ie=Object.prototype,nr=Ie.hasOwnProperty,Ve=Ie.toString,Ze=Dt?Dt.toStringTag:void 0;function si(i){var t=nr.call(i,Ze),r=i[Ze];try{i[Ze]=void 0;var e=!0}catch{}var n=Ve.call(i);return e&&(t?i[Ze]=r:delete i[Ze]),n}var ai=Object.prototype,ui=ai.toString;function j(i){return ui.call(i)}var ot="[object Null]",F="[object Undefined]",at=Dt?Dt.toStringTag:void 0;function Ut(i){return i==null?i===void 0?F:ot:at&&at in Object(i)?si(i):j(i)}function nt(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var fe="[object AsyncFunction]",st="[object Function]",Jt="[object GeneratorFunction]",X="[object Proxy]";function q(i){if(!nt(i))return!1;var t=Ut(i);return t==st||t==Jt||t==fe||t==X}var or=9007199254740991;function Mt(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=or}function ht(i){return i!=null&&Mt(i.length)&&!q(i)}var qe={};function De(){}function Wt(i){return function(){if(i!==null){var t=i;i=null,t.apply(this,arguments)}}}var Tt=typeof Symbol=="function"&&Symbol.iterator,re=function(i){return Tt&&i[Tt]&&i[Tt]()};function ae(i,t){for(var r=-1,e=Array(i);++r<i;)e[r]=t(r);return e}function ie(i){return i!=null&&typeof i=="object"}var sr="[object Arguments]";function Xe(i){return ie(i)&&Ut(i)==sr}var Zt=Object.prototype,ce=Zt.hasOwnProperty,ee=Zt.propertyIsEnumerable,be=Xe(function(){return arguments}())?Xe:function(i){return ie(i)&&ce.call(i,"callee")&&!ee.call(i,"callee")},Se=Array.isArray;function Pr(){return!1}var ji=typeof o=="object"&&o&&!o.nodeType&&o,Wi=ji&&typeof d=="object"&&d&&!d.nodeType&&d,Go=Wi&&Wi.exports===ji,Hi=Go?Gt.Buffer:void 0,Jo=Hi?Hi.isBuffer:void 0,Ko=Jo||Pr,Qo=9007199254740991,$o=/^(?:0|[1-9]\d*)$/;function ts(i,t){return t=t??Qo,!!t&&(typeof i=="number"||$o.test(i))&&i>-1&&i%1==0&&i<t}var es="[object Arguments]",rs="[object Array]",is="[object Boolean]",ns="[object Date]",os="[object Error]",ss="[object Function]",as="[object Map]",us="[object Number]",cs="[object Object]",hs="[object RegExp]",ls="[object Set]",ps="[object String]",ds="[object WeakMap]",ys="[object ArrayBuffer]",gs="[object DataView]",vs="[object Float32Array]",ms="[object Float64Array]",ws="[object Int8Array]",Ss="[object Int16Array]",Es="[object Int32Array]",_s="[object Uint8Array]",xs="[object Uint8ClampedArray]",Fs="[object Uint16Array]",Is="[object Uint32Array]",Pt={};Pt[vs]=Pt[ms]=Pt[ws]=Pt[Ss]=Pt[Es]=Pt[_s]=Pt[xs]=Pt[Fs]=Pt[Is]=!0,Pt[es]=Pt[rs]=Pt[ys]=Pt[is]=Pt[gs]=Pt[ns]=Pt[os]=Pt[ss]=Pt[as]=Pt[us]=Pt[cs]=Pt[hs]=Pt[ls]=Pt[ps]=Pt[ds]=!1;function bs(i){return ie(i)&&Mt(i.length)&&!!Pt[Ut(i)]}function ks(i){return function(t){return i(t)}}var Vi=typeof o=="object"&&o&&!o.nodeType&&o,Zi=Vi&&typeof d=="object"&&d&&!d.nodeType&&d,Ns=Zi&&Zi.exports===Vi,fi=Ns&&At.process,qi=function(){try{return fi&&fi.binding&&fi.binding("util")}catch{}}(),Xi=qi&&qi.isTypedArray,Rs=Xi?ks(Xi):bs,Ts=Object.prototype,Os=Ts.hasOwnProperty;function As(i,t){var r=Se(i),e=!r&&be(i),n=!r&&!e&&Ko(i),a=!r&&!e&&!n&&Rs(i),u=r||e||n||a,l=u?ae(i.length,String):[],S=l.length;for(var x in i)(t||Os.call(i,x))&&!(u&&(x=="length"||n&&(x=="offset"||x=="parent")||a&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||ts(x,S)))&&l.push(x);return l}var Ls=Object.prototype;function Ds(i){var t=i&&i.constructor,r=typeof t=="function"&&t.prototype||Ls;return i===r}function Cs(i,t){return function(r){return i(t(r))}}var Bs=Cs(Object.keys,Object),Us=Object.prototype,Ms=Us.hasOwnProperty;function Ps(i){if(!Ds(i))return Bs(i);var t=[];for(var r in Object(i))Ms.call(i,r)&&r!="constructor"&&t.push(r);return t}function Yi(i){return ht(i)?As(i):Ps(i)}function zs(i){var t=-1,r=i.length;return function(){return++t<r?{value:i[t],key:t}:null}}function js(i){var t=-1;return function(){var e=i.next();return e.done?null:(t++,{value:e.value,key:t})}}function Ws(i){var t=Yi(i),r=-1,e=t.length;return function(){var a=t[++r];return r<e?{value:i[a],key:a}:null}}function Hs(i){if(ht(i))return zs(i);var t=re(i);return t?js(t):Ws(i)}function Gi(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function Ji(i){return function(t,r,e){if(e=Wt(e||De),i<=0||!t)return e(null);var n=Hs(t),a=!1,u=0;function l(x,O){if(u-=1,x)a=!0,e(x);else{if(O===qe||a&&u<=0)return a=!0,e(null);S()}}function S(){for(;u<i&&!a;){var x=n();if(x===null){a=!0,u<=0&&e(null);return}u+=1,r(x.value,x.key,Gi(l))}}S()}}function Ki(i,t,r,e){Ji(t)(i,r,e)}function ci(i,t){return function(r,e,n){return i(r,t,e,n)}}function Vs(i,t,r){r=Wt(r||De);var e=0,n=0,a=i.length;a===0&&r(null);function u(l,S){l?r(l):(++n===a||S===qe)&&r(null)}for(;e<a;e++)t(i[e],e,Gi(u))}var Zs=ci(Ki,1/0),Qi=function(i,t,r){var e=ht(i)?Vs:Zs;e(i,t,r)};function qs(i){return function(t,r,e){return i(Qi,t,r,e)}}function $i(i,t,r,e){e=e||De,t=t||[];var n=[],a=0;i(t,function(u,l,S){var x=a++;r(u,function(O,D){n[x]=D,S(O)})},function(u){e(u,n)})}var Xs=qs($i);bt(Xs);function Ys(i){return function(t,r,e,n){return i(Ji(r),t,e,n)}}var Gs=Ys($i),Js=ci(Gs,1);bt(Js),Z(function(i,t){return Z(function(r){return i.apply(null,t.concat(r))})});function Ks(i,t){for(var r=-1,e=i==null?0:i.length;++r<e&&t(i[r],r,i)!==!1;);return i}function Qs(i){return function(t,r,e){for(var n=-1,a=Object(t),u=e(t),l=u.length;l--;){var S=u[i?l:++n];if(r(a[S],S,a)===!1)break}return t}}var $s=Qs();function Qu(i,t){return i&&$s(i,t,Yi)}function ta(i,t,r,e){for(var n=i.length,a=r+(e?1:-1);e?a--:++a<n;)if(t(i[a],a,i))return a;return-1}function ea(i){return i!==i}function ra(i,t,r){for(var e=r-1,n=i.length;++e<n;)if(i[e]===t)return e;return-1}function $u(i,t,r){return t===t?ra(i,t,r):ta(i,ea,r)}var tn="\\ud800-\\udfff",ia="\\u0300-\\u036f",na="\\ufe20-\\ufe2f",oa="\\u20d0-\\u20ff",sa=ia+na+oa,aa="\\ufe0e\\ufe0f",ua="["+tn+"]",hi="["+sa+"]",fa="\\ud83c[\\udffb-\\udfff]",ca="(?:"+hi+"|"+fa+")",en="[^"+tn+"]",rn="(?:\\ud83c[\\udde6-\\uddff]){2}",nn="[\\ud800-\\udbff][\\udc00-\\udfff]",ha="\\u200d",on=ca+"?",sn="["+aa+"]?",la="(?:"+ha+"(?:"+[en,rn,nn].join("|")+")"+sn+on+")*",tf=sn+on+la,ef="(?:"+[en+hi+"?",hi,rn,nn,ua].join("|")+")",an=typeof setImmediate=="function"&&setImmediate,un=typeof m=="object"&&typeof m.nextTick=="function";function fn(i){setTimeout(i,0)}function cn(i){return Z(function(t,r){i(function(){t.apply(null,r)})})}var zr;an?zr=setImmediate:un?zr=m.nextTick:zr=fn,cn(zr);var pa=ci(Ki,1);function da(i,t,r,e){e=Wt(e||De),pa(i,function(n,a,u){r(t,n,function(l,S){t=S,u(l)})},function(n){e(n,t)})}var ya=Z(function(t){return Z(function(r){var e=this,n=r[r.length-1];typeof n=="function"?r.pop():n=De,da(t,r,function(a,u,l){u.apply(e,a.concat(Z(function(S,x){l(S,x)})))},function(a,u){n.apply(e,[a].concat(u))})})});Z(function(i){return ya.apply(null,i.reverse())}),Z(function(i){var t=[null].concat(i);return J(function(r,e){return e.apply(this,t)})});function hn(i){return Z(function(t,r){t.apply(null,r.concat(Z(function(e,n){typeof console=="object"&&(e?console.error&&console.error(e):console[i]&&Ks(n,function(a){console[i](a)}))})))})}hn("dir");function ga(i){return function(t,r,e){return i(t,e)}}function ln(i,t,r){Qi(i,ga(t),r)}hn("log");var jr;un?jr=m.nextTick:an?jr=setImmediate:jr=fn,cn(jr);var rf=Math.ceil,nf=Math.max,he;function va(){he||(he={},he[Dropbox.ApiError.NETWORK_ERROR]=c.EIO,he[Dropbox.ApiError.INVALID_PARAM]=c.EINVAL,he[Dropbox.ApiError.INVALID_TOKEN]=c.EPERM,he[Dropbox.ApiError.OAUTH_ERROR]=c.EPERM,he[Dropbox.ApiError.NOT_FOUND]=c.ENOENT,he[Dropbox.ApiError.INVALID_METHOD]=c.EINVAL,he[Dropbox.ApiError.NOT_ACCEPTABLE]=c.EINVAL,he[Dropbox.ApiError.CONFLICT]=c.EINVAL,he[Dropbox.ApiError.RATE_LIMITED]=c.EBUSY,he[Dropbox.ApiError.SERVER_ERROR]=c.EBUSY,he[Dropbox.ApiError.OVER_QUOTA]=c.ENOSPC)}function ma(i){return i&&i.stat.isFile}function wa(i){return i&&i.stat.isFolder}function Sa(i){return i==null||typeof i=="object"&&typeof i.byteLength=="number"}var oe=function(t){this._cache={},this._client=t};oe.prototype.readdir=function(t,r){var e=this,n=this.getCachedDirInfo(t);this._wrap(function(a){n!==null&&n.contents?e._client.readdir(t,{contentHash:n.stat.contentHash},a):e._client.readdir(t,a)},function(a,u,l,S){a?a.status===Dropbox.ApiError.NO_CONTENT&&n!==null?r(null,n.contents.slice(0)):r(a):(e.updateCachedDirInfo(t,l,u.slice(0)),S.forEach(function(x){e.updateCachedInfo(w.join(t,x.name),x)}),r(null,u))})},oe.prototype.remove=function(t,r){var e=this;this._wrap(function(n){e._client.remove(t,n)},function(n,a){n||e.updateCachedInfo(t,a),r(n)})},oe.prototype.move=function(t,r,e){var n=this;this._wrap(function(a){n._client.move(t,r,a)},function(a,u){a||(n.deleteCachedInfo(t),n.updateCachedInfo(r,u)),e(a)})},oe.prototype.stat=function(t,r){var e=this;this._wrap(function(n){e._client.stat(t,n)},function(n,a){n||e.updateCachedInfo(t,a),r(n,a)})},oe.prototype.readFile=function(t,r){var e=this,n=this.getCachedFileInfo(t);n!==null&&n.contents!==null?this.stat(t,function(a,u){a?r(a):u.contentHash===n.stat.contentHash?r(a,n.contents.slice(0),n.stat):e.readFile(t,r)}):this._wrap(function(a){e._client.readFile(t,{arrayBuffer:!0},a)},function(a,u,l){a||e.updateCachedInfo(t,l,u.slice(0)),r(a,u,l)})},oe.prototype.writeFile=function(t,r,e){var n=this;this._wrap(function(a){n._client.writeFile(t,r,a)},function(a,u){a||n.updateCachedInfo(t,u,r.slice(0)),e(a,u)})},oe.prototype.mkdir=function(t,r){var e=this;this._wrap(function(n){e._client.mkdir(t,n)},function(n,a){n||e.updateCachedInfo(t,a,[]),r(n)})},oe.prototype._wrap=function(t,r){var e=0,n=function(a){var u=2;if(a&&3>++e)switch(a.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){t(n)},u*1e3);break;default:r.apply(null,arguments);break}else r.apply(null,arguments)};t(n)},oe.prototype.getCachedInfo=function(t){return this._cache[t.toLowerCase()]},oe.prototype.putCachedInfo=function(t,r){this._cache[t.toLowerCase()]=r},oe.prototype.deleteCachedInfo=function(t){delete this._cache[t.toLowerCase()]},oe.prototype.getCachedDirInfo=function(t){var r=this.getCachedInfo(t);return wa(r)?r:null},oe.prototype.getCachedFileInfo=function(t){var r=this.getCachedInfo(t);return ma(r)?r:null},oe.prototype.updateCachedDirInfo=function(t,r,e){e===void 0&&(e=null);var n=this.getCachedInfo(t);r.contentHash!==null&&(n===void 0||n.stat.contentHash!==r.contentHash)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedFileInfo=function(t,r,e){e===void 0&&(e=null);var n=this.getCachedInfo(t);r.versionTag!==null&&(n===void 0||n.stat.versionTag!==r.versionTag)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedInfo=function(t,r,e){e===void 0&&(e=null),r.isFile&&Sa(e)?this.updateCachedFileInfo(t,r,e):r.isFolder&&Array.isArray(e)&&this.updateCachedDirInfo(t,r,e)};var Ea=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(this.isDirty()){var a=this.getBuffer(),u=K(a);this._fs._writeFileStrict(this.getPath(),u,function(l){l||n.resetDirty(),e(l)})}else e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),Wr=function(i){function t(r,e){e===void 0&&(e=!0),i.call(this),this._client=new oe(r),kt(e,t.Name,{client:"authenticated dropbox client instance"}),va()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.client,!1))},t.isAvailable=function(){return typeof Dropbox<"u"},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var n=this;this._client.readdir("/",function(a,u){if(a)e(n.convert(a,"/"));else{var l=function(x,O){var D=w.join("/",x);n._client.remove(D,function(V){O(V?n.convert(V,D):null)})},S=function(x){x?e(x):e()};ln(u,l,S)}})},t.prototype.rename=function(e,n,a){var u=this;this._client.move(e,n,function(l){l?u._client.stat(n,function(S,x){if(S||x.isFolder){var O=l.response.error.indexOf(e)>-1?e:n;a(u.convert(l,O))}else u._client.remove(n,function(D){D?a(u.convert(D,n)):u.rename(e,n,a)})}):a()})},t.prototype.stat=function(e,n,a){var u=this;this._client.stat(e,function(l,S){if(l)a(u.convert(l,e));else if(S&&S.isRemoved)a(p.FileError(c.ENOENT,e));else{var x=new C(u._statType(S),S.size);return a(null,x)}})},t.prototype.open=function(e,n,a,u){var l=this;this._client.readFile(e,function(S,x,O){if(S)if(n.isReadable())u(l.convert(S,e));else switch(S.status){case Dropbox.ApiError.NOT_FOUND:var D=new ArrayBuffer(0);return l._writeFileStrict(e,D,function(rt,ft){if(rt)u(rt);else{var yt=l._makeFile(e,n,ft,xt(D));u(null,yt)}});default:return u(l.convert(S,e))}else{var V;x===null?V=Ct():V=xt(x);var $=l._makeFile(e,n,O,V);return u(null,$)}})},t.prototype._writeFileStrict=function(e,n,a){var u=this,l=w.dirname(e);this.stat(l,!1,function(S,x){S?a(p.FileError(c.ENOENT,l)):u._client.writeFile(e,n,function(O,D){O?a(u.convert(O,e)):a(null,D)})})},t.prototype._statType=function(e){return e.isFile?L.FILE:L.DIRECTORY},t.prototype._makeFile=function(e,n,a,u){var l=this._statType(a),S=new C(l,a.size);return new Ea(this,e,n,S,u)},t.prototype._remove=function(e,n,a){var u=this;this._client.stat(e,function(l,S){l?n(u.convert(l,e)):S.isFile&&!a?n(p.FileError(c.ENOTDIR,e)):!S.isFile&&a?n(p.FileError(c.EISDIR,e)):u._client.remove(e,function(x){n(x?u.convert(x,e):null)})})},t.prototype.unlink=function(e,n){this._remove(e,n,!0)},t.prototype.rmdir=function(e,n){this._remove(e,n,!1)},t.prototype.mkdir=function(e,n,a){var u=this,l=w.dirname(e);this._client.stat(l,function(S,x){S?a(u.convert(S,l)):u._client.mkdir(e,function(O){a(O?p.FileError(c.EEXIST,e):null)})})},t.prototype.readdir=function(e,n){var a=this;this._client.readdir(e,function(u,l){return u?n(a.convert(u)):n(null,l)})},t.prototype.convert=function(e,n){n===void 0&&(n=null);var a=he[e.status];return a===void 0&&(a=c.EIO),n?p.FileError(a,n):new p(a)},t}(it);Wr.Name="Dropbox",Wr.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(i,t){i.isAuthenticated&&i.isAuthenticated()?t():t(new p(c.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function qt(i,t){t===void 0&&(t="");for(var r=i.errno,e=i.node,n=[];e&&(n.unshift(e.name),e!==e.parent);)e=e.parent;return new p(r,_[r],n.length>0?"/"+n.join("/"):t)}var _a=function(i){function t(r,e,n,a){i.call(this),this._fs=r,this._FS=e,this._path=n,this._stream=a}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var n=null;try{this.closeSync()}catch(a){n=a}finally{e(n)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw qt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(n){e(n)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw qt(e,this._path)}},t.prototype.truncate=function(e,n){var a=null;try{this.truncateSync(e)}catch(u){a=u}finally{n(a)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(n){throw qt(n,this._path)}},t.prototype.write=function(e,n,a,u,l){try{l(null,this.writeSync(e,n,a,u),e)}catch(S){l(S)}},t.prototype.writeSync=function(e,n,a,u){try{var l=ut(e),S=u===null?void 0:u;return this._FS.write(this._stream,l,n,a,S)}catch(x){throw qt(x,this._path)}},t.prototype.read=function(e,n,a,u,l){try{l(null,this.readSync(e,n,a,u),e)}catch(S){l(S)}},t.prototype.readSync=function(e,n,a,u){try{var l=ut(e),S=u===null?void 0:u;return this._FS.read(this._stream,l,n,a,S)}catch(x){throw qt(x,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,n,a){var u=null;try{this.chownSync(e,n)}catch(l){u=l}finally{a(u)}},t.prototype.chownSync=function(e,n){try{this._FS.fchown(this._stream.fd,e,n)}catch(a){throw qt(a,this._path)}},t.prototype.chmod=function(e,n){var a=null;try{this.chmodSync(e)}catch(u){a=u}finally{n(a)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(n){throw qt(n,this._path)}},t.prototype.utimes=function(e,n,a){var u=null;try{this.utimesSync(e,n)}catch(l){u=l}finally{a(u)}},t.prototype.utimesSync=function(e,n){this._fs.utimesSync(this._path,e,n)},t}(gt),Hr=function(i){function t(r){i.call(this),this._FS=r}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.FS))},t.isAvailable=function(){return!0},t.prototype.getName=function(){return this._FS.DB_NAME()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!0},t.prototype.supportsProps=function(){return!0},t.prototype.supportsSynch=function(){return!0},t.prototype.renameSync=function(e,n){try{this._FS.rename(e,n)}catch(a){throw a.errno===c.ENOENT?qt(a,this.existsSync(e)?n:e):qt(a)}},t.prototype.statSync=function(e,n){try{var a=n?this._FS.lstat(e):this._FS.stat(e),u=this.modeToFileType(a.mode);return new C(u,a.size,a.mode,a.atime,a.mtime,a.ctime)}catch(l){throw qt(l,e)}},t.prototype.openSync=function(e,n,a){try{var u=this._FS.open(e,n.getFlagString(),a);if(this._FS.isDir(u.node.mode))throw this._FS.close(u),p.EISDIR(e);return new _a(this,this._FS,e,u)}catch(l){throw qt(l,e)}},t.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(n){throw qt(n,e)}},t.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(n){throw qt(n,e)}},t.prototype.mkdirSync=function(e,n){try{this._FS.mkdir(e,n)}catch(a){throw qt(a,e)}},t.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter(function(n){return n!=="."&&n!==".."})}catch(n){throw qt(n,e)}},t.prototype.truncateSync=function(e,n){try{this._FS.truncate(e,n)}catch(a){throw qt(a,e)}},t.prototype.readFileSync=function(e,n,a){try{var u=this._FS.readFile(e,{flags:a.getFlagString()}),l=vt(u);return n?l.toString(n):l}catch(S){throw qt(S,e)}},t.prototype.writeFileSync=function(e,n,a,u,l){try{a&&(n=f.from(n,a));var S=ut(n);this._FS.writeFile(e,S,{flags:u.getFlagString(),encoding:"binary"}),this._FS.chmod(e,l)}catch(x){throw qt(x,e)}},t.prototype.chmodSync=function(e,n,a){try{n?this._FS.lchmod(e,a):this._FS.chmod(e,a)}catch(u){throw qt(u,e)}},t.prototype.chownSync=function(e,n,a,u){try{n?this._FS.lchown(e,a,u):this._FS.chown(e,a,u)}catch(l){throw qt(l,e)}},t.prototype.symlinkSync=function(e,n,a){try{this._FS.symlink(e,n)}catch(u){throw qt(u)}},t.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(n){throw qt(n,e)}},t.prototype.utimesSync=function(e,n,a){try{this._FS.utime(e,n.getTime(),a.getTime())}catch(u){throw qt(u,e)}},t.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return L.DIRECTORY;if(this._FS.isFile(e))return L.FILE;if(this._FS.isLink(e))return L.SYMLINK;throw p.EPERM("Invalid mode: "+e)},t}(_t);Hr.Name="EmscriptenFileSystem",Hr.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var ar=function(i){function t(r,e){i.call(this),this._folder=r,this._wrapped=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var n=this;this._wrapped.exists(this._folder,function(a){a?e():n._wrapped.isReadOnly()?e(p.ENOENT(n._folder)):n._wrapped.mkdir(n._folder,511,e)})},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t}(it);ar.Name="FolderAdapter",ar.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function pn(i,t){if(t!==null&&typeof t=="object"){var r=t,e=r.path;e&&(e="/"+w.relative(i,e),r.message=r.message.replace(r.path,e),r.path=e)}return t}function xa(i,t){return typeof t=="function"?function(r){arguments.length>0&&(arguments[0]=pn(i,r)),t.apply(null,arguments)}:t}function dn(i,t,r){return i.slice(i.length-4)!=="Sync"?function(){return arguments.length>0&&(t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),arguments[arguments.length-1]=xa(this._folder,arguments[arguments.length-1])),this._wrapped[i].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),this._wrapped[i].apply(this._wrapped,arguments)}catch(e){throw pn(this._folder,e)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(i){ar.prototype[i]=dn(i,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(i){ar.prototype[i]=dn(i,!0,!0)});var Vr;typeof window<"u"?Vr=window:typeof self<"u"?Vr=self:Vr=y;var Kt=Vr;function Fa(i){return i.isDirectory}var li=Kt.webkitRequestFileSystem||Kt.requestFileSystem||null;function Ia(i,t,r,e){if(typeof navigator.webkitPersistentStorage<"u")switch(i){case Kt.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,r,e);break;case Kt.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,r,e);break;default:e(new TypeError("Invalid storage type: "+i));break}else Kt.webkitStorageInfo.requestQuota(i,t,r,e)}function ba(i){return Array.prototype.slice.call(i||[],0)}function ke(i,t,r){switch(i.name){case"PathExistsError":return p.EEXIST(t);case"QuotaExceededError":return p.FileError(c.ENOSPC,t);case"NotFoundError":return p.ENOENT(t);case"SecurityError":return p.FileError(c.EACCES,t);case"InvalidModificationError":return p.FileError(c.EPERM,t);case"TypeMismatchError":return p.FileError(r?c.ENOTDIR:c.EISDIR,t);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return p.FileError(c.EINVAL,t)}}var ka=function(i){function t(r,e,n,a,u,l){i.call(this,r,n,a,u,l),this._entry=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(!this.isDirty())return e();this._entry.createWriter(function(a){var u=n.getBuffer(),l=new Blob([K(u)]),S=l.size;a.onwriteend=function(x){a.onwriteend=null,a.onerror=null,a.truncate(S),n.resetDirty(),e()},a.onerror=function(x){e(ke(x,n.getPath(),!1))},a.write(l)})},t.prototype.close=function(e){this.sync(e)},t}(Yt),Zr=function(i){function t(r,e,n){r===void 0&&(r=5),e===void 0&&(e=Kt.PERSISTENT),n===void 0&&(n=!0),i.call(this),this.size=1024*1024*r,this.type=e,kt(n,t.Name,{size:r,type:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t(e.size,e.type,!1);a.allocate(function(u){return u?n(u):n(null,a)},!1)},t.isAvailable=function(){return!!li},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,n){var a=this;e===void 0&&(e=function(){}),n===void 0&&(n=!0),n&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var u=function(S){a.fs=S,e()},l=function(S){e(ke(S,"/",!0))};this.type===Kt.PERSISTENT?Ia(this.type,this.size,function(S){li(a.type,S,u,l)},l):li(this.type,this.size,u,l)},t.prototype.empty=function(e){this._readdir("/",function(n,a){if(n)console.error("Failed to empty FS"),e(n);else{var u=function(S){n?(console.error("Failed to empty FS"),e(n)):e()},l=function(S,x){var O=function(){x()},D=function(V){x(ke(V,S.fullPath,!S.isDirectory))};Fa(S)?S.removeRecursively(O,D):S.remove(O,D)};ln(a,l,u)}})},t.prototype.rename=function(e,n,a){var u=this,l=2,S=0,x=this.fs.root,O=e,D=function($){--l<=0&&a(ke($,O,!1))},V=function($){if(++S===2)return a(new p(c.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(e===n)return a();O=w.dirname(n),x.getDirectory(O,{},function(rt){O=w.basename(n),$.moveTo(rt,O,function(ft){a()},function(ft){$.isDirectory?(O=n,u.unlink(n,function(yt){yt?D(ft):u.rename(e,n,a)})):D(ft)})},D)};x.getFile(e,{},V,D),x.getDirectory(e,{},V,D)},t.prototype.stat=function(e,n,a){var u=this,l={create:!1},S=function(V){var $=function(rt){var ft=new C(L.FILE,rt.size);a(null,ft)};V.file($,O)},x=function(V){var $=4096,rt=new C(L.DIRECTORY,$);a(null,rt)},O=function(V){a(ke(V,e,!1))},D=function(){u.fs.root.getDirectory(e,l,x,O)};this.fs.root.getFile(e,l,S,D)},t.prototype.open=function(e,n,a,u){var l=this,S=function(x){x.name==="InvalidModificationError"&&n.isExclusive()?u(p.EEXIST(e)):u(ke(x,e,!1))};this.fs.root.getFile(e,{create:n.pathNotExistsAction()===A.CREATE_FILE,exclusive:n.isExclusive()},function(x){x.file(function(O){var D=new FileReader;D.onloadend=function(V){var $=l._makeFile(e,x,n,O,D.result);u(null,$)},D.onerror=function(V){S(D.error)},D.readAsArrayBuffer(O)},S)},S)},t.prototype.unlink=function(e,n){this._remove(e,n,!0)},t.prototype.rmdir=function(e,n){var a=this;this.readdir(e,function(u,l){u?n(u):l.length>0?n(p.ENOTEMPTY(e)):a._remove(e,n,!1)})},t.prototype.mkdir=function(e,n,a){var u={create:!0,exclusive:!0},l=function(x){a()},S=function(x){a(ke(x,e,!0))};this.fs.root.getDirectory(e,u,l,S)},t.prototype.readdir=function(e,n){this._readdir(e,function(a,u){if(u){for(var l=[],S=0,x=u;S<x.length;S+=1){var O=x[S];l.push(O.name)}n(null,l)}else return n(a)})},t.prototype._makeFile=function(e,n,a,u,l){l===void 0&&(l=new ArrayBuffer(0));var S=new C(L.FILE,u.size),x=xt(l);return new ka(this,n,e,a,S,x)},t.prototype._readdir=function(e,n){var a=function(u){n(ke(u,e,!0))};this.fs.root.getDirectory(e,{create:!1},function(u){var l=u.createReader(),S=[],x=function(){l.readEntries(function(O){O.length?(S=S.concat(ba(O)),x()):n(null,S)},a)};x()},a)},t.prototype._remove=function(e,n,a){var u=function(x){var O=function(){n()},D=function(V){n(ke(V,e,!a))};x.remove(O,D)},l=function(x){n(ke(x,e,!a))},S={create:!1};a?this.fs.root.getFile(e,S,u,l):this.fs.root.getDirectory(e,S,u,l)},t}(it);Zr.Name="HTML5FS",Zr.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var le=function(t,r,e,n,a,u){this.id=t,this.size=r,this.mode=e,this.atime=n,this.mtime=a,this.ctime=u};le.fromBuffer=function(t){if(t===void 0)throw new Error("NO");return new le(t.toString("ascii",30),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22))},le.prototype.toStats=function(){return new C((this.mode&61440)===L.DIRECTORY?L.DIRECTORY:L.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},le.prototype.getSize=function(){return 30+this.id.length},le.prototype.toBuffer=function(t){return t===void 0&&(t=f.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},le.prototype.update=function(t){var r=!1;this.size!==t.size&&(this.size=t.size,r=!0),this.mode!==t.mode&&(this.mode=t.mode,r=!0);var e=t.atime.getTime();this.atime!==e&&(this.atime=e,r=!0);var n=t.mtime.getTime();this.mtime!==n&&(this.mtime=n,r=!0);var a=t.ctime.getTime();return this.ctime!==a&&(this.ctime=a,r=!0),r},le.prototype.isFile=function(){return(this.mode&61440)===L.FILE},le.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY};var je="/",pi=null;function yn(){return pi||(pi=f.from("{}"))}function qr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=Math.random()*16|0,r=i==="x"?t:t&3|8;return r.toString(16)})}function ge(i,t){return i?(t(i),!1):!0}function $t(i,t,r){return i?(t.abort(function(){r(i)}),!1):!0}var Ce=function(t){this.store=t,this.originalData={},this.modifiedKeys=[]};Ce.prototype.get=function(t){var r=this.store.get(t);return this.stashOldValue(t,r),r},Ce.prototype.put=function(t,r,e){return this.markModified(t),this.store.put(t,r,e)},Ce.prototype.del=function(t){this.markModified(t),this.store.del(t)},Ce.prototype.commit=function(){},Ce.prototype.abort=function(){for(var t=this,r=0,e=t.modifiedKeys;r<e.length;r+=1){var n=e[r],a=t.originalData[n];a?t.store.put(n,a,!0):t.store.del(n)}},Ce.prototype.stashOldValue=function(t,r){this.originalData.hasOwnProperty(t)||(this.originalData[t]=r)},Ce.prototype.markModified=function(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))};var gn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),vn=function(i){function t(r){i.call(this),this.store=r.store,this.makeRootDirectory()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},t.prototype.renameSync=function(e,n){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),l=w.basename(e),S=w.dirname(n),x=w.basename(n),O=this.findINode(a,u),D=this.getDirListing(a,u,O);if(!D[l])throw p.ENOENT(e);var V=D[l];if(delete D[l],(S+"/").indexOf(e+"/")===0)throw new p(c.EBUSY,u);var $,rt;if(S===u?($=O,rt=D):($=this.findINode(a,S),rt=this.getDirListing(a,S,$)),rt[x]){var ft=this.getINode(a,n,rt[x]);if(ft.isFile())try{a.del(ft.id),a.del(rt[x])}catch(yt){throw a.abort(),yt}else throw p.EPERM(n)}rt[x]=V;try{a.put(O.id,f.from(JSON.stringify(D)),!0),a.put($.id,f.from(JSON.stringify(rt)),!0)}catch(yt){throw a.abort(),yt}a.commit()},t.prototype.statSync=function(e,n){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},t.prototype.createFileSync=function(e,n,a){var u=this.store.beginTransaction("readwrite"),l=Ct(),S=this.commitNewFile(u,e,L.FILE,a,l);return new gn(this,e,n,S.toStats(),l)},t.prototype.openFileSync=function(e,n){var a=this.store.beginTransaction("readonly"),u=this.findINode(a,e),l=a.get(u.id);if(l===void 0)throw p.ENOENT(e);return new gn(this,e,n,u.toStats(),l)},t.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},t.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.removeEntry(e,!0)},t.prototype.mkdirSync=function(e,n){var a=this.store.beginTransaction("readwrite"),u=f.from("{}");this.commitNewFile(a,e,L.DIRECTORY,n,u)},t.prototype.readdirSync=function(e){var n=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(n,e,this.findINode(n,e)))},t.prototype._syncSync=function(e,n,a){var u=this.store.beginTransaction("readwrite"),l=this._findINode(u,w.dirname(e),w.basename(e)),S=this.getINode(u,e,l),x=S.update(a);try{u.put(S.id,n,!0),x&&u.put(l,S.toBuffer(),!0)}catch(O){throw u.abort(),O}u.commit()},t.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(e.get(je)===void 0){var n=new Date().getTime(),a=new le(qr(),4096,511|L.DIRECTORY,n,n,n);e.put(a.id,yn(),!1),e.put(je,a.toBuffer(),!1),e.commit()}},t.prototype._findINode=function(e,n,a){var u=this,l=function(S){var x=u.getDirListing(e,n,S);if(x[a])return x[a];throw p.ENOENT(w.resolve(n,a))};return n==="/"?a===""?je:l(this.getINode(e,n,je)):l(this.getINode(e,n+w.sep+a,this._findINode(e,w.dirname(n),w.basename(n))))},t.prototype.findINode=function(e,n){return this.getINode(e,n,this._findINode(e,w.dirname(n),w.basename(n)))},t.prototype.getINode=function(e,n,a){var u=e.get(a);if(u===void 0)throw p.ENOENT(n);return le.fromBuffer(u)},t.prototype.getDirListing=function(e,n,a){if(!a.isDirectory())throw p.ENOTDIR(n);var u=e.get(a.id);if(u===void 0)throw p.ENOENT(n);return JSON.parse(u.toString())},t.prototype.addNewNode=function(e,n){for(var a=0,u;a<5;)try{return u=qr(),e.put(u,n,!1),u}catch{}throw new p(c.EIO,"Unable to commit data to key-value store.")},t.prototype.commitNewFile=function(e,n,a,u,l){var S=w.dirname(n),x=w.basename(n),O=this.findINode(e,S),D=this.getDirListing(e,S,O),V=new Date().getTime();if(n==="/"||D[x])throw p.EEXIST(n);var $;try{var rt=this.addNewNode(e,l);$=new le(rt,l.length,u|a,V,V,V);var ft=this.addNewNode(e,$.toBuffer());D[x]=ft,e.put(O.id,f.from(JSON.stringify(D)),!0)}catch(yt){throw e.abort(),yt}return e.commit(),$},t.prototype.removeEntry=function(e,n){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),l=this.findINode(a,u),S=this.getDirListing(a,u,l),x=w.basename(e);if(!S[x])throw p.ENOENT(e);var O=S[x];delete S[x];var D=this.getINode(a,e,O);if(!n&&D.isDirectory())throw p.EISDIR(e);if(n&&!D.isDirectory())throw p.ENOTDIR(e);try{a.del(D.id),a.del(O),a.put(l.id,f.from(JSON.stringify(S)),!0)}catch(V){throw a.abort(),V}a.commit()},t}(_t),mn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(a){a||n.resetDirty(),e(a)}):e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),Na=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.init=function(e,n){this.store=e,this.makeRootDirectory(n)},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var n=this;this.store.clear(function(a){ge(a,e)&&n.makeRootDirectory(e)})},t.prototype.rename=function(e,n,a){var u=this,l=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e),O=w.dirname(n),D=w.basename(n),V={},$={},rt=!1;if((O+"/").indexOf(e+"/")===0)return a(new p(c.EBUSY,S));var ft=function(){if(!(rt||!$.hasOwnProperty(S)||!$.hasOwnProperty(O))){var Ft=$[S],Vt=V[S],se=$[O],Te=V[O];if(!Ft[x])a(p.ENOENT(e));else{var Oe=Ft[x];delete Ft[x];var dr=function(){se[D]=Oe,l.put(Vt.id,f.from(JSON.stringify(Ft)),!0,function(Me){$t(Me,l,a)&&(S===O?l.commit(a):l.put(Te.id,f.from(JSON.stringify(se)),!0,function(Pe){$t(Pe,l,a)&&l.commit(a)}))})};se[D]?u.getINode(l,n,se[D],function(Me,Pe){$t(Me,l,a)&&(Pe.isFile()?l.del(Pe.id,function(ao){$t(ao,l,a)&&l.del(se[D],function(ru){$t(ru,l,a)&&dr()})}):l.abort(function(ao){a(p.EPERM(n))}))}):dr()}}},yt=function(Ft){u.findINodeAndDirListing(l,Ft,function(Vt,se,Te){Vt?rt||(rt=!0,l.abort(function(){a(Vt)})):(V[Ft]=se,$[Ft]=Te,ft())})};yt(S),S!==O&&yt(O)},t.prototype.stat=function(e,n,a){var u=this.store.beginTransaction("readonly");this.findINode(u,e,function(l,S){ge(l,a)&&a(null,S.toStats())})},t.prototype.createFile=function(e,n,a,u){var l=this,S=this.store.beginTransaction("readwrite"),x=Ct();this.commitNewFile(S,e,L.FILE,a,x,function(O,D){ge(O,u)&&u(null,new mn(l,e,n,D.toStats(),x))})},t.prototype.openFile=function(e,n,a){var u=this,l=this.store.beginTransaction("readonly");this.findINode(l,e,function(S,x){ge(S,a)&&l.get(x.id,function(O,D){ge(O,a)&&(D===void 0?a(p.ENOENT(e)):a(null,new mn(u,e,n,x.toStats(),D)))})})},t.prototype.unlink=function(e,n){this.removeEntry(e,!1,n)},t.prototype.rmdir=function(e,n){var a=this;this.readdir(e,function(u,l){u?n(u):l.length>0?n(p.ENOTEMPTY(e)):a.removeEntry(e,!0,n)})},t.prototype.mkdir=function(e,n,a){var u=this.store.beginTransaction("readwrite"),l=f.from("{}");this.commitNewFile(u,e,L.DIRECTORY,n,l,a)},t.prototype.readdir=function(e,n){var a=this,u=this.store.beginTransaction("readonly");this.findINode(u,e,function(l,S){ge(l,n)&&a.getDirListing(u,e,S,function(x,O){ge(x,n)&&n(null,Object.keys(O))})})},t.prototype._sync=function(e,n,a,u){var l=this,S=this.store.beginTransaction("readwrite");this._findINode(S,w.dirname(e),w.basename(e),function(x,O){$t(x,S,u)&&l.getINode(S,e,O,function(D,V){if($t(D,S,u)){var $=V.update(a);S.put(V.id,n,!0,function(rt){$t(rt,S,u)&&($?S.put(O,V.toBuffer(),!0,function(ft){$t(ft,S,u)&&S.commit(u)}):S.commit(u))})}})})},t.prototype.makeRootDirectory=function(e){var n=this.store.beginTransaction("readwrite");n.get(je,function(a,u){if(a||u===void 0){var l=new Date().getTime(),S=new le(qr(),4096,511|L.DIRECTORY,l,l,l);n.put(S.id,yn(),!1,function(x){$t(x,n,e)&&n.put(je,S.toBuffer(),!1,function(O){O?n.abort(function(){e(O)}):n.commit(e)})})}else n.commit(e)})},t.prototype._findINode=function(e,n,a,u){var l=this,S=function(x,O,D){x?u(x):D[a]?u(null,D[a]):u(p.ENOENT(w.resolve(n,a)))};n==="/"?a===""?u(null,je):this.getINode(e,n,je,function(x,O){ge(x,u)&&l.getDirListing(e,n,O,function(D,V){S(D,O,V)})}):this.findINodeAndDirListing(e,n,S)},t.prototype.findINode=function(e,n,a){var u=this;this._findINode(e,w.dirname(n),w.basename(n),function(l,S){ge(l,a)&&u.getINode(e,n,S,a)})},t.prototype.getINode=function(e,n,a,u){e.get(a,function(l,S){ge(l,u)&&(S===void 0?u(p.ENOENT(n)):u(null,le.fromBuffer(S)))})},t.prototype.getDirListing=function(e,n,a,u){a.isDirectory()?e.get(a.id,function(l,S){if(ge(l,u))try{u(null,JSON.parse(S.toString()))}catch{u(p.ENOENT(n))}}):u(p.ENOTDIR(n))},t.prototype.findINodeAndDirListing=function(e,n,a){var u=this;this.findINode(e,n,function(l,S){ge(l,a)&&u.getDirListing(e,n,S,function(x,O){ge(x,a)&&a(null,S,O)})})},t.prototype.addNewNode=function(e,n,a){var u=0,l,S=function(){++u===5?a(new p(c.EIO,"Unable to commit data to key-value store.")):(l=qr(),e.put(l,n,!1,function(x,O){x||!O?S():a(null,l)}))};S()},t.prototype.commitNewFile=function(e,n,a,u,l,S){var x=this,O=w.dirname(n),D=w.basename(n),V=new Date().getTime();if(n==="/")return S(p.EEXIST(n));this.findINodeAndDirListing(e,O,function($,rt,ft){$t($,e,S)&&(ft[D]?e.abort(function(){S(p.EEXIST(n))}):x.addNewNode(e,l,function(yt,Ft){if($t(yt,e,S)){var Vt=new le(Ft,l.length,u|a,V,V,V);x.addNewNode(e,Vt.toBuffer(),function(se,Te){$t(se,e,S)&&(ft[D]=Te,e.put(rt.id,f.from(JSON.stringify(ft)),!0,function(Oe){$t(Oe,e,S)&&e.commit(function(dr){$t(dr,e,S)&&S(null,Vt)})}))})}}))})},t.prototype.removeEntry=function(e,n,a){var u=this,l=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e);this.findINodeAndDirListing(l,S,function(O,D,V){if($t(O,l,a))if(!V[x])l.abort(function(){a(p.ENOENT(e))});else{var $=V[x];delete V[x],u.getINode(l,e,$,function(rt,ft){$t(rt,l,a)&&(!n&&ft.isDirectory()?l.abort(function(){a(p.EISDIR(e))}):n&&!ft.isDirectory()?l.abort(function(){a(p.ENOTDIR(e))}):l.del(ft.id,function(yt){$t(yt,l,a)&&l.del($,function(Ft){$t(Ft,l,a)&&l.put(D.id,f.from(JSON.stringify(V)),!0,function(Vt){$t(Vt,l,a)&&l.commit(a)})})}))})}})},t}(it),Ye=function(){this.store={}};Ye.prototype.name=function(){return ur.Name},Ye.prototype.clear=function(){this.store={}},Ye.prototype.beginTransaction=function(t){return new Ce(this)},Ye.prototype.get=function(t){return this.store[t]},Ye.prototype.put=function(t,r,e){return!e&&this.store.hasOwnProperty(t)?!1:(this.store[t]=r,!0)},Ye.prototype.del=function(t){delete this.store[t]};var ur=function(i){function t(){i.call(this,{store:new Ye})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t)},t}(vn);ur.Name="InMemory",ur.Options={};var di=Kt.indexedDB||Kt.mozIndexedDB||Kt.webkitIndexedDB||Kt.msIndexedDB;function _r(i,t){switch(t===void 0&&(t=i.toString()),i.name){case"NotFoundError":return new p(c.ENOENT,t);case"QuotaExceededError":return new p(c.ENOSPC,t);default:return new p(c.EIO,t)}}function xr(i,t,r){return t===void 0&&(t=c.EIO),r===void 0&&(r=null),function(e){e.preventDefault(),i(new p(t,r!==null?r:void 0))}}var yi=function(t,r){this.tx=t,this.store=r};yi.prototype.get=function(t,r){try{var e=this.store.get(t);e.onerror=xr(r),e.onsuccess=function(n){var a=n.target.result;a===void 0?r(null,a):r(null,xt(a))}}catch(n){r(_r(n))}};var Ra=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.put=function(e,n,a,u){try{var l=K(n),S;a?S=this.store.put(l,e):S=this.store.add(l,e),S.onerror=xr(u),S.onsuccess=function(x){u(null,!0)}}catch(x){u(_r(x))}},t.prototype.del=function(e,n){try{var a=this.store.delete(e);a.onerror=xr(n),a.onsuccess=function(u){n()}}catch(u){n(_r(u))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var n=null;try{this.tx.abort()}catch(a){n=_r(a)}finally{e(n)}},t}(yi),Xr=function(t,r){var e=this;r===void 0&&(r="browserfs"),this.storeName=r;var n=di.open(this.storeName,1);n.onupgradeneeded=function(a){var u=a.target.result;u.objectStoreNames.contains(e.storeName)&&u.deleteObjectStore(e.storeName),u.createObjectStore(e.storeName)},n.onsuccess=function(a){e.db=a.target.result,t(null,e)},n.onerror=xr(t,c.EACCES)};Xr.prototype.name=function(){return Fr.Name+" - "+this.storeName},Xr.prototype.clear=function(t){try{var r=this.db.transaction(this.storeName,"readwrite"),e=r.objectStore(this.storeName),n=e.clear();n.onsuccess=function(a){setTimeout(t,0)},n.onerror=xr(t)}catch(a){t(_r(a))}},Xr.prototype.beginTransaction=function(t){t===void 0&&(t="readonly");var r=this.db.transaction(this.storeName,t),e=r.objectStore(this.storeName);if(t==="readwrite")return new Ra(r,e);if(t==="readonly")return new yi(r,e);throw new p(c.EINVAL,"Invalid transaction type.")};var Fr=function(i){function t(r,e,n){var a=this;n===void 0&&(n=!0),i.call(this),this.store=new Xr(function(u){u?r(u):a.init(a.store,function(l){r(l,a)})},e),kt(n,t.Name,{storeName:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){new t(n,e.storeName,!1)},t.isAvailable=function(){try{return typeof di<"u"&&di.open("__browserfs_test__")!==null}catch{return!1}},t}(Na);Fr.Name="IndexedDB",Fr.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var gi=!1,Ir;try{Kt.localStorage.setItem("__test__",String.fromCharCode(55296)),gi=Kt.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch{gi=!1}Ir=gi?"binary_string":"binary_string_ie",f.isEncoding(Ir)||(Ir="base64");var Ge=function(){};Ge.prototype.name=function(){return br.Name},Ge.prototype.clear=function(){Kt.localStorage.clear()},Ge.prototype.beginTransaction=function(t){return new Ce(this)},Ge.prototype.get=function(t){try{var r=Kt.localStorage.getItem(t);if(r!==null)return f.from(r,Ir)}catch{}},Ge.prototype.put=function(t,r,e){try{return!e&&Kt.localStorage.getItem(t)!==null?!1:(Kt.localStorage.setItem(t,r.toString(Ir)),!0)}catch{throw new p(c.ENOSPC,"LocalStorage is full.")}},Ge.prototype.del=function(t){try{Kt.localStorage.removeItem(t)}catch(r){throw new p(c.EIO,"Unable to delete key "+t+": "+r)}};var br=function(i){function t(){i.call(this,{store:new Ge})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t)},t.isAvailable=function(){return typeof Kt.localStorage<"u"},t}(vn);br.Name="LocalStorage",br.Options={};var fr=function(i){function t(){i.call(this),this.mountList=[],this.mntMap={},this.rootFs=new ur}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t;Object.keys(e).forEach(function(u){a.mount(u,e[u])}),n(null,a)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,n){if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),this.mntMap[e])throw new p(c.EINVAL,"Mount point "+e+" is already taken.");z(e,511,this.rootFs),this.mntMap[e]=n,this.mountList.push(e),this.mountList=this.mountList.sort(function(a,u){return u.length-a.length})},t.prototype.umount=function(e){var n=this;if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),!this.mntMap[e])throw new p(c.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&n.rootFs.readdirSync(e).length===0;)n.rootFs.rmdirSync(e),e=w.dirname(e)},t.prototype._getFs=function(e){for(var n=this,a=this.mountList,u=a.length,l=0;l<u;l++){var S=a[l];if(S.length<=e.length&&e.indexOf(S)===0)return e=e.substr(S.length>1?S.length:0),e===""&&(e="/"),{fs:n.mntMap[S],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,n){n(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,n,a){var u=e.message.indexOf(n);return u!==-1&&(e.message=e.message.substr(0,u)+a+e.message.substr(u+n.length),e.path=a),e},t.prototype.rename=function(e,n,a){var u=this,l=this._getFs(e),S=this._getFs(n);return l.fs===S.fs?l.fs.rename(l.path,S.path,function(x){x&&u.standardizeError(u.standardizeError(x,l.path,e),S.path,n),a(x)}):ct.readFile(e,function(x,O){if(x)return a(x);ct.writeFile(n,O,function(D){if(D)return a(D);ct.unlink(e,a)})})},t.prototype.renameSync=function(e,n){var a=this._getFs(e),u=this._getFs(n);if(a.fs===u.fs)try{return a.fs.renameSync(a.path,u.path)}catch(S){throw this.standardizeError(this.standardizeError(S,a.path,e),u.path,n),S}var l=ct.readFileSync(e);return ct.writeFileSync(n,l),ct.unlinkSync(e)},t.prototype.readdirSync=function(e){var n=this._getFs(e),a=null;if(n.fs!==this.rootFs)try{a=this.rootFs.readdirSync(e)}catch{}try{var u=n.fs.readdirSync(n.path);return a===null?u:u.concat(a.filter(function(l){return u.indexOf(l)===-1}))}catch(l){if(a===null)throw this.standardizeError(l,n.path,e);return a}},t.prototype.readdir=function(e,n){var a=this,u=this._getFs(e);u.fs.readdir(u.path,function(l,S){if(u.fs!==a.rootFs)try{var x=a.rootFs.readdirSync(e);S?S=S.concat(x.filter(function(O){return S.indexOf(O)===-1})):S=x}catch{if(l)return n(a.standardizeError(l,u.path,e))}else if(l)return n(a.standardizeError(l,u.path,e));n(null,S)})},t.prototype.rmdirSync=function(e){var n=this._getFs(e);if(this._containsMountPt(e))throw p.ENOTEMPTY(e);try{n.fs.rmdirSync(n.path)}catch(a){throw this.standardizeError(a,n.path,e)}},t.prototype.rmdir=function(e,n){var a=this,u=this._getFs(e);this._containsMountPt(e)?n(p.ENOTEMPTY(e)):u.fs.rmdir(u.path,function(l){n(l?a.standardizeError(l,u.path,e):null)})},t.prototype._containsMountPt=function(e){for(var n=this.mountList,a=n.length,u=0;u<a;u++){var l=n[u];if(l.length>=e.length&&l.slice(0,e.length)===e)return!0}return!1},t}(it);fr.Name="MountableFileSystem",fr.Options={};function wn(i,t,r){return t?function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var a=e[0],u=this._getFs(a);e[0]=u.path;try{return u.fs[i].apply(u.fs,e)}catch(l){throw this.standardizeError(l,u.path,a),l}}:function(){for(var e=this,n=[],a=arguments.length;a--;)n[a]=arguments[a];var u=n[0],l=this._getFs(u);if(n[0]=l.path,typeof n[n.length-1]=="function"){var S=n[n.length-1];n[n.length-1]=function(){for(var x=[],O=arguments.length;O--;)x[O]=arguments[O];x.length>0&&x[0]instanceof p&&e.standardizeError(x[0],l.path,u),S.apply(null,x)}}return l.fs[i].apply(l.fs,n)}}for(var Sn=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],kr=0;kr<Sn.length;kr++)for(var Ta=Sn[kr],vi=0,En=Ta;vi<En.length;vi+=1){var Yr=En[vi];fr.prototype[Yr]=wn(Yr,!1,kr+1),fr.prototype[Yr+"Sync"]=wn(Yr+"Sync",!0,kr+1)}var Nr;if(typeof setImmediate<"u")Nr=setImmediate;else{var Ee=Kt,cr=[],_n="zero-timeout-message",Oa=function(){if(typeof Ee.importScripts<"u"||!Ee.postMessage)return!1;var i=!0,t=Ee.onmessage;return Ee.onmessage=function(){i=!1},Ee.postMessage("","*"),Ee.onmessage=t,i};if(Oa()){Nr=function(i){cr.push(i),Ee.postMessage(_n,"*")};var xn=function(i){if(i.source===self&&i.data===_n&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,cr.length>0)){var t=cr.shift();return t()}};Ee.addEventListener?Ee.addEventListener("message",xn,!0):Ee.attachEvent("onmessage",xn)}else if(Ee.MessageChannel){var Fn=new Ee.MessageChannel;Fn.port1.onmessage=function(i){if(cr.length>0)return cr.shift()()},Nr=function(i){cr.push(i),Fn.port2.postMessage("")}}else Nr=function(i){return setTimeout(i,0)}}var mi=Nr,Rr=function(){this._locked=!1,this._waiters=[]};Rr.prototype.lock=function(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()},Rr.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var t=this._waiters.shift();if(t){mi(t);return}this._locked=!1},Rr.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},Rr.prototype.isLocked=function(){return this._locked};var mt=function(t){this._fs=t,this._mu=new Rr};mt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},mt.prototype.getFSUnlocked=function(){return this._fs},mt.prototype.initialize=function(t){this._fs.initialize(t)},mt.prototype.diskSpace=function(t,r){this._fs.diskSpace(t,r)},mt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},mt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},mt.prototype.supportsProps=function(){return this._fs.supportsProps()},mt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},mt.prototype.rename=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.rename(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.renameSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,r)},mt.prototype.stat=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.stat(t,r,function(a,u){n._mu.unlock(),e(a,u)})})},mt.prototype.statSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,r)},mt.prototype.open=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.open(t,r,e,function(u,l){a._mu.unlock(),n(u,l)})})},mt.prototype.openSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,r,e)},mt.prototype.unlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.unlink(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.unlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t)},mt.prototype.rmdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.rmdir(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.rmdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t)},mt.prototype.mkdir=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.mkdir(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.mkdirSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,r)},mt.prototype.readdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.readdir(t,function(n,a){e._mu.unlock(),r(n,a)})})},mt.prototype.readdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t)},mt.prototype.exists=function(t,r){var e=this;this._mu.lock(function(){e._fs.exists(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.existsSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t)},mt.prototype.realpath=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.realpath(t,r,function(a,u){n._mu.unlock(),e(a,u)})})},mt.prototype.realpathSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,r)},mt.prototype.truncate=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.truncate(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.truncateSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,r)},mt.prototype.readFile=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.readFile(t,r,e,function(u,l){a._mu.unlock(),n(u,l)})})},mt.prototype.readFileSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,r,e)},mt.prototype.writeFile=function(t,r,e,n,a,u){var l=this;this._mu.lock(function(){l._fs.writeFile(t,r,e,n,a,function(S){l._mu.unlock(),u(S)})})},mt.prototype.writeFileSync=function(t,r,e,n,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,r,e,n,a)},mt.prototype.appendFile=function(t,r,e,n,a,u){var l=this;this._mu.lock(function(){l._fs.appendFile(t,r,e,n,a,function(S){l._mu.unlock(),u(S)})})},mt.prototype.appendFileSync=function(t,r,e,n,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,r,e,n,a)},mt.prototype.chmod=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.chmod(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.chmodSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,r,e)},mt.prototype.chown=function(t,r,e,n,a){var u=this;this._mu.lock(function(){u._fs.chown(t,r,e,n,function(l){u._mu.unlock(),a(l)})})},mt.prototype.chownSync=function(t,r,e,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,r,e,n)},mt.prototype.utimes=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.utimes(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.utimesSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,r,e)},mt.prototype.link=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.link(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.linkSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,r)},mt.prototype.symlink=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.symlink(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.symlinkSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,r,e)},mt.prototype.readlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.readlink(t,function(n,a){e._mu.unlock(),r(n,a)})})},mt.prototype.readlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t)};var Be="/.deletedFiles.log";function In(i){return 146|i}function ve(i){return b.getFileFlag(i)}var bn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(!this.isDirty()){e(null);return}this._fs._syncAsync(this,function(a){n.resetDirty(),e(a)})},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),kn=function(i){function t(r,e){if(i.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=r,this._readable=e,this._writable.isReadOnly())throw new p(c.EINVAL,"Writable file system must be writable.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,n){var a=this;this.createParentDirectoriesAsync(e.getPath(),function(u){if(u)return n(u);a._writable.writeFile(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode,n)})},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode)},t.prototype.getName=function(){return Tr.Name},t.prototype.initialize=function(e){var n=this,a=this._initializeCallbacks,u=function(l){n._isInitialized=!l,n._initializeCallbacks=[],a.forEach(function(S){return S(l)})};if(this._isInitialized)return e();a.push(e),a.length===1&&this._writable.readFile(Be,"utf8",ve("r"),function(l,S){if(l){if(l.errno!==c.ENOENT)return u(l)}else n._deleteLog=S;n._reparseDeletionLog(),u()})},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,n,a){var u=this;if(!(!this.checkInitAsync(a)||this.checkPathAsync(e,a)||this.checkPathAsync(n,a))){if(e===Be||n===Be)return a(p.EPERM("Cannot rename deletion log."));if(e===n)return a();this.stat(e,!1,function(l,S){return l?a(l):u.stat(n,!1,function(x,O){var D=u;function V(rt){var ft=rt.shift();if(!ft)return a();var yt=w.resolve(e,ft),Ft=w.resolve(n,ft);D.rename(yt,Ft,function(Vt){if(Vt)return a(Vt);V(rt)})}var $=511;if(S.isDirectory()){if(x)return x.errno!==c.ENOENT?a(x):u._writable.exists(e,function(rt){if(rt)return u._writable.rename(e,n,a);u._writable.mkdir(n,$,function(ft){if(ft)return a(ft);u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})});if($=O.mode,!O.isDirectory())return a(p.ENOTDIR(n));u.readdir(n,function(rt,ft){if(ft&&ft.length)return a(p.ENOTEMPTY(n));u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})}if(O&&O.isDirectory())return a(p.EISDIR(n));u.readFile(e,null,ve("r"),function(rt,ft){return rt?a(rt):u.writeFile(n,ft,null,ve("w"),S.mode,function(yt){return yt?a(yt):u.unlink(e,a)})})})})}},t.prototype.renameSync=function(e,n){var a=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(n),e===Be||n===Be)throw p.EPERM("Cannot rename deletion log.");var u=this.statSync(e,!1);if(u.isDirectory()){if(e===n)return;var l=511;if(this.existsSync(n)){var S=this.statSync(n,!1);if(l=S.mode,S.isDirectory()){if(this.readdirSync(n).length>0)throw p.ENOTEMPTY(n)}else throw p.ENOTDIR(n)}this._writable.existsSync(e)?this._writable.renameSync(e,n):this._writable.existsSync(n)||this._writable.mkdirSync(n,l),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach(function(x){a.renameSync(w.resolve(e,x),w.resolve(n,x))})}else{if(this.existsSync(n)&&this.statSync(n,!1).isDirectory())throw p.EISDIR(n);this.writeFileSync(n,this.readFileSync(e,null,ve("r")),null,ve("w"),u.mode)}e!==n&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,n,a){var u=this;!this.checkInitAsync(a)||this._writable.stat(e,n,function(l,S){l&&l.errno===c.ENOENT?(u._deletedFiles[e]&&a(p.ENOENT(e)),u._readable.stat(e,n,function(x,O){O&&(O=O.clone(),O.mode=In(O.mode)),a(x,O)})):a(l,S)})},t.prototype.statSync=function(e,n){this.checkInitialized();try{return this._writable.statSync(e,n)}catch{if(this._deletedFiles[e])throw p.ENOENT(e);var a=this._readable.statSync(e,n).clone();return a.mode=In(a.mode),a}},t.prototype.open=function(e,n,a,u){var l=this;!this.checkInitAsync(u)||this.checkPathAsync(e,u)||this.stat(e,!1,function(S,x){if(x)switch(n.pathExistsAction()){case A.TRUNCATE_FILE:return l.createParentDirectoriesAsync(e,function(O){if(O)return u(O);l._writable.open(e,n,a,u)});case A.NOP:return l._writable.exists(e,function(O){O?l._writable.open(e,n,a,u):(x=x.clone(),x.mode=a,l._readable.readFile(e,null,ve("r"),function(D,V){if(D)return u(D);x.size===-1&&(x.size=V.length);var $=new bn(l,e,n,x,V);u(null,$)}))});default:return u(p.EEXIST(e))}else switch(n.pathNotExistsAction()){case A.CREATE_FILE:return l.createParentDirectoriesAsync(e,function(O){return O?u(O):l._writable.open(e,n,a,u)});default:return u(p.ENOENT(e))}})},t.prototype.openSync=function(e,n,a){if(this.checkInitialized(),this.checkPath(e),e===Be)throw p.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(n.pathExistsAction()){case A.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,n,a);case A.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,n,a);var u=this._readable.readFileSync(e,null,ve("r")),l=this._readable.statSync(e,!1).clone();return l.mode=a,new bn(this,e,n,l,u);default:throw p.EEXIST(e)}else switch(n.pathNotExistsAction()){case A.CREATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,n,a);default:throw p.ENOENT(e)}},t.prototype.unlink=function(e,n){var a=this;!this.checkInitAsync(n)||this.checkPathAsync(e,n)||this.exists(e,function(u){if(!u)return n(p.ENOENT(e));a._writable.exists(e,function(l){if(l)return a._writable.unlink(e,function(S){if(S)return n(S);a.exists(e,function(x){x&&a.deletePath(e),n(null)})});a.deletePath(e),n(null)})})},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e))this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e);else throw p.ENOENT(e)},t.prototype.rmdir=function(e,n){var a=this;if(!!this.checkInitAsync(n)){var u=function(){a.readdir(e,function(l,S){if(l)return n(l);if(S.length)return n(p.ENOTEMPTY(e));a.deletePath(e),n(null)})};this.exists(e,function(l){if(!l)return n(p.ENOENT(e));a._writable.exists(e,function(S){S?a._writable.rmdir(e,function(x){if(x)return n(x);a._readable.exists(e,function(O){O?u():n()})}):u()})})}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),this.existsSync(e)){if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.deletePath(e)}}else throw p.ENOENT(e)},t.prototype.mkdir=function(e,n,a){var u=this;!this.checkInitAsync(a)||this.exists(e,function(l){if(l)return a(p.EEXIST(e));u.createParentDirectoriesAsync(e,function(S){if(S)return a(S);u._writable.mkdir(e,n,a)})})},t.prototype.mkdirSync=function(e,n){if(this.checkInitialized(),this.existsSync(e))throw p.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,n)},t.prototype.readdir=function(e,n){var a=this;!this.checkInitAsync(n)||this.stat(e,!1,function(u,l){if(u)return n(u);if(!l.isDirectory())return n(p.ENOTDIR(e));a._writable.readdir(e,function(S,x){if(S&&S.code!=="ENOENT")return n(S);(S||!x)&&(x=[]),a._readable.readdir(e,function(O,D){(O||!D)&&(D=[]);var V={},$=x.concat(D.filter(function(rt){return!a._deletedFiles[e+"/"+rt]})).filter(function(rt){var ft=!V[rt];return V[rt]=!0,ft});n(null,$)})})})},t.prototype.readdirSync=function(e){var n=this;this.checkInitialized();var a=this.statSync(e,!1);if(!a.isDirectory())throw p.ENOTDIR(e);var u=[];try{u=u.concat(this._writable.readdirSync(e))}catch{}try{u=u.concat(this._readable.readdirSync(e).filter(function(S){return!n._deletedFiles[e+"/"+S]}))}catch{}var l={};return u.filter(function(S){var x=!l[S];return l[S]=!0,x})},t.prototype.exists=function(e,n){var a=this;this.checkInitialized(),this._writable.exists(e,function(u){if(u)return n(!0);a._readable.exists(e,function(l){n(l&&a._deletedFiles[e]!==!0)})})},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&this._deletedFiles[e]!==!0},t.prototype.chmod=function(e,n,a,u){var l=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);l._writable.chmod(e,n,a,u)})},t.prototype.chmodSync=function(e,n,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.chmodSync(e,n,a)})},t.prototype.chown=function(e,n,a,u,l){var S=this;!this.checkInitAsync(l)||this.operateOnWritableAsync(e,function(x){if(x)return l(x);S._writable.chown(e,n,a,u,l)})},t.prototype.chownSync=function(e,n,a,u){var l=this;this.checkInitialized(),this.operateOnWritable(e,function(){l._writable.chownSync(e,n,a,u)})},t.prototype.utimes=function(e,n,a,u){var l=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);l._writable.utimes(e,n,a,u)})},t.prototype.utimesSync=function(e,n,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.utimesSync(e,n,a)})},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+`
`)},t.prototype.updateLog=function(e){var n=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Be,this._deleteLog,"utf8",b.getFileFlag("w"),420,function(a){n._deleteLogUpdatePending=!1,a?n._deleteLogError=a:n._deleteLogUpdateNeeded&&(n._deleteLogUpdateNeeded=!1,n.updateLog(""))}))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(n){e._deletedFiles[n.slice(1)]=n.slice(0,1)==="d"})},t.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new p(c.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},t.prototype.checkInitAsync=function(e){if(this._isInitialized){if(this._deleteLogError!==null){var n=this._deleteLogError;return this._deleteLogError=null,e(n),!1}}else return e(new p(c.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},t.prototype.checkPath=function(e){if(e===Be)throw p.EPERM(e)},t.prototype.checkPathAsync=function(e,n){return e===Be?(n(p.EPERM(e)),!0):!1},t.prototype.createParentDirectoriesAsync=function(e,n){var a=w.dirname(e),u=[],l=this;this._writable.stat(a,!1,S);function S(O,D){O?(u.push(a),a=w.dirname(a),l._writable.stat(a,!1,S)):x()}function x(){if(!u.length)return n();var O=u.pop();l._readable.stat(O,!1,function(D,V){if(!V)return n();l._writable.mkdir(O,V.mode,function($){if($)return n($);x()})})}},t.prototype.createParentDirectories=function(e){for(var n=this,a=w.dirname(e),u=[];!this._writable.existsSync(a);)u.push(a),a=w.dirname(a);u=u.reverse(),u.forEach(function(l){n._writable.mkdirSync(l,n.statSync(l,!1).mode)})},t.prototype.operateOnWritable=function(e,n){if(this.existsSync(e))this._writable.existsSync(e)||this.copyToWritable(e),n();else throw p.ENOENT(e)},t.prototype.operateOnWritableAsync=function(e,n){var a=this;this.exists(e,function(u){if(!u)return n(p.ENOENT(e));a._writable.exists(e,function(l){if(l)n();else return a.copyToWritableAsync(e,n)})})},t.prototype.copyToWritable=function(e){var n=this.statSync(e,!1);n.isDirectory()?this._writable.mkdirSync(e,n.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,ve("r")),null,ve("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,n){var a=this;this.stat(e,!1,function(u,l){if(u)return n(u);if(l.isDirectory())return a._writable.mkdir(e,l.mode,n);a._readable.readFile(e,null,ve("r"),function(S,x){if(S)return n(S);a.writeFile(e,x,null,ve("w"),l.mode,n)})})},t}(it),Tr=function(i){function t(r,e,n){n===void 0&&(n=!0),i.call(this,new kn(r,e)),kt(n,t.Name,{readable:"readable file system",writable:"writable file system"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{var a=new t(e.writable,e.readable,!1);a.initialize(function(u){n(u,a)},!1)}catch(u){n(u)}},t.isAvailable=function(){return kn.isAvailable()},t.prototype.initialize=function(e,n){n===void 0&&(n=!0),n&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),i.prototype.initialize.call(this,e)},t.prototype.getOverlayedFileSystems=function(){return i.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return i.prototype.getFSUnlocked.call(this)},t}(mt);Tr.Name="OverlayFS",Tr.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var Ht;(function(i){i[i.CB=0]="CB",i[i.FD=1]="FD",i[i.API_ERROR=2]="API_ERROR",i[i.STATS=3]="STATS",i[i.PROBE=4]="PROBE",i[i.FILEFLAG=5]="FILEFLAG",i[i.BUFFER=6]="BUFFER",i[i.ERROR=7]="ERROR"})(Ht||(Ht={}));var wi=function(){this._callbacks={},this._nextId=0};wi.prototype.toRemoteArg=function(t){var r=this._nextId++;return this._callbacks[r]=t,{type:Ht.CB,id:r}},wi.prototype.toLocalArg=function(t){var r=this._callbacks[t];return delete this._callbacks[t],r};var Gr=function(){this._fileDescriptors={},this._nextId=0};Gr.prototype.toRemoteArg=function(t,r,e,n){var a=this._nextId++,u,l;this._fileDescriptors[a]=t,t.stat(function(S,x){S?n(S):(l=Je(x.toBuffer()),e.isReadable()?t.read(f.alloc(x.size),0,x.size,0,function(O,D,V){O?n(O):(u=Je(V),n(null,{type:Ht.FD,id:a,data:u,stat:l,path:r,flag:e.getFlagString()}))}):n(null,{type:Ht.FD,id:a,data:new ArrayBuffer(0),stat:l,path:r,flag:e.getFlagString()}))})},Gr.prototype.applyFdAPIRequest=function(t,r){var e=this,n=t.args[0];this._applyFdChanges(n,function(a,u){a?r(a):u[t.method](function(l){t.method==="close"&&delete e._fileDescriptors[n.id],r(l)})})},Gr.prototype._applyFdChanges=function(t,r){var e=this._fileDescriptors[t.id],n=Ke(t.data),a=C.fromBuffer(Ke(t.stat)),u=b.getFileFlag(t.flag);u.isWriteable()?e.write(n,0,n.length,u.isAppendable()?e.getPos():0,function(l){function S(){e.stat(function(x,O){x?r(x):O.mode!==a.mode?e.chmod(a.mode,function(D){r(D,e)}):r(x,e)})}l?r(l):u.isAppendable()?S():e.truncate(n.length,function(){S()})}):r(null,e)};function Jr(i){return{type:Ht.API_ERROR,errorData:Je(i.writeToBuffer())}}function Nn(i){return p.fromBuffer(Ke(i.errorData))}function Rn(i){return{type:Ht.ERROR,name:i.name,message:i.message,stack:i.stack}}function Tn(i){var t=Kt[i.name];typeof t!="function"&&(t=Error);var r=new t(i.message);return r.stack=i.stack,r}function On(i){return{type:Ht.STATS,statsData:Je(i.toBuffer())}}function An(i){return C.fromBuffer(Ke(i.statsData))}function Ln(i){return{type:Ht.FILEFLAG,flagStr:i.getFlagString()}}function Dn(i){return b.getFileFlag(i.flagStr)}function Je(i){return K(i)}function Ke(i){return xt(i)}function Cn(i){return{type:Ht.BUFFER,data:Je(i)}}function Bn(i){return Ke(i.data)}function Aa(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}function La(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}var Un=function(i){function t(r,e,n,a,u,l){i.call(this,r,e,n,a,l),this._remoteFdId=u}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:Ht.FD,id:this._remoteFdId,data:Je(this.getBuffer()),stat:Je(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,n){var a=this;this.isDirty()?this._fs.syncClose(e,this,function(u){u||a.resetDirty(),n(u)}):n()},t}(Yt),Kr=function(i){function t(r,e){var n=this;e===void 0&&(e=!0),i.call(this),this._callbackConverter=new wi,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=r,kt(e,t.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(a){var u=a.data;if(La(u)){var l,S=u.args,x=new Array(S.length);for(l=0;l<x.length;l++)x[l]=n._argRemote2Local(S[l]);n._callbackConverter.toLocalArg(u.cbId).apply(null,x)}})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t(e.worker,!1);a.initialize(function(){n(null,a)})},t.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},t.attachRemoteListener=function(e){var n=new Gr;function a(l,S,x){switch(typeof l){case"object":l instanceof C?x(null,On(l)):l instanceof p?x(null,Jr(l)):l instanceof gt?x(null,n.toRemoteArg(l,S[0],S[1],x)):l instanceof b?x(null,Ln(l)):l instanceof f?x(null,Cn(l)):l instanceof Error?x(null,Rn(l)):x(null,l);break;default:x(null,l);break}}function u(l,S){if(!l)return l;switch(typeof l){case"object":if(typeof l.type=="number"){var x=l;switch(x.type){case Ht.CB:var O=l.id;return function(){var D=arguments,V,$=new Array(arguments.length),rt,ft=arguments.length;function yt(Ft){ft>0&&(ft=-1,rt={browserfsMessage:!0,cbId:O,args:[Jr(Ft)]},e.postMessage(rt))}for(V=0;V<arguments.length;V++)(function(Ft,Vt){a(Vt,S,function(se,Te){$[Ft]=Te,se?yt(se):--ft===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))})})(V,D[V]);arguments.length===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))};case Ht.API_ERROR:return Nn(x);case Ht.STATS:return An(x);case Ht.FILEFLAG:return Dn(x);case Ht.BUFFER:return Bn(x);case Ht.ERROR:return Tn(x);default:return l}}else return l;default:return l}}e.addEventListener("message",function(l){var S=l.data;if(Aa(S)){var x=S.args,O=new Array(x.length);switch(S.method){case"close":case"sync":(function(){var $=x[1];n.applyFdAPIRequest(S,function(rt){var ft={browserfsMessage:!0,cbId:$.id,args:rt?[Jr(rt)]:[]};e.postMessage(ft)})})();break;case"probe":(function(){var $=ct.getRootFS(),rt=x[1],ft={type:Ht.PROBE,isReadOnly:$.isReadOnly(),supportsLinks:$.supportsLinks(),supportsProps:$.supportsProps()},yt={browserfsMessage:!0,cbId:rt.id,args:[ft]};e.postMessage(yt)})();break;default:for(var D=0;D<x.length;D++)O[D]=u(x[D],O);var V=ct.getRootFS();V[S.method].apply(V,O);break}}})},t.prototype.getName=function(){return t.Name},t.prototype.initialize=function(e){var n=this;if(this._isInitialized)e();else{var a={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(Ct()),this._callbackConverter.toRemoteArg(function(u){n._isInitialized=!0,n._isReadOnly=u.isReadOnly,n._supportLinks=u.supportsLinks,n._supportProps=u.supportsProps,e()})]};this._worker.postMessage(a)}},t.prototype.isReadOnly=function(){return this._isReadOnly},t.prototype.supportsSynch=function(){return!1},t.prototype.supportsLinks=function(){return this._supportLinks},t.prototype.supportsProps=function(){return this._supportProps},t.prototype.rename=function(e,n,a){this._rpc("rename",arguments)},t.prototype.stat=function(e,n,a){this._rpc("stat",arguments)},t.prototype.open=function(e,n,a,u){this._rpc("open",arguments)},t.prototype.unlink=function(e,n){this._rpc("unlink",arguments)},t.prototype.rmdir=function(e,n){this._rpc("rmdir",arguments)},t.prototype.mkdir=function(e,n,a){this._rpc("mkdir",arguments)},t.prototype.readdir=function(e,n){this._rpc("readdir",arguments)},t.prototype.exists=function(e,n){this._rpc("exists",arguments)},t.prototype.realpath=function(e,n,a){this._rpc("realpath",arguments)},t.prototype.truncate=function(e,n,a){this._rpc("truncate",arguments)},t.prototype.readFile=function(e,n,a,u){this._rpc("readFile",arguments)},t.prototype.writeFile=function(e,n,a,u,l,S){this._rpc("writeFile",arguments)},t.prototype.appendFile=function(e,n,a,u,l,S){this._rpc("appendFile",arguments)},t.prototype.chmod=function(e,n,a,u){this._rpc("chmod",arguments)},t.prototype.chown=function(e,n,a,u,l){this._rpc("chown",arguments)},t.prototype.utimes=function(e,n,a,u){this._rpc("utimes",arguments)},t.prototype.link=function(e,n,a){this._rpc("link",arguments)},t.prototype.symlink=function(e,n,a,u){this._rpc("symlink",arguments)},t.prototype.readlink=function(e,n){this._rpc("readlink",arguments)},t.prototype.syncClose=function(e,n,a){this._worker.postMessage({browserfsMessage:!0,method:e,args:[n.toRemoteArg(),this._callbackConverter.toRemoteArg(a)]})},t.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){var n=e;switch(n.type){case Ht.API_ERROR:return Nn(n);case Ht.FD:var a=n;return new Un(this,a.path,b.getFileFlag(a.flag),C.fromBuffer(Ke(a.stat)),a.id,Ke(a.data));case Ht.STATS:return An(n);case Ht.FILEFLAG:return Dn(n);case Ht.BUFFER:return Bn(n);case Ht.ERROR:return Tn(n);default:return e}}else return e;default:return e}},t.prototype._rpc=function(e,n){for(var a=this,u=new Array(n.length),l=0;l<n.length;l++)u[l]=a._argLocal2Remote(n[l]);var S={browserfsMessage:!0,method:e,args:u};this._worker.postMessage(S)},t.prototype._argLocal2Remote=function(e){if(!e)return e;switch(typeof e){case"object":return e instanceof C?On(e):e instanceof p?Jr(e):e instanceof Un?e.toRemoteArg():e instanceof b?Ln(e):e instanceof f?Cn(e):e instanceof Error?Rn(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}},t}(it);Kr.Name="WorkerFS",Kr.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(i,t){i.postMessage?t():t(new p(c.EINVAL,"option must be a Web Worker instance."))}}};function Da(i,t,r){var e=new XMLHttpRequest;e.open("GET",i,!0);var n=!0;switch(t){case"buffer":e.responseType="arraybuffer";break;case"json":try{e.responseType="json",n=e.responseType==="json"}catch{n=!1}break;default:return r(new p(c.EINVAL,"Invalid download type: "+t))}e.onreadystatechange=function(a){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":return r(null,e.response?f.from(e.response):Ct());case"json":return n?r(null,e.response):r(null,JSON.parse(e.responseText))}else return r(new p(e.status,"XHR error."))},e.send()}function Ca(i,t){var r=new XMLHttpRequest;r.open("GET",i,!1);var e=null,n=null;if(r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":var u=r.responseText;e=f.alloc(u.length);for(var l=0;l<u.length;l++)e[l]=u.charCodeAt(l);return;case"json":e=JSON.parse(r.responseText);return}else{n=new p(r.status,"XHR error.");return}},r.send(),n)throw n;return e}function Ba(i,t){var r=new XMLHttpRequest;switch(r.open("GET",i,!1),t){case"buffer":r.responseType="arraybuffer";break;case"json":break;default:throw new p(c.EINVAL,"Invalid download type: "+t)}var e,n;if(r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":e=f.from(r.response);break;case"json":e=JSON.parse(r.response);break}else n=new p(r.status,"XHR error.")},r.send(),n)throw n;return e}function Mn(i,t,r){var e=new XMLHttpRequest;e.open("HEAD",t,i),e.onreadystatechange=function(n){if(e.readyState===4)if(e.status===200)try{return r(null,parseInt(e.getResponseHeader("Content-Length")||"-1",10))}catch{return r(new p(c.EIO,"XHR HEAD error: Could not read content-length."))}else return r(new p(e.status,"XHR HEAD error."))},e.send()}var Pn=Da,Ua=St&&typeof Blob<"u"?Ba:Ca;function Ma(i){var t=-1;return Mn(!1,i,function(r,e){if(r)throw r;t=e}),t}function Pa(i,t){Mn(!0,i,t)}var _e=function(){this._index={},this.addPath("/",new pe)};_e.fromListing=function(t){var r=new _e,e=new pe;r._index["/"]=e;for(var n=[["",t,e]];n.length>0;){var a=void 0,u=n.pop(),l=u[0],S=u[1],x=u[2];for(var O in S)if(S.hasOwnProperty(O)){var D=S[O],V=l+"/"+O;D?(r._index[V]=a=new pe,n.push([V,D,a])):a=new hr(new C(L.FILE,-1,365)),x&&(x._ls[O]=a)}}return r},_e.prototype.fileIterator=function(t){var r=this;for(var e in r._index)if(r._index.hasOwnProperty(e))for(var n=r._index[e],a=n.getListing(),u=0,l=a;u<l.length;u+=1){var S=l[u],x=n.getItem(S);Ue(x)&&t(x.getData())}},_e.prototype.addPath=function(t,r){if(!r)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(this._index.hasOwnProperty(t))return this._index[t]===r;var e=this._split_path(t),n=e[0],a=e[1],u=this._index[n];return u===void 0&&t!=="/"&&(u=new pe,!this.addPath(n,u))||t!=="/"&&!u.addItem(a,r)?!1:(We(r)&&(this._index[t]=r),!0)},_e.prototype.addPathFast=function(t,r){var e=t.lastIndexOf("/"),n=e===0?"/":t.substring(0,e),a=t.substring(e+1),u=this._index[n];return u===void 0&&(u=new pe,this.addPathFast(n,u)),u.addItem(a,r)?(r.isDir()&&(this._index[t]=r),!0):!1},_e.prototype.removePath=function(t){var r=this,e=this._split_path(t),n=e[0],a=e[1],u=this._index[n];if(u===void 0)return null;var l=u.remItem(a);if(l===null)return null;if(We(l)){for(var S=l.getListing(),x=0,O=S;x<O.length;x+=1){var D=O[x];r.removePath(t+"/"+D)}t!=="/"&&delete this._index[t]}return l},_e.prototype.ls=function(t){var r=this._index[t];return r===void 0?null:r.getListing()},_e.prototype.getInode=function(t){var r=this._split_path(t),e=r[0],n=r[1],a=this._index[e];return a===void 0?null:e===t?a:a.getItem(n)},_e.prototype._split_path=function(t){var r=w.dirname(t),e=t.substr(r.length+(r==="/"?0:1));return[r,e]};var hr=function(t){this.data=t};hr.prototype.isFile=function(){return!0},hr.prototype.isDir=function(){return!1},hr.prototype.getData=function(){return this.data},hr.prototype.setData=function(t){this.data=t};var pe=function(t){t===void 0&&(t=null),this.data=t,this._ls={}};pe.prototype.isFile=function(){return!1},pe.prototype.isDir=function(){return!0},pe.prototype.getData=function(){return this.data},pe.prototype.getStats=function(){return new C(L.DIRECTORY,4096,365)},pe.prototype.getListing=function(){return Object.keys(this._ls)},pe.prototype.getItem=function(t){var r=this._ls[t];return r||null},pe.prototype.addItem=function(t,r){return t in this._ls?!1:(this._ls[t]=r,!0)},pe.prototype.remItem=function(t){var r=this._ls[t];return r===void 0?null:(delete this._ls[t],r)};function Ue(i){return!!i&&i.isFile()}function We(i){return!!i&&i.isDir()}function za(i,t,r){try{r(null,i.toString(t))}catch(e){r(e)}}var Qr=function(i){function t(r,e,n){e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),r||(r="index.json"),e.length>0&&e.charAt(e.length-1)!=="/"&&(e=e+"/"),this.prefixUrl=e;var a=null;if(typeof r=="string"){if(a=this._requestFileSync(r,"json"),!a)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else a=r;kt(n,t.Name,{index:typeof r=="string"?r:"file index as an object",baseUrl:e}),this._index=_e.fromListing(a)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?t.FromURL(e.index,n,e.baseUrl,!1):n(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},t.FromURL=function(e,n,a,u){a===void 0&&(a=e.slice(0,e.lastIndexOf("/")+1)),u===void 0&&(u=!0),u&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+e+'", baseUrl: "'+a+`" }, cb)' instead.`),Pn(e,"json",function(l,S){l?n(l):n(null,new t(S,a,!1))})},t.prototype.empty=function(){this._index.fileIterator(function(e){e.fileData=null})},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,n){n(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,n){var a=this._index.getInode(e);if(Ue(a)){if(a===null)throw p.ENOENT(e);var u=a.getData();u.size=n.length,u.fileData=n}else throw p.EISDIR(e)},t.prototype.stat=function(e,n,a){var u=this._index.getInode(e);if(u===null)return a(p.ENOENT(e));var l;Ue(u)?(l=u.getData(),l.size<0?this._requestFileSizeAsync(e,function(S,x){if(S)return a(S);l.size=x,a(null,l.clone())}):a(null,l.clone())):We(u)?(l=u.getStats(),a(null,l)):a(p.FileError(c.EINVAL,e))},t.prototype.statSync=function(e,n){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Ue(a))u=a.getData(),u.size<0&&(u.size=this._requestFileSizeSync(e));else if(We(a))u=a.getStats();else throw p.FileError(c.EINVAL,e);return u},t.prototype.open=function(e,n,a,u){if(n.isWriteable())return u(new p(c.EPERM,e));var l=this,S=this._index.getInode(e);if(S===null)return u(p.ENOENT(e));if(Ue(S)){var x=S.getData();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:return u(p.EEXIST(e));case A.NOP:if(x.fileData)return u(null,new ue(l,e,n,x.clone(),x.fileData));this._requestFileAsync(e,"buffer",function(O,D){return O?u(O):(x.size=D.length,x.fileData=D,u(null,new ue(l,e,n,x.clone(),D)))});break;default:return u(new p(c.EINVAL,"Invalid FileMode object."))}}else return u(p.EISDIR(e))},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(c.EPERM,e);var u=this._index.getInode(e);if(u===null)throw p.ENOENT(e);if(Ue(u)){var l=u.getData();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:if(l.fileData)return new ue(this,e,n,l.clone(),l.fileData);var S=this._requestFileSync(e,"buffer");return l.size=S.length,l.fileData=S,new ue(this,e,n,l.clone(),S);default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e)},t.prototype.readdir=function(e,n){try{n(null,this.readdirSync(e))}catch(a){n(a)}},t.prototype.readdirSync=function(e){var n=this._index.getInode(e);if(n===null)throw p.ENOENT(e);if(We(n))return n.getListing();throw p.ENOTDIR(e)},t.prototype.readFile=function(e,n,a,u){var l=u;this.open(e,a,420,function(S,x){if(S)return u(S);u=function(V,$){x.close(function(rt){return V||(V=rt),l(V,$)})};var O=x,D=O.getBuffer();n===null?u(S,Rt(D)):za(D,n,u)})},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var l=u,S=l.getBuffer();return n===null?Rt(S):S.toString(n)}finally{u.closeSync()}},t.prototype.getXhrPath=function(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,n,a){Pn(this.getXhrPath(e),n,a)},t.prototype._requestFileSync=function(e,n){return Ua(this.getXhrPath(e),n)},t.prototype._requestFileSizeAsync=function(e,n){Pa(this.getXhrPath(e),n)},t.prototype._requestFileSizeSync=function(e){return Ma(this.getXhrPath(e))},t}(it);Qr.Name="XmlHttpRequest",Qr.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Qe=function(){};Qe.str2byte=function(t,r){for(var e=t.length>r.length?r.length:t.length,n=0;n<e;n++){var a=t.charCodeAt(n);if(a>127){var u=Qe.extendedChars.indexOf(t.charAt(n));u>-1&&(a=u+128)}r[a]=n}return e},Qe.byte2str=function(t){for(var r=new Array(t.length),e=0;e<t.length;e++){var n=t[e];n>127?r[e]=Qe.extendedChars[n-128]:r[e]=String.fromCharCode(n)}return r.join("")},Qe.byteLength=function(t){return t.length},Qe.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var ja=s(31).inflateRaw,zn={},jn;(function(i){i[i.MSDOS=0]="MSDOS",i[i.AMIGA=1]="AMIGA",i[i.OPENVMS=2]="OPENVMS",i[i.UNIX=3]="UNIX",i[i.VM_CMS=4]="VM_CMS",i[i.ATARI_ST=5]="ATARI_ST",i[i.OS2_HPFS=6]="OS2_HPFS",i[i.MAC=7]="MAC",i[i.Z_SYSTEM=8]="Z_SYSTEM",i[i.CP_M=9]="CP_M",i[i.NTFS=10]="NTFS",i[i.MVS=11]="MVS",i[i.VSE=12]="VSE",i[i.ACORN_RISC=13]="ACORN_RISC",i[i.VFAT=14]="VFAT",i[i.ALT_MVS=15]="ALT_MVS",i[i.BEOS=16]="BEOS",i[i.TANDEM=17]="TANDEM",i[i.OS_400=18]="OS_400",i[i.OSX=19]="OSX"})(jn||(jn={}));var lr;(function(i){i[i.STORED=0]="STORED",i[i.SHRUNK=1]="SHRUNK",i[i.REDUCED_1=2]="REDUCED_1",i[i.REDUCED_2=3]="REDUCED_2",i[i.REDUCED_3=4]="REDUCED_3",i[i.REDUCED_4=5]="REDUCED_4",i[i.IMPLODE=6]="IMPLODE",i[i.DEFLATE=8]="DEFLATE",i[i.DEFLATE64=9]="DEFLATE64",i[i.TERSE_OLD=10]="TERSE_OLD",i[i.BZIP2=12]="BZIP2",i[i.LZMA=14]="LZMA",i[i.TERSE_NEW=18]="TERSE_NEW",i[i.LZ77=19]="LZ77",i[i.WAVPACK=97]="WAVPACK",i[i.PPMD=98]="PPMD"})(lr||(lr={}));function Wn(i,t){var r=t&31,e=(t>>5&15)-1,n=(t>>9)+1980,a=i&31,u=i>>5&63,l=i>>11;return new Date(n,e,r,l,u,a)}function $r(i,t,r,e){return e===0?"":t?i.toString("utf8",r,r+e):Qe.byte2str(i.slice(r,r+e))}var me=function(t){if(this.data=t,t.readUInt32LE(0)!==67324752)throw new p(c.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};me.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},me.prototype.flags=function(){return this.data.readUInt16LE(6)},me.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},me.prototype.lastModFileTime=function(){return Wn(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},me.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},me.prototype.crc32=function(){return this.data.readUInt32LE(14)},me.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},me.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},me.prototype.fileName=function(){return $r(this.data,this.useUTF8(),30,this.fileNameLength())},me.prototype.extraField=function(){var t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},me.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},me.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var Or=function(t,r,e){this.header=t,this.record=r,this.data=e};Or.prototype.decompress=function(){var t=this.header.compressionMethod(),r=zn[t];if(r)return r(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var e=lr[t];throw e||(e="Unknown: "+t),new p(c.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+e)},Or.prototype.getHeader=function(){return this.header},Or.prototype.getRecord=function(){return this.record},Or.prototype.getRawData=function(){return this.data};var Si=function(t){this.data=t};Si.prototype.crc32=function(){return this.data.readUInt32LE(0)},Si.prototype.compressedSize=function(){return this.data.readUInt32LE(4)},Si.prototype.uncompressedSize=function(){return this.data.readUInt32LE(8)};var Hn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==134630224)throw new p(c.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))};Hn.prototype.length=function(){return this.data.readUInt32LE(4)},Hn.prototype.extraFieldData=function(){return this.data.slice(8,8+this.length())};var Vn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==84233040)throw new p(c.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))};Vn.prototype.size=function(){return this.data.readUInt16LE(4)},Vn.prototype.signatureData=function(){return this.data.slice(6,6+this.size())};var Ot=function(t,r){if(this.zipData=t,this.data=r,this.data.readUInt32LE(0)!==33639248)throw new p(c.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Ot.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Ot.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Ot.prototype.flag=function(){return this.data.readUInt16LE(8)},Ot.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Ot.prototype.lastModFileTime=function(){return Wn(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Ot.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Ot.prototype.crc32=function(){return this.data.readUInt32LE(16)},Ot.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Ot.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Ot.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Ot.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Ot.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Ot.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Ot.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Ot.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Ot.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Ot.prototype.produceFilename=function(){var t=$r(this.data,this.useUTF8(),46,this.fileNameLength());return t.replace(/\\/g,"/")},Ot.prototype.fileName=function(){return this._filename},Ot.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Ot.prototype.extraField=function(){var t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},Ot.prototype.fileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return $r(this.data,this.useUTF8(),t,this.fileCommentLength())},Ot.prototype.rawFileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())},Ot.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Ot.prototype.isDirectory=function(){var t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"},Ot.prototype.isFile=function(){return!this.isDirectory()},Ot.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Ot.prototype.isEncrypted=function(){return(this.flag()&1)===1},Ot.prototype.getFileData=function(){var t=this.headerRelativeOffset(),r=new me(this.zipData.slice(t));return new Or(r,this,this.zipData.slice(t+r.totalSize()))},Ot.prototype.getData=function(){return this.getFileData().decompress()},Ot.prototype.getRawData=function(){return this.getFileData().getRawData()},Ot.prototype.getStats=function(){return new C(L.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var Ne=function(t){if(this.data=t,this.data.readUInt32LE(0)!==101010256)throw new p(c.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};Ne.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},Ne.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},Ne.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},Ne.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},Ne.prototype.cdSize=function(){return this.data.readUInt32LE(12)},Ne.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},Ne.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},Ne.prototype.cdZipComment=function(){return $r(this.data,!0,22,this.cdZipCommentLength())},Ne.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var Zn=function(t,r,e,n){this.index=t,this.directoryEntries=r,this.eocd=e,this.data=n},$e=function(i){function t(r,e,n){e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),this.name=e,this._index=new _e,this._directoryEntries=[],this._eocd=null,kt(n,t.Name,{zipData:"zip data as a Buffer",name:e}),r instanceof Zn?(this._index=r.index,this._directoryEntries=r.directoryEntries,this._eocd=r.eocd,this.data=r.data):(this.data=r,this.populateIndex())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{t.computeIndex(e.zipData,function(a){var u=new t(a,e.name,!1);n(null,u)},!1)}catch(a){n(a)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,n){zn[e]=n},t.computeIndex=function(e,n,a){a===void 0&&(a=!0),a&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var u=new _e,l=t.getEOCD(e);if(l.diskNumber()!==l.cdDiskNumber())throw new p(c.EINVAL,"ZipFS does not support spanned zip files.");var S=l.cdOffset();if(S===4294967295)throw new p(c.EINVAL,"ZipFS does not support Zip64.");var x=S+l.cdSize();t.computeIndexResponsive(e,u,S,x,n,[],l)},t.getEOCD=function(e){for(var n=22,a=Math.min(n+65535,e.length-1),u=n;u<a;u++)if(e.readUInt32LE(e.length-u)===101010256)return new Ne(e.slice(e.length-u));throw new p(c.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,n){var a=e.fileName();if(a.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");a.charAt(a.length-1)==="/"&&(a=a.substr(0,a.length-1)),e.isDirectory()?n.addPathFast("/"+a,new pe(e)):n.addPathFast("/"+a,new hr(e))},t.computeIndexResponsive=function(e,n,a,u,l,S,x){if(a<u){for(var O=0;O++<200&&a<u;){var D=new Ot(e,e.slice(a));t.addToIndex(D,n),a+=D.totalSize(),S.push(D)}mi(function(){t.computeIndexResponsive(e,n,a,u,l,S,x)})}else l(new Zn(n,S,x,e))},t.prototype.getName=function(){return t.Name+(this.name!==""?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var n=this._index.getInode(e);if(n===null)throw p.ENOENT(e);if(Ue(n))return n.getData();if(We(n))return n.getData();throw p.EPERM("Invalid inode: "+n)},t.prototype.getCentralDirectoryEntryAt=function(e){var n=this._directoryEntries[e];if(!n)throw new RangeError("Invalid directory index: "+e+".");return n},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,n){n(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,n){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Ue(a))u=a.getData().getStats();else if(We(a))u=a.getStats();else throw new p(c.EINVAL,"Invalid inode.");return u},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(c.EPERM,e);var u=this._index.getInode(e);if(u)if(Ue(u)){var l=u.getData(),S=l.getStats();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,n,S,l.getData());default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e);else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var n=this._index.getInode(e);if(n){if(We(n))return n.getListing();throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var l=u,S=l.getBuffer();return n===null?Rt(S):S.toString(n)}finally{u.closeSync()}},t.prototype.populateIndex=function(){var e=this,n=this._eocd=t.getEOCD(this.data);if(n.diskNumber()!==n.cdDiskNumber())throw new p(c.EINVAL,"ZipFS does not support spanned zip files.");var a=n.cdOffset();if(a===4294967295)throw new p(c.EINVAL,"ZipFS does not support Zip64.");for(var u=a+n.cdSize();a<u;){var l=new Ot(e.data,e.data.slice(a));a+=l.totalSize(),t.addToIndex(l,e._index),e._directoryEntries.push(l)}},t}(_t);$e.Name="ZipFS",$e.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:te},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},$e.CompressionMethod=lr,$e.RegisterDecompressionMethod(lr.DEFLATE,function(i,t,r){return It(ja(i.slice(0,t),{chunkSize:r}))}),$e.RegisterDecompressionMethod(lr.STORED,function(i,t,r){return Rt(i,0,r)});var Wa="IEEE_P1282";function de(i,t,r){return i.toString("ascii",t,t+r).trim()}function Ei(i,t,r){if(r===1)return String.fromCharCode(i[t]);for(var e=Math.floor(r/2),n=new Array(e),a=0;a<e;a++){var u=t+(a<<1);n[a]=String.fromCharCode(i[u+1]|i[u]<<8)}return n.join("")}function Re(i,t){var r=parseInt(de(i,t,4),10),e=parseInt(de(i,t+4,2),10),n=parseInt(de(i,t+6,2),10),a=parseInt(de(i,t+8,2),10),u=parseInt(de(i,t+10,2),10),l=parseInt(de(i,t+12,2),10),S=parseInt(de(i,t+14,2),10);return new Date(r,e,n,a,u,l,S*100)}function tr(i,t){var r=i[t],e=i[t+1],n=i[t+2],a=i[t+3],u=i[t+4],l=i[t+5];return new Date(r,e-1,n,a,u,l)}function Ha(i,t){var r=i.slice(t),e=new Qt(r);switch(e.signatureWord()){case 17221:return new Jn(r);case 20548:return new qa(r);case 21328:return new Kn(r);case 21332:return new Qn(r);case 17746:return new $n(r);case 17747:return new Xa(r);case 20568:return new eo(r);case 20558:return new Ya(r);case 21324:return new _i(r);case 20045:return new ro(r);case 17228:return new xi(r);case 20556:return new Ga(r);case 21061:return new io(r);case 21574:return new no(r);case 21318:return new Ja(r);case 21074:return new to(r);default:return e}}function qn(i,t,r,e){r=r-4;for(var n=new Array;t<r;){var a=Ha(i,t),u=a.length();if(u===0)return n;if(t+=u,a instanceof Qn)break;a instanceof Jn?n=n.concat(a.getEntries(e)):n.push(a)}return n}var pr=function(t){this._data=t};pr.prototype.type=function(){return this._data[0]},pr.prototype.standardIdentifier=function(){return de(this._data,1,5)},pr.prototype.version=function(){return this._data[6]},pr.prototype.data=function(){return this._data.slice(7,2048)};var Xn=function(i){function t(r){i.call(this,r),this._root=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return Re(this._data,813)},t.prototype.volumeModificationDate=function(){return Re(this._data,830)},t.prototype.volumeExpirationDate=function(){return Re(this._data,847)},t.prototype.volumeEffectiveDate=function(){return Re(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,883+512)},t.prototype.reserved=function(){return this._data.slice(1395,1395+653)},t.prototype._getString32=function(e){return this._getString(e,32)},t}(pr),Va=function(i){function t(r){if(i.call(this,r),this.type()!==1)throw new p(c.EIO,"Invalid primary volume descriptor.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new Yn(e,-1)},t.prototype._getString=function(e,n){return this._getString(e,n)},t}(Xn),Za=function(i){function t(r){if(i.call(this,r),this.type()!==2)throw new p(c.EIO,"Invalid supplementary volume descriptor.");var e=this.escapeSequence(),n=e[2];if(e[0]!==37||e[1]!==47||n!==64&&n!==67&&n!==69)throw new p(c.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+e.toString())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new Gn(e,-1)},t.prototype._getString=function(e,n){return Ei(this._data,e,n)},t}(Xn),zt=function(t,r){this._suEntries=null,this._fileOrDir=null,this._data=t,this._rockRidgeOffset=r};zt.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},zt.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},zt.prototype.rootCheckForRockRidge=function(t){var r=this.getDirectory(t);this._rockRidgeOffset=r.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},zt.prototype.length=function(){return this._data[0]},zt.prototype.extendedAttributeRecordLength=function(){return this._data[1]},zt.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},zt.prototype.dataLength=function(){return this._data.readUInt32LE(10)},zt.prototype.recordingDate=function(){return tr(this._data,18)},zt.prototype.fileFlags=function(){return this._data[25]},zt.prototype.fileUnitSize=function(){return this._data[26]},zt.prototype.interleaveGapSize=function(){return this._data[27]},zt.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},zt.prototype.identifier=function(){return this._getString(33,this._data[32])},zt.prototype.fileName=function(t){if(this.hasRockRidge()){var r=this._rockRidgeFilename(t);if(r!==null)return r}var e=this.identifier();if(this.isDirectory(t))return e;var n=e.indexOf(";");return n===-1?e:e[n-1]==="."?e.slice(0,n-1):e.slice(0,n)},zt.prototype.isDirectory=function(t){var r=!!(this.fileFlags()&2);return!r&&this.hasRockRidge()&&(r=this.getSUEntries(t).filter(function(e){return e instanceof xi}).length>0),r},zt.prototype.isSymlink=function(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(function(r){return r instanceof _i}).length>0},zt.prototype.getSymlinkPath=function(t){for(var r="",e=this.getSUEntries(t),n=this._getGetString(),a=0,u=e;a<u.length;a+=1){var l=u[a];if(l instanceof _i){for(var S=l.componentRecords(),x=0,O=S;x<O.length;x+=1){var D=O[x],V=D.flags();V&2?r+="./":V&4?r+="../":V&8?r+="/":(r+=D.content(n),V&1||(r+="/"))}if(!l.continueFlag())break}}return r.length>1&&r[r.length-1]==="/"?r.slice(0,r.length-1):r},zt.prototype.getFile=function(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},zt.prototype.getDirectory=function(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir},zt.prototype.getSUEntries=function(t){return this._suEntries||this._constructSUEntries(t),this._suEntries},zt.prototype._rockRidgeFilename=function(t){var r=this.getSUEntries(t).filter(function(S){return S instanceof ro});if(r.length===0||r[0].flags()&6)return null;for(var e="",n=this._getGetString(),a=0,u=r;a<u.length;a+=1){var l=u[a];if(e+=l.name(n),!(l.flags()&1))break}return e},zt.prototype._constructSUEntries=function(t){var r=33+this._data[32];r%2===1&&r++,r+=this._rockRidgeOffset,this._suEntries=qn(this._data,r,this.length(),t)},zt.prototype._getRockRidgeOffset=function(t){this._rockRidgeOffset=0;var r=this.getSUEntries(t);if(r.length>0){var e=r[0];if(e instanceof Kn&&e.checkBytesPass())for(var n=1;n<r.length;n++){var a=r[n];if(a instanceof to||a instanceof $n&&a.extensionIdentifier()===Wa)return e.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var Yn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,n){return de(this._data,e,n)},t.prototype._constructDirectory=function(e){return new Ka(this,e)},t.prototype._getGetString=function(){return de},t}(zt),Gn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,n){return Ei(this._data,e,n)},t.prototype._constructDirectory=function(e){return new Qa(this,e)},t.prototype._getGetString=function(){return Ei},t}(zt),Qt=function(t){this._data=t};Qt.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qt.prototype.signatureWordString=function(){return de(this._data,0,2)},Qt.prototype.length=function(){return this._data[2]},Qt.prototype.suVersion=function(){return this._data[3]};var Jn=function(i){function t(r){i.call(this,r),this._entries=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var n=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=qn(e,n,this.continuationLength(),e)}return this._entries},t}(Qt),qa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),Kn=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},t.prototype.bytesSkipped=function(){return this._data[6]},t}(Qt),Qn=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),$n=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return de(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return de(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return de(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t}(Qt),Xa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t}(Qt),to=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),eo=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t}(Qt),Ya=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t}(Qt),_i=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return this.flags()&1},t.prototype.componentRecords=function(){for(var e=this,n=new Array,a=5;a<this.length();){var u=new Ar(e._data.slice(a));n.push(u),a+=u.length()}return n},t}(Qt),Ar=function(t){this._data=t};Ar.prototype.flags=function(){return this._data[0]},Ar.prototype.length=function(){return 2+this.componentLength()},Ar.prototype.componentLength=function(){return this._data[1]},Ar.prototype.content=function(t){return t(this._data,2,this.componentLength())};var ro=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t}(Qt),xi=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),Ga=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),io=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),no=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return this.flags()&1?this._longFormDates()?Re(this._data,5):tr(this._data,5):null},t.prototype.modify=function(){if(this.flags()&2){var e=this.flags()&1?1:0;return this._longFormDates?Re(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.access=function(){if(this.flags()&4){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,this._longFormDates?Re(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.backup=function(){if(this.flags()&16){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,this._longFormDates?Re(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.expiration=function(){if(this.flags()&32){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,this._longFormDates?Re(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.effective=function(){if(this.flags()&64){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,e+=this.flags()&32?1:0,this._longFormDates?Re(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype._longFormDates=function(){return!!this.flags()},t}(Qt),Ja=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t}(Qt),Lr=function(t,r){var e=this;this._fileList=[],this._fileMap={},this._record=t;var n=t.lba(),a=n+t.dataLength();if(!(t.fileFlags()&2)){var u=t.getSUEntries(r).filter(function(O){return O instanceof xi})[0];n=u.childDirectoryLba()*2048,a=1/0}for(;n<a;){var l=r[n];if(l===0){n++;continue}var S=e._constructDirectoryRecord(r.slice(n)),x=S.fileName(r);x!=="\0"&&x!==""?(!S.hasRockRidge()||S.getSUEntries(r).filter(function(O){return O instanceof io}).length===0)&&(e._fileMap[x]=S,e._fileList.push(x)):a===1/0&&(a=n+S.dataLength()),n+=S.length()}};Lr.prototype.getRecord=function(t){return this._fileMap[t]},Lr.prototype.getFileList=function(){return this._fileList},Lr.prototype.getDotEntry=function(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))};var Ka=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Yn(e,this._record.getRockRidgeOffset())},t}(Lr),Qa=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Gn(e,this._record.getRockRidgeOffset())},t}(Lr),ti=function(i){function t(r,e,n){var a=this;e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),this._data=r,kt(n,t.Name,{data:"ISO data as a Buffer",name:e});for(var u=!1,l=16*2048,S=new Array;!u;){var x=r.slice(l),O=new pr(x);switch(O.type()){case 1:S.push(new Va(x));break;case 2:S.push(new Za(x));break;case 255:u=!0;break}l+=2048}if(S.length===0)throw new p(c.EIO,"Unable to find a suitable volume descriptor.");S.forEach(function(D){(!a._pvd||a._pvd.type()!==2)&&(a._pvd=D)}),this._root=this._pvd.rootDirectoryEntry(r),this._name=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a,u;try{a=new t(e.data,e.name,!1)}catch(l){l=l}finally{n(u,a)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,n){n(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,n){var a=this._getDirectoryRecord(e);if(a===null)throw p.ENOENT(e);return this._getStats(e,a)},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(c.EPERM,e);var u=this._getDirectoryRecord(e);if(u){if(u.isSymlink(this._data))return this.openSync(w.resolve(e,u.getSymlinkPath(this._data)),n,a);if(u.isDirectory(this._data))throw p.EISDIR(e);var l=u.getFile(this._data),S=this._getStats(e,u);switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,n,S,l);default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var n=this._getDirectoryRecord(e);if(n){if(n.isDirectory(this._data))return n.getDirectory(this._data).getFileList().slice(0);throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var l=u,S=l.getBuffer();return n===null?Rt(S):S.toString(n)}finally{u.closeSync()}},t.prototype._getDirectoryRecord=function(e){var n=this;if(e==="/")return this._root;for(var a=e.split("/").slice(1),u=this._root,l=0,S=a;l<S.length;l+=1){var x=S[l];if(u.isDirectory(n._data)){if(u=u.getDirectory(n._data).getRecord(x),!u)return null}else return null}return u},t.prototype._getStats=function(e,n){if(n.isSymlink(this._data)){var a=w.resolve(e,n.getSymlinkPath(this._data)),u=this._getDirectoryRecord(a);return u?this._getStats(a,u):null}else{var l=n.dataLength(),S=365,x=n.recordingDate(),O=x,D=x,V=x;if(n.hasRockRidge())for(var $=n.getSUEntries(this._data),rt=0,ft=$;rt<ft.length;rt+=1){var yt=ft[rt];if(yt instanceof eo)S=yt.mode();else if(yt instanceof no){var Ft=yt.flags();Ft&4&&(O=yt.access()),Ft&2&&(D=yt.modify()),Ft&1&&(V=yt.creation())}}return S=S&365,new C(n.isDirectory(this._data)?L.DIRECTORY:L.FILE,l,S,O,D,V)}},t}(_t);ti.Name="IsoFS",ti.Options={data:{type:"object",description:"The ISO file in a buffer",validator:te}},[I,Wr,Hr,ar,Zr,ur,Fr,ti,br,fr,Tr,Kr,Qr,$e].forEach(function(i){var t=i.Create;i.Create=function(r,e){var n=typeof r=="function",a=n?r:e,u=n?{}:r;function l(S){S?a(S):t.call(i,u,a)}N(i,u,l)}});var ei={AsyncMirror:I,Dropbox:Wr,Emscripten:Hr,FolderAdapter:ar,HTML5FS:Zr,InMemory:ur,IndexedDB:Fr,IsoFS:ti,LocalStorage:br,MountableFileSystem:fr,OverlayFS:Tr,WorkerFS:Kr,XmlHttpRequest:Qr,ZipFS:$e};m.initializeTTYs&&m.initializeTTYs();function $a(i){i.Buffer=f,i.process=m;var t=i.require?i.require:null;i.require=function(r){var e=oo(r);return e||t.apply(null,Array.prototype.slice.call(arguments,0))}}function tu(i,t){ei[i]=t}function oo(i){switch(i){case"fs":return ct;case"path":return w;case"buffer":return E;case"process":return m;case"bfs_utils":return R;default:return ei[i]}}function so(i){return ct.initialize(i)}function eu(i,t){Fi(i,function(r,e){e?(so(e),t()):t(r)})}function Fi(i,t){var r=i.fs;if(!r)return t(new p(c.EPERM,'Missing "fs" property on configuration object.'));var e=i.options,n=0,a=!1;function u(){if(!a){a=!0;var x=ei[r];x?x.Create(e,t):t(new p(c.EPERM,"File system "+r+" is not available in BrowserFS."))}}if(e!==null&&typeof e=="object"){var l=!1,S=Object.keys(e).filter(function(x){return x!=="fs"});S.forEach(function(x){var O=e[x];O!==null&&typeof O=="object"&&O.fs&&(n++,Fi(O,function(D,V){if(n--,D){if(a)return;a=!0,t(D)}else e[x]=V,n===0&&l&&u()}))}),l=!0}n===0&&u()}"ab".substr(-1)!=="b"&&(String.prototype.substr=function(i){return function(t,r){return t<0&&(t=this.length+t),i.call(this,t,r)}}(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(i,t){i===void 0&&(i=0),t===void 0&&(t=this.length);var r=this;return i<0&&(i=this.length+i,i<0&&(i=0)),t<0&&(t=this.length+t,t<0&&(t=0)),t<i&&(t=i),new Uint8Array(r.buffer,r.byteOffset+i,t-i)})),o.install=$a,o.registerFileSystem=tu,o.BFSRequire=oo,o.initialize=so,o.configure=eu,o.getFileSystem=Fi,o.EmscriptenFS=lt,o.FileSystem=ei,o.Errors=T,o.setImmediate=mi}).call(o,s(1),function(){return this}(),s(5)(h),s(6))},function(h,o,s){h.exports=s(2).Buffer},function(h,o,s){(function(c){"use strict";var y=s(3),d=s(4);o.Buffer=c,o.SlowBuffer=U,o.INSPECT_MAX_BYTES=50;var m=2147483647;o.kMaxLength=m,c.TYPED_ARRAY_SUPPORT=E(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function E(){try{var I=new Uint8Array(1);return I.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},I.foo()===42}catch{return!1}}function w(I){if(I>m)throw new RangeError("Invalid typed array length");var g=new Uint8Array(I);return g.__proto__=c.prototype,g}function c(I,g,v){if(typeof I=="number"){if(typeof g=="string")throw new Error("If encoding is specified then the first argument must be a string");return A(I)}return _(I,g,v)}typeof Symbol<"u"&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192;function _(I,g,v){if(typeof I=="number")throw new TypeError('"value" argument must not be a number');return Yt(I)?C(I,g,v):typeof I=="string"?b(I,g):G(I)}c.from=function(I,g,v){return _(I,g,v)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array;function p(I){if(typeof I!="number")throw new TypeError('"size" argument must be a number');if(I<0)throw new RangeError('"size" argument must not be negative')}function T(I,g,v){return p(I),I<=0?w(I):g!==void 0?typeof v=="string"?w(I).fill(g,v):w(I).fill(g):w(I)}c.alloc=function(I,g,v){return T(I,g,v)};function A(I){return p(I),w(I<0?0:W(I)|0)}c.allocUnsafe=function(I){return A(I)},c.allocUnsafeSlow=function(I){return A(I)};function b(I,g){if((typeof g!="string"||g==="")&&(g="utf8"),!c.isEncoding(g))throw new TypeError('"encoding" must be a valid string encoding');var v=Et(I,g)|0,k=w(v),B=k.write(I,g);return B!==v&&(k=k.slice(0,B)),k}function L(I){for(var g=I.length<0?0:W(I.length)|0,v=w(g),k=0;k<g;k+=1)v[k]=I[k]&255;return v}function C(I,g,v){if(g<0||I.byteLength<g)throw new RangeError("'offset' is out of bounds");if(I.byteLength<g+(v||0))throw new RangeError("'length' is out of bounds");var k;return g===void 0&&v===void 0?k=new Uint8Array(I):v===void 0?k=new Uint8Array(I,g):k=new Uint8Array(I,g,v),k.__proto__=c.prototype,k}function G(I){if(c.isBuffer(I)){var g=W(I.length)|0,v=w(g);return v.length===0||I.copy(v,0,0,g),v}if(I){if(ue(I)||"length"in I)return typeof I.length!="number"||Fe(I.length)?w(0):L(I);if(I.type==="Buffer"&&Array.isArray(I.data))return L(I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function W(I){if(I>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return I|0}function U(I){return+I!=I&&(I=0),c.alloc(+I)}c.isBuffer=function(g){return g!=null&&g._isBuffer===!0},c.compare=function(g,v){if(!c.isBuffer(g)||!c.isBuffer(v))throw new TypeError("Arguments must be Buffers");if(g===v)return 0;for(var k=g.length,B=v.length,Z=0,J=Math.min(k,B);Z<J;++Z)if(g[Z]!==v[Z]){k=g[Z],B=v[Z];break}return k<B?-1:B<k?1:0},c.isEncoding=function(g){switch(String(g).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(g,v){if(!Array.isArray(g))throw new TypeError('"list" argument must be an Array of Buffers');if(g.length===0)return c.alloc(0);var k;if(v===void 0)for(v=0,k=0;k<g.length;++k)v+=g[k].length;var B=c.allocUnsafe(v),Z=0;for(k=0;k<g.length;++k){var J=g[k];if(!c.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(B,Z),Z+=J.length}return B};function Et(I,g){if(c.isBuffer(I))return I.length;if(ue(I)||Yt(I))return I.byteLength;typeof I!="string"&&(I=""+I);var v=I.length;if(v===0)return 0;for(var k=!1;;)switch(g){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":case void 0:return Q(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return _t(I).length;default:if(k)return Q(I).length;g=(""+g).toLowerCase(),k=!0}}c.byteLength=Et;function et(I,g,v){var k=!1;if((g===void 0||g<0)&&(g=0),g>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,g>>>=0,v<=g))return"";for(I||(I="utf8");;)switch(I){case"hex":return It(this,g,v);case"utf8":case"utf-8":return Xt(this,g,v);case"ascii":return K(this,g,v);case"latin1":case"binary":return ut(this,g,v);case"base64":return St(this,g,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,g,v);default:if(k)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),k=!0}}c.prototype._isBuffer=!0;function wt(I,g,v){var k=I[g];I[g]=I[v],I[v]=k}c.prototype.swap16=function(){var g=this.length;if(g%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var v=0;v<g;v+=2)wt(this,v,v+1);return this},c.prototype.swap32=function(){var g=this.length;if(g%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var v=0;v<g;v+=4)wt(this,v,v+3),wt(this,v+1,v+2);return this},c.prototype.swap64=function(){var g=this.length;if(g%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var v=0;v<g;v+=8)wt(this,v,v+7),wt(this,v+1,v+6),wt(this,v+2,v+5),wt(this,v+3,v+4);return this},c.prototype.toString=function(){var g=this.length;return g===0?"":arguments.length===0?Xt(this,0,g):et.apply(this,arguments)},c.prototype.equals=function(g){if(!c.isBuffer(g))throw new TypeError("Argument must be a Buffer");return this===g?!0:c.compare(this,g)===0},c.prototype.inspect=function(){var g="",v=o.INSPECT_MAX_BYTES;return this.length>0&&(g=this.toString("hex",0,v).match(/.{2}/g).join(" "),this.length>v&&(g+=" ... ")),"<Buffer "+g+">"},c.prototype.compare=function(g,v,k,B,Z){if(!c.isBuffer(g))throw new TypeError("Argument must be a Buffer");if(v===void 0&&(v=0),k===void 0&&(k=g?g.length:0),B===void 0&&(B=0),Z===void 0&&(Z=this.length),v<0||k>g.length||B<0||Z>this.length)throw new RangeError("out of range index");if(B>=Z&&v>=k)return 0;if(B>=Z)return-1;if(v>=k)return 1;if(v>>>=0,k>>>=0,B>>>=0,Z>>>=0,this===g)return 0;for(var J=Z-B,bt=k-v,At=Math.min(J,bt),Bt=this.slice(B,Z),Gt=g.slice(v,k),Dt=0;Dt<At;++Dt)if(Bt[Dt]!==Gt[Dt]){J=Bt[Dt],bt=Gt[Dt];break}return J<bt?-1:bt<J?1:0};function pt(I,g,v,k,B){if(I.length===0)return-1;if(typeof v=="string"?(k=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,Fe(v)&&(v=B?0:I.length-1),v<0&&(v=I.length+v),v>=I.length){if(B)return-1;v=I.length-1}else if(v<0)if(B)v=0;else return-1;if(typeof g=="string"&&(g=c.from(g,k)),c.isBuffer(g))return g.length===0?-1:M(I,g,v,k,B);if(typeof g=="number")return g=g&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(I,g,v):Uint8Array.prototype.lastIndexOf.call(I,g,v):M(I,[g],v,k,B);throw new TypeError("val must be string, number or Buffer")}function M(I,g,v,k,B){var Z=1,J=I.length,bt=g.length;if(k!==void 0&&(k=String(k).toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(I.length<2||g.length<2)return-1;Z=2,J/=2,bt/=2,v/=2}function At(nr,Ve){return Z===1?nr[Ve]:nr.readUInt16BE(Ve*Z)}var Bt;if(B){var Gt=-1;for(Bt=v;Bt<J;Bt++)if(At(I,Bt)===At(g,Gt===-1?0:Bt-Gt)){if(Gt===-1&&(Gt=Bt),Bt-Gt+1===bt)return Gt*Z}else Gt!==-1&&(Bt-=Bt-Gt),Gt=-1}else for(v+bt>J&&(v=J-bt),Bt=v;Bt>=0;Bt--){for(var Dt=!0,Ie=0;Ie<bt;Ie++)if(At(I,Bt+Ie)!==At(g,Ie)){Dt=!1;break}if(Dt)return Bt}return-1}c.prototype.includes=function(g,v,k){return this.indexOf(g,v,k)!==-1},c.prototype.indexOf=function(g,v,k){return pt(this,g,v,k,!0)},c.prototype.lastIndexOf=function(g,v,k){return pt(this,g,v,k,!1)};function tt(I,g,v,k){v=Number(v)||0;var B=I.length-v;k?(k=Number(k),k>B&&(k=B)):k=B;var Z=g.length;if(Z%2!==0)throw new TypeError("Invalid hex string");k>Z/2&&(k=Z/2);for(var J=0;J<k;++J){var bt=parseInt(g.substr(J*2,2),16);if(Fe(bt))return J;I[v+J]=bt}return J}function ct(I,g,v,k){return gt(Q(g,I.length-v),I,v,k)}function Nt(I,g,v,k){return gt(lt(g),I,v,k)}function dt(I,g,v,k){return Nt(I,g,v,k)}function Lt(I,g,v,k){return gt(_t(g),I,v,k)}function kt(I,g,v,k){return gt(it(g,I.length-v),I,v,k)}c.prototype.write=function(g,v,k,B){if(v===void 0)B="utf8",k=this.length,v=0;else if(k===void 0&&typeof v=="string")B=v,k=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(k)?(k=k>>>0,B===void 0&&(B="utf8")):(B=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Z=this.length-v;if((k===void 0||k>Z)&&(k=Z),g.length>0&&(k<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");for(var J=!1;;)switch(B){case"hex":return tt(this,g,v,k);case"utf8":case"utf-8":return ct(this,g,v,k);case"ascii":return Nt(this,g,v,k);case"latin1":case"binary":return dt(this,g,v,k);case"base64":return Lt(this,g,v,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return kt(this,g,v,k);default:if(J)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),J=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function St(I,g,v){return g===0&&v===I.length?y.fromByteArray(I):y.fromByteArray(I.slice(g,v))}function Xt(I,g,v){v=Math.min(I.length,v);for(var k=[],B=g;B<v;){var Z=I[B],J=null,bt=Z>239?4:Z>223?3:Z>191?2:1;if(B+bt<=v){var At,Bt,Gt,Dt;switch(bt){case 1:Z<128&&(J=Z);break;case 2:At=I[B+1],(At&192)===128&&(Dt=(Z&31)<<6|At&63,Dt>127&&(J=Dt));break;case 3:At=I[B+1],Bt=I[B+2],(At&192)===128&&(Bt&192)===128&&(Dt=(Z&15)<<12|(At&63)<<6|Bt&63,Dt>2047&&(Dt<55296||Dt>57343)&&(J=Dt));break;case 4:At=I[B+1],Bt=I[B+2],Gt=I[B+3],(At&192)===128&&(Bt&192)===128&&(Gt&192)===128&&(Dt=(Z&15)<<18|(At&63)<<12|(Bt&63)<<6|Gt&63,Dt>65535&&Dt<1114112&&(J=Dt))}}J===null?(J=65533,bt=1):J>65535&&(J-=65536,k.push(J>>>10&1023|55296),J=56320|J&1023),k.push(J),B+=bt}return z(k)}var P=4096;function z(I){var g=I.length;if(g<=P)return String.fromCharCode.apply(String,I);for(var v="",k=0;k<g;)v+=String.fromCharCode.apply(String,I.slice(k,k+=P));return v}function K(I,g,v){var k="";v=Math.min(I.length,v);for(var B=g;B<v;++B)k+=String.fromCharCode(I[B]&127);return k}function ut(I,g,v){var k="";v=Math.min(I.length,v);for(var B=g;B<v;++B)k+=String.fromCharCode(I[B]);return k}function It(I,g,v){var k=I.length;(!g||g<0)&&(g=0),(!v||v<0||v>k)&&(v=k);for(var B="",Z=g;Z<v;++Z)B+=Y(I[Z]);return B}function vt(I,g,v){for(var k=I.slice(g,v),B="",Z=0;Z<k.length;Z+=2)B+=String.fromCharCode(k[Z]+k[Z+1]*256);return B}c.prototype.slice=function(g,v){var k=this.length;g=~~g,v=v===void 0?k:~~v,g<0?(g+=k,g<0&&(g=0)):g>k&&(g=k),v<0?(v+=k,v<0&&(v=0)):v>k&&(v=k),v<g&&(v=g);var B=this.subarray(g,v);return B.__proto__=c.prototype,B};function xt(I,g,v){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+g>v)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g],Z=1,J=0;++J<v&&(Z*=256);)B+=this[g+J]*Z;return B},c.prototype.readUIntBE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g+--v],Z=1;v>0&&(Z*=256);)B+=this[g+--v]*Z;return B},c.prototype.readUInt8=function(g,v){return g=g>>>0,v||xt(g,1,this.length),this[g]},c.prototype.readUInt16LE=function(g,v){return g=g>>>0,v||xt(g,2,this.length),this[g]|this[g+1]<<8},c.prototype.readUInt16BE=function(g,v){return g=g>>>0,v||xt(g,2,this.length),this[g]<<8|this[g+1]},c.prototype.readUInt32LE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),(this[g]|this[g+1]<<8|this[g+2]<<16)+this[g+3]*16777216},c.prototype.readUInt32BE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]*16777216+(this[g+1]<<16|this[g+2]<<8|this[g+3])},c.prototype.readIntLE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g],Z=1,J=0;++J<v&&(Z*=256);)B+=this[g+J]*Z;return Z*=128,B>=Z&&(B-=Math.pow(2,8*v)),B},c.prototype.readIntBE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=v,Z=1,J=this[g+--B];B>0&&(Z*=256);)J+=this[g+--B]*Z;return Z*=128,J>=Z&&(J-=Math.pow(2,8*v)),J},c.prototype.readInt8=function(g,v){return g=g>>>0,v||xt(g,1,this.length),this[g]&128?(255-this[g]+1)*-1:this[g]},c.prototype.readInt16LE=function(g,v){g=g>>>0,v||xt(g,2,this.length);var k=this[g]|this[g+1]<<8;return k&32768?k|4294901760:k},c.prototype.readInt16BE=function(g,v){g=g>>>0,v||xt(g,2,this.length);var k=this[g+1]|this[g]<<8;return k&32768?k|4294901760:k},c.prototype.readInt32LE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]|this[g+1]<<8|this[g+2]<<16|this[g+3]<<24},c.prototype.readInt32BE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]<<24|this[g+1]<<16|this[g+2]<<8|this[g+3]},c.prototype.readFloatLE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),d.read(this,g,!0,23,4)},c.prototype.readFloatBE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),d.read(this,g,!1,23,4)},c.prototype.readDoubleLE=function(g,v){return g=g>>>0,v||xt(g,8,this.length),d.read(this,g,!0,52,8)},c.prototype.readDoubleBE=function(g,v){return g=g>>>0,v||xt(g,8,this.length),d.read(this,g,!1,52,8)};function Rt(I,g,v,k,B,Z){if(!c.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>B||g<Z)throw new RangeError('"value" argument is out of bounds');if(v+k>I.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function(g,v,k,B){if(g=+g,v=v>>>0,k=k>>>0,!B){var Z=Math.pow(2,8*k)-1;Rt(this,g,v,k,Z,0)}var J=1,bt=0;for(this[v]=g&255;++bt<k&&(J*=256);)this[v+bt]=g/J&255;return v+k},c.prototype.writeUIntBE=function(g,v,k,B){if(g=+g,v=v>>>0,k=k>>>0,!B){var Z=Math.pow(2,8*k)-1;Rt(this,g,v,k,Z,0)}var J=k-1,bt=1;for(this[v+J]=g&255;--J>=0&&(bt*=256);)this[v+J]=g/bt&255;return v+k},c.prototype.writeUInt8=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,1,255,0),this[v]=g&255,v+1},c.prototype.writeUInt16LE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,2,65535,0),this[v]=g&255,this[v+1]=g>>>8,v+2},c.prototype.writeUInt16BE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,2,65535,0),this[v]=g>>>8,this[v+1]=g&255,v+2},c.prototype.writeUInt32LE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,4,4294967295,0),this[v+3]=g>>>24,this[v+2]=g>>>16,this[v+1]=g>>>8,this[v]=g&255,v+4},c.prototype.writeUInt32BE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,4,4294967295,0),this[v]=g>>>24,this[v+1]=g>>>16,this[v+2]=g>>>8,this[v+3]=g&255,v+4},c.prototype.writeIntLE=function(g,v,k,B){if(g=+g,v=v>>>0,!B){var Z=Math.pow(2,8*k-1);Rt(this,g,v,k,Z-1,-Z)}var J=0,bt=1,At=0;for(this[v]=g&255;++J<k&&(bt*=256);)g<0&&At===0&&this[v+J-1]!==0&&(At=1),this[v+J]=(g/bt>>0)-At&255;return v+k},c.prototype.writeIntBE=function(g,v,k,B){if(g=+g,v=v>>>0,!B){var Z=Math.pow(2,8*k-1);Rt(this,g,v,k,Z-1,-Z)}var J=k-1,bt=1,At=0;for(this[v+J]=g&255;--J>=0&&(bt*=256);)g<0&&At===0&&this[v+J+1]!==0&&(At=1),this[v+J]=(g/bt>>0)-At&255;return v+k},c.prototype.writeInt8=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,1,127,-128),g<0&&(g=255+g+1),this[v]=g&255,v+1},c.prototype.writeInt16LE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,2,32767,-32768),this[v]=g&255,this[v+1]=g>>>8,v+2},c.prototype.writeInt16BE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,2,32767,-32768),this[v]=g>>>8,this[v+1]=g&255,v+2},c.prototype.writeInt32LE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,4,2147483647,-2147483648),this[v]=g&255,this[v+1]=g>>>8,this[v+2]=g>>>16,this[v+3]=g>>>24,v+4},c.prototype.writeInt32BE=function(g,v,k){return g=+g,v=v>>>0,k||Rt(this,g,v,4,2147483647,-2147483648),g<0&&(g=4294967295+g+1),this[v]=g>>>24,this[v+1]=g>>>16,this[v+2]=g>>>8,this[v+3]=g&255,v+4};function jt(I,g,v,k,B,Z){if(v+k>I.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function Ct(I,g,v,k,B){return g=+g,v=v>>>0,B||jt(I,g,v,4,34028234663852886e22,-34028234663852886e22),d.write(I,g,v,k,23,4),v+4}c.prototype.writeFloatLE=function(g,v,k){return Ct(this,g,v,!0,k)},c.prototype.writeFloatBE=function(g,v,k){return Ct(this,g,v,!1,k)};function te(I,g,v,k,B){return g=+g,v=v>>>0,B||jt(I,g,v,8,17976931348623157e292,-17976931348623157e292),d.write(I,g,v,k,52,8),v+8}c.prototype.writeDoubleLE=function(g,v,k){return te(this,g,v,!0,k)},c.prototype.writeDoubleBE=function(g,v,k){return te(this,g,v,!1,k)},c.prototype.copy=function(g,v,k,B){if(k||(k=0),!B&&B!==0&&(B=this.length),v>=g.length&&(v=g.length),v||(v=0),B>0&&B<k&&(B=k),B===k||g.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("sourceStart out of bounds");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),g.length-v<B-k&&(B=g.length-v+k);var Z=B-k,J;if(this===g&&k<v&&v<B)for(J=Z-1;J>=0;--J)g[J+v]=this[J+k];else if(Z<1e3)for(J=0;J<Z;++J)g[J+v]=this[J+k];else Uint8Array.prototype.set.call(g,this.subarray(k,k+Z),v);return Z},c.prototype.fill=function(g,v,k,B){if(typeof g=="string"){if(typeof v=="string"?(B=v,v=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),g.length===1){var Z=g.charCodeAt(0);Z<256&&(g=Z)}if(B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!c.isEncoding(B))throw new TypeError("Unknown encoding: "+B)}else typeof g=="number"&&(g=g&255);if(v<0||this.length<v||this.length<k)throw new RangeError("Out of range index");if(k<=v)return this;v=v>>>0,k=k===void 0?this.length:k>>>0,g||(g=0);var J;if(typeof g=="number")for(J=v;J<k;++J)this[J]=g;else{var bt=c.isBuffer(g)?g:new c(g,B),At=bt.length;for(J=0;J<k-v;++J)this[J+v]=bt[J%At]}return this};var N=/[^+/0-9A-Za-z-_]/g;function R(I){if(I=I.trim().replace(N,""),I.length<2)return"";for(;I.length%4!==0;)I=I+"=";return I}function Y(I){return I<16?"0"+I.toString(16):I.toString(16)}function Q(I,g){g=g||1/0;for(var v,k=I.length,B=null,Z=[],J=0;J<k;++J){if(v=I.charCodeAt(J),v>55295&&v<57344){if(!B){if(v>56319){(g-=3)>-1&&Z.push(239,191,189);continue}else if(J+1===k){(g-=3)>-1&&Z.push(239,191,189);continue}B=v;continue}if(v<56320){(g-=3)>-1&&Z.push(239,191,189),B=v;continue}v=(B-55296<<10|v-56320)+65536}else B&&(g-=3)>-1&&Z.push(239,191,189);if(B=null,v<128){if((g-=1)<0)break;Z.push(v)}else if(v<2048){if((g-=2)<0)break;Z.push(v>>6|192,v&63|128)}else if(v<65536){if((g-=3)<0)break;Z.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((g-=4)<0)break;Z.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return Z}function lt(I){for(var g=[],v=0;v<I.length;++v)g.push(I.charCodeAt(v)&255);return g}function it(I,g){for(var v,k,B,Z=[],J=0;J<I.length&&!((g-=2)<0);++J)v=I.charCodeAt(J),k=v>>8,B=v%256,Z.push(B),Z.push(k);return Z}function _t(I){return y.toByteArray(R(I))}function gt(I,g,v,k){for(var B=0;B<k&&!(B+v>=g.length||B>=I.length);++B)g[B+v]=I[B];return B}function Yt(I){return I instanceof ArrayBuffer||I!=null&&I.constructor!=null&&I.constructor.name==="ArrayBuffer"&&typeof I.byteLength=="number"}function ue(I){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(I)}function Fe(I){return I!==I}}).call(o,s(1))},function(h,o){"use strict";o.byteLength=c,o.toByteArray=_,o.fromByteArray=A;for(var s=[],f=[],y=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,E=d.length;m<E;++m)s[m]=d[m],f[d.charCodeAt(m)]=m;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63;function w(b){var L=b.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return b[L-2]==="="?2:b[L-1]==="="?1:0}function c(b){return b.length*3/4-w(b)}function _(b){var L,C,G,W,U,Et,et=b.length;U=w(b),Et=new y(et*3/4-U),G=U>0?et-4:et;var wt=0;for(L=0,C=0;L<G;L+=4,C+=3)W=f[b.charCodeAt(L)]<<18|f[b.charCodeAt(L+1)]<<12|f[b.charCodeAt(L+2)]<<6|f[b.charCodeAt(L+3)],Et[wt++]=W>>16&255,Et[wt++]=W>>8&255,Et[wt++]=W&255;return U===2?(W=f[b.charCodeAt(L)]<<2|f[b.charCodeAt(L+1)]>>4,Et[wt++]=W&255):U===1&&(W=f[b.charCodeAt(L)]<<10|f[b.charCodeAt(L+1)]<<4|f[b.charCodeAt(L+2)]>>2,Et[wt++]=W>>8&255,Et[wt++]=W&255),Et}function p(b){return s[b>>18&63]+s[b>>12&63]+s[b>>6&63]+s[b&63]}function T(b,L,C){for(var G,W=[],U=L;U<C;U+=3)G=(b[U]<<16)+(b[U+1]<<8)+b[U+2],W.push(p(G));return W.join("")}function A(b){for(var L,C=b.length,G=C%3,W="",U=[],Et=16383,et=0,wt=C-G;et<wt;et+=Et)U.push(T(b,et,et+Et>wt?wt:et+Et));return G===1?(L=b[C-1],W+=s[L>>2],W+=s[L<<4&63],W+="=="):G===2&&(L=(b[C-2]<<8)+b[C-1],W+=s[L>>10],W+=s[L>>4&63],W+=s[L<<2&63],W+="="),U.push(W),U.join("")}},function(h,o){o.read=function(s,f,y,d,m){var E,w,c=m*8-d-1,_=(1<<c)-1,p=_>>1,T=-7,A=y?m-1:0,b=y?-1:1,L=s[f+A];for(A+=b,E=L&(1<<-T)-1,L>>=-T,T+=c;T>0;E=E*256+s[f+A],A+=b,T-=8);for(w=E&(1<<-T)-1,E>>=-T,T+=d;T>0;w=w*256+s[f+A],A+=b,T-=8);if(E===0)E=1-p;else{if(E===_)return w?NaN:(L?-1:1)*(1/0);w=w+Math.pow(2,d),E=E-p}return(L?-1:1)*w*Math.pow(2,E-d)},o.write=function(s,f,y,d,m,E){var w,c,_,p=E*8-m-1,T=(1<<p)-1,A=T>>1,b=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=d?0:E-1,C=d?1:-1,G=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(c=isNaN(f)?1:0,w=T):(w=Math.floor(Math.log(f)/Math.LN2),f*(_=Math.pow(2,-w))<1&&(w--,_*=2),w+A>=1?f+=b/_:f+=b*Math.pow(2,1-A),f*_>=2&&(w++,_/=2),w+A>=T?(c=0,w=T):w+A>=1?(c=(f*_-1)*Math.pow(2,m),w=w+A):(c=f*Math.pow(2,A-1)*Math.pow(2,m),w=0));m>=8;s[y+L]=c&255,L+=C,c/=256,m-=8);for(w=w<<m|c,p+=m;p>0;s[y+L]=w&255,L+=C,w/=256,p-=8);s[y+L-C]|=G*128}},function(h,o){h.exports=function(s){return s.webpackPolyfill||(s.deprecate=function(){},s.paths=[],s.children=[],s.webpackPolyfill=1),s}},function(h,o,s){"use strict";var f=s(7),y=new f,d={};function m(w){d[w]||(typeof y[w]=="function"?d[w]=function(){return y[w].apply(y,arguments)}:d[w]=y[w])}for(var E in y)m(E);d.initializeTTYs=function(){y.stdin===null&&(y.initializeTTYs(),d.stdin=y.stdin,d.stdout=y.stdout,d.stderr=y.stderr)},y.nextTick(function(){d.initializeTTYs()}),h.exports=d},function(h,o,s){(function(f){"use strict";var y=this&&this.__extends||function(_,p){for(var T in p)p.hasOwnProperty(T)&&(_[T]=p[T]);function A(){this.constructor=_}_.prototype=p===null?Object.create(p):(A.prototype=p.prototype,new A)},d=s(8),m=null,E=function(){function _(p,T){this.fun=p,this.array=T}return _.prototype.run=function(){this.fun.apply(null,this.array)},_}(),w=function(){function _(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return _.prototype.push=function(p){var T=this;this._queue.push(p)===1&&!this._draining&&setTimeout(function(){return T._drainQueue()},0)},_.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},_.prototype._drainQueue=function(){var p=this;if(!this._draining){var T=setTimeout(function(){return p._cleanUpNextTick()});this._draining=!0;for(var A=this._queue.length;A;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<A;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,A=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(T)}},_}(),c=function(_){y(p,_);function p(){_.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new w,this.execPath=f,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return p.prototype.chdir=function(T){m===null&&(m=s(9)),this._cwd=m.resolve(T)},p.prototype.cwd=function(){return this._cwd},p.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},p.prototype.nextTick=function(T){for(var A=[],b=1;b<arguments.length;b++)A[b-1]=arguments[b];this._queue.push(new E(T,A))},p.prototype.abort=function(){this.emit("abort")},p.prototype.exit=function(T){this.exitCode=T,this.emit("exit",[T])},p.prototype.getgid=function(){return this._gid},p.prototype.setgid=function(T){typeof T=="number"?this._gid=T:this._gid=1},p.prototype.getuid=function(){return this._uid},p.prototype.setuid=function(T){typeof T=="number"?this._uid=T:this._uid=1},p.prototype.kill=function(T,A){this.emit("kill",[T,A])},p.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},p.prototype.umask=function(T){T===void 0&&(T=this._mask);var A=this._mask;return this._mask=T,this.emit("umask",[T]),A},p.prototype.hrtime=function(){var T;typeof performance<"u"?T=performance.now():Date.now?T=Date.now():T=new Date().getTime();var A=T/1e3|0;return T-=A*1e3,T=T*1e6|0,[A,T]},p.prototype.initializeTTYs=function(){if(this.stdout===null){var T=s(10);this.stdout=new T,this.stderr=new T,this.stdin=new T}},p.prototype.disconnect=function(){},p}(d.EventEmitter);h.exports=c}).call(o,"/")},function(h,o){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}h.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(E){if(!y(E)||E<0||isNaN(E))throw TypeError("n must be a positive number");return this._maxListeners=E,this},s.prototype.emit=function(E){var w,c,_,p,T,A;if(this._events||(this._events={}),E==="error"&&(!this._events.error||d(this._events.error)&&!this._events.error.length)){if(w=arguments[1],w instanceof Error)throw w;var b=new Error('Uncaught, unspecified "error" event. ('+w+")");throw b.context=w,b}if(c=this._events[E],m(c))return!1;if(f(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),c.apply(this,p)}else if(d(c))for(p=Array.prototype.slice.call(arguments,1),A=c.slice(),_=A.length,T=0;T<_;T++)A[T].apply(this,p);return!0},s.prototype.addListener=function(E,w){var c;if(!f(w))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",E,f(w.listener)?w.listener:w),this._events[E]?d(this._events[E])?this._events[E].push(w):this._events[E]=[this._events[E],w]:this._events[E]=w,d(this._events[E])&&!this._events[E].warned&&(m(this._maxListeners)?c=s.defaultMaxListeners:c=this._maxListeners,c&&c>0&&this._events[E].length>c&&(this._events[E].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[E].length),typeof console.trace=="function"&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(E,w){if(!f(w))throw TypeError("listener must be a function");var c=!1;function _(){this.removeListener(E,_),c||(c=!0,w.apply(this,arguments))}return _.listener=w,this.on(E,_),this},s.prototype.removeListener=function(E,w){var c,_,p,T;if(!f(w))throw TypeError("listener must be a function");if(!this._events||!this._events[E])return this;if(c=this._events[E],p=c.length,_=-1,c===w||f(c.listener)&&c.listener===w)delete this._events[E],this._events.removeListener&&this.emit("removeListener",E,w);else if(d(c)){for(T=p;T-- >0;)if(c[T]===w||c[T].listener&&c[T].listener===w){_=T;break}if(_<0)return this;c.length===1?(c.length=0,delete this._events[E]):c.splice(_,1),this._events.removeListener&&this.emit("removeListener",E,w)}return this},s.prototype.removeAllListeners=function(E){var w,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[E]&&delete this._events[E],this;if(arguments.length===0){for(w in this._events)w!=="removeListener"&&this.removeAllListeners(w);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[E],f(c))this.removeListener(E,c);else if(c)for(;c.length;)this.removeListener(E,c[c.length-1]);return delete this._events[E],this},s.prototype.listeners=function(E){var w;return!this._events||!this._events[E]?w=[]:f(this._events[E])?w=[this._events[E]]:w=this._events[E].slice(),w},s.prototype.listenerCount=function(E){if(this._events){var w=this._events[E];if(f(w))return 1;if(w)return w.length}return 0},s.listenerCount=function(E,w){return E.listenerCount(w)};function f(E){return typeof E=="function"}function y(E){return typeof E=="number"}function d(E){return typeof E=="object"&&E!==null}function m(E){return E===void 0}},function(h,o,s){(function(f){"use strict";var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function d(w){var c=y.exec(w);return c.shift(),c}var m=function(){function w(){}return w.normalize=function(c){c===""&&(c=".");var _=c.charAt(0)===w.sep;c=w._removeDuplicateSeps(c);for(var p=c.split(w.sep),T=[],A=0;A<p.length;A++){var b=p[A];b!=="."&&(b===".."&&(_||!_&&T.length>0&&T[0]!=="..")?T.pop():T.push(b))}if(!_&&T.length<2)switch(T.length){case 1:T[0]===""&&T.unshift(".");break;default:T.push(".")}return c=T.join(w.sep),_&&c.charAt(0)!==w.sep&&(c=w.sep+c),c},w.join=function(){for(var c=[],_=0;_<arguments.length;_++)c[_-0]=arguments[_];for(var p=[],T=0;T<c.length;T++){var A=c[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&p.push(A)}return w.normalize(p.join(w.sep))},w.resolve=function(){for(var c=[],_=0;_<arguments.length;_++)c[_-0]=arguments[_];for(var p=[],T=0;T<c.length;T++){var A=c[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&(A.charAt(0)===w.sep&&(p=[]),p.push(A))}var b=w.normalize(p.join(w.sep));if(b.length>1&&b.charAt(b.length-1)===w.sep)return b.substr(0,b.length-1);if(b.charAt(0)!==w.sep){b.charAt(0)==="."&&(b.length===1||b.charAt(1)===w.sep)&&(b=b.length===1?"":b.substr(2));var L=f.cwd();b!==""?b=this.normalize(L+(L!=="/"?w.sep:"")+b):b=L}return b},w.relative=function(c,_){var p;c=w.resolve(c),_=w.resolve(_);var T=c.split(w.sep),A=_.split(w.sep);A.shift(),T.shift();var b=0,L=[];for(p=0;p<T.length;p++){var C=T[p];if(C!==A[p]){b=T.length-p;break}}L=A.slice(p),T.length===1&&T[0]===""&&(b=0),b>T.length&&(b=T.length);var G="";for(p=0;p<b;p++)G+="../";return G+=L.join(w.sep),G.length>1&&G.charAt(G.length-1)===w.sep&&(G=G.substr(0,G.length-1)),G},w.dirname=function(c){c=w._removeDuplicateSeps(c);var _=c.charAt(0)===w.sep,p=c.split(w.sep);return p.pop()===""&&p.length>0&&p.pop(),p.length>1||p.length===1&&!_?p.join(w.sep):_?w.sep:"."},w.basename=function(c,_){if(_===void 0&&(_=""),c==="")return c;c=w.normalize(c);var p=c.split(w.sep),T=p[p.length-1];if(T===""&&p.length>1)return p[p.length-2];if(_.length>0){var A=T.substr(T.length-_.length);if(A===_)return T.substr(0,T.length-_.length)}return T},w.extname=function(c){c=w.normalize(c);var _=c.split(w.sep);if(c=_.pop(),c===""&&_.length>0&&(c=_.pop()),c==="..")return"";var p=c.lastIndexOf(".");return p===-1||p===0?"":c.substr(p)},w.isAbsolute=function(c){return c.length>0&&c.charAt(0)===w.sep},w._makeLong=function(c){return c},w.parse=function(c){var _=d(c);return{root:_[0],dir:_[0]+_[1].slice(0,-1),base:_[2],ext:_[3],name:_[2].slice(0,_[2].length-_[3].length)}},w.format=function(c){if(c===null||typeof c!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof c);var _=c.root||"";if(typeof _!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof c.root);var p=c.dir?c.dir+w.sep:"",T=c.base||"";return p+T},w._removeDuplicateSeps=function(c){return c=c.replace(this._replaceRegex,this.sep),c},w.sep="/",w._replaceRegex=new RegExp("//+","g"),w.delimiter=":",w.posix=w,w.win32=w,w}(),E=m;h.exports=m}).call(o,s(6))},function(h,o,s){(function(f){"use strict";var y=this&&this.__extends||function(E,w){for(var c in w)w.hasOwnProperty(c)&&(E[c]=w[c]);function _(){this.constructor=E}E.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)},d=s(11),m=function(E){y(w,E);function w(){E.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return w.prototype.setRawMode=function(c){this.isRaw!==c&&(this.isRaw=c,this.emit("modeChange"))},w.prototype.changeColumns=function(c){c!==this.columns&&(this.columns=c,this.emit("resize"))},w.prototype.changeRows=function(c){c!==this.rows&&(this.rows=c,this.emit("resize"))},w.isatty=function(c){return c&&c instanceof w},w.prototype._write=function(c,_,p){var T;try{var A;typeof c=="string"?A=new f(c,_):A=c,this._bufferedWrites.push(A),this._waitingForWrites&&this._read(1024)}catch(b){T=b}finally{p(T)}},w.prototype._read=function(c){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},w}(d.Duplex);h.exports=m}).call(o,s(1))},function(h,o,s){h.exports=d;var f=s(8).EventEmitter,y=s(12);y(d,f),d.Readable=s(13),d.Writable=s(27),d.Duplex=s(28),d.Transform=s(29),d.PassThrough=s(30),d.Stream=d;function d(){f.call(this)}d.prototype.pipe=function(m,E){var w=this;function c(C){m.writable&&m.write(C)===!1&&w.pause&&w.pause()}w.on("data",c);function _(){w.readable&&w.resume&&w.resume()}m.on("drain",_),!m._isStdio&&(!E||E.end!==!1)&&(w.on("end",T),w.on("close",A));var p=!1;function T(){p||(p=!0,m.end())}function A(){p||(p=!0,typeof m.destroy=="function"&&m.destroy())}function b(C){if(L(),f.listenerCount(this,"error")===0)throw C}w.on("error",b),m.on("error",b);function L(){w.removeListener("data",c),m.removeListener("drain",_),w.removeListener("end",T),w.removeListener("close",A),w.removeListener("error",b),m.removeListener("error",b),w.removeListener("end",L),w.removeListener("close",L),m.removeListener("close",L)}return w.on("end",L),w.on("close",L),m.on("close",L),m.emit("pipe",w),m}},function(h,o){typeof Object.create=="function"?h.exports=function(f,y){f.super_=y,f.prototype=Object.create(y.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:h.exports=function(f,y){f.super_=y;var d=function(){};d.prototype=y.prototype,f.prototype=new d,f.prototype.constructor=f}},function(h,o,s){(function(f){var y=function(){try{return s(11)}catch{}}();o=h.exports=s(14),o.Stream=y||o,o.Readable=o,o.Writable=s(22),o.Duplex=s(21),o.Transform=s(25),o.PassThrough=s(26),!f.browser&&f.env.READABLE_STREAM==="disable"&&y&&(h.exports=y)}).call(o,s(6))},function(h,o,s){(function(f){"use strict";h.exports=U;var y=s(15),d=s(16),m;U.ReadableState=W;var E=s(8).EventEmitter,w=function(N,R){return N.listeners(R).length},c;(function(){try{c=s(11)}catch{}finally{c||(c=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17),T=s(18);T.inherits=s(12);var A=s(19),b=void 0;A&&A.debuglog?b=A.debuglog("stream"):b=function(){};var L=s(20),C;T.inherits(U,c);function G(N,R,Y){if(typeof N.prependListener=="function")return N.prependListener(R,Y);!N._events||!N._events[R]?N.on(R,Y):d(N._events[R])?N._events[R].unshift(Y):N._events[R]=[Y,N._events[R]]}function W(N,R){m=m||s(21),N=N||{},this.objectMode=!!N.objectMode,R instanceof m&&(this.objectMode=this.objectMode||!!N.readableObjectMode);var Y=N.highWaterMark,Q=this.objectMode?16:16*1024;this.highWaterMark=Y||Y===0?Y:Q,this.highWaterMark=~~this.highWaterMark,this.buffer=new L,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=N.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,N.encoding&&(C||(C=s(24).StringDecoder),this.decoder=new C(N.encoding),this.encoding=N.encoding)}function U(N){if(m=m||s(21),!(this instanceof U))return new U(N);this._readableState=new W(N,this),this.readable=!0,N&&typeof N.read=="function"&&(this._read=N.read),c.call(this)}U.prototype.push=function(N,R){var Y=this._readableState;return!Y.objectMode&&typeof N=="string"&&(R=R||Y.defaultEncoding,R!==Y.encoding&&(N=p.from(N,R),R="")),Et(this,Y,N,R,!1)},U.prototype.unshift=function(N){var R=this._readableState;return Et(this,R,N,"",!0)},U.prototype.isPaused=function(){return this._readableState.flowing===!1};function Et(N,R,Y,Q,lt){var it=tt(R,Y);if(it)N.emit("error",it);else if(Y===null)R.reading=!1,ct(N,R);else if(R.objectMode||Y&&Y.length>0)if(R.ended&&!lt){var _t=new Error("stream.push() after EOF");N.emit("error",_t)}else if(R.endEmitted&&lt){var gt=new Error("stream.unshift() after end event");N.emit("error",gt)}else{var Yt;R.decoder&&!lt&&!Q&&(Y=R.decoder.write(Y),Yt=!R.objectMode&&Y.length===0),lt||(R.reading=!1),Yt||(R.flowing&&R.length===0&&!R.sync?(N.emit("data",Y),N.read(0)):(R.length+=R.objectMode?1:Y.length,lt?R.buffer.unshift(Y):R.buffer.push(Y),R.needReadable&&Nt(N))),Lt(N,R)}else lt||(R.reading=!1);return et(R)}function et(N){return!N.ended&&(N.needReadable||N.length<N.highWaterMark||N.length===0)}U.prototype.setEncoding=function(N){return C||(C=s(24).StringDecoder),this._readableState.decoder=new C(N),this._readableState.encoding=N,this};var wt=8388608;function pt(N){return N>=wt?N=wt:(N--,N|=N>>>1,N|=N>>>2,N|=N>>>4,N|=N>>>8,N|=N>>>16,N++),N}function M(N,R){return N<=0||R.length===0&&R.ended?0:R.objectMode?1:N!==N?R.flowing&&R.length?R.buffer.head.data.length:R.length:(N>R.highWaterMark&&(R.highWaterMark=pt(N)),N<=R.length?N:R.ended?R.length:(R.needReadable=!0,0))}U.prototype.read=function(N){b("read",N),N=parseInt(N,10);var R=this._readableState,Y=N;if(N!==0&&(R.emittedReadable=!1),N===0&&R.needReadable&&(R.length>=R.highWaterMark||R.ended))return b("read: emitReadable",R.length,R.ended),R.length===0&&R.ended?Rt(this):Nt(this),null;if(N=M(N,R),N===0&&R.ended)return R.length===0&&Rt(this),null;var Q=R.needReadable;b("need readable",Q),(R.length===0||R.length-N<R.highWaterMark)&&(Q=!0,b("length less than watermark",Q)),R.ended||R.reading?(Q=!1,b("reading or ended",Q)):Q&&(b("do read"),R.reading=!0,R.sync=!0,R.length===0&&(R.needReadable=!0),this._read(R.highWaterMark),R.sync=!1,R.reading||(N=M(Y,R)));var lt;return N>0?lt=ut(N,R):lt=null,lt===null?(R.needReadable=!0,N=0):R.length-=N,R.length===0&&(R.ended||(R.needReadable=!0),Y!==N&&R.ended&&Rt(this)),lt!==null&&this.emit("data",lt),lt};function tt(N,R){var Y=null;return!_.isBuffer(R)&&typeof R!="string"&&R!==null&&R!==void 0&&!N.objectMode&&(Y=new TypeError("Invalid non-string/buffer chunk")),Y}function ct(N,R){if(!R.ended){if(R.decoder){var Y=R.decoder.end();Y&&Y.length&&(R.buffer.push(Y),R.length+=R.objectMode?1:Y.length)}R.ended=!0,Nt(N)}}function Nt(N){var R=N._readableState;R.needReadable=!1,R.emittedReadable||(b("emitReadable",R.flowing),R.emittedReadable=!0,R.sync?y(dt,N):dt(N))}function dt(N){b("emit readable"),N.emit("readable"),K(N)}function Lt(N,R){R.readingMore||(R.readingMore=!0,y(kt,N,R))}function kt(N,R){for(var Y=R.length;!R.reading&&!R.flowing&&!R.ended&&R.length<R.highWaterMark&&(b("maybeReadMore read 0"),N.read(0),Y!==R.length);)Y=R.length;R.readingMore=!1}U.prototype._read=function(N){this.emit("error",new Error("_read() is not implemented"))},U.prototype.pipe=function(N,R){var Y=this,Q=this._readableState;switch(Q.pipesCount){case 0:Q.pipes=N;break;case 1:Q.pipes=[Q.pipes,N];break;default:Q.pipes.push(N);break}Q.pipesCount+=1,b("pipe count=%d opts=%j",Q.pipesCount,R);var lt=(!R||R.end!==!1)&&N!==f.stdout&&N!==f.stderr,it=lt?gt:Fe;Q.endEmitted?y(it):Y.once("end",it),N.on("unpipe",_t);function _t(J){b("onunpipe"),J===Y&&Fe()}function gt(){b("onend"),N.end()}var Yt=St(Y);N.on("drain",Yt);var ue=!1;function Fe(){b("cleanup"),N.removeListener("close",k),N.removeListener("finish",B),N.removeListener("drain",Yt),N.removeListener("error",v),N.removeListener("unpipe",_t),Y.removeListener("end",gt),Y.removeListener("end",Fe),Y.removeListener("data",g),ue=!0,Q.awaitDrain&&(!N._writableState||N._writableState.needDrain)&&Yt()}var I=!1;Y.on("data",g);function g(J){b("ondata"),I=!1;var bt=N.write(J);bt===!1&&!I&&((Q.pipesCount===1&&Q.pipes===N||Q.pipesCount>1&&te(Q.pipes,N)!==-1)&&!ue&&(b("false write response, pause",Y._readableState.awaitDrain),Y._readableState.awaitDrain++,I=!0),Y.pause())}function v(J){b("onerror",J),Z(),N.removeListener("error",v),w(N,"error")===0&&N.emit("error",J)}G(N,"error",v);function k(){N.removeListener("finish",B),Z()}N.once("close",k);function B(){b("onfinish"),N.removeListener("close",k),Z()}N.once("finish",B);function Z(){b("unpipe"),Y.unpipe(N)}return N.emit("pipe",Y),Q.flowing||(b("pipe resume"),Y.resume()),N};function St(N){return function(){var R=N._readableState;b("pipeOnDrain",R.awaitDrain),R.awaitDrain&&R.awaitDrain--,R.awaitDrain===0&&w(N,"data")&&(R.flowing=!0,K(N))}}U.prototype.unpipe=function(N){var R=this._readableState;if(R.pipesCount===0)return this;if(R.pipesCount===1)return N&&N!==R.pipes?this:(N||(N=R.pipes),R.pipes=null,R.pipesCount=0,R.flowing=!1,N&&N.emit("unpipe",this),this);if(!N){var Y=R.pipes,Q=R.pipesCount;R.pipes=null,R.pipesCount=0,R.flowing=!1;for(var lt=0;lt<Q;lt++)Y[lt].emit("unpipe",this);return this}var it=te(R.pipes,N);return it===-1?this:(R.pipes.splice(it,1),R.pipesCount-=1,R.pipesCount===1&&(R.pipes=R.pipes[0]),N.emit("unpipe",this),this)},U.prototype.on=function(N,R){var Y=c.prototype.on.call(this,N,R);if(N==="data")this._readableState.flowing!==!1&&this.resume();else if(N==="readable"){var Q=this._readableState;!Q.endEmitted&&!Q.readableListening&&(Q.readableListening=Q.needReadable=!0,Q.emittedReadable=!1,Q.reading?Q.length&&Nt(this,Q):y(Xt,this))}return Y},U.prototype.addListener=U.prototype.on;function Xt(N){b("readable nexttick read 0"),N.read(0)}U.prototype.resume=function(){var N=this._readableState;return N.flowing||(b("resume"),N.flowing=!0,P(this,N)),this};function P(N,R){R.resumeScheduled||(R.resumeScheduled=!0,y(z,N,R))}function z(N,R){R.reading||(b("resume read 0"),N.read(0)),R.resumeScheduled=!1,R.awaitDrain=0,N.emit("resume"),K(N),R.flowing&&!R.reading&&N.read(0)}U.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function K(N){var R=N._readableState;for(b("flow",R.flowing);R.flowing&&N.read()!==null;);}U.prototype.wrap=function(N){var R=this._readableState,Y=!1,Q=this;N.on("end",function(){if(b("wrapped end"),R.decoder&&!R.ended){var _t=R.decoder.end();_t&&_t.length&&Q.push(_t)}Q.push(null)}),N.on("data",function(_t){if(b("wrapped data"),R.decoder&&(_t=R.decoder.write(_t)),!(R.objectMode&&_t==null)&&!(!R.objectMode&&(!_t||!_t.length))){var gt=Q.push(_t);gt||(Y=!0,N.pause())}});for(var lt in N)this[lt]===void 0&&typeof N[lt]=="function"&&(this[lt]=function(_t){return function(){return N[_t].apply(N,arguments)}}(lt));var it=["error","close","destroy","pause","resume"];return Ct(it,function(_t){N.on(_t,Q.emit.bind(Q,_t))}),Q._read=function(_t){b("wrapped _read",_t),Y&&(Y=!1,N.resume())},Q},U._fromList=ut;function ut(N,R){if(R.length===0)return null;var Y;return R.objectMode?Y=R.buffer.shift():!N||N>=R.length?(R.decoder?Y=R.buffer.join(""):R.buffer.length===1?Y=R.buffer.head.data:Y=R.buffer.concat(R.length),R.buffer.clear()):Y=It(N,R.buffer,R.decoder),Y}function It(N,R,Y){var Q;return N<R.head.data.length?(Q=R.head.data.slice(0,N),R.head.data=R.head.data.slice(N)):N===R.head.data.length?Q=R.shift():Q=Y?vt(N,R):xt(N,R),Q}function vt(N,R){var Y=R.head,Q=1,lt=Y.data;for(N-=lt.length;Y=Y.next;){var it=Y.data,_t=N>it.length?it.length:N;if(_t===it.length?lt+=it:lt+=it.slice(0,N),N-=_t,N===0){_t===it.length?(++Q,Y.next?R.head=Y.next:R.head=R.tail=null):(R.head=Y,Y.data=it.slice(_t));break}++Q}return R.length-=Q,lt}function xt(N,R){var Y=p.allocUnsafe(N),Q=R.head,lt=1;for(Q.data.copy(Y),N-=Q.data.length;Q=Q.next;){var it=Q.data,_t=N>it.length?it.length:N;if(it.copy(Y,Y.length-N,0,_t),N-=_t,N===0){_t===it.length?(++lt,Q.next?R.head=Q.next:R.head=R.tail=null):(R.head=Q,Q.data=it.slice(_t));break}++lt}return R.length-=lt,Y}function Rt(N){var R=N._readableState;if(R.length>0)throw new Error('"endReadable()" called on non-empty stream');R.endEmitted||(R.ended=!0,y(jt,R,N))}function jt(N,R){!N.endEmitted&&N.length===0&&(N.endEmitted=!0,R.readable=!1,R.emit("end"))}function Ct(N,R){for(var Y=0,Q=N.length;Y<Q;Y++)R(N[Y],Y)}function te(N,R){for(var Y=0,Q=N.length;Y<Q;Y++)if(N[Y]===R)return Y;return-1}}).call(o,s(6))},function(h,o,s){(function(f){"use strict";!f.version||f.version.indexOf("v0.")===0||f.version.indexOf("v1.")===0&&f.version.indexOf("v1.8.")!==0?h.exports=y:h.exports=f.nextTick;function y(d,m,E,w){if(typeof d!="function")throw new TypeError('"callback" argument must be a function');var c=arguments.length,_,p;switch(c){case 0:case 1:return f.nextTick(d);case 2:return f.nextTick(function(){d.call(null,m)});case 3:return f.nextTick(function(){d.call(null,m,E)});case 4:return f.nextTick(function(){d.call(null,m,E,w)});default:for(_=new Array(c-1),p=0;p<_.length;)_[p++]=arguments[p];return f.nextTick(function(){d.apply(null,_)})}}}).call(o,s(6))},function(h,o){var s={}.toString;h.exports=Array.isArray||function(f){return s.call(f)=="[object Array]"}},function(h,o,s){(function(f){"use strict";var y=s(2),d=y.Buffer,m=y.SlowBuffer,E=y.kMaxLength||2147483647;o.alloc=function(c,_,p){if(typeof d.alloc=="function")return d.alloc(c,_,p);if(typeof p=="number")throw new TypeError("encoding must not be number");if(typeof c!="number")throw new TypeError("size must be a number");if(c>E)throw new RangeError("size is too large");var T=p,A=_;A===void 0&&(T=void 0,A=0);var b=new d(c);if(typeof A=="string")for(var L=new d(A,T),C=L.length,G=-1;++G<c;)b[G]=L[G%C];else b.fill(A);return b},o.allocUnsafe=function(c){if(typeof d.allocUnsafe=="function")return d.allocUnsafe(c);if(typeof c!="number")throw new TypeError("size must be a number");if(c>E)throw new RangeError("size is too large");return new d(c)},o.from=function(c,_,p){if(typeof d.from=="function"&&(!f.Uint8Array||Uint8Array.from!==d.from))return d.from(c,_,p);if(typeof c=="number")throw new TypeError('"value" argument must not be a number');if(typeof c=="string")return new d(c,_);if(typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer){var T=_;if(arguments.length===1)return new d(c);typeof T>"u"&&(T=0);var A=p;if(typeof A>"u"&&(A=c.byteLength-T),T>=c.byteLength)throw new RangeError("'offset' is out of bounds");if(A>c.byteLength-T)throw new RangeError("'length' is out of bounds");return new d(c.slice(T,T+A))}if(d.isBuffer(c)){var b=new d(c.length);return c.copy(b,0,0,c.length),b}if(c){if(Array.isArray(c)||typeof ArrayBuffer<"u"&&c.buffer instanceof ArrayBuffer||"length"in c)return new d(c);if(c.type==="Buffer"&&Array.isArray(c.data))return new d(c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},o.allocUnsafeSlow=function(c){if(typeof d.allocUnsafeSlow=="function")return d.allocUnsafeSlow(c);if(typeof c!="number")throw new TypeError("size must be a number");if(c>=E)throw new RangeError("size is too large");return new m(c)}}).call(o,function(){return this}())},function(h,o,s){(function(f){function y(U){return Array.isArray?Array.isArray(U):W(U)==="[object Array]"}o.isArray=y;function d(U){return typeof U=="boolean"}o.isBoolean=d;function m(U){return U===null}o.isNull=m;function E(U){return U==null}o.isNullOrUndefined=E;function w(U){return typeof U=="number"}o.isNumber=w;function c(U){return typeof U=="string"}o.isString=c;function _(U){return typeof U=="symbol"}o.isSymbol=_;function p(U){return U===void 0}o.isUndefined=p;function T(U){return W(U)==="[object RegExp]"}o.isRegExp=T;function A(U){return typeof U=="object"&&U!==null}o.isObject=A;function b(U){return W(U)==="[object Date]"}o.isDate=b;function L(U){return W(U)==="[object Error]"||U instanceof Error}o.isError=L;function C(U){return typeof U=="function"}o.isFunction=C;function G(U){return U===null||typeof U=="boolean"||typeof U=="number"||typeof U=="string"||typeof U=="symbol"||typeof U>"u"}o.isPrimitive=G,o.isBuffer=f.isBuffer;function W(U){return Object.prototype.toString.call(U)}}).call(o,s(1))},function(h,o){},function(h,o,s){"use strict";var f=s(2).Buffer,y=s(17);h.exports=d;function d(){this.head=null,this.tail=null,this.length=0}d.prototype.push=function(m){var E={data:m,next:null};this.length>0?this.tail.next=E:this.head=E,this.tail=E,++this.length},d.prototype.unshift=function(m){var E={data:m,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length},d.prototype.shift=function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}},d.prototype.clear=function(){this.head=this.tail=null,this.length=0},d.prototype.join=function(m){if(this.length===0)return"";for(var E=this.head,w=""+E.data;E=E.next;)w+=m+E.data;return w},d.prototype.concat=function(m){if(this.length===0)return y.alloc(0);if(this.length===1)return this.head.data;for(var E=y.allocUnsafe(m>>>0),w=this.head,c=0;w;)w.data.copy(E,c),c+=w.data.length,w=w.next;return E}},function(h,o,s){"use strict";var f=Object.keys||function(L){var C=[];for(var G in L)C.push(G);return C};h.exports=p;var y=s(15),d=s(18);d.inherits=s(12);var m=s(14),E=s(22);d.inherits(p,m);for(var w=f(E.prototype),c=0;c<w.length;c++){var _=w[c];p.prototype[_]||(p.prototype[_]=E.prototype[_])}function p(L){if(!(this instanceof p))return new p(L);m.call(this,L),E.call(this,L),L&&L.readable===!1&&(this.readable=!1),L&&L.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,L&&L.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",T)}function T(){this.allowHalfOpen||this._writableState.ended||y(A,this)}function A(L){L.end()}function b(L,C){for(var G=0,W=L.length;G<W;G++)C(L[G],G)}},function(h,o,s){(function(f){"use strict";h.exports=C;var y=s(15),d=!f.browser&&["v0.10","v0.9."].indexOf(f.version.slice(0,5))>-1?setImmediate:y,m;C.WritableState=b;var E=s(18);E.inherits=s(12);var w={deprecate:s(23)},c;(function(){try{c=s(11)}catch{}finally{c||(c=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17);E.inherits(C,c);function T(){}function A(P,z,K){this.chunk=P,this.encoding=z,this.callback=K,this.next=null}function b(P,z){m=m||s(21),P=P||{},this.objectMode=!!P.objectMode,z instanceof m&&(this.objectMode=this.objectMode||!!P.writableObjectMode);var K=P.highWaterMark,ut=this.objectMode?16:16*1024;this.highWaterMark=K||K===0?K:ut,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var It=P.decodeStrings===!1;this.decodeStrings=!It,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(vt){M(z,vt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Xt(this)}b.prototype.getBuffer=function(){for(var z=this.bufferedRequest,K=[];z;)K.push(z),z=z.next;return K},function(){try{Object.defineProperty(b.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(P){return L.call(this,P)?!0:P&&P._writableState instanceof b}})):L=function(P){return P instanceof this};function C(P){if(m=m||s(21),!L.call(C,this)&&!(this instanceof m))return new C(P);this._writableState=new b(P,this),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev)),c.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function G(P,z){var K=new Error("write after end");P.emit("error",K),y(z,K)}function W(P,z,K,ut){var It=!0,vt=!1;return K===null?vt=new TypeError("May not write null values to stream"):typeof K!="string"&&K!==void 0&&!z.objectMode&&(vt=new TypeError("Invalid non-string/buffer chunk")),vt&&(P.emit("error",vt),y(ut,vt),It=!1),It}C.prototype.write=function(P,z,K){var ut=this._writableState,It=!1,vt=_.isBuffer(P);return typeof z=="function"&&(K=z,z=null),vt?z="buffer":z||(z=ut.defaultEncoding),typeof K!="function"&&(K=T),ut.ended?G(this,K):(vt||W(this,ut,P,K))&&(ut.pendingcb++,It=Et(this,ut,vt,P,z,K)),It},C.prototype.cork=function(){var P=this._writableState;P.corked++},C.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,!P.writing&&!P.corked&&!P.finished&&!P.bufferProcessing&&P.bufferedRequest&&Nt(this,P))},C.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+z);return this._writableState.defaultEncoding=z,this};function U(P,z,K){return!P.objectMode&&P.decodeStrings!==!1&&typeof z=="string"&&(z=p.from(z,K)),z}function Et(P,z,K,ut,It,vt){K||(ut=U(z,ut,It),_.isBuffer(ut)&&(It="buffer"));var xt=z.objectMode?1:ut.length;z.length+=xt;var Rt=z.length<z.highWaterMark;if(Rt||(z.needDrain=!0),z.writing||z.corked){var jt=z.lastBufferedRequest;z.lastBufferedRequest=new A(ut,It,vt),jt?jt.next=z.lastBufferedRequest:z.bufferedRequest=z.lastBufferedRequest,z.bufferedRequestCount+=1}else et(P,z,!1,xt,ut,It,vt);return Rt}function et(P,z,K,ut,It,vt,xt){z.writelen=ut,z.writecb=xt,z.writing=!0,z.sync=!0,K?P._writev(It,z.onwrite):P._write(It,vt,z.onwrite),z.sync=!1}function wt(P,z,K,ut,It){--z.pendingcb,K?y(It,ut):It(ut),P._writableState.errorEmitted=!0,P.emit("error",ut)}function pt(P){P.writing=!1,P.writecb=null,P.length-=P.writelen,P.writelen=0}function M(P,z){var K=P._writableState,ut=K.sync,It=K.writecb;if(pt(K),z)wt(P,K,ut,z,It);else{var vt=dt(K);!vt&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&Nt(P,K),ut?d(tt,P,K,vt,It):tt(P,K,vt,It)}}function tt(P,z,K,ut){K||ct(P,z),z.pendingcb--,ut(),kt(P,z)}function ct(P,z){z.length===0&&z.needDrain&&(z.needDrain=!1,P.emit("drain"))}function Nt(P,z){z.bufferProcessing=!0;var K=z.bufferedRequest;if(P._writev&&K&&K.next){var ut=z.bufferedRequestCount,It=new Array(ut),vt=z.corkedRequestsFree;vt.entry=K;for(var xt=0;K;)It[xt]=K,K=K.next,xt+=1;et(P,z,!0,z.length,It,"",vt.finish),z.pendingcb++,z.lastBufferedRequest=null,vt.next?(z.corkedRequestsFree=vt.next,vt.next=null):z.corkedRequestsFree=new Xt(z)}else{for(;K;){var Rt=K.chunk,jt=K.encoding,Ct=K.callback,te=z.objectMode?1:Rt.length;if(et(P,z,!1,te,Rt,jt,Ct),K=K.next,z.writing)break}K===null&&(z.lastBufferedRequest=null)}z.bufferedRequestCount=0,z.bufferedRequest=K,z.bufferProcessing=!1}C.prototype._write=function(P,z,K){K(new Error("_write() is not implemented"))},C.prototype._writev=null,C.prototype.end=function(P,z,K){var ut=this._writableState;typeof P=="function"?(K=P,P=null,z=null):typeof z=="function"&&(K=z,z=null),P!=null&&this.write(P,z),ut.corked&&(ut.corked=1,this.uncork()),!ut.ending&&!ut.finished&&St(this,ut,K)};function dt(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function Lt(P,z){z.prefinished||(z.prefinished=!0,P.emit("prefinish"))}function kt(P,z){var K=dt(z);return K&&(z.pendingcb===0?(Lt(P,z),z.finished=!0,P.emit("finish")):Lt(P,z)),K}function St(P,z,K){z.ending=!0,kt(P,z),K&&(z.finished?y(K):P.once("finish",K)),z.ended=!0,P.writable=!1}function Xt(P){var z=this;this.next=null,this.entry=null,this.finish=function(K){var ut=z.entry;for(z.entry=null;ut;){var It=ut.callback;P.pendingcb--,It(K),ut=ut.next}P.corkedRequestsFree?P.corkedRequestsFree.next=z:P.corkedRequestsFree=z}}}).call(o,s(6))},function(h,o){(function(s){h.exports=f;function f(d,m){if(y("noDeprecation"))return d;var E=!1;function w(){if(!E){if(y("throwDeprecation"))throw new Error(m);y("traceDeprecation")?console.trace(m):console.warn(m),E=!0}return d.apply(this,arguments)}return w}function y(d){try{if(!s.localStorage)return!1}catch{return!1}var m=s.localStorage[d];return m==null?!1:String(m).toLowerCase()==="true"}}).call(o,function(){return this}())},function(h,o,s){var f=s(2).Buffer,y=f.isEncoding||function(_){switch(_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function d(_){if(_&&!y(_))throw new Error("Unknown encoding: "+_)}var m=o.StringDecoder=function(_){switch(this.encoding=(_||"utf8").toLowerCase().replace(/[-_]/,""),d(_),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=w;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=c;break;default:this.write=E;return}this.charBuffer=new f(6),this.charReceived=0,this.charLength=0};m.prototype.write=function(_){for(var p="";this.charLength;){var T=_.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:_.length;if(_.copy(this.charBuffer,this.charReceived,0,T),this.charReceived+=T,this.charReceived<this.charLength)return"";_=_.slice(T,_.length),p=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var b=p.charCodeAt(p.length-1);if(b>=55296&&b<=56319){this.charLength+=this.surrogateSize,p="";continue}if(this.charReceived=this.charLength=0,_.length===0)return p;break}this.detectIncompleteChar(_);var A=_.length;this.charLength&&(_.copy(this.charBuffer,0,_.length-this.charReceived,A),A-=this.charReceived),p+=_.toString(this.encoding,0,A);var A=p.length-1,b=p.charCodeAt(A);if(b>=55296&&b<=56319){var L=this.surrogateSize;return this.charLength+=L,this.charReceived+=L,this.charBuffer.copy(this.charBuffer,L,0,L),_.copy(this.charBuffer,0,0,L),p.substring(0,A)}return p},m.prototype.detectIncompleteChar=function(_){for(var p=_.length>=3?3:_.length;p>0;p--){var T=_[_.length-p];if(p==1&&T>>5==6){this.charLength=2;break}if(p<=2&&T>>4==14){this.charLength=3;break}if(p<=3&&T>>3==30){this.charLength=4;break}}this.charReceived=p},m.prototype.end=function(_){var p="";if(_&&_.length&&(p=this.write(_)),this.charReceived){var T=this.charReceived,A=this.charBuffer,b=this.encoding;p+=A.slice(0,T).toString(b)}return p};function E(_){return _.toString(this.encoding)}function w(_){this.charReceived=_.length%2,this.charLength=this.charReceived?2:0}function c(_){this.charReceived=_.length%3,this.charLength=this.charReceived?3:0}},function(h,o,s){"use strict";h.exports=E;var f=s(21),y=s(18);y.inherits=s(12),y.inherits(E,f);function d(c){this.afterTransform=function(_,p){return m(c,_,p)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function m(c,_,p){var T=c._transformState;T.transforming=!1;var A=T.writecb;if(!A)return c.emit("error",new Error("no writecb in Transform class"));T.writechunk=null,T.writecb=null,p!=null&&c.push(p),A(_);var b=c._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&c._read(b.highWaterMark)}function E(c){if(!(this instanceof E))return new E(c);f.call(this,c),this._transformState=new d(this);var _=this;this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(p,T){w(_,p,T)}):w(_)})}E.prototype.push=function(c,_){return this._transformState.needTransform=!1,f.prototype.push.call(this,c,_)},E.prototype._transform=function(c,_,p){throw new Error("_transform() is not implemented")},E.prototype._write=function(c,_,p){var T=this._transformState;if(T.writecb=p,T.writechunk=c,T.writeencoding=_,!T.transforming){var A=this._readableState;(T.needTransform||A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}},E.prototype._read=function(c){var _=this._transformState;_.writechunk!==null&&_.writecb&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0};function w(c,_,p){if(_)return c.emit("error",_);p!=null&&c.push(p);var T=c._writableState,A=c._transformState;if(T.length)throw new Error("Calling transform done when ws.length != 0");if(A.transforming)throw new Error("Calling transform done when still transforming");return c.push(null)}},function(h,o,s){"use strict";h.exports=d;var f=s(25),y=s(18);y.inherits=s(12),y.inherits(d,f);function d(m){if(!(this instanceof d))return new d(m);f.call(this,m)}d.prototype._transform=function(m,E,w){w(null,m)}},function(h,o,s){h.exports=s(22)},function(h,o,s){h.exports=s(21)},function(h,o,s){h.exports=s(25)},function(h,o,s){h.exports=s(26)},function(h,o,s){"use strict";var f=s(32),y=s(33),d=s(38),m=s(39),E=s(40),w=s(41),c=s(42),_=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=y.assign({chunkSize:16384,windowBits:0,to:""},b||{});var L=this.options;L.raw&&L.windowBits>=0&&L.windowBits<16&&(L.windowBits=-L.windowBits,L.windowBits===0&&(L.windowBits=-15)),L.windowBits>=0&&L.windowBits<16&&!(b&&b.windowBits)&&(L.windowBits+=32),L.windowBits>15&&L.windowBits<48&&(L.windowBits&15)===0&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var C=f.inflateInit2(this.strm,L.windowBits);if(C!==m.Z_OK)throw new Error(E[C]);this.header=new c,f.inflateGetHeader(this.strm,this.header)}p.prototype.push=function(b,L){var C=this.strm,G=this.options.chunkSize,W=this.options.dictionary,U,Et,et,wt,pt,M,tt=!1;if(this.ended)return!1;Et=L===~~L?L:L===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof b=="string"?C.input=d.binstring2buf(b):_.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new y.Buf8(G),C.next_out=0,C.avail_out=G),U=f.inflate(C,m.Z_NO_FLUSH),U===m.Z_NEED_DICT&&W&&(typeof W=="string"?M=d.string2buf(W):_.call(W)==="[object ArrayBuffer]"?M=new Uint8Array(W):M=W,U=f.inflateSetDictionary(this.strm,M)),U===m.Z_BUF_ERROR&&tt===!0&&(U=m.Z_OK,tt=!1),U!==m.Z_STREAM_END&&U!==m.Z_OK)return this.onEnd(U),this.ended=!0,!1;C.next_out&&(C.avail_out===0||U===m.Z_STREAM_END||C.avail_in===0&&(Et===m.Z_FINISH||Et===m.Z_SYNC_FLUSH))&&(this.options.to==="string"?(et=d.utf8border(C.output,C.next_out),wt=C.next_out-et,pt=d.buf2string(C.output,et),C.next_out=wt,C.avail_out=G-wt,wt&&y.arraySet(C.output,C.output,et,wt,0),this.onData(pt)):this.onData(y.shrinkBuf(C.output,C.next_out))),C.avail_in===0&&C.avail_out===0&&(tt=!0)}while((C.avail_in>0||C.avail_out===0)&&U!==m.Z_STREAM_END);return U===m.Z_STREAM_END&&(Et=m.Z_FINISH),Et===m.Z_FINISH?(U=f.inflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===m.Z_OK):(Et===m.Z_SYNC_FLUSH&&(this.onEnd(m.Z_OK),C.avail_out=0),!0)},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function T(b,L){var C=new p(L);if(C.push(b,!0),C.err)throw C.msg||E[C.err];return C.result}function A(b,L){return L=L||{},L.raw=!0,T(b,L)}o.Inflate=p,o.inflate=T,o.inflateRaw=A,o.ungzip=T},function(h,o,s){"use strict";var f=s(33),y=s(34),d=s(35),m=s(36),E=s(37),w=0,c=1,_=2,p=4,T=5,A=6,b=0,L=1,C=2,G=-2,W=-3,U=-4,Et=-5,et=8,wt=1,pt=2,M=3,tt=4,ct=5,Nt=6,dt=7,Lt=8,kt=9,St=10,Xt=11,P=12,z=13,K=14,ut=15,It=16,vt=17,xt=18,Rt=19,jt=20,Ct=21,te=22,N=23,R=24,Y=25,Q=26,lt=27,it=28,_t=29,gt=30,Yt=31,ue=32,Fe=852,I=592,g=15,v=g;function k(j){return(j>>>24&255)+(j>>>8&65280)+((j&65280)<<8)+((j&255)<<24)}function B(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Z(j){var ot;return!j||!j.state?G:(ot=j.state,j.total_in=j.total_out=ot.total=0,j.msg="",ot.wrap&&(j.adler=ot.wrap&1),ot.mode=wt,ot.last=0,ot.havedict=0,ot.dmax=32768,ot.head=null,ot.hold=0,ot.bits=0,ot.lencode=ot.lendyn=new f.Buf32(Fe),ot.distcode=ot.distdyn=new f.Buf32(I),ot.sane=1,ot.back=-1,b)}function J(j){var ot;return!j||!j.state?G:(ot=j.state,ot.wsize=0,ot.whave=0,ot.wnext=0,Z(j))}function bt(j,ot){var F,at;return!j||!j.state||(at=j.state,ot<0?(F=0,ot=-ot):(F=(ot>>4)+1,ot<48&&(ot&=15)),ot&&(ot<8||ot>15))?G:(at.window!==null&&at.wbits!==ot&&(at.window=null),at.wrap=F,at.wbits=ot,J(j))}function At(j,ot){var F,at;return j?(at=new B,j.state=at,at.window=null,F=bt(j,ot),F!==b&&(j.state=null),F):G}function Bt(j){return At(j,v)}var Gt=!0,Dt,Ie;function nr(j){if(Gt){var ot;for(Dt=new f.Buf32(512),Ie=new f.Buf32(32),ot=0;ot<144;)j.lens[ot++]=8;for(;ot<256;)j.lens[ot++]=9;for(;ot<280;)j.lens[ot++]=7;for(;ot<288;)j.lens[ot++]=8;for(E(c,j.lens,0,288,Dt,0,j.work,{bits:9}),ot=0;ot<32;)j.lens[ot++]=5;E(_,j.lens,0,32,Ie,0,j.work,{bits:5}),Gt=!1}j.lencode=Dt,j.lenbits=9,j.distcode=Ie,j.distbits=5}function Ve(j,ot,F,at){var Ut,nt=j.state;return nt.window===null&&(nt.wsize=1<<nt.wbits,nt.wnext=0,nt.whave=0,nt.window=new f.Buf8(nt.wsize)),at>=nt.wsize?(f.arraySet(nt.window,ot,F-nt.wsize,nt.wsize,0),nt.wnext=0,nt.whave=nt.wsize):(Ut=nt.wsize-nt.wnext,Ut>at&&(Ut=at),f.arraySet(nt.window,ot,F-at,Ut,nt.wnext),at-=Ut,at?(f.arraySet(nt.window,ot,F-at,at,0),nt.wnext=at,nt.whave=nt.wsize):(nt.wnext+=Ut,nt.wnext===nt.wsize&&(nt.wnext=0),nt.whave<nt.wsize&&(nt.whave+=Ut))),0}function Ze(j,ot){var F,at,Ut,nt,fe,st,Jt,X,q,or,Mt,ht,qe,De,Wt=0,Tt,re,ae,ie,sr,Xe,Zt,ce,ee=new f.Buf8(4),be,Se,Pr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return G;F=j.state,F.mode===P&&(F.mode=z),fe=j.next_out,Ut=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,q=F.bits,or=st,Mt=Jt,ce=b;t:for(;;)switch(F.mode){case wt:if(F.wrap===0){F.mode=z;break}for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.wrap&2&&X===35615){F.check=0,ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0),X=0,q=0,F.mode=pt;break}if(F.flags=0,F.head&&(F.head.done=!1),!(F.wrap&1)||(((X&255)<<8)+(X>>8))%31){j.msg="incorrect header check",F.mode=gt;break}if((X&15)!==et){j.msg="unknown compression method",F.mode=gt;break}if(X>>>=4,q-=4,Zt=(X&15)+8,F.wbits===0)F.wbits=Zt;else if(Zt>F.wbits){j.msg="invalid window size",F.mode=gt;break}F.dmax=1<<Zt,j.adler=F.check=1,F.mode=X&512?St:P,X=0,q=0;break;case pt:for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.flags=X,(F.flags&255)!==et){j.msg="unknown compression method",F.mode=gt;break}if(F.flags&57344){j.msg="unknown header flags set",F.mode=gt;break}F.head&&(F.head.text=X>>8&1),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0,F.mode=M;case M:for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.head&&(F.head.time=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,ee[2]=X>>>16&255,ee[3]=X>>>24&255,F.check=d(F.check,ee,4,0)),X=0,q=0,F.mode=tt;case tt:for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.head&&(F.head.xflags=X&255,F.head.os=X>>8),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0,F.mode=ct;case ct:if(F.flags&1024){for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.length=X,F.head&&(F.head.extra_len=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0}else F.head&&(F.head.extra=null);F.mode=Nt;case Nt:if(F.flags&1024&&(ht=F.length,ht>st&&(ht=st),ht&&(F.head&&(Zt=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),f.arraySet(F.head.extra,at,nt,ht,Zt)),F.flags&512&&(F.check=d(F.check,at,ht,nt)),st-=ht,nt+=ht,F.length-=ht),F.length))break t;F.length=0,F.mode=dt;case dt:if(F.flags&2048){if(st===0)break t;ht=0;do Zt=at[nt+ht++],F.head&&Zt&&F.length<65536&&(F.head.name+=String.fromCharCode(Zt));while(Zt&&ht<st);if(F.flags&512&&(F.check=d(F.check,at,ht,nt)),st-=ht,nt+=ht,Zt)break t}else F.head&&(F.head.name=null);F.length=0,F.mode=Lt;case Lt:if(F.flags&4096){if(st===0)break t;ht=0;do Zt=at[nt+ht++],F.head&&Zt&&F.length<65536&&(F.head.comment+=String.fromCharCode(Zt));while(Zt&&ht<st);if(F.flags&512&&(F.check=d(F.check,at,ht,nt)),st-=ht,nt+=ht,Zt)break t}else F.head&&(F.head.comment=null);F.mode=kt;case kt:if(F.flags&512){for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X!==(F.check&65535)){j.msg="header crc mismatch",F.mode=gt;break}X=0,q=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),j.adler=F.check=0,F.mode=P;break;case St:for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}j.adler=F.check=k(X),X=0,q=0,F.mode=Xt;case Xt:if(F.havedict===0)return j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,C;j.adler=F.check=1,F.mode=P;case P:if(ot===T||ot===A)break t;case z:if(F.last){X>>>=q&7,q-=q&7,F.mode=lt;break}for(;q<3;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}switch(F.last=X&1,X>>>=1,q-=1,X&3){case 0:F.mode=K;break;case 1:if(nr(F),F.mode=jt,ot===A){X>>>=2,q-=2;break t}break;case 2:F.mode=vt;break;case 3:j.msg="invalid block type",F.mode=gt}X>>>=2,q-=2;break;case K:for(X>>>=q&7,q-=q&7;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if((X&65535)!==(X>>>16^65535)){j.msg="invalid stored block lengths",F.mode=gt;break}if(F.length=X&65535,X=0,q=0,F.mode=ut,ot===A)break t;case ut:F.mode=It;case It:if(ht=F.length,ht){if(ht>st&&(ht=st),ht>Jt&&(ht=Jt),ht===0)break t;f.arraySet(Ut,at,nt,ht,fe),st-=ht,nt+=ht,Jt-=ht,fe+=ht,F.length-=ht;break}F.mode=P;break;case vt:for(;q<14;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.nlen=(X&31)+257,X>>>=5,q-=5,F.ndist=(X&31)+1,X>>>=5,q-=5,F.ncode=(X&15)+4,X>>>=4,q-=4,F.nlen>286||F.ndist>30){j.msg="too many length or distance symbols",F.mode=gt;break}F.have=0,F.mode=xt;case xt:for(;F.have<F.ncode;){for(;q<3;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.lens[Pr[F.have++]]=X&7,X>>>=3,q-=3}for(;F.have<19;)F.lens[Pr[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,be={bits:F.lenbits},ce=E(w,F.lens,0,19,F.lencode,0,F.work,be),F.lenbits=be.bits,ce){j.msg="invalid code lengths set",F.mode=gt;break}F.have=0,F.mode=Rt;case Rt:for(;F.have<F.nlen+F.ndist;){for(;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(ae<16)X>>>=Tt,q-=Tt,F.lens[F.have++]=ae;else{if(ae===16){for(Se=Tt+2;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X>>>=Tt,q-=Tt,F.have===0){j.msg="invalid bit length repeat",F.mode=gt;break}Zt=F.lens[F.have-1],ht=3+(X&3),X>>>=2,q-=2}else if(ae===17){for(Se=Tt+3;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=Tt,q-=Tt,Zt=0,ht=3+(X&7),X>>>=3,q-=3}else{for(Se=Tt+7;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=Tt,q-=Tt,Zt=0,ht=11+(X&127),X>>>=7,q-=7}if(F.have+ht>F.nlen+F.ndist){j.msg="invalid bit length repeat",F.mode=gt;break}for(;ht--;)F.lens[F.have++]=Zt}}if(F.mode===gt)break;if(F.lens[256]===0){j.msg="invalid code -- missing end-of-block",F.mode=gt;break}if(F.lenbits=9,be={bits:F.lenbits},ce=E(c,F.lens,0,F.nlen,F.lencode,0,F.work,be),F.lenbits=be.bits,ce){j.msg="invalid literal/lengths set",F.mode=gt;break}if(F.distbits=6,F.distcode=F.distdyn,be={bits:F.distbits},ce=E(_,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,be),F.distbits=be.bits,ce){j.msg="invalid distances set",F.mode=gt;break}if(F.mode=jt,ot===A)break t;case jt:F.mode=Ct;case Ct:if(st>=6&&Jt>=258){j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,m(j,Mt),fe=j.next_out,Ut=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,q=F.bits,F.mode===P&&(F.back=-1);break}for(F.back=0;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(re&&(re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.lencode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=ie,q-=ie,F.back+=ie}if(X>>>=Tt,q-=Tt,F.back+=Tt,F.length=ae,re===0){F.mode=Q;break}if(re&32){F.back=-1,F.mode=P;break}if(re&64){j.msg="invalid literal/length code",F.mode=gt;break}F.extra=re&15,F.mode=te;case te:if(F.extra){for(Se=F.extra;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.length+=X&(1<<F.extra)-1,X>>>=F.extra,q-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=N;case N:for(;Wt=F.distcode[X&(1<<F.distbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if((re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.distcode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=ie,q-=ie,F.back+=ie}if(X>>>=Tt,q-=Tt,F.back+=Tt,re&64){j.msg="invalid distance code",F.mode=gt;break}F.offset=ae,F.extra=re&15,F.mode=R;case R:if(F.extra){for(Se=F.extra;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.offset+=X&(1<<F.extra)-1,X>>>=F.extra,q-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){j.msg="invalid distance too far back",F.mode=gt;break}F.mode=Y;case Y:if(Jt===0)break t;if(ht=Mt-Jt,F.offset>ht){if(ht=F.offset-ht,ht>F.whave&&F.sane){j.msg="invalid distance too far back",F.mode=gt;break}ht>F.wnext?(ht-=F.wnext,qe=F.wsize-ht):qe=F.wnext-ht,ht>F.length&&(ht=F.length),De=F.window}else De=Ut,qe=fe-F.offset,ht=F.length;ht>Jt&&(ht=Jt),Jt-=ht,F.length-=ht;do Ut[fe++]=De[qe++];while(--ht);F.length===0&&(F.mode=Ct);break;case Q:if(Jt===0)break t;Ut[fe++]=F.length,Jt--,F.mode=Ct;break;case lt:if(F.wrap){for(;q<32;){if(st===0)break t;st--,X|=at[nt++]<<q,q+=8}if(Mt-=Jt,j.total_out+=Mt,F.total+=Mt,Mt&&(j.adler=F.check=F.flags?d(F.check,Ut,Mt,fe-Mt):y(F.check,Ut,Mt,fe-Mt)),Mt=Jt,(F.flags?X:k(X))!==F.check){j.msg="incorrect data check",F.mode=gt;break}X=0,q=0}F.mode=it;case it:if(F.wrap&&F.flags){for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X!==(F.total&4294967295)){j.msg="incorrect length check",F.mode=gt;break}X=0,q=0}F.mode=_t;case _t:ce=L;break t;case gt:ce=W;break t;case Yt:return U;case ue:default:return G}return j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,(F.wsize||Mt!==j.avail_out&&F.mode<gt&&(F.mode<lt||ot!==p))&&Ve(j,j.output,j.next_out,Mt-j.avail_out)?(F.mode=Yt,U):(or-=j.avail_in,Mt-=j.avail_out,j.total_in+=or,j.total_out+=Mt,F.total+=Mt,F.wrap&&Mt&&(j.adler=F.check=F.flags?d(F.check,Ut,Mt,j.next_out-Mt):y(F.check,Ut,Mt,j.next_out-Mt)),j.data_type=F.bits+(F.last?64:0)+(F.mode===P?128:0)+(F.mode===jt||F.mode===ut?256:0),(or===0&&Mt===0||ot===p)&&ce===b&&(ce=Et),ce)}function si(j){if(!j||!j.state)return G;var ot=j.state;return ot.window&&(ot.window=null),j.state=null,b}function ai(j,ot){var F;return!j||!j.state||(F=j.state,(F.wrap&2)===0)?G:(F.head=ot,ot.done=!1,b)}function ui(j,ot){var F=ot.length,at,Ut,nt;return!j||!j.state||(at=j.state,at.wrap!==0&&at.mode!==Xt)?G:at.mode===Xt&&(Ut=1,Ut=y(Ut,ot,F,0),Ut!==at.check)?W:(nt=Ve(j,ot,F,F),nt?(at.mode=Yt,U):(at.havedict=1,b))}o.inflateReset=J,o.inflateReset2=bt,o.inflateResetKeep=Z,o.inflateInit=Bt,o.inflateInit2=At,o.inflate=Ze,o.inflateEnd=si,o.inflateGetHeader=ai,o.inflateSetDictionary=ui,o.inflateInfo="pako inflate (from Nodeca project)"},function(h,o){"use strict";var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(d){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var E=m.shift();if(!!E){if(typeof E!="object")throw new TypeError(E+"must be non-object");for(var w in E)E.hasOwnProperty(w)&&(d[w]=E[w])}}return d},o.shrinkBuf=function(d,m){return d.length===m?d:d.subarray?d.subarray(0,m):(d.length=m,d)};var f={arraySet:function(d,m,E,w,c){if(m.subarray&&d.subarray){d.set(m.subarray(E,E+w),c);return}for(var _=0;_<w;_++)d[c+_]=m[E+_]},flattenChunks:function(d){var m,E,w,c,_,p;for(w=0,m=0,E=d.length;m<E;m++)w+=d[m].length;for(p=new Uint8Array(w),c=0,m=0,E=d.length;m<E;m++)_=d[m],p.set(_,c),c+=_.length;return p}},y={arraySet:function(d,m,E,w,c){for(var _=0;_<w;_++)d[c+_]=m[E+_]},flattenChunks:function(d){return[].concat.apply([],d)}};o.setTyped=function(d){d?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,f)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,y))},o.setTyped(s)},function(h,o){"use strict";function s(f,y,d,m){for(var E=f&65535|0,w=f>>>16&65535|0,c=0;d!==0;){c=d>2e3?2e3:d,d-=c;do E=E+y[m++]|0,w=w+E|0;while(--c);E%=65521,w%=65521}return E|w<<16|0}h.exports=s},function(h,o){"use strict";function s(){for(var d,m=[],E=0;E<256;E++){d=E;for(var w=0;w<8;w++)d=d&1?3988292384^d>>>1:d>>>1;m[E]=d}return m}var f=s();function y(d,m,E,w){var c=f,_=w+E;d^=-1;for(var p=w;p<_;p++)d=d>>>8^c[(d^m[p])&255];return d^-1}h.exports=y},function(h,o){"use strict";var s=30,f=12;h.exports=function(d,m){var E,w,c,_,p,T,A,b,L,C,G,W,U,Et,et,wt,pt,M,tt,ct,Nt,dt,Lt,kt,St;E=d.state,w=d.next_in,kt=d.input,c=w+(d.avail_in-5),_=d.next_out,St=d.output,p=_-(m-d.avail_out),T=_+(d.avail_out-257),A=E.dmax,b=E.wsize,L=E.whave,C=E.wnext,G=E.window,W=E.hold,U=E.bits,Et=E.lencode,et=E.distcode,wt=(1<<E.lenbits)-1,pt=(1<<E.distbits)-1;t:do{U<15&&(W+=kt[w++]<<U,U+=8,W+=kt[w++]<<U,U+=8),M=Et[W&wt];e:for(;;){if(tt=M>>>24,W>>>=tt,U-=tt,tt=M>>>16&255,tt===0)St[_++]=M&65535;else if(tt&16){ct=M&65535,tt&=15,tt&&(U<tt&&(W+=kt[w++]<<U,U+=8),ct+=W&(1<<tt)-1,W>>>=tt,U-=tt),U<15&&(W+=kt[w++]<<U,U+=8,W+=kt[w++]<<U,U+=8),M=et[W&pt];r:for(;;){if(tt=M>>>24,W>>>=tt,U-=tt,tt=M>>>16&255,tt&16){if(Nt=M&65535,tt&=15,U<tt&&(W+=kt[w++]<<U,U+=8,U<tt&&(W+=kt[w++]<<U,U+=8)),Nt+=W&(1<<tt)-1,Nt>A){d.msg="invalid distance too far back",E.mode=s;break t}if(W>>>=tt,U-=tt,tt=_-p,Nt>tt){if(tt=Nt-tt,tt>L&&E.sane){d.msg="invalid distance too far back",E.mode=s;break t}if(dt=0,Lt=G,C===0){if(dt+=b-tt,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Nt,Lt=St}}else if(C<tt){if(dt+=b+C-tt,tt-=C,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);if(dt=0,C<ct){tt=C,ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Nt,Lt=St}}}else if(dt+=C-tt,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Nt,Lt=St}for(;ct>2;)St[_++]=Lt[dt++],St[_++]=Lt[dt++],St[_++]=Lt[dt++],ct-=3;ct&&(St[_++]=Lt[dt++],ct>1&&(St[_++]=Lt[dt++]))}else{dt=_-Nt;do St[_++]=St[dt++],St[_++]=St[dt++],St[_++]=St[dt++],ct-=3;while(ct>2);ct&&(St[_++]=St[dt++],ct>1&&(St[_++]=St[dt++]))}}else if((tt&64)===0){M=et[(M&65535)+(W&(1<<tt)-1)];continue r}else{d.msg="invalid distance code",E.mode=s;break t}break}}else if((tt&64)===0){M=Et[(M&65535)+(W&(1<<tt)-1)];continue e}else if(tt&32){E.mode=f;break t}else{d.msg="invalid literal/length code",E.mode=s;break t}break}}while(w<c&&_<T);ct=U>>3,w-=ct,U-=ct<<3,W&=(1<<U)-1,d.next_in=w,d.next_out=_,d.avail_in=w<c?5+(c-w):5-(w-c),d.avail_out=_<T?257+(T-_):257-(_-T),E.hold=W,E.bits=U}},function(h,o,s){"use strict";var f=s(33),y=15,d=852,m=592,E=0,w=1,c=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],A=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];h.exports=function(L,C,G,W,U,Et,et,wt){var pt=wt.bits,M=0,tt=0,ct=0,Nt=0,dt=0,Lt=0,kt=0,St=0,Xt=0,P=0,z,K,ut,It,vt,xt=null,Rt=0,jt,Ct=new f.Buf16(y+1),te=new f.Buf16(y+1),N=null,R=0,Y,Q,lt;for(M=0;M<=y;M++)Ct[M]=0;for(tt=0;tt<W;tt++)Ct[C[G+tt]]++;for(dt=pt,Nt=y;Nt>=1&&Ct[Nt]===0;Nt--);if(dt>Nt&&(dt=Nt),Nt===0)return U[Et++]=1<<24|64<<16|0,U[Et++]=1<<24|64<<16|0,wt.bits=1,0;for(ct=1;ct<Nt&&Ct[ct]===0;ct++);for(dt<ct&&(dt=ct),St=1,M=1;M<=y;M++)if(St<<=1,St-=Ct[M],St<0)return-1;if(St>0&&(L===E||Nt!==1))return-1;for(te[1]=0,M=1;M<y;M++)te[M+1]=te[M]+Ct[M];for(tt=0;tt<W;tt++)C[G+tt]!==0&&(et[te[C[G+tt]]++]=tt);if(L===E?(xt=N=et,jt=19):L===w?(xt=_,Rt-=257,N=p,R-=257,jt=256):(xt=T,N=A,jt=-1),P=0,tt=0,M=ct,vt=Et,Lt=dt,kt=0,ut=-1,Xt=1<<dt,It=Xt-1,L===w&&Xt>d||L===c&&Xt>m)return 1;for(;;){Y=M-kt,et[tt]<jt?(Q=0,lt=et[tt]):et[tt]>jt?(Q=N[R+et[tt]],lt=xt[Rt+et[tt]]):(Q=32+64,lt=0),z=1<<M-kt,K=1<<Lt,ct=K;do K-=z,U[vt+(P>>kt)+K]=Y<<24|Q<<16|lt|0;while(K!==0);for(z=1<<M-1;P&z;)z>>=1;if(z!==0?(P&=z-1,P+=z):P=0,tt++,--Ct[M]===0){if(M===Nt)break;M=C[G+et[tt]]}if(M>dt&&(P&It)!==ut){for(kt===0&&(kt=dt),vt+=ct,Lt=M-kt,St=1<<Lt;Lt+kt<Nt&&(St-=Ct[Lt+kt],!(St<=0));)Lt++,St<<=1;if(Xt+=1<<Lt,L===w&&Xt>d||L===c&&Xt>m)return 1;ut=P&It,U[ut]=dt<<24|Lt<<16|vt-Et|0}}return P!==0&&(U[vt+P]=M-kt<<24|64<<16|0),wt.bits=dt,0}},function(h,o,s){"use strict";var f=s(33),y=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var m=new f.Buf8(256),E=0;E<256;E++)m[E]=E>=252?6:E>=248?5:E>=240?4:E>=224?3:E>=192?2:1;m[254]=m[254]=1,o.string2buf=function(c){var _,p,T,A,b,L=c.length,C=0;for(A=0;A<L;A++)p=c.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=c.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),C+=p<128?1:p<2048?2:p<65536?3:4;for(_=new f.Buf8(C),b=0,A=0;b<C;A++)p=c.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=c.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),p<128?_[b++]=p:p<2048?(_[b++]=192|p>>>6,_[b++]=128|p&63):p<65536?(_[b++]=224|p>>>12,_[b++]=128|p>>>6&63,_[b++]=128|p&63):(_[b++]=240|p>>>18,_[b++]=128|p>>>12&63,_[b++]=128|p>>>6&63,_[b++]=128|p&63);return _};function w(c,_){if(_<65537&&(c.subarray&&d||!c.subarray&&y))return String.fromCharCode.apply(null,f.shrinkBuf(c,_));for(var p="",T=0;T<_;T++)p+=String.fromCharCode(c[T]);return p}o.buf2binstring=function(c){return w(c,c.length)},o.binstring2buf=function(c){for(var _=new f.Buf8(c.length),p=0,T=_.length;p<T;p++)_[p]=c.charCodeAt(p);return _},o.buf2string=function(c,_){var p,T,A,b,L=_||c.length,C=new Array(L*2);for(T=0,p=0;p<L;){if(A=c[p++],A<128){C[T++]=A;continue}if(b=m[A],b>4){C[T++]=65533,p+=b-1;continue}for(A&=b===2?31:b===3?15:7;b>1&&p<L;)A=A<<6|c[p++]&63,b--;if(b>1){C[T++]=65533;continue}A<65536?C[T++]=A:(A-=65536,C[T++]=55296|A>>10&1023,C[T++]=56320|A&1023)}return w(C,T)},o.utf8border=function(c,_){var p;for(_=_||c.length,_>c.length&&(_=c.length),p=_-1;p>=0&&(c[p]&192)===128;)p--;return p<0||p===0?_:p+m[c[p]]>_?p:_}},function(h,o){"use strict";h.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(h,o){"use strict";h.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(h,o){"use strict";function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}h.exports=s},function(h,o){"use strict";function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}h.exports=s}])})});var vo=yr(ri=>{"use strict";ri.byteLength=hu;ri.toByteArray=pu;ri.fromByteArray=gu;var Ae=[],xe=[],cu=typeof Uint8Array<"u"?Uint8Array:Array,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(rr=0,yo=ki.length;rr<yo;++rr)Ae[rr]=ki[rr],xe[ki.charCodeAt(rr)]=rr;var rr,yo;xe["-".charCodeAt(0)]=62;xe["_".charCodeAt(0)]=63;function go(h){var o=h.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=h.indexOf("=");s===-1&&(s=o);var f=s===o?0:4-s%4;return[s,f]}function hu(h){var o=go(h),s=o[0],f=o[1];return(s+f)*3/4-f}function lu(h,o,s){return(o+s)*3/4-s}function pu(h){var o,s=go(h),f=s[0],y=s[1],d=new cu(lu(h,f,y)),m=0,E=y>0?f-4:f,w;for(w=0;w<E;w+=4)o=xe[h.charCodeAt(w)]<<18|xe[h.charCodeAt(w+1)]<<12|xe[h.charCodeAt(w+2)]<<6|xe[h.charCodeAt(w+3)],d[m++]=o>>16&255,d[m++]=o>>8&255,d[m++]=o&255;return y===2&&(o=xe[h.charCodeAt(w)]<<2|xe[h.charCodeAt(w+1)]>>4,d[m++]=o&255),y===1&&(o=xe[h.charCodeAt(w)]<<10|xe[h.charCodeAt(w+1)]<<4|xe[h.charCodeAt(w+2)]>>2,d[m++]=o>>8&255,d[m++]=o&255),d}function du(h){return Ae[h>>18&63]+Ae[h>>12&63]+Ae[h>>6&63]+Ae[h&63]}function yu(h,o,s){for(var f,y=[],d=o;d<s;d+=3)f=(h[d]<<16&16711680)+(h[d+1]<<8&65280)+(h[d+2]&255),y.push(du(f));return y.join("")}function gu(h){for(var o,s=h.length,f=s%3,y=[],d=16383,m=0,E=s-f;m<E;m+=d)y.push(yu(h,m,m+d>E?E:m+d));return f===1?(o=h[s-1],y.push(Ae[o>>2]+Ae[o<<4&63]+"==")):f===2&&(o=(h[s-2]<<8)+h[s-1],y.push(Ae[o>>10]+Ae[o>>4&63]+Ae[o<<2&63]+"=")),y.join("")}});var mo=yr(Ni=>{Ni.read=function(h,o,s,f,y){var d,m,E=y*8-f-1,w=(1<<E)-1,c=w>>1,_=-7,p=s?y-1:0,T=s?-1:1,A=h[o+p];for(p+=T,d=A&(1<<-_)-1,A>>=-_,_+=E;_>0;d=d*256+h[o+p],p+=T,_-=8);for(m=d&(1<<-_)-1,d>>=-_,_+=f;_>0;m=m*256+h[o+p],p+=T,_-=8);if(d===0)d=1-c;else{if(d===w)return m?NaN:(A?-1:1)*(1/0);m=m+Math.pow(2,f),d=d-c}return(A?-1:1)*m*Math.pow(2,d-f)};Ni.write=function(h,o,s,f,y,d){var m,E,w,c=d*8-y-1,_=(1<<c)-1,p=_>>1,T=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=f?0:d-1,b=f?1:-1,L=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(E=isNaN(o)?1:0,m=_):(m=Math.floor(Math.log(o)/Math.LN2),o*(w=Math.pow(2,-m))<1&&(m--,w*=2),m+p>=1?o+=T/w:o+=T*Math.pow(2,1-p),o*w>=2&&(m++,w/=2),m+p>=_?(E=0,m=_):m+p>=1?(E=(o*w-1)*Math.pow(2,y),m=m+p):(E=o*Math.pow(2,p-1)*Math.pow(2,y),m=0));y>=8;h[s+A]=E&255,A+=b,E/=256,y-=8);for(m=m<<y|E,c+=y;c>0;h[s+A]=m&255,A+=b,m/=256,c-=8);h[s+A-b]|=L*128}});var Co=yr(Sr=>{"use strict";var Ri=vo(),mr=mo(),wo=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Sr.Buffer=H;Sr.SlowBuffer=_u;Sr.INSPECT_MAX_BYTES=50;var ii=2147483647;Sr.kMaxLength=ii;H.TYPED_ARRAY_SUPPORT=vu();!H.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function vu(){try{let h=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(h,o),h.foo()===42}catch{return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.byteOffset}});function ze(h){if(h>ii)throw new RangeError('The value "'+h+'" is invalid for option "size"');let o=new Uint8Array(h);return Object.setPrototypeOf(o,H.prototype),o}function H(h,o,s){if(typeof h=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Li(h)}return xo(h,o,s)}H.poolSize=8192;function xo(h,o,s){if(typeof h=="string")return wu(h,o);if(ArrayBuffer.isView(h))return Su(h);if(h==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if(Le(h,ArrayBuffer)||h&&Le(h.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Le(h,SharedArrayBuffer)||h&&Le(h.buffer,SharedArrayBuffer)))return Oi(h,o,s);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let f=h.valueOf&&h.valueOf();if(f!=null&&f!==h)return H.from(f,o,s);let y=Eu(h);if(y)return y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return H.from(h[Symbol.toPrimitive]("string"),o,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}H.from=function(h,o,s){return xo(h,o,s)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function Fo(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(h<0)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function mu(h,o,s){return Fo(h),h<=0?ze(h):o!==void 0?typeof s=="string"?ze(h).fill(o,s):ze(h).fill(o):ze(h)}H.alloc=function(h,o,s){return mu(h,o,s)};function Li(h){return Fo(h),ze(h<0?0:Di(h)|0)}H.allocUnsafe=function(h){return Li(h)};H.allocUnsafeSlow=function(h){return Li(h)};function wu(h,o){if((typeof o!="string"||o==="")&&(o="utf8"),!H.isEncoding(o))throw new TypeError("Unknown encoding: "+o);let s=Io(h,o)|0,f=ze(s),y=f.write(h,o);return y!==s&&(f=f.slice(0,y)),f}function Ti(h){let o=h.length<0?0:Di(h.length)|0,s=ze(o);for(let f=0;f<o;f+=1)s[f]=h[f]&255;return s}function Su(h){if(Le(h,Uint8Array)){let o=new Uint8Array(h);return Oi(o.buffer,o.byteOffset,o.byteLength)}return Ti(h)}function Oi(h,o,s){if(o<0||h.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<o+(s||0))throw new RangeError('"length" is outside of buffer bounds');let f;return o===void 0&&s===void 0?f=new Uint8Array(h):s===void 0?f=new Uint8Array(h,o):f=new Uint8Array(h,o,s),Object.setPrototypeOf(f,H.prototype),f}function Eu(h){if(H.isBuffer(h)){let o=Di(h.length)|0,s=ze(o);return s.length===0||h.copy(s,0,0,o),s}if(h.length!==void 0)return typeof h.length!="number"||Bi(h.length)?ze(0):Ti(h);if(h.type==="Buffer"&&Array.isArray(h.data))return Ti(h.data)}function Di(h){if(h>=ii)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ii.toString(16)+" bytes");return h|0}function _u(h){return+h!=h&&(h=0),H.alloc(+h)}H.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==H.prototype};H.compare=function(o,s){if(Le(o,Uint8Array)&&(o=H.from(o,o.offset,o.byteLength)),Le(s,Uint8Array)&&(s=H.from(s,s.offset,s.byteLength)),!H.isBuffer(o)||!H.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===s)return 0;let f=o.length,y=s.length;for(let d=0,m=Math.min(f,y);d<m;++d)if(o[d]!==s[d]){f=o[d],y=s[d];break}return f<y?-1:y<f?1:0};H.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(o,s){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return H.alloc(0);let f;if(s===void 0)for(s=0,f=0;f<o.length;++f)s+=o[f].length;let y=H.allocUnsafe(s),d=0;for(f=0;f<o.length;++f){let m=o[f];if(Le(m,Uint8Array))d+m.length>y.length?(H.isBuffer(m)||(m=H.from(m)),m.copy(y,d)):Uint8Array.prototype.set.call(y,m,d);else if(H.isBuffer(m))m.copy(y,d);else throw new TypeError('"list" argument must be an Array of Buffers');d+=m.length}return y};function Io(h,o){if(H.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||Le(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);let s=h.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&s===0)return 0;let y=!1;for(;;)switch(o){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return Ai(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return Do(h).length;default:if(y)return f?-1:Ai(h).length;o=(""+o).toLowerCase(),y=!0}}H.byteLength=Io;function xu(h,o,s){let f=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,o>>>=0,s<=o))return"";for(h||(h="utf8");;)switch(h){case"hex":return Lu(this,o,s);case"utf8":case"utf-8":return ko(this,o,s);case"ascii":return Ou(this,o,s);case"latin1":case"binary":return Au(this,o,s);case"base64":return Ru(this,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Du(this,o,s);default:if(f)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),f=!0}}H.prototype._isBuffer=!0;function ir(h,o,s){let f=h[o];h[o]=h[s],h[s]=f}H.prototype.swap16=function(){let o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<o;s+=2)ir(this,s,s+1);return this};H.prototype.swap32=function(){let o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<o;s+=4)ir(this,s,s+3),ir(this,s+1,s+2);return this};H.prototype.swap64=function(){let o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<o;s+=8)ir(this,s,s+7),ir(this,s+1,s+6),ir(this,s+2,s+5),ir(this,s+3,s+4);return this};H.prototype.toString=function(){let o=this.length;return o===0?"":arguments.length===0?ko(this,0,o):xu.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(o){if(!H.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:H.compare(this,o)===0};H.prototype.inspect=function(){let o="",s=Sr.INSPECT_MAX_BYTES;return o=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(o+=" ... "),"<Buffer "+o+">"};wo&&(H.prototype[wo]=H.prototype.inspect);H.prototype.compare=function(o,s,f,y,d){if(Le(o,Uint8Array)&&(o=H.from(o,o.offset,o.byteLength)),!H.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(s===void 0&&(s=0),f===void 0&&(f=o?o.length:0),y===void 0&&(y=0),d===void 0&&(d=this.length),s<0||f>o.length||y<0||d>this.length)throw new RangeError("out of range index");if(y>=d&&s>=f)return 0;if(y>=d)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,y>>>=0,d>>>=0,this===o)return 0;let m=d-y,E=f-s,w=Math.min(m,E),c=this.slice(y,d),_=o.slice(s,f);for(let p=0;p<w;++p)if(c[p]!==_[p]){m=c[p],E=_[p];break}return m<E?-1:E<m?1:0};function bo(h,o,s,f,y){if(h.length===0)return-1;if(typeof s=="string"?(f=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,Bi(s)&&(s=y?0:h.length-1),s<0&&(s=h.length+s),s>=h.length){if(y)return-1;s=h.length-1}else if(s<0)if(y)s=0;else return-1;if(typeof o=="string"&&(o=H.from(o,f)),H.isBuffer(o))return o.length===0?-1:So(h,o,s,f,y);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?y?Uint8Array.prototype.indexOf.call(h,o,s):Uint8Array.prototype.lastIndexOf.call(h,o,s):So(h,[o],s,f,y);throw new TypeError("val must be string, number or Buffer")}function So(h,o,s,f,y){let d=1,m=h.length,E=o.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(h.length<2||o.length<2)return-1;d=2,m/=2,E/=2,s/=2}function w(_,p){return d===1?_[p]:_.readUInt16BE(p*d)}let c;if(y){let _=-1;for(c=s;c<m;c++)if(w(h,c)===w(o,_===-1?0:c-_)){if(_===-1&&(_=c),c-_+1===E)return _*d}else _!==-1&&(c-=c-_),_=-1}else for(s+E>m&&(s=m-E),c=s;c>=0;c--){let _=!0;for(let p=0;p<E;p++)if(w(h,c+p)!==w(o,p)){_=!1;break}if(_)return c}return-1}H.prototype.includes=function(o,s,f){return this.indexOf(o,s,f)!==-1};H.prototype.indexOf=function(o,s,f){return bo(this,o,s,f,!0)};H.prototype.lastIndexOf=function(o,s,f){return bo(this,o,s,f,!1)};function Fu(h,o,s,f){s=Number(s)||0;let y=h.length-s;f?(f=Number(f),f>y&&(f=y)):f=y;let d=o.length;f>d/2&&(f=d/2);let m;for(m=0;m<f;++m){let E=parseInt(o.substr(m*2,2),16);if(Bi(E))return m;h[s+m]=E}return m}function Iu(h,o,s,f){return ni(Ai(o,h.length-s),h,s,f)}function bu(h,o,s,f){return ni(Mu(o),h,s,f)}function ku(h,o,s,f){return ni(Do(o),h,s,f)}function Nu(h,o,s,f){return ni(Pu(o,h.length-s),h,s,f)}H.prototype.write=function(o,s,f,y){if(s===void 0)y="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")y=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,y===void 0&&(y="utf8")):(y=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-s;if((f===void 0||f>d)&&(f=d),o.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");y||(y="utf8");let m=!1;for(;;)switch(y){case"hex":return Fu(this,o,s,f);case"utf8":case"utf-8":return Iu(this,o,s,f);case"ascii":case"latin1":case"binary":return bu(this,o,s,f);case"base64":return ku(this,o,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Nu(this,o,s,f);default:if(m)throw new TypeError("Unknown encoding: "+y);y=(""+y).toLowerCase(),m=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ru(h,o,s){return o===0&&s===h.length?Ri.fromByteArray(h):Ri.fromByteArray(h.slice(o,s))}function ko(h,o,s){s=Math.min(h.length,s);let f=[],y=o;for(;y<s;){let d=h[y],m=null,E=d>239?4:d>223?3:d>191?2:1;if(y+E<=s){let w,c,_,p;switch(E){case 1:d<128&&(m=d);break;case 2:w=h[y+1],(w&192)===128&&(p=(d&31)<<6|w&63,p>127&&(m=p));break;case 3:w=h[y+1],c=h[y+2],(w&192)===128&&(c&192)===128&&(p=(d&15)<<12|(w&63)<<6|c&63,p>2047&&(p<55296||p>57343)&&(m=p));break;case 4:w=h[y+1],c=h[y+2],_=h[y+3],(w&192)===128&&(c&192)===128&&(_&192)===128&&(p=(d&15)<<18|(w&63)<<12|(c&63)<<6|_&63,p>65535&&p<1114112&&(m=p))}}m===null?(m=65533,E=1):m>65535&&(m-=65536,f.push(m>>>10&1023|55296),m=56320|m&1023),f.push(m),y+=E}return Tu(f)}var Eo=4096;function Tu(h){let o=h.length;if(o<=Eo)return String.fromCharCode.apply(String,h);let s="",f=0;for(;f<o;)s+=String.fromCharCode.apply(String,h.slice(f,f+=Eo));return s}function Ou(h,o,s){let f="";s=Math.min(h.length,s);for(let y=o;y<s;++y)f+=String.fromCharCode(h[y]&127);return f}function Au(h,o,s){let f="";s=Math.min(h.length,s);for(let y=o;y<s;++y)f+=String.fromCharCode(h[y]);return f}function Lu(h,o,s){let f=h.length;(!o||o<0)&&(o=0),(!s||s<0||s>f)&&(s=f);let y="";for(let d=o;d<s;++d)y+=zu[h[d]];return y}function Du(h,o,s){let f=h.slice(o,s),y="";for(let d=0;d<f.length-1;d+=2)y+=String.fromCharCode(f[d]+f[d+1]*256);return y}H.prototype.slice=function(o,s){let f=this.length;o=~~o,s=s===void 0?f:~~s,o<0?(o+=f,o<0&&(o=0)):o>f&&(o=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<o&&(s=o);let y=this.subarray(o,s);return Object.setPrototypeOf(y,H.prototype),y};function ne(h,o,s){if(h%1!==0||h<0)throw new RangeError("offset is not uint");if(h+o>s)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(o,s,f){o=o>>>0,s=s>>>0,f||ne(o,s,this.length);let y=this[o],d=1,m=0;for(;++m<s&&(d*=256);)y+=this[o+m]*d;return y};H.prototype.readUintBE=H.prototype.readUIntBE=function(o,s,f){o=o>>>0,s=s>>>0,f||ne(o,s,this.length);let y=this[o+--s],d=1;for(;s>0&&(d*=256);)y+=this[o+--s]*d;return y};H.prototype.readUint8=H.prototype.readUInt8=function(o,s){return o=o>>>0,s||ne(o,1,this.length),this[o]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(o,s){return o=o>>>0,s||ne(o,2,this.length),this[o]|this[o+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(o,s){return o=o>>>0,s||ne(o,2,this.length),this[o]<<8|this[o+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])};H.prototype.readBigUInt64LE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],f=this[o+7];(s===void 0||f===void 0)&&Br(o,this.length-8);let y=s+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24,d=this[++o]+this[++o]*2**8+this[++o]*2**16+f*2**24;return BigInt(y)+(BigInt(d)<<BigInt(32))});H.prototype.readBigUInt64BE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],f=this[o+7];(s===void 0||f===void 0)&&Br(o,this.length-8);let y=s*2**24+this[++o]*2**16+this[++o]*2**8+this[++o],d=this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+f;return(BigInt(y)<<BigInt(32))+BigInt(d)});H.prototype.readIntLE=function(o,s,f){o=o>>>0,s=s>>>0,f||ne(o,s,this.length);let y=this[o],d=1,m=0;for(;++m<s&&(d*=256);)y+=this[o+m]*d;return d*=128,y>=d&&(y-=Math.pow(2,8*s)),y};H.prototype.readIntBE=function(o,s,f){o=o>>>0,s=s>>>0,f||ne(o,s,this.length);let y=s,d=1,m=this[o+--y];for(;y>0&&(d*=256);)m+=this[o+--y]*d;return d*=128,m>=d&&(m-=Math.pow(2,8*s)),m};H.prototype.readInt8=function(o,s){return o=o>>>0,s||ne(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]};H.prototype.readInt16LE=function(o,s){o=o>>>0,s||ne(o,2,this.length);let f=this[o]|this[o+1]<<8;return f&32768?f|4294901760:f};H.prototype.readInt16BE=function(o,s){o=o>>>0,s||ne(o,2,this.length);let f=this[o+1]|this[o]<<8;return f&32768?f|4294901760:f};H.prototype.readInt32LE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24};H.prototype.readInt32BE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]};H.prototype.readBigInt64LE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],f=this[o+7];(s===void 0||f===void 0)&&Br(o,this.length-8);let y=this[o+4]+this[o+5]*2**8+this[o+6]*2**16+(f<<24);return(BigInt(y)<<BigInt(32))+BigInt(s+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24)});H.prototype.readBigInt64BE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],f=this[o+7];(s===void 0||f===void 0)&&Br(o,this.length-8);let y=(s<<24)+this[++o]*2**16+this[++o]*2**8+this[++o];return(BigInt(y)<<BigInt(32))+BigInt(this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+f)});H.prototype.readFloatLE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),mr.read(this,o,!0,23,4)};H.prototype.readFloatBE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),mr.read(this,o,!1,23,4)};H.prototype.readDoubleLE=function(o,s){return o=o>>>0,s||ne(o,8,this.length),mr.read(this,o,!0,52,8)};H.prototype.readDoubleBE=function(o,s){return o=o>>>0,s||ne(o,8,this.length),mr.read(this,o,!1,52,8)};function ye(h,o,s,f,y,d){if(!H.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>y||o<d)throw new RangeError('"value" argument is out of bounds');if(s+f>h.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(o,s,f,y){if(o=+o,s=s>>>0,f=f>>>0,!y){let E=Math.pow(2,8*f)-1;ye(this,o,s,f,E,0)}let d=1,m=0;for(this[s]=o&255;++m<f&&(d*=256);)this[s+m]=o/d&255;return s+f};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(o,s,f,y){if(o=+o,s=s>>>0,f=f>>>0,!y){let E=Math.pow(2,8*f)-1;ye(this,o,s,f,E,0)}let d=f-1,m=1;for(this[s+d]=o&255;--d>=0&&(m*=256);)this[s+d]=o/m&255;return s+f};H.prototype.writeUint8=H.prototype.writeUInt8=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,1,255,0),this[s]=o&255,s+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,2,65535,0),this[s]=o&255,this[s+1]=o>>>8,s+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,2,65535,0),this[s]=o>>>8,this[s+1]=o&255,s+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,4,4294967295,0),this[s+3]=o>>>24,this[s+2]=o>>>16,this[s+1]=o>>>8,this[s]=o&255,s+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,4,4294967295,0),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};function No(h,o,s,f,y){Lo(o,f,y,h,s,7);let d=Number(o&BigInt(4294967295));h[s++]=d,d=d>>8,h[s++]=d,d=d>>8,h[s++]=d,d=d>>8,h[s++]=d;let m=Number(o>>BigInt(32)&BigInt(4294967295));return h[s++]=m,m=m>>8,h[s++]=m,m=m>>8,h[s++]=m,m=m>>8,h[s++]=m,s}function Ro(h,o,s,f,y){Lo(o,f,y,h,s,7);let d=Number(o&BigInt(4294967295));h[s+7]=d,d=d>>8,h[s+6]=d,d=d>>8,h[s+5]=d,d=d>>8,h[s+4]=d;let m=Number(o>>BigInt(32)&BigInt(4294967295));return h[s+3]=m,m=m>>8,h[s+2]=m,m=m>>8,h[s+1]=m,m=m>>8,h[s]=m,s+8}H.prototype.writeBigUInt64LE=He(function(o,s=0){return No(this,o,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=He(function(o,s=0){return Ro(this,o,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(o,s,f,y){if(o=+o,s=s>>>0,!y){let w=Math.pow(2,8*f-1);ye(this,o,s,f,w-1,-w)}let d=0,m=1,E=0;for(this[s]=o&255;++d<f&&(m*=256);)o<0&&E===0&&this[s+d-1]!==0&&(E=1),this[s+d]=(o/m>>0)-E&255;return s+f};H.prototype.writeIntBE=function(o,s,f,y){if(o=+o,s=s>>>0,!y){let w=Math.pow(2,8*f-1);ye(this,o,s,f,w-1,-w)}let d=f-1,m=1,E=0;for(this[s+d]=o&255;--d>=0&&(m*=256);)o<0&&E===0&&this[s+d+1]!==0&&(E=1),this[s+d]=(o/m>>0)-E&255;return s+f};H.prototype.writeInt8=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,1,127,-128),o<0&&(o=255+o+1),this[s]=o&255,s+1};H.prototype.writeInt16LE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,2,32767,-32768),this[s]=o&255,this[s+1]=o>>>8,s+2};H.prototype.writeInt16BE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,2,32767,-32768),this[s]=o>>>8,this[s+1]=o&255,s+2};H.prototype.writeInt32LE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,4,2147483647,-2147483648),this[s]=o&255,this[s+1]=o>>>8,this[s+2]=o>>>16,this[s+3]=o>>>24,s+4};H.prototype.writeInt32BE=function(o,s,f){return o=+o,s=s>>>0,f||ye(this,o,s,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};H.prototype.writeBigInt64LE=He(function(o,s=0){return No(this,o,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=He(function(o,s=0){return Ro(this,o,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function To(h,o,s,f,y,d){if(s+f>h.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function Oo(h,o,s,f,y){return o=+o,s=s>>>0,y||To(h,o,s,4,34028234663852886e22,-34028234663852886e22),mr.write(h,o,s,f,23,4),s+4}H.prototype.writeFloatLE=function(o,s,f){return Oo(this,o,s,!0,f)};H.prototype.writeFloatBE=function(o,s,f){return Oo(this,o,s,!1,f)};function Ao(h,o,s,f,y){return o=+o,s=s>>>0,y||To(h,o,s,8,17976931348623157e292,-17976931348623157e292),mr.write(h,o,s,f,52,8),s+8}H.prototype.writeDoubleLE=function(o,s,f){return Ao(this,o,s,!0,f)};H.prototype.writeDoubleBE=function(o,s,f){return Ao(this,o,s,!1,f)};H.prototype.copy=function(o,s,f,y){if(!H.isBuffer(o))throw new TypeError("argument should be a Buffer");if(f||(f=0),!y&&y!==0&&(y=this.length),s>=o.length&&(s=o.length),s||(s=0),y>0&&y<f&&(y=f),y===f||o.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("sourceEnd out of bounds");y>this.length&&(y=this.length),o.length-s<y-f&&(y=o.length-s+f);let d=y-f;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,y):Uint8Array.prototype.set.call(o,this.subarray(f,y),s),d};H.prototype.fill=function(o,s,f,y){if(typeof o=="string"){if(typeof s=="string"?(y=s,s=0,f=this.length):typeof f=="string"&&(y=f,f=this.length),y!==void 0&&typeof y!="string")throw new TypeError("encoding must be a string");if(typeof y=="string"&&!H.isEncoding(y))throw new TypeError("Unknown encoding: "+y);if(o.length===1){let m=o.charCodeAt(0);(y==="utf8"&&m<128||y==="latin1")&&(o=m)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,o||(o=0);let d;if(typeof o=="number")for(d=s;d<f;++d)this[d]=o;else{let m=H.isBuffer(o)?o:H.from(o,y),E=m.length;if(E===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(d=0;d<f-s;++d)this[d+s]=m[d%E]}return this};var vr={};function Ci(h,o,s){vr[h]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:o.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${h}]`,this.stack,delete this.name}get code(){return h}set code(y){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:y,writable:!0})}toString(){return`${this.name} [${h}]: ${this.message}`}}}Ci("ERR_BUFFER_OUT_OF_BOUNDS",function(h){return h?`${h} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ci("ERR_INVALID_ARG_TYPE",function(h,o){return`The "${h}" argument must be of type number. Received type ${typeof o}`},TypeError);Ci("ERR_OUT_OF_RANGE",function(h,o,s){let f=`The value of "${h}" is out of range.`,y=s;return Number.isInteger(s)&&Math.abs(s)>2**32?y=_o(String(s)):typeof s=="bigint"&&(y=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(y=_o(y)),y+="n"),f+=` It must be ${o}. Received ${y}`,f},RangeError);function _o(h){let o="",s=h.length,f=h[0]==="-"?1:0;for(;s>=f+4;s-=3)o=`_${h.slice(s-3,s)}${o}`;return`${h.slice(0,s)}${o}`}function Cu(h,o,s){wr(o,"offset"),(h[o]===void 0||h[o+s]===void 0)&&Br(o,h.length-(s+1))}function Lo(h,o,s,f,y,d){if(h>s||h<o){let m=typeof o=="bigint"?"n":"",E;throw d>3?o===0||o===BigInt(0)?E=`>= 0${m} and < 2${m} ** ${(d+1)*8}${m}`:E=`>= -(2${m} ** ${(d+1)*8-1}${m}) and < 2 ** ${(d+1)*8-1}${m}`:E=`>= ${o}${m} and <= ${s}${m}`,new vr.ERR_OUT_OF_RANGE("value",E,h)}Cu(f,y,d)}function wr(h,o){if(typeof h!="number")throw new vr.ERR_INVALID_ARG_TYPE(o,"number",h)}function Br(h,o,s){throw Math.floor(h)!==h?(wr(h,s),new vr.ERR_OUT_OF_RANGE(s||"offset","an integer",h)):o<0?new vr.ERR_BUFFER_OUT_OF_BOUNDS:new vr.ERR_OUT_OF_RANGE(s||"offset",`>= ${s?1:0} and <= ${o}`,h)}var Bu=/[^+/0-9A-Za-z-_]/g;function Uu(h){if(h=h.split("=")[0],h=h.trim().replace(Bu,""),h.length<2)return"";for(;h.length%4!==0;)h=h+"=";return h}function Ai(h,o){o=o||1/0;let s,f=h.length,y=null,d=[];for(let m=0;m<f;++m){if(s=h.charCodeAt(m),s>55295&&s<57344){if(!y){if(s>56319){(o-=3)>-1&&d.push(239,191,189);continue}else if(m+1===f){(o-=3)>-1&&d.push(239,191,189);continue}y=s;continue}if(s<56320){(o-=3)>-1&&d.push(239,191,189),y=s;continue}s=(y-55296<<10|s-56320)+65536}else y&&(o-=3)>-1&&d.push(239,191,189);if(y=null,s<128){if((o-=1)<0)break;d.push(s)}else if(s<2048){if((o-=2)<0)break;d.push(s>>6|192,s&63|128)}else if(s<65536){if((o-=3)<0)break;d.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((o-=4)<0)break;d.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return d}function Mu(h){let o=[];for(let s=0;s<h.length;++s)o.push(h.charCodeAt(s)&255);return o}function Pu(h,o){let s,f,y,d=[];for(let m=0;m<h.length&&!((o-=2)<0);++m)s=h.charCodeAt(m),f=s>>8,y=s%256,d.push(y),d.push(f);return d}function Do(h){return Ri.toByteArray(Uu(h))}function ni(h,o,s,f){let y;for(y=0;y<f&&!(y+s>=o.length||y>=h.length);++y)o[y+s]=h[y];return y}function Le(h,o){return h instanceof o||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===o.name}function Bi(h){return h!==h}var zu=function(){let h="0123456789abcdef",o=new Array(256);for(let s=0;s<16;++s){let f=s*16;for(let y=0;y<16;++y)o[f+y]=h[s]+h[y]}return o}();function He(h){return typeof BigInt>"u"?ju:h}function ju(){throw new Error("BigInt not supported")}});var Xo=yr((Rf,Xu)=>{Xu.exports=""});var Yo=yr((Df,Gu)=>{Gu.exports=`\r
\r
\r
<!--\r
\r
<Menu>\r
<ImageOrVid><Result watched image>\r
<Result Spectrogram> <Compared Spectrogram> (can overlay)\r
<Res2>               <Comp2>\r
    ...                 ...\r
\r
todo:\r
\r
Concise menu, finish file loading\r
Result list + comparison\r
Result saving/loading files\r
mediarecorder on canvas result too for vod\r
webworkers probably good idea for processing image on secondary canvases\r
\r
frame buffering stuff cuz graphs\r
\r
\r
-->\r
\r
        <div id="pickerDiv" style="position: relative;"> <!-- We want the source canvas to maintain the source image/video's aspect ratio so it looks correct, the capture can be stretched otherwise-->\r
            <img src="" style="position: absolute; top: 0; z-index:1;" ></img>\r
            <video src="" style="position: absolute; top: 0; display:none; z-index:2;" ></video>\r
            <canvas id="picker" style="position: absolute; top: 0; z-index:3;" ></canvas>\r
        </div>\r
        <div id="captureDiv"><canvas id="capture" style="z-index:11;"></canvas></div>\r
        \r
        <button id="toggleMenu">Toggle Menu</button>\r
\r
        <div id="menu" style="">\r
            <button id="snip">Analyze</button>\r
            <button id="animate">Record</button>\r
            <button id="webcam">Use Webcam</button>\r
            <button id="image">Use Image</button>\r
            <span style="color:white;">Image:</span><select id="imgselect">\r
                <option value="src/assets/spectrum_full.png" selected>Full Image</option>\r
                <option value="src/assets/spectrum1.png">Spectrum 1</option>\r
                <option value="src/assets/spectrum2.jpg">Spectrum 2</option>\r
                <option value="src/assets/shrimp.jpg">Shrimp</option>\r
                <option value="src/assets/chickenfat.png">Chicken Fat</option>\r
                <option value="src/assets/chickenbreast.png">Chicken Breast</option>\r
                <option value="src/assets/brownbeerbottle.png">Brown Beer Bottle</option>\r
            </select>\r
            <input type="url" id="imgurl" placeholder="Image URL"></input>\r
            <button id="setImgUrl">Set Image URL</button>\r
            <input type="url" id="videourl" placeholder="Video URL"></input>\r
            <button id="setVideoUrl">Set Video URL</button>\r
            <button id="fileinput">Load File</button>\r
            <span style="color:white;">Click to draw a rectangle around the portion of the image you want to analyze!</span>\r
        <hr>\r
        <div  id="compare" style="overflow-y:scroll;">\r
        </div>\r
        <div id="captured" style="overflow-y:scroll;">\r
        </div>\r
        <div id="saved" style="overflow-y:scroll;">\r
        </div>`});var Dr=class{constructor(o=this.onOpen,s=null,f=null){this.onOpen=o,this.notes=[{idx:0,text:"comment"}],s!==null&&document.getElementById(s).addEventListener("click",this.saveCSV),f!==null&&document.getElementById(f).addEventListener("click",this.openCSV)}processArraysForCSV(o=["1|2|3","3|2|1"],s="|",f="a,b,c",y=!1){let d=f+`
`,m=0;return o.forEach((E,w)=>{o[w]==="string"&&s!==","?d+=E.split(s).join(","):csvData+=E.join(","),y===!0&&this.notes[m].idx===w&&(E+=this.notes[m].text,m++),E.indexOf(`
`)<0&&(d+=`
`)}),d}static saveCSV(o=`a,b,c
1,2,3
3,2,1
`,s=new Date().toISOString()){var f=document.createElement("a");f.href="data:text/csv;charset=utf-8,"+encodeURI(o),f.target="_blank",s!==""?f.download=s+".csv":f.download=Date().toISOString()+".csv",f.click()}static openCSV(o=",",s=(f,y,d)=>d){var f=document.createElement("input");f.accept=".csv",f.type="file",f.onchange=y=>{var d=y.target.files[0],m=new FileReader;m.onload=E=>{var w=E.target.result,c=w.split(`
`);let _=[];var p=[];c.pop(),c.forEach((T,A)=>{if(A==0)_=T.split(o);else{var b=T.split(o);p.push(b)}}),s(p,_,f.value),f.value=""},m.readAsText(d)},f.click()}static openCSVRaw(o=(s,f)=>f){var s=document.createElement("input");s.accept=".csv",s.type="file",s.onchange=f=>{var y=f.target.files[0],d=new FileReader;d.onload=m=>{var E=m.target.result;o(E,s.value),s.value=""},d.readAsText(y)},s.click()}onOpen(o=[],s=[]){console.log("CSV Opened!",s,o)}};var er=fo(co()),ho=!1,bi=er.BFSRequire("fs"),uf=er.BFSRequire("buffer").Buffer,lo=async(h=["data","projects","extensions","settings","plugins"],o=()=>{},s=()=>{})=>ho?!0:new Promise(f=>{let y=bi.getRootFS();er.FileSystem.IndexedDB.Create({},(d,m)=>{if(d)throw d;if(!m)throw s(),new Error("Error creating BrowserFS");er.initialize(m);let E=[];h.forEach(async w=>{E.push(fu(bi,w))}),Promise.all(E).then(w=>{o(),ho=!0,f(!0)})})});var po=async(h,o,s="data",f=y=>{})=>new Promise(y=>{bi.writeFile("/"+s+"/"+h,o,d=>{if(d)throw d;f(o),y(!0)})});var gr={},fu=async(h,o)=>new Promise(s=>{gr[o]==="exists"||gr[o]==="created"?s():h.exists(`/${o}`,f=>{f?(gr[o]="exists",console.log(`/${o} exists!`),s()):gr[o]==="creating"?(console.log(o+" is still being created."),s()):(console.log("creating "+o),gr[o]="creating",h.mkdir(o,y=>{if(y)throw y;gr[o]="created",setTimeout(s,500)}))})});var Ui=fo(Co());var Mi={getImageData:function(h){var o=h.width,s=h.height,f=h.getContext("2d").getImageData(0,0,o,s);return f},toArrayBuffer:function(h){var o=canvas.width,s=canvas.height,f=o*4,y=new Uint32Array(h.data.buffer),d=Math.floor((32*o+31)/32)*4,m=d*s,E=122+m,w=new ArrayBuffer(E),c=new DataView(w),_=0,p,T=0,A,b=0,L,C;for(G(19778),W(E),_+=4,W(122),W(108),W(o),W(-s>>>0),G(1),G(32),W(3),W(m),W(2835),W(2835),_+=8,W(16711680),W(65280),W(255),W(4278190080),W(1466527264);T<s;){for(A=122+T*d,p=0;p<f;)C=y[b++],L=C>>>24,c.setUint32(A+p,C<<8|L),p+=4;T++}return w;function G(U){c.setUint16(_,U,!0),_+=2}function W(U){c.setUint32(_,U,!0),_+=4}},toBlob:function(h){return new Blob([this.toArrayBuffer(this.getImageData(h))],{type:"image/bmp"})},ImageDatatoBlob:function(h){return new Blob([this.toArrayBuffer(h)],{type:"image/bmp"})},toDataURL:function(h){for(var o=new Uint8Array(this.toArrayBuffer(this.getImageData(h))),s="",f=0,y=o.length;f<y;)s+=String.fromCharCode(o[f++]);return"data:image/bmp;base64,"+Ui.Buffer.from(s,"base64").toString("ascii")},ImageDatatoDataURL:function(h){for(var o=new Uint8Array(this.toArrayBuffer(h)),s="",f=0,y=o.length;f<y;)s+=String.fromCharCode(o[f++]);return"data:image/bmp;base64,"+Ui.Buffer.from(s,"base64").toString("ascii")}};function Ur(h,o,s,f,y=0,d=0){if(h.naturalWidth)return{x:h.naturalWidth*(s-y)/o.width,y:h.naturalHeight*(f-d)/o.height};if(h.videoWidth)return{x:h.videoWidth*(s-y)/o.width,y:h.videoHeight*(f-d)/o.height};if(h.width)return{x:h.width*(s-y)/o.width,y:h.height*(f-d)/o.height}}function Wu(h){let o=Array.from(h.data),s=[],f=0;for(let c=0;c<o.length;c+=4)c/4%h.width===0&&(f=0),s[f]?(s[f].i+=parseFloat(o[c]+o[c+1]+o[c+2]),s[f].r+=parseFloat(o[c]),s[f].g+=parseFloat(o[c+1]),s[f].b+=parseFloat(o[c+2])):s[f]={i:parseFloat(o[c]+o[c+1]+o[c+2]),r:parseFloat(o[c]),g:parseFloat(o[c+1]),b:parseFloat(o[c+2])},f++;let y=Math.max(...s.map(c=>c.i)),d=Math.max(...s.map(c=>c.r)),m=Math.max(...s.map(c=>c.b)),E=Math.max(...s.map(c=>c.g)),w=Math.max(d,m,E);return{bitmap:h,width:h.width,height:h.height,bitarr:o,xrgbintensities:s,xintmax:y,xrintmax:d,xbintmax:m,xgintmax:E,xrgbmax:w}}async function Bo(h,o){let s=Object.assign({},h);delete s.bitmap;let f=JSON.stringify(s);return await po(o,f,"processed")}function Uo(h,o,s){return new ImageData(Uint8ClampedArray.from(h),o,s)}function Mo(h,o,s=0,f=0,y=o.width,d=o.height,m=0,E=0,w=h.canvas.width,c=h.canvas.height){return h.drawImage(o,s,f,y,d,m,E,w,c)}function Po(h,o,s=0,f=0,y=h.canvas.width,d=h.canvas.height){let m=Wu(o);h.fillStyle="white",h.strokeStyle="ghostwhite",h.lineWidth=1,h.beginPath();let E=m.xrgbintensities.length,w=y/E;return m.xrgbintensities.forEach((c,_)=>{_===0?h.moveTo(s,f+d*(1-c.i/m.xintmax)):h.lineTo(s+_*w,f+d*(1-c.i/m.xintmax))}),h.stroke(),h.strokeStyle="tomato",h.lineWidth=1,h.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?h.moveTo(s,f+d*(1-c.r/m.xintmax)):h.lineTo(s+_*w,f+d*(1-c.r/m.xintmax))}),h.stroke(),h.strokeStyle="#00b8f5",h.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?h.moveTo(s,f+d*(1-c.b/m.xintmax)):h.lineTo(s+_*w,f+d*(1-c.b/m.xintmax))}),h.stroke(),h.strokeStyle="chartreuse",h.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?h.moveTo(s,f+d*(1-c.g/m.xintmax)):h.lineTo(s+_*w,f+d*(1-c.g/m.xintmax))}),h.stroke(),m}function zo(h,o=30,s=Hu){let f=h.captureStream(o),y=new MediaRecorder(f),d=[];return y.ondataavailable=function(m){d.push(m.data)},y.onstop=function(m){let E=new Blob(d,{type:"video/mp4"});d=[];let w=URL.createObjectURL(E);s(w)},y}function Hu(h,o=new Date().toISOString()){var s=document.createElement("a");s.href=h,s.target="_blank",o!==""?s.download=o+".mp4":s.download=new Date().toISOString()+".mp4",s.click()}function jo(h){var o=new DataView(h),s={};s.fileheader={},s.fileheader.bfType=o.getUint16(0,!0),s.fileheader.bfSize=o.getUint32(2,!0),s.fileheader.bfReserved1=o.getUint16(6,!0),s.fileheader.bfReserved2=o.getUint16(8,!0),s.fileheader.bfOffBits=o.getUint32(10,!0),s.infoheader={},s.infoheader.biSize=o.getUint32(14,!0),s.infoheader.biWidth=o.getUint32(18,!0),s.infoheader.biHeight=o.getUint32(22,!0),s.infoheader.biPlanes=o.getUint16(26,!0),s.infoheader.biBitCount=o.getUint16(28,!0),s.infoheader.biCompression=o.getUint32(30,!0),s.infoheader.biSizeImage=o.getUint32(34,!0),s.infoheader.biXPelsPerMeter=o.getUint32(38,!0),s.infoheader.biYPelsPerMeter=o.getUint32(42,!0),s.infoheader.biClrUsed=o.getUint32(46,!0),s.infoheader.biClrImportant=o.getUint32(50,!0);var f=s.fileheader.bfOffBits;return s.stride=Math.floor((s.infoheader.biBitCount*s.infoheader.biWidth+31)/32)*4,s.pixels=new Uint8Array(h,f),s}function Wo(h){canvas=document.createElement("canvas");var o=canvas.getContext("2d"),s=h.infoheader.biWidth,f=h.infoheader.biHeight;canvas.width=s,canvas.height=f;for(var y=o.createImageData(s,f),d=y.data,m=h.pixels,E=h.stride,w=0;w<f;++w)for(var c=0;c<s;++c){var _=(c+s*(f-w))*4,p=c*3+E*w;d[_]=m[p+2],d[_+1]=m[p+1],d[_+2]=m[p],d[_+3]=255}return o.putImageData(y,0,0),canvas.toDataURL("image/png")}function Ho(h,o){let s=`x,r,g,b,i
`,f="";h.forEach((d,m)=>{f+=`${m},${d.r},${d.g},${d.b},${d.i}
`});let y=s+f;Dr.saveCSV(y,o+"_"+new Date().toISOString())}async function Vo(h,o,s="320px",f="180px"){let y=`
    <div style='width:${s}; height:${f};'>
        <div>
            <input id='title' type='text' placeholder='name'>
            <button id='toggledisplay'>Toggle Display</button>
            <button id='savepng'>Save PNG</button>
            <button id='savebmp'>Save BMP</button>
            <button id='savecsv'>Save CSV</button>
            <button id='backup'>Backup</button>
            <button id='X'>X</button>
        </div>
        <canvas id='capturecanvas' style='width:100%; height:100%;'></canvas>
        <canvas id='graphcanvas' style='width:100%; height:100%;'></canvas>
    </div>`;if(typeof o=="string"&&(o=document.getElementById(o)),o){o.insertAdjacentHTML("afterbegin",y);let d=document.querySelector("#capturecanvas");d.width=h.width,d.height=h.height;let m=d.getContext("2d");m.drawImage(h,0,0);let E=document.querySelector("#title");console.log(h);let w=m.getImageData(0,0,d.width,d.height),c=document.querySelector("#graphcanvas"),_=Po(c.getContext("2d"),w),p={parentNode:o,width:h.width,height:h.height,canvas:d,input:E,mapped:_};return o.querySelector("#toggledisplay").onclick=()=>{d.style.display==""&&c.style.display==""?d.style.display="none":d.style.display=="none"?(d.style.display="",c.style.display="none"):c.style.display=="none"&&(c.style.display="")},o.querySelector("#backup").onclick=()=>{Bo(p.mapped,E.value+"_"+new Date().toISOString())},o.querySelector("#savepng").onclick=()=>{let T=new OffscreenCanvas(p.mapped.bitmap.width,p.mapped.bitmap.height);T.getContext("2d").drawImage(h,0,0);let A=new FileReader;A.addEventListener("load",function(){var b=document.createElement("a");b.href=A.result,b.target="_blank",E.value!==""?b.download=E.value+"_"+new Date().toISOString()+".png":b.download=new Date().toISOString()+".png",b.click()},!1),T.convertToBlob({type:"image/png"}).then(b=>{A.readAsDataURL(b)})},o.querySelector("#savebmp").onclick=()=>{let T=Mi.ImageDatatoDataURL(Uo(p.mapped.bitarr,p.mapped.width,p.mapped.height));var A=document.createElement("a");A.href=T,A.target="_blank",E.value!==""?A.download=E.value+"_"+new Date().toISOString()+".bmp":A.download=new Date().toISOString()+".bmp",A.click()},o.querySelector("#savecsv").onclick=()=>{Ho(p.mapped.xrgbintensities,E.value)},o.querySelector("#X").onclick=()=>{d.parentNode.parentNode.removeChild(d.parentNode)},p}return y}var oi=class extends HTMLElement{template=o=>`<div> Custom Fragment Props: ${JSON.stringify(o)} </div>`;props={test:!0};useShadow=!1;oncreate=void 0;onresize=void 0;ondelete=void 0;onchanged=void 0;FRAGMENT=void 0;attachedShadow=!1;obsAttributes=["props","options","onchanged","onresize","ondelete","oncreate","template"];get observedAttributes(){return this.obsAttributes}get obsAttributes(){return this.obsAttributes}set obsAttributes(o){typeof o=="string"?this.obsAttributes.push(o):Array.isArray(o)&&(this.obsAttributes=o)}static get tag(){return this.name.toLowerCase()+"-"}static addElement(o=this.tag,s=this,f=void 0){Vu(s,o,f)}attributeChangedCallback(o,s,f){if(o==="onchanged"){let y=f;if(typeof y=="string"&&(y=Er(y)),typeof y=="function"){this.onchanged=y,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged);let d=new CustomEvent("changed",{detail:{props:this.props}});this.state.subscribeTrigger("props",()=>{this.dispatchEvent(d)})}}else if(o==="onresize"){let y=f;if(typeof y=="string"&&(y=Er(y)),typeof y=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=d=>{this.onresize(this.props)},this.onresize=y,window.addEventListener("resize",this.ONRESIZE)}}else if(o==="ondelete"){let y=f;typeof y=="string"&&(y=Er(y)),typeof y=="function"&&(this.ondelete=()=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),y&&y(this.props)})}else if(o==="oncreate"){let y=f;typeof y=="string"&&(y=Er(y)),typeof y=="function"&&(this.oncreate=y)}else if(o==="props"){let y=f;typeof y=="string"&&(y=JSON.parse(y)),Object.assign(this.props,y),this.state.setState({props:this.props})}else if(o==="template"){let y=f;this.template=options.template,typeof y=="function"?this.templateString=this.template(this.props):this.templateString=y,this.render(this.props);let d=new CustomEvent("created",{detail:{props:this.props}});this.dispatchEvent(d)}else{let y=f;if(o.includes("eval_"))o=o.split("_"),o.shift(),o=o.join(),y=Er(f);else if(typeof f=="string")try{y=JSON.parse(f)}catch{y=f}this[o]=y,o!=="props"&&(this.props[o]=y)}}connectedCallback(){let o=this.getAttribute("props");typeof o=="string"&&(o=JSON.parse(o)),Object.assign(this.props,o),this.state.setState({props:this.props}),Array.from(this.attributes).forEach(m=>{let E=m.name,w=m.value;if(E.includes("eval_"))E=E.split("_"),E.shift(),E=E.join(),w=Er(m.value);else if(typeof m.value=="string")try{w=JSON.parse(m.value)}catch{w=m.value}this[E]||Object.defineProperties(this,m,{value:w,writable:!0,get(){return this[E]},set(c){this.setAttribute(E,c)}}),this[E]=w,E!=="props"&&(this.props[E]=w),this.obsAttributes.push(E)});let s=new CustomEvent("resized",{detail:{props:this.props}}),f=new CustomEvent("changed",{detail:{props:this.props}}),y=new CustomEvent("deleted",{detail:{props:this.props}}),d=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(d),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(f)}),typeof this.onresize=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=m=>{this.onresize(this.props),this.dispatchEvent(s)},window.addEventListener("resize",this.ONRESIZE)}if(typeof this.ondelete=="function"){let m=this.ondelete;this.ondelete=(E=this.props)=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),this.dispatchEvent(y),m(E)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}constructor(){super()}delete=()=>{this.remove(),typeof this.ondelete=="function"&&this.ondelete(this.props)};render=(o=this.props)=>{typeof this.template=="function"?this.templateString=this.template(o):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let f=s.content;this.FRAGMENT&&(this.useShadow?this.shadowRoot.removeChild(this.FRAGMENT):this.removeChild(this.FRAGMENT)),this.useShadow?(this.attachedShadow||this.attachShadow({mode:"open"}),this.shadowRoot.prepend(f),this.FRAGMENT=this.shadowRoot.childNodes[0]):this.prepend(f),this.FRAGMENT=this.childNodes[0],this.oncreate&&this.oncreate(o)};state={pushToState:{},data:{},triggers:{},setState(o){if(Object.assign(this.pushToState,o),Object.keys(this.triggers).length>0)for(let s of Object.getOwnPropertyNames(this.triggers))this.pushToState[s]&&(this.data[s]=this.pushToState[s],delete this.pushToState[s],this.triggers[s].forEach(f=>{f.onchanged(this.data[s])}));return this.pushToState},subscribeTrigger(o,s=f=>{}){if(o){this.triggers[o]||(this.triggers[o]=[]);let f=this.triggers[o].length;return this.triggers[o].push({idx:f,onchanged:s}),this.triggers[o].length-1}else return},unsubscribeTrigger(o,s){let f,y=this.triggers[o];if(y)if(!s)delete this.triggers[o];else return y.find(m=>{if(m.idx===s)return!0})&&y.splice(f,1),!0},subscribeTriggerOnce(o=void 0,s=f=>{}){let f,y=d=>{s(d),this.unsubscribeTrigger(o,f)};f=this.subscribeTrigger(o,y)}};get props(){return this.props}set props(o={}){this.setAttribute("props",o)}get template(){return this.template}set template(o){this.setAttribute("template",o)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(o){this.setAttribute("onchanged",o)}get onresize(){return this.props}set onresize(o){this.setAttribute("onresize",o)}get ondelete(){return this.props}set ondelete(o){this.setAttribute("ondelete",o)}get oncreate(){return this.oncreate}set oncreate(o){this.setAttribute("oncreated",o)}};function Vu(h,o,s=null){try{s?o?window.customElements.define(o,h,{extends:s}):window.customElements.define(h.name.toLowerCase()+"-",h,{extends:s}):o?window.customElements.define(o,h):window.customElements.define(h.name.toLowerCase()+"-",h)}catch{}}function xf(h=""){return h+Math.floor(Math.random()*1e15)}function Er(method){let getFunctionBody=h=>h.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=h=>{let o=h.indexOf(")");return h.slice(0,h.indexOf("{",o)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;try{if(newFuncHead.includes("function ")){let h=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(h,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let h=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(h,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else try{newFunc=eval(newFuncHead+newFuncBody+"}")}catch(err){newFunc=eval(method)}}catch(h){}return newFunc}var qo={pushToState:{},data:{},triggers:{},setState(h){Object.assign(this.data,h);for(let o of Object.getOwnPropertyNames(h))this.triggers[o]&&this.triggers[o].forEach(s=>s.onchange(this.data[o]));return this.data},subscribeTrigger(h,o=s=>{}){if(h){this.triggers[h]||(this.triggers[h]=[]);let s=this.triggers[h].length;return this.triggers[h].push({idx:s,onchange:o}),this.triggers[h].length-1}else return},unsubscribeTrigger(h,o){let s,f=this.triggers[h];if(f)if(!o)delete this.triggers[h];else return f.find(d=>{if(d.idx===o)return!0})&&f.splice(s,1),!0},subscribeTriggerOnce(h=void 0,o=s=>{}){let s,f=y=>{o(y),this.unsubscribeTrigger(h,s)};s=this.subscribeTrigger(h,f)}},Zo=class{state=qo;nodes=new Map;nNodes=0;constructor(){}convertChildrenToNodes(o){o.convertChildrenToNodes(o)}addNode(o={}){return new we(o,void 0,this)}getNode(o){return this.nodes.get(o)}run(o,s,f){if(typeof o=="string"&&(o=this.nodes.get(o)),o)return o.run(s,o,f)}runNode=this.run;removeTree(o){if(typeof o=="string"&&(o=this.nodes.get(o)),o){let s=function(f){f.children&&(Array.isArray(f.children)?f.children.forEach(y=>{y.stopNode&&y.stopNode(),y.tag&&this.nodes.get(y.tag)&&this.nodes.delete(y.tag),this.nodes.forEach(d=>{d.nodes.get(y.tag)&&d.nodes.delete(y.tag)}),s(y)}):typeof f.children=="object"&&(f.stopNode&&f.stopNode(),f.tag&&this.nodes.get(f.tag)&&this.nodes.delete(f.tag),this.nodes.forEach(y=>{y.nodes.get(f.tag)&&y.nodes.delete(f.tag)}),s(f)))};o.stopNode&&o.stopNode(),o.tag&&(this.nodes.delete(o.tag),this.nodes.forEach(f=>{f.nodes.get(o.tag)&&f.nodes.delete(o.tag)}),s(o))}}removeNode(o){typeof o=="string"&&(o=this.nodes.get(o)),o?.tag&&this.nodes.delete(o.tag),o?.tag&&this.nodes.get(o.tag)&&(this.nodes.delete(o.tag),this.nodes.forEach(s=>{s.nodes.get(o.tag)&&s.nodes.delete(o.tag)}))}appendNode(o={},s){s.addChildren(o)}async callParent(o,s,f=o,y){if(o?.parent)return await o.callParent(s,o.parent,f,y)}async callChildren(o,s,f=o,y,d){if(o?.children)return await o.callChildren(s,f,y,d)}subscribe(o,s=f=>{}){return this.state.subscribeTrigger(o,s)}unsubscribe(o,s){this.state.unsubscribeTrigger(o,s)}subscribeNode(o,s){return this.state.subscribeTrigger(o.tag,f=>{this.run(s,f,this)})}create(o=(y,d,m,E)=>{},s,f){return Zu(o,s,f,this)}print(o,s=!0){if(typeof o=="object"&&o.operator)return o.print(o,s)}reconstruct(o="{}"){let s=Pi(o);s&&this.addNode(s)}},we=class{tag;parent;children;graph;state=qo;nodes=new Map;ANIMATE="animate";LOOP="loop";looper=void 0;animation=void 0;constructor(o={},s,f){!o.tag&&f?o.tag=`node${f.nNodes}`:o.tag||(o.tag=`node${Math.floor(Math.random()*1e10)}`),Object.assign(this,o),this.parent=s,this.graph=f,f&&(f.nNodes++,f.nodes.set(o.tag,this)),this.children&&this.convertChildrenToNodes(this)}operator(o,s=this,f,y){return o}runOp(o,s=this,f,y){let d=s.operator(o,s,f,y);return d instanceof Promise?d.then(m=>(this.state.setState({[s.tag]:m}),m)):this.state.setState({[s.tag]:d}),d}runNode(o,s,f){if(typeof o=="string"&&(o=this.nodes.get(o)),o)return o.run(s,o,f)}run(o,s=this,f){if(typeof s=="string"){let y;if(this.graph&&(y=this.graph.nodes.get(s)),y||(y=this.nodes.get(s)),s=y,!s)return}if(!(s.children&&s.forward||s.parent&&s.backward||s.repeat||s.delay||s.frame||s.recursive||s.operator.constructor.name==="AsyncFunction")){let y=s.runOp(s,o,f);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,o,s,f),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,o,s,f),y}return new Promise(async y=>{if(s){let d=(E,w,c=0)=>new Promise(async _=>{c++;let p=await E.runOp(w,E,f,c);if(typeof E.repeat=="number"){for(;c<E.repeat;){if(E.delay){setTimeout(async()=>{_(await d(E,w,c))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await d(E,w,c))});break}else p=await E.runOp(w,E,f,c);c++}if(c===E.repeat){_(p);return}}else if(typeof E.recursive=="number"){for(;c<E.recursive;){if(E.delay){setTimeout(async()=>{_(await d(E,p,c))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await d(E,p,c))});break}else p=await E.runOp(p,E,f,c);c++}if(c===E.recursive){_(p);return}}else{_(p);return}}),m=async()=>{let E=await d(s,o);if(s.backward&&s.parent&&await this.runNode(s.parent,E,s),s.children&&s.forward)if(Array.isArray(s.children))for(let w=0;w<s.children.length;w++)await this.runNode(s.children[w],E,s);else await this.runNode(s.children,E,s);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,o,s,f),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,o,s,f),E};s.delay?setTimeout(async()=>{y(await m())},s.delay):s.frame&&requestAnimationFrame?requestAnimationFrame(async()=>{y(await m())}):y(await m())}else y(void 0)})}runAnimation(o=this.animation,s,f=this,y){if(this.animation=o,o||(this.animation=this.operator),f.animate&&!f.isAnimating){f.isAnimating=!0;let d=async()=>{if(f.isAnimating){let m=await this.animation(s,f,y,this.ANIMATE);if(this.tag&&typeof m<"u"&&(this.state.setState({[this.tag]:m}),f.backward&&f.parent&&await this.runNode(f.parent,m,f),f.children&&f.forward))if(Array.isArray(f.children))for(let E=0;E<f.children.length;E++)await this.runNode(f.children[E],m,f);else await this.runNode(f.children,m,f);requestAnimationFrame(async()=>{await d()})}};requestAnimationFrame(d)}}runLoop(o=this.looper,s,f=this,y){if(this.looper=o,o||(this.looper=this.operator),typeof f.loop=="number"&&!f.isLooping){f.isLooping=!0;let d=async()=>{if(f.looping){let m=await this.looper(s,f,y);if(this.tag&&typeof m<"u"&&(this.state.setState({[this.tag]:m}),f.backward&&f.parent&&await this.runNode(f.parent,m,f),f.children&&f.forward))if(Array.isArray(f.children))for(let E=0;E<f.children.length;E++)await this.runNode(f.children[E],m,f);else await this.runNode(f.children,m,f);setTimeout(async()=>{await d()},f.loop)}}}}setOperator(o=function(f,y=this,d,m){return f}){this.operator=o}setParent(o){this.parent=o}setChildren(o){this.children=o}removeTree(o){if(typeof o=="string"&&(o=this.nodes.get(o)),o){let s=function(f){f.children&&(Array.isArray(f.children)?f.children.forEach(y=>{y.stopNode&&y.stopNode(),y.tag&&this.nodes.get(y.tag)&&this.nodes.delete(y.tag),this.nodes.forEach(d=>{d.nodes.get(y.tag)&&d.nodes.delete(y.tag)}),s(y)}):typeof f.children=="object"&&(f.stopNode&&f.stopNode(),f.tag&&this.nodes.get(f.tag)&&this.nodes.delete(f.tag),this.nodes.forEach(y=>{y.nodes.get(f.tag)&&y.nodes.delete(f.tag)}),s(f)))};o.stopNode&&o.stopNode(),o.tag&&(this.nodes.delete(o.tag),this.nodes.forEach(f=>{f.nodes.get(o.tag)&&f.nodes.delete(o.tag)}),s(o),this.graph&&this.graph.nodes.removeTree(o))}}addNode(o={}){let s=new we(o,this,this.graph);return this.nodes.set(convertedtag,s),this.graph&&this.graph.nodes.set(s.tag,s),s}removeNode(o){typeof o=="string"&&(o=this.nodes.get(o)),o?.tag&&this.nodes.delete(o.tag),o?.tag&&this.nodes.get(o.tag)&&(this.nodes.delete(o.tag),this.graph&&this.graph.nodes.delete(o.tag),this.nodes.forEach(s=>{s.nodes.get(o.tag)&&s.nodes.delete(o.tag)}))}appendNode(o,s=this){typeof o=="string"&&(o=this.nodes.get(o)),o&&s.addChildren(o)}getNode(o){return this.nodes.get(o)}stopLooping(o=this){o.isLooping=!1}stopAnimating(o=this){o.isAnimating=!1}stopNode(o=this){o.stopAnimating(o),o.stopLooping(o)}addChildren(o){this.children||(this.children=[]),Array.isArray(this.children)?Array.isArray(o)?(this.children.push(...o),o.forEach(s=>{typeof s=="object"&&s.tag&&(this.nodes.set(s.tag,s),this.graph&&this.graph.nodes.set(s.tag,s))})):(this.children.push(o),typeof o=="object"&&o.tag&&(this.nodes.set(o.tag,o),this.graph&&this.graph.nodes.set(o.tag,o))):(this.children=[o],typeof o=="object"&&o.tag&&(this.nodes.set(o.tag,o),this.graph&&this.graph.nodes.set(o.tag,o)))}convertChildrenToNodes(o=this){if(o.children?.name==="GraphNode")this.graph?.nodes.get(o.tag)||this.graph.nodes.set(o.tag,o),this.nodes.get(o.tag)||this.nodes.set(o.tag,o);else if(Array.isArray(o.children))for(let s=0;s<o.children.length;s++)if(o.children[s].name==="GraphNode"){this.graph?.nodes.get(o.children[s].tag)||this.graph.nodes.set(o.children[s].tag,o.children[s]),this.nodes.get(o.children[s].tag)||this.nodes.set(o.children[s].tag,o.children[s]);continue}else typeof o.children[s]=="object"?(o.children[s]=new we(o.children[s],o,this.graph),this.nodes.set(o.children[s].tag,o.children[s]),this.convertChildrenToNodes(o.children[s])):typeof o.children[s]=="string"&&(this.graph&&(o.children[s]=this.graph.getNode(o.children[s]),this.nodes.get(o.children[s].tag)||this.nodes.set(o.children[s].tag,o.children[s])),o.children[s]||(o.children[s]=this.nodes.get(o.children[s])));else typeof o.children=="object"?(o.children=new we(o.children,o,this.graph),this.nodes.set(o.children.tag,o.children),this.convertChildrenToNodes(o.children)):typeof o.children=="string"&&(this.graph&&(o.children=this.graph.getNode(o.children),this.nodes.get(o.children.tag)||this.nodes.set(o.children.tag,o.children)),o.children||(o.children=this.nodes.get(o.children)));return o.children}async callParent(o,s=this,f){if(typeof this.parent?.operator=="function")return await this.parent.runOp(o,this.parent,s,f)}async callChildren(o,s=this,f,y){let d;if(Array.isArray(this.children))if(y)d=await this.children[y]?.runOp(o,this.children[y],s,f);else{d=[];for(let m=0;m<this.children.length;m++)d.push(await this.children[m]?.runOp(o,this.children[m],s,f))}else this.children&&(d=await this.children.runOp(o,this.children,s,f));return d}setProps(o={}){Object.assign(this,o)}subscribe(o=f=>{},s=this.tag){return typeof o=="object"?this.subscribeNode(o):this.state.subscribeTrigger(s,o)}unsubscribe(o,s=this.tag){this.state.unsubscribeTrigger(s,o)}subscribeNode(o,s=this.tag){return this.state.subscribeTrigger(s,f=>{this.runNode(o,f,this)})}print(o=this,s=!0,f=[]){let y=new we;f.push(o.tag);let d={tag:o.tag,operator:o.operator.toString()};o.parent&&(d.parent=o.parent.tag),o.children&&(Array.isArray(o.children)?o.children=o.children.map(m=>typeof m=="string"?m:f.includes(m.tag)?m.tag:s?m.print(m,s,f):m.tag):typeof o.children=="object"?(s||(d.children=[o.children.tag]),f.includes(o.children.tag)?d.children=[o.children.tag]:d.children=[o.children.print(o.children,s,f)]):typeof o.children=="string"&&(d.children=[o.children]));for(let m in o)m==="parent"||m==="children"||typeof y[m]>"u"&&(typeof o[m]=="function"?d[m]=o[m].toString():typeof o[m]=="object"?d[m]=JSON.stringifyWithCircularRefs(o[m]):d[m]=o[m]);return JSON.stringify(d)}reconstruct(o="{}"){let s=Pi(o);s&&this.addNode(s)}};function Zu(h,o,s,f){return typeof s=="object"?(s.operator=h,new we(s,o,f)):new we({operator:h},o,f)}function kf(h="{}",o,s){let f=Pi(h);if(f)return new we(f,o,s)}function Pi(h="{}"){try{let s=function(f){for(let y in f)if(typeof f[y]=="string"){let d=qu(f[y]);typeof d=="function"&&(f[y]=d)}else typeof f[y]=="object"&&s(f[y]);return f},o=JSON.parse(h);return s(o)}catch(o){console.error(o);return}}JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=function(){let h=new Map,o=[],s=["this"];function f(){h.clear(),o.length=0,s.length=1}function y(m,E){var w=o.length-1,c=o[w];if(typeof c=="object")if(c[m]===E||w===0)s.push(m),o.push(E.pushed);else for(;w-->=0;){if(c=o[w],typeof c=="object"&&c[m]===E){w+=2,o.length=w,s.length=w,--w,o[w]=E,s[w]=m;break}w--}}function d(m,E){if(E!=null&&typeof E=="object"){m&&y(m,E);let w=h.get(E);if(w)return"[Circular Reference]"+w;h.set(E,s.join("."))}return E}return function(E,w){try{return o.push(E),JSON.stringify(E,d,w)}finally{f()}}}());function qu(method=""){let getFunctionBody=h=>h.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=h=>{let o=h.indexOf(")");return h.slice(0,h.indexOf("{",o)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let h=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(h,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let h=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(h,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var Yu=Xo(),Mr=class extends oi{props={operator:(o,s,f,y)=>(console.log(o),o),forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};input_delay=1;template=Yu;render=(o=this.props)=>{typeof this.template=="function"?this.templateString=this.template(o):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let f=s.content;this.fragment&&this.removeChild(this.fragment),this.fragment=f,this.appendChild(f),this.setupNode(this.props),this.props.input&&setTimeout(async()=>{this.props.node.runNode(this.props.node,this.props.input,this.props.graph)},this.input_delay),this.oncreate&&this.oncreate(o)};setupNode(o){let s=this.parentNode;if(s.props?.operator&&s.props?.node&&(o.parent=s.props.node),!o.graph){for(;!s.props?.nodes&&!(s.constructor.name==="HTMLBodyElement"||s.constructor.name==="HTMLHeadElement"||s.constructor.name==="HTMLHtmlElement"||s.constructor.name==="HTMLDocument");)s=s.parentNode;s.props?.nodes&&(o.graph=s.props.graph,o.input_delay=s.props.input_delay)}this.id&&!o.tag&&(o.tag=this.id),o.graph&&!o.node&&o.tag?o.node=o.graph.nodes.get(o.tag):o.graph&&typeof o.node=="string"&&(o.node=o.graph.nodes.get(o.node)),o.node||(o.node=new we(o,o.parent,o.graph)),o.tag=o.node.tag,this.id||(this.id=o.tag),o.parent&&o.parent.addChildren(o.node)}};Mr.addElement("graph-node");var Ju=Yo(),zi=class extends Mr{bitmap;bitslice;canvas;ctx;offscreen;offscreenctx;capture;capturectx;img;video;imgselect;captures={};loaded={};template=Ju;props={picking:0,picked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},imgpicked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},running:!1,mode:"img",animation:(o,s,f,y)=>{},operator:(o,s,f,y)=>{},forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};oncreate=o=>{this.canvas=this.querySelector("#picker"),this.pickerDiv=this.querySelector("#pickerDiv"),this.img=this.querySelector("img"),this.video=this.querySelector("video"),this.select=this.querySelector("#imgselect"),this.capture=this.querySelector("#capture"),this.menu=this.querySelector("#menu"),this.toggleMenu=this.querySelector("#toggleMenu"),this.toggleMenu.style="position: absolute; top: 25px; right: 25px;",this.toggleMenu.onclick=()=>{this.menu.style.display==="none"?this.menu.style.display="":this.menu.style.display="none"},this.querySelector("#fileinput").onchange=this.handleFileInput,this.querySelector("#snip").onclick=f=>{this.props.picked.y1&&this.props.picked.x1&&this.canvasCapture(f)};let s=()=>{if(this.props.mode==="video"&&this.props.picked.y1&&this.props.picked.x1){this.props.running=!0;let f=zo(this.capture);this.querySelector("#animate").innerHTML="Recording...",this.querySelector("#animate").onclick=()=>{this.props.running=!1,f.stop(),this.querySelector("#animate").innerHTML="Record",this.querySelector("#animate").onclick=s}}};this.querySelector("#animate").onclick=s,this.select.onchange=f=>{},this.querySelector("#webcam").onclick=this.useWebcam,this.querySelector("#image").onclick=this.useImage,this.querySelector("#setImgUrl").onclick=this.inputImgUrl,this.querySelector("#setVideoUrl").onclick=this.inputVideoSrc,this.querySelector("#fileinput").onclick=this.loadFile,o.canvas=this.canvas,o.context?o.context=this.canvas.getContext(o.context):o.context=this.canvas.getContext("2d"),this.context=o.context,this.ctx=this.context,o.ctx=this.context,this.offscreen=new OffscreenCanvas(this.canvas.width,this.canvas.height),this.offscreenctx=this.offscreen.getContext("2d"),this.capturectx=this.capture.getContext("2d"),this.props.picked.x0=0,this.props.picked.y0=0,this.props.picked.x1=this.canvas.width,this.props.picked.y1=this.canvas.height,this.canvas.onclick=this.canvasClicked,setTimeout(()=>{o.animate&&o.node.runAnimation()},10);try{this.useImage()}catch(f){console.error(f)}this.onresize()};useWebcam=()=>{this.props.running=!1,this.img.style.display="none",this.video.src&&(this.video.pause(),this.video.src=""),this.video.style.display="",navigator.getUserMedia&&navigator.getUserMedia({video:!0},o=>{this.video.srcObject=o,this.video.play(),this.video.width=this.canvas.width,this.video.height=this.canvas.height,this.props.mode="video",this.canvas.height=this.video.height,this.canvas.width=this.video.width},console.error)};useImage=()=>{this.props.running=!1,this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=this.select.options[this.select.selectedIndex].value,this.img.style.display="",this.props.mode="img",this.canvas.height=this.img.height,this.canvas.width=this.img.width,this.canvas.style.width=this.img.style.width,this.canvas.style.height=this.img.style.height};inputImgUrl(){this.props.running=!1;let o=this.querySelector("#imgurl").value;o&&(this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=o,this.img.style.display="",this.props.mode="img",this.canvas.height=this.img.height,this.canvas.width=this.img.width,this.canvas.style.width=this.img.style.width,this.canvas.style.height=this.img.style.height)}inputVideoSrc(){this.props.running=!1,this.img.style.display="none",this.video.style.display="";let o=this.querySelector("#videourl").value;o&&(this.video.src=o,this.video.play(),this.props.mode="video",this.canvas.height=this.video.height,this.canvas.width=this.video.width,this.canvas.style.width=this.video.style.width,this.canvas.style.height=this.video.style.height)}loadFile(){var o=document.createElement("input");o.accept=".mp4,.png,.bmp,.jpg",o.type="file",o.onchange=s=>{let f=s.target.files[0],y=URL.createObjectURL(f);if(this.loaded[o.value]=y,this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),o.value.endsWith(".mp4"))this.props.mode="video",this.video.src=y,this.video.play();else if(this.props.mode="img",o.value.endsWith(".bmp")){var d=new FileReader;d.onload=m=>{var E=m.target.result,w=jo(E);let c=Wo(w);this.img.src=c},d.readAsArrayBuffer(f)}else this.img.src=y},o.click()}drawCircle(o,s,f,y="green",d=5,m="#003300",E=this.ctx){E.beginPath(),E.arc(o,s,f,0,2*Math.PI,!1),E.fillStyle=y,E.fill(),E.lineWidth=d,E.strokeStyle=m,E.closePath(),E.stroke()}drawLine(o={x:0,y:0},s={x:1,y:1},f=5,y="#003300",d=this.ctx){d.beginPath(),d.lineWidth=f,d.strokeStyle=y,d.moveTo(o.x,o.y),d.lineTo(s.x,s.y),d.stroke()}canvasClicked=o=>{if(this.props.running=!1,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.props.picking===0){this.props.picked.x0=o.pageX-this.canvas.offsetLeft,this.props.picked.y0=o.pageY-this.canvas.offsetTop,this.props.picked.x1=void 0,this.props.picked.y1=void 0;let s;this.props.mode==="img"?s=Ur(this.img,this.canvas,this.props.picked.x0,this.props.picked.y0):this.props.mode==="video"&&(s=Ur(this.video,this.canvas,this.props.picked.x0,this.props.picked.y0)),this.props.imgpicked.x0=s.x,this.props.imgpicked.y0=s.y,this.props.imgpicked.x1=void 0,this.props.imgpicked.y1=void 0,this.drawCircle(this.props.picked.x0,this.props.picked.y0,2.5,"orange",1,"orange"),this.props.picking=1}else{this.props.picked.x1=o.pageX-this.canvas.offsetLeft,this.props.picked.y1=o.pageY-this.canvas.offsetTop;let s;if(this.props.mode==="img"?s=Ur(this.img,this.canvas,this.props.picked.x1,this.props.picked.y1):this.props.mode==="video"&&(s=Ur(this.video,this.canvas,this.props.picked.x1,this.props.picked.y1)),this.props.imgpicked.x1=s.x,this.props.imgpicked.y1=s.y,this.props.picked.x1<this.props.picked.x0){let f=this.props.picked.x1;this.props.picked.x1=this.props.picked.x0,this.props.picked.x0=f,f=this.props.imgpicked.x1,this.props.imgpicked.x1=this.props.imgpicked.x0,this.props.imgpicked.x0=f}if(this.props.picked.y1<this.props.picked.y0){let f=this.props.picked.y1;this.props.picked.y1=this.props.picked.y0,this.props.picked.y0=f,f=this.props.imgpicked.y1,this.props.imgpicked.y1=this.props.imgpicked.y0,this.props.imgpicked.y0=f}this.props.picking=0,this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.strokeStyle="orange",this.ctx.rect(this.props.picked.x0,this.props.picked.y0,Math.abs(this.props.picked.x1-this.props.picked.x0),Math.abs(this.props.picked.y1-this.props.picked.y0)),this.ctx.stroke(),console.log(this.props.imgpicked),this.props.mode==="video"?this.continuousCapture(this.video):(this.capture.width=Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),this.capture.height=Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),Mo(this.capturectx,this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capture.width,this.capture.height))}};continuousCapture(o){this.props.imgpicked.x1&&this.props.imgpicked.x0&&this.props.imgpicked.y1&&this.props.imgpicked.y0&&(this.capturectx.drawImage(o,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capturectx.width,this.capturectx.height),this.continuousCapture(o))}processCapture=o=>{Vo(o,this.querySelector("#captured"),"49.99%","200px")};canvasCapture(o){if(this.props.mode==="img"){if(!this.img.src)return;createImageBitmap(this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}else if(this.props.mode==="video"){if(!this.video.src)return;createImageBitmap(this.video,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}}onresize=o=>{this.img.width=this.pickerDiv.offsetWidth,this.canvas&&(this.props.mode==="img"&&this.img?.naturalWidth>0?(this.canvas.height=this.img.parentNode.clientWidth*this.img.naturalHeight/this.img.naturalWidth,this.canvas.style.height=this.img.parentNode.clientWidth*this.img.naturalHeight/this.img.naturalWidth):this.props.mode==="video"&&this.video&&this.video?.videoWidth>0?(this.canvas.height=this.video.parentNode.clientWidth*this.video.videoHeight/this.video.videoWidth,this.canvas.style.height=this.video.parentNode.clientWidth*this.video.videoHeight/this.video.videoWidth):(this.canvas.width=this.canvas.parentNode.clientWidth,this.canvas.height=this.canvas.parentNode.clientHeight,this.canvas.style.width=this.canvas.parentNode.clientWidth,this.canvas.style.height=this.canvas.parentNode.clientHeight))}};zi.addElement("spectrometer-node");lo(["processed"]);var Ku=document.createElement("spectrometer-node");document.body.appendChild(Ku);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
* @license  MIT
*/
/*! canvas-to-bmp version 1.0 ALPHA https://stackoverflow.com/questions/29652307/canvas-unable-to-generate-bmp-image-dataurl-in-chrome
    (c) 2015 Ken "Epistemex" Fyrstenberg, modified by Josh Brewster 2022
    MIT License (this header required)
*/
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
