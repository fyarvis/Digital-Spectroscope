(()=>{var ru=Object.create;var co=Object.defineProperty;var iu=Object.getOwnPropertyDescriptor;var nu=Object.getOwnPropertyNames;var ou=Object.getPrototypeOf,su=Object.prototype.hasOwnProperty;var yr=(l,o)=>()=>(o||l((o={exports:{}}).exports,o),o.exports);var au=(l,o,s,c)=>{if(o&&typeof o=="object"||typeof o=="function")for(let d of nu(o))!su.call(l,d)&&d!==s&&co(l,d,{get:()=>o[d],enumerable:!(c=iu(o,d))||c.enumerable});return l};var fo=(l,o,s)=>(s=l!=null?ru(ou(l)):{},au(o||!l||!l.__esModule?co(s,"default",{value:l,enumerable:!0}):s,l));var lo=yr((Cr,Ii)=>{(function(o,s){typeof Cr=="object"&&typeof Ii=="object"?Ii.exports=s():typeof define=="function"&&define.amd?define([],s):typeof Cr=="object"?Cr.BrowserFS=s():o.BrowserFS=s()})(Cr,function(){return function(l){var o={};function s(c){if(o[c])return o[c].exports;var d=o[c]={exports:{},id:c,loaded:!1};return l[c].call(d.exports,d,d.exports,s),d.loaded=!0,d.exports}return s.m=l,s.c=o,s.p="",s(0)}([function(l,o,s){(function(c,d,y,g){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var E=s(2),w=s(9),f;(function(i){i[i.EPERM=1]="EPERM",i[i.ENOENT=2]="ENOENT",i[i.EIO=5]="EIO",i[i.EBADF=9]="EBADF",i[i.EACCES=13]="EACCES",i[i.EBUSY=16]="EBUSY",i[i.EEXIST=17]="EEXIST",i[i.ENOTDIR=20]="ENOTDIR",i[i.EISDIR=21]="EISDIR",i[i.EINVAL=22]="EINVAL",i[i.EFBIG=27]="EFBIG",i[i.ENOSPC=28]="ENOSPC",i[i.EROFS=30]="EROFS",i[i.ENOTEMPTY=39]="ENOTEMPTY",i[i.ENOTSUP=95]="ENOTSUP"})(f||(f={}));var _={};_[f.EPERM]="Operation not permitted.",_[f.ENOENT]="No such file or directory.",_[f.EIO]="Input/output error.",_[f.EBADF]="Bad file descriptor.",_[f.EACCES]="Permission denied.",_[f.EBUSY]="Resource busy or locked.",_[f.EEXIST]="File exists.",_[f.ENOTDIR]="File is not a directory.",_[f.EISDIR]="File is a directory.",_[f.EINVAL]="Invalid argument.",_[f.EFBIG]="File is too big.",_[f.ENOSPC]="No space left on disk.",_[f.EROFS]="Cannot modify a read-only file system.",_[f.ENOTEMPTY]="Directory is not empty.",_[f.ENOTSUP]="Operation is not supported.";var p=function(i){function t(r,e,n){e===void 0&&(e=_[r]),i.call(this,e),this.syscall="",this.errno=r,this.code=f[r],this.path=n,this.stack=new i().stack,this.message="Error: "+this.code+": "+e+(this.path?", '"+this.path+"'":"")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.fromJSON=function(e){var n=new t(0);return n.errno=e.errno,n.code=e.code,n.path=e.path,n.stack=e.stack,n.message=e.message,n},t.fromBuffer=function(e,n){return n===void 0&&(n=0),t.fromJSON(JSON.parse(e.toString("utf8",n+4,n+4+e.readUInt32LE(n))))},t.FileError=function(e,n){return new t(e,_[e],n)},t.ENOENT=function(e){return this.FileError(f.ENOENT,e)},t.EEXIST=function(e){return this.FileError(f.EEXIST,e)},t.EISDIR=function(e){return this.FileError(f.EISDIR,e)},t.ENOTDIR=function(e){return this.FileError(f.ENOTDIR,e)},t.EPERM=function(e){return this.FileError(f.EPERM,e)},t.ENOTEMPTY=function(e){return this.FileError(f.ENOTEMPTY,e)},t.prototype.toString=function(){return this.message},t.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},t.prototype.writeToBuffer=function(e,n){e===void 0&&(e=c.alloc(this.bufferSize())),n===void 0&&(n=0);var a=e.write(JSON.stringify(this.toJSON()),n+4);return e.writeUInt32LE(a,n),e},t.prototype.bufferSize=function(){return 4+c.byteLength(JSON.stringify(this.toJSON()))},t}(Error),T=Object.freeze({get ErrorCode(){return f},ErrorStrings:_,ApiError:p}),A;(function(i){i[i.NOP=0]="NOP",i[i.THROW_EXCEPTION=1]="THROW_EXCEPTION",i[i.TRUNCATE_FILE=2]="TRUNCATE_FILE",i[i.CREATE_FILE=3]="CREATE_FILE"})(A||(A={}));var b=function i(t){if(this.flagStr=t,i.validFlagStrs.indexOf(t)<0)throw new p(f.EINVAL,"Invalid flag: "+t)};b.getFileFlag=function(t){return b.flagCache.hasOwnProperty(t)?b.flagCache[t]:b.flagCache[t]=new b(t)},b.prototype.getFlagString=function(){return this.flagStr},b.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},b.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},b.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},b.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},b.prototype.pathExistsAction=function(){return this.isExclusive()?A.THROW_EXCEPTION:this.isTruncating()?A.TRUNCATE_FILE:A.NOP},b.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?A.CREATE_FILE:A.THROW_EXCEPTION},b.flagCache={},b.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var L;(function(i){i[i.FILE=32768]="FILE",i[i.DIRECTORY=16384]="DIRECTORY",i[i.SYMLINK=40960]="SYMLINK"})(L||(L={}));var C=function(t,r,e,n,a,u){if(n===void 0&&(n=new Date),a===void 0&&(a=new Date),u===void 0&&(u=new Date),this.size=r,this.atime=n,this.mtime=a,this.ctime=u,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,e)this.mode=e;else switch(t){case L.FILE:this.mode=420;break;case L.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(r/512),this.mode<4096&&(this.mode|=t)};C.fromBuffer=function(t){var r=t.readUInt32LE(0),e=t.readUInt32LE(4),n=t.readDoubleLE(8),a=t.readDoubleLE(16),u=t.readDoubleLE(24);return new C(e&61440,r,e&4095,new Date(n),new Date(a),new Date(u))},C.prototype.toBuffer=function(){var t=c.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},C.prototype.clone=function(){return new C(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},C.prototype.isFile=function(){return(this.mode&61440)===L.FILE},C.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY},C.prototype.isSymbolicLink=function(){return(this.mode&61440)===L.SYMLINK},C.prototype.chmod=function(t){this.mode=this.mode&61440|t},C.prototype.isSocket=function(){return!1},C.prototype.isBlockDevice=function(){return!1},C.prototype.isCharacterDevice=function(){return!1},C.prototype.isFIFO=function(){return!1};var G=function(i,t){return i};function W(i){if(i)return i;throw new p(f.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function M(i,t){switch(typeof i){case"number":return i;case"string":var r=parseInt(i,8);return isNaN(r)?t:r;default:return t}}function Et(i){if(i instanceof Date)return i;if(typeof i=="number")return new Date(i*1e3);throw new p(f.EINVAL,"Invalid time.")}function et(i){if(i.indexOf("\0")>=0)throw new p(f.EINVAL,"Path must be a string without null bytes.");if(i==="")throw new p(f.EINVAL,"Path must not be empty.");return w.resolve(i)}function wt(i,t,r,e){switch(typeof i){case"object":return{encoding:typeof i.encoding<"u"?i.encoding:t,flag:typeof i.flag<"u"?i.flag:r,mode:M(i.mode,e)};case"string":return{encoding:i,flag:r,mode:e};default:return{encoding:t,flag:r,mode:e}}}function pt(){}var U=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};U.prototype.initialize=function(t){if(!t.constructor.isAvailable())throw new p(f.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=t},U.prototype._toUnixTimestamp=function(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},U.prototype.getRootFS=function(){return this.root?this.root:null},U.prototype.rename=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{W(this.root).rename(et(t),et(r),n)}catch(a){n(a)}},U.prototype.renameSync=function(t,r){W(this.root).renameSync(et(t),et(r))},U.prototype.exists=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).exists(et(t),e)}catch{return e(!1)}},U.prototype.existsSync=function(t){try{return W(this.root).existsSync(et(t))}catch{return!1}},U.prototype.stat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!1,e)}catch(n){return e(n)}},U.prototype.statSync=function(t){return W(this.root).statSync(et(t),!1)},U.prototype.lstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!0,e)}catch(n){return e(n)}},U.prototype.lstatSync=function(t){return W(this.root).statSync(et(t),!0)},U.prototype.truncate=function(t,r,e){r===void 0&&(r=0),e===void 0&&(e=pt);var n=0;typeof r=="function"?e=r:typeof r=="number"&&(n=r);var a=G(e,1);try{if(n<0)throw new p(f.EINVAL);return W(this.root).truncate(et(t),n,a)}catch(u){return a(u)}},U.prototype.truncateSync=function(t,r){if(r===void 0&&(r=0),r<0)throw new p(f.EINVAL);return W(this.root).truncateSync(et(t),r)},U.prototype.unlink=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).unlink(et(t),e)}catch(n){return e(n)}},U.prototype.unlinkSync=function(t){return W(this.root).unlinkSync(et(t))},U.prototype.open=function(t,r,e,n){var a=this;n===void 0&&(n=pt);var u=M(e,420);n=typeof e=="function"?e:n;var h=G(n,2);try{W(this.root).open(et(t),b.getFileFlag(r),u,function(S,x){x?h(S,a.getFdForFile(x)):h(S)})}catch(S){h(S)}},U.prototype.openSync=function(t,r,e){return e===void 0&&(e=420),this.getFdForFile(W(this.root).openSync(et(t),b.getFileFlag(r),M(e,420)))},U.prototype.readFile=function(t,r,e){r===void 0&&(r={}),e===void 0&&(e=pt);var n=wt(r,null,"r",null);e=typeof r=="function"?r:e;var a=G(e,2);try{var u=b.getFileFlag(n.flag);return u.isReadable()?W(this.root).readFile(et(t),n.encoding,u,a):a(new p(f.EINVAL,"Flag passed to readFile must allow for reading."))}catch(h){return a(h)}},U.prototype.readFileSync=function(t,r){r===void 0&&(r={});var e=wt(r,null,"r",null),n=b.getFileFlag(e.flag);if(!n.isReadable())throw new p(f.EINVAL,"Flag passed to readFile must allow for reading.");return W(this.root).readFileSync(et(t),e.encoding,n)},U.prototype.writeFile=function(t,r,e,n){e===void 0&&(e={}),n===void 0&&(n=pt);var a=wt(e,"utf8","w",420);n=typeof e=="function"?e:n;var u=G(n,1);try{var h=b.getFileFlag(a.flag);return h.isWriteable()?W(this.root).writeFile(et(t),r,a.encoding,h,a.mode,u):u(new p(f.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(S){return u(S)}},U.prototype.writeFileSync=function(t,r,e){var n=wt(e,"utf8","w",420),a=b.getFileFlag(n.flag);if(!a.isWriteable())throw new p(f.EINVAL,"Flag passed to writeFile must allow for writing.");return W(this.root).writeFileSync(et(t),r,n.encoding,a,n.mode)},U.prototype.appendFile=function(t,r,e,n){n===void 0&&(n=pt);var a=wt(e,"utf8","a",420);n=typeof e=="function"?e:n;var u=G(n,1);try{var h=b.getFileFlag(a.flag);if(!h.isAppendable())return u(new p(f.EINVAL,"Flag passed to appendFile must allow for appending."));W(this.root).appendFile(et(t),r,a.encoding,h,a.mode,u)}catch(S){u(S)}},U.prototype.appendFileSync=function(t,r,e){var n=wt(e,"utf8","a",420),a=b.getFileFlag(n.flag);if(!a.isAppendable())throw new p(f.EINVAL,"Flag passed to appendFile must allow for appending.");return W(this.root).appendFileSync(et(t),r,n.encoding,a,n.mode)},U.prototype.fstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{var n=this.fd2file(t);n.stat(e)}catch(a){e(a)}},U.prototype.fstatSync=function(t){return this.fd2file(t).statSync()},U.prototype.close=function(t,r){var e=this;r===void 0&&(r=pt);var n=G(r,1);try{this.fd2file(t).close(function(a){a||e.closeFd(t),n(a)})}catch(a){n(a)}},U.prototype.closeSync=function(t){this.fd2file(t).closeSync(),this.closeFd(t)},U.prototype.ftruncate=function(t,r,e){e===void 0&&(e=pt);var n=typeof r=="number"?r:0;e=typeof r=="function"?r:e;var a=G(e,1);try{var u=this.fd2file(t);if(n<0)throw new p(f.EINVAL);u.truncate(n,a)}catch(h){a(h)}},U.prototype.ftruncateSync=function(t,r){r===void 0&&(r=0);var e=this.fd2file(t);if(r<0)throw new p(f.EINVAL);e.truncateSync(r)},U.prototype.fsync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).sync(e)}catch(n){e(n)}},U.prototype.fsyncSync=function(t){this.fd2file(t).syncSync()},U.prototype.fdatasync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).datasync(e)}catch(n){e(n)}},U.prototype.fdatasyncSync=function(t){this.fd2file(t).datasyncSync()},U.prototype.write=function(t,r,e,n,a,u){u===void 0&&(u=pt);var h,S,x,O=null;if(typeof r=="string"){var D="utf8";switch(typeof e){case"function":u=e;break;case"number":O=e,D=typeof n=="string"?n:"utf8",u=typeof a=="function"?a:u;break;default:return u=typeof n=="function"?n:typeof a=="function"?a:u,u(new p(f.EINVAL,"Invalid arguments."))}h=c.from(r,D),S=0,x=h.length}else h=r,S=e,x=n,O=typeof a=="number"?a:null,u=typeof a=="function"?a:u;var V=G(u,3);try{var $=this.fd2file(t);O==null&&(O=$.getPos()),$.write(h,S,x,O,V)}catch(rt){V(rt)}},U.prototype.writeSync=function(t,r,e,n,a){var u,h=0,S,x;if(typeof r=="string"){x=typeof e=="number"?e:null;var O=typeof n=="string"?n:"utf8";h=0,u=c.from(r,O),S=u.length}else u=r,h=e,S=n,x=typeof a=="number"?a:null;var D=this.fd2file(t);return x==null&&(x=D.getPos()),D.writeSync(u,h,S,x)},U.prototype.read=function(t,r,e,n,a,u){u===void 0&&(u=pt);var h,S,x,O,D;if(typeof r=="number"){x=r,h=e;var V=n;u=typeof a=="function"?a:u,S=0,O=c.alloc(x),D=G(function(rt,ct,yt){if(rt)return u(rt);u(rt,yt.toString(V),ct)},3)}else O=r,S=e,x=n,h=a,D=G(u,3);try{var $=this.fd2file(t);h==null&&(h=$.getPos()),$.read(O,S,x,h,D)}catch(rt){D(rt)}},U.prototype.readSync=function(t,r,e,n,a){var u=!1,h,S,x,O,D="utf8";typeof r=="number"?(x=r,O=e,D=n,S=0,h=c.alloc(x),u=!0):(h=r,S=e,x=n,O=a);var V=this.fd2file(t);O==null&&(O=V.getPos());var $=V.readSync(h,S,x,O);return u?[h.toString(D),$]:$},U.prototype.fchown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{this.fd2file(t).chown(r,e,a)}catch(u){a(u)}},U.prototype.fchownSync=function(t,r,e){this.fd2file(t).chownSync(r,e)},U.prototype.fchmod=function(t,r,e){var n=G(e,1);try{var a=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmod(a,n)}catch(u){n(u)}},U.prototype.fchmodSync=function(t,r){var e=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmodSync(e)},U.prototype.futimes=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{var u=this.fd2file(t);typeof r=="number"&&(r=new Date(r*1e3)),typeof e=="number"&&(e=new Date(e*1e3)),u.utimes(r,e,a)}catch(h){a(h)}},U.prototype.futimesSync=function(t,r,e){this.fd2file(t).utimesSync(Et(r),Et(e))},U.prototype.rmdir=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{t=et(t),W(this.root).rmdir(t,e)}catch(n){e(n)}},U.prototype.rmdirSync=function(t){return t=et(t),W(this.root).rmdirSync(t)},U.prototype.mkdir=function(t,r,e){e===void 0&&(e=pt),typeof r=="function"&&(e=r,r=511);var n=G(e,1);try{t=et(t),W(this.root).mkdir(t,r,n)}catch(a){n(a)}},U.prototype.mkdirSync=function(t,r){W(this.root).mkdirSync(et(t),M(r,511))},U.prototype.readdir=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readdir(t,e)}catch(n){e(n)}},U.prototype.readdirSync=function(t){return t=et(t),W(this.root).readdirSync(t)},U.prototype.link=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{t=et(t),r=et(r),W(this.root).link(t,r,n)}catch(a){n(a)}},U.prototype.linkSync=function(t,r){return t=et(t),r=et(r),W(this.root).linkSync(t,r)},U.prototype.symlink=function(t,r,e,n){n===void 0&&(n=pt);var a=typeof e=="string"?e:"file";n=typeof e=="function"?e:n;var u=G(n,1);try{if(a!=="file"&&a!=="dir")return u(new p(f.EINVAL,"Invalid type: "+a));t=et(t),r=et(r),W(this.root).symlink(t,r,a,u)}catch(h){u(h)}},U.prototype.symlinkSync=function(t,r,e){if(!e)e="file";else if(e!=="file"&&e!=="dir")throw new p(f.EINVAL,"Invalid type: "+e);return t=et(t),r=et(r),W(this.root).symlinkSync(t,r,e)},U.prototype.readlink=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readlink(t,e)}catch(n){e(n)}},U.prototype.readlinkSync=function(t){return t=et(t),W(this.root).readlinkSync(t)},U.prototype.chown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{t=et(t),W(this.root).chown(t,!1,r,e,a)}catch(u){a(u)}},U.prototype.chownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!1,r,e)},U.prototype.lchown=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{t=et(t),W(this.root).chown(t,!0,r,e,a)}catch(u){a(u)}},U.prototype.lchownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!0,r,e)},U.prototype.chmod=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{var a=M(r,-1);if(a<0)throw new p(f.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!1,a,n)}catch(u){n(u)}},U.prototype.chmodSync=function(t,r){var e=M(r,-1);if(e<0)throw new p(f.EINVAL,"Invalid mode.");t=et(t),W(this.root).chmodSync(t,!1,e)},U.prototype.lchmod=function(t,r,e){e===void 0&&(e=pt);var n=G(e,1);try{var a=M(r,-1);if(a<0)throw new p(f.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!0,a,n)}catch(u){n(u)}},U.prototype.lchmodSync=function(t,r){var e=M(r,-1);if(e<1)throw new p(f.EINVAL,"Invalid mode.");W(this.root).chmodSync(et(t),!0,e)},U.prototype.utimes=function(t,r,e,n){n===void 0&&(n=pt);var a=G(n,1);try{W(this.root).utimes(et(t),Et(r),Et(e),a)}catch(u){a(u)}},U.prototype.utimesSync=function(t,r,e){W(this.root).utimesSync(et(t),Et(r),Et(e))},U.prototype.realpath=function(t,r,e){e===void 0&&(e=pt);var n=typeof r=="object"?r:{};e=typeof r=="function"?r:pt;var a=G(e,2);try{t=et(t),W(this.root).realpath(t,n,a)}catch(u){a(u)}},U.prototype.realpathSync=function(t,r){return r===void 0&&(r={}),t=et(t),W(this.root).realpathSync(t,r)},U.prototype.watchFile=function(t,r,e){throw e===void 0&&(e=pt),new p(f.ENOTSUP)},U.prototype.unwatchFile=function(t,r){throw r===void 0&&(r=pt),new p(f.ENOTSUP)},U.prototype.watch=function(t,r,e){throw e===void 0&&(e=pt),new p(f.ENOTSUP)},U.prototype.access=function(t,r,e){throw e===void 0&&(e=pt),new p(f.ENOTSUP)},U.prototype.accessSync=function(t,r){throw new p(f.ENOTSUP)},U.prototype.createReadStream=function(t,r){throw new p(f.ENOTSUP)},U.prototype.createWriteStream=function(t,r){throw new p(f.ENOTSUP)},U.prototype.wrapCallbacks=function(t){G=t},U.prototype.getFdForFile=function(t){var r=this.nextFd++;return this.fdMap[r]=t,r},U.prototype.fd2file=function(t){var r=this.fdMap[t];if(r)return r;throw new p(f.EBADF,"Invalid file descriptor.")},U.prototype.closeFd=function(t){delete this.fdMap[t]},U.Stats=C;var tt=new U,ft={},Rt=U.prototype;Object.keys(Rt).forEach(function(i){typeof tt[i]=="function"?ft[i]=function(){return tt[i].apply(tt,arguments)}:ft[i]=tt[i]}),ft.changeFSModule=function(i){tt=i},ft.getFSModule=function(){return tt},ft.FS=U;function dt(i,t,r,e,n){return i<t||r<t?i>r?r+1:i+1:e===n?t:t+1}function Lt(i,t){if(i===t)return 0;if(i.length>t.length){var r=i;i=t,t=r}for(var e=i.length,n=t.length;e>0&&i.charCodeAt(e-1)===t.charCodeAt(n-1);)e--,n--;for(var a=0;a<e&&i.charCodeAt(a)===t.charCodeAt(a);)a++;if(e-=a,n-=a,e===0||n===1)return n;for(var u=new Array(e<<1),h=0;h<e;)u[e+h]=i.charCodeAt(a+h),u[h]=++h;var S,x,O,D,V;for(S=0;S+3<n;)for(var $=t.charCodeAt(a+(x=S)),rt=t.charCodeAt(a+(O=S+1)),ct=t.charCodeAt(a+(D=S+2)),yt=t.charCodeAt(a+(V=S+3)),Ft=S+=4,Vt=0;Vt<e;){var se=u[e+Vt],Te=u[Vt];x=dt(Te,x,O,$,se),O=dt(x,O,D,rt,se),D=dt(O,D,V,ct,se),Ft=dt(D,V,Ft,yt,se),u[Vt++]=Ft,V=D,D=O,O=x,x=Te}for(var Oe=0;S<n;){var dr=t.charCodeAt(a+(x=S));Oe=++S;for(var Ue=0;Ue<e;Ue++){var Pe=u[Ue];u[Ue]=Oe=Pe<x||Oe<x?Pe>Oe?Oe+1:Pe+1:dr===u[e+Ue]?x:x+1,x=Pe}}return Oe}function kt(i,t,r){i&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(r)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var St=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Xt=typeof window>"u";function P(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function z(i,t,r){r.existsSync(i)||(z(w.dirname(i),t,r),r.mkdirSync(i,t))}function K(i){var t=ut(i),r=t.byteOffset,e=t.byteLength;return r===0&&e===t.buffer.byteLength?t.buffer:t.buffer.slice(r,r+e)}function ut(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function It(i){return i instanceof c?i:i instanceof Uint8Array?vt(i):c.from(i)}function vt(i){return i instanceof c?i:i.byteOffset===0&&i.byteLength===i.buffer.byteLength?xt(i.buffer):c.from(i.buffer,i.byteOffset,i.byteLength)}function xt(i){return c.from(i)}function Nt(i,t,r){if(t===void 0&&(t=0),r===void 0&&(r=i.length),t<0||r<0||r>i.length||t>r)throw new TypeError("Invalid slice bounds on buffer of length "+i.length+": ["+t+", "+r+"]");if(i.length===0)return Ct();var e=ut(i),n=i[0],a=(n+1)%255;return i[0]=a,e[0]===a?(e[0]=n,vt(e.slice(t,r))):(i[0]=n,vt(e.subarray(t,r)))}var jt=null;function Ct(){return jt||(jt=c.alloc(0))}function te(i,t){c.isBuffer(i)?t():t(new p(f.EINVAL,"option must be a Buffer."))}function R(i,t,r){var e=i.Options,n=i.Name,a=0,u=!1,h=!1;function S(V){u||(V&&(u=!0,r(V)),a--,a===0&&h&&r())}var x=function(V){if(e.hasOwnProperty(V)){var $=e[V],rt=t[V];if(rt==null){if(!$.optional){var ct=Object.keys(t).filter(function(Ft){return!(Ft in e)}).map(function(Ft){return{str:Ft,distance:Lt(V,Ft)}}).filter(function(Ft){return Ft.distance<5}).sort(function(Ft,Vt){return Ft.distance-Vt.distance});return u?{}:(u=!0,{v:r(new p(f.EINVAL,"["+n+"] Required option '"+V+"' not provided."+(ct.length>0?" You provided unrecognized option '"+ct[0].str+"'; perhaps you meant to type '"+V+"'.":"")+`
Option description: `+$.description))})}}else{var yt=!1;if(Array.isArray($.type)?yt=$.type.indexOf(typeof rt)!==-1:yt=typeof rt===$.type,yt)$.validator&&(a++,$.validator(rt,S));else return u?{}:(u=!0,{v:r(new p(f.EINVAL,"["+n+"] Value provided for option "+V+" is not the proper type. Expected "+(Array.isArray($.type)?"one of {"+$.type.join(", ")+"}":$.type)+", but received "+typeof rt+`
Option description: `+$.description))})}}};for(var O in e){var D=x(O);if(D)return D.v}h=!0,a===0&&!u&&r()}var N=Object.freeze({deprecationMessage:kt,isIE:St,isWebWorker:Xt,fail:P,mkdirpSync:z,buffer2ArrayBuffer:K,buffer2Uint8array:ut,arrayish2Buffer:It,uint8Array2Buffer:vt,arrayBuffer2Buffer:xt,copyingSlice:Nt,emptyBuffer:Ct,bufferValidator:te,checkOptions:R}),Y=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Y.prototype.open=function(t){var r=this.fs.realPath(t.node),e=this.FS;try{e.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(r,this.fs.flagsToPermissionString(t.flags)))}catch(n){throw n.code?new e.ErrnoError(this.ERRNO_CODES[n.code]):n}},Y.prototype.close=function(t){var r=this.FS;try{r.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(e){throw e.code?new r.ErrnoError(this.ERRNO_CODES[e.code]):e}},Y.prototype.read=function(t,r,e,n,a){try{return this.nodefs.readSync(t.nfd,vt(r),e,n,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.write=function(t,r,e,n,a){try{return this.nodefs.writeSync(t.nfd,vt(r),e,n,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.llseek=function(t,r,e){var n=r;if(e===1)n+=t.position;else if(e===2&&this.FS.isFile(t.node.mode))try{var a=this.nodefs.fstatSync(t.nfd);n+=a.size}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}if(n<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=n,n};var Q=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Q.prototype.getattr=function(t){var r=this.fs.realPath(t),e;try{e=this.nodefs.lstatSync(r)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},Q.prototype.setattr=function(t,r){var e=this.fs.realPath(t);try{if(r.mode!==void 0&&(this.nodefs.chmodSync(e,r.mode),t.mode=r.mode),r.timestamp!==void 0){var n=new Date(r.timestamp);this.nodefs.utimesSync(e,n,n)}}catch(a){if(!a.code)throw a;if(a.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}if(r.size!==void 0)try{this.nodefs.truncateSync(e,r.size)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.lookup=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r),n=this.fs.getMode(e);return this.fs.createNode(t,r,n)},Q.prototype.mknod=function(t,r,e,n){var a=this.fs.createNode(t,r,e,n),u=this.fs.realPath(a);try{this.FS.isDir(a.mode)?this.nodefs.mkdirSync(u,a.mode):this.nodefs.writeFileSync(u,"",{mode:a.mode})}catch(h){throw h.code?new this.FS.ErrnoError(this.ERRNO_CODES[h.code]):h}return a},Q.prototype.rename=function(t,r,e){var n=this.fs.realPath(t),a=this.PATH.join2(this.fs.realPath(r),e);try{this.nodefs.renameSync(n,a),t.name=e,t.parent=r}catch(u){throw u.code?new this.FS.ErrnoError(this.ERRNO_CODES[u.code]):u}},Q.prototype.unlink=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.unlinkSync(e)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.rmdir=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.rmdirSync(e)}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.readdir=function(t){var r=this.fs.realPath(t);try{var e=this.nodefs.readdirSync(r);return e.push(".",".."),e}catch(n){throw n.code?new this.FS.ErrnoError(this.ERRNO_CODES[n.code]):n}},Q.prototype.symlink=function(t,r,e){var n=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.symlinkSync(e,n)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.readlink=function(t){var r=this.fs.realPath(t);try{return this.nodefs.readlinkSync(r)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}};var ht=function(t,r,e,n){t===void 0&&(t=self.FS),r===void 0&&(r=self.PATH),e===void 0&&(e=self.ERRNO_CODES),n===void 0&&(n=ft),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=n,this.FS=t,this.PATH=r,this.ERRNO_CODES=e,this.node_ops=new Q(this),this.stream_ops=new Y(this)};ht.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},ht.prototype.createNode=function(t,r,e,n){var a=this.FS;if(!a.isDir(e)&&!a.isFile(e)&&!a.isLink(e))throw new a.ErrnoError(this.ERRNO_CODES.EINVAL);var u=a.createNode(t,r,e);return u.node_ops=this.node_ops,u.stream_ops=this.stream_ops,u},ht.prototype.getMode=function(t){var r;try{r=this.nodefs.lstatSync(t)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}return r.mode},ht.prototype.realPath=function(t){for(var r=[];t.parent!==t;)r.push(t.name),t=t.parent;return r.push(t.mount.opts.root),r.reverse(),this.PATH.join.apply(null,r)},ht.prototype.flagsToPermissionString=function(t){var r=typeof t=="string"?parseInt(t,10):t;return r&=8191,r in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[r]:t},ht.prototype.getNodeFS=function(){return this.nodefs},ht.prototype.getFS=function(){return this.FS},ht.prototype.getPATH=function(){return this.PATH},ht.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var it=function(){};it.prototype.supportsLinks=function(){return!1},it.prototype.diskSpace=function(t,r){r(0,0)},it.prototype.openFile=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.createFile=function(t,r,e,n){throw new p(f.ENOTSUP)},it.prototype.open=function(t,r,e,n){var a=this,u=function(h,S){if(h)switch(r.pathNotExistsAction()){case A.CREATE_FILE:return a.stat(w.dirname(t),!1,function(x,O){x?n(x):O&&!O.isDirectory()?n(p.ENOTDIR(w.dirname(t))):a.createFile(t,r,e,n)});case A.THROW_EXCEPTION:return n(p.ENOENT(t));default:return n(new p(f.EINVAL,"Invalid FileFlag object."))}else{if(S&&S.isDirectory())return n(p.EISDIR(t));switch(r.pathExistsAction()){case A.THROW_EXCEPTION:return n(p.EEXIST(t));case A.TRUNCATE_FILE:return a.openFile(t,r,function(x,O){x?n(x):O?O.truncate(0,function(){O.sync(function(){n(null,O)})}):P()});case A.NOP:return a.openFile(t,r,n);default:return n(new p(f.EINVAL,"Invalid FileFlag object."))}}};this.stat(t,!1,u)},it.prototype.rename=function(t,r,e){e(new p(f.ENOTSUP))},it.prototype.renameSync=function(t,r){throw new p(f.ENOTSUP)},it.prototype.stat=function(t,r,e){e(new p(f.ENOTSUP))},it.prototype.statSync=function(t,r){throw new p(f.ENOTSUP)},it.prototype.openFileSync=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.createFileSync=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.openSync=function(t,r,e){var n;try{n=this.statSync(t,!1)}catch{switch(r.pathNotExistsAction()){case A.CREATE_FILE:var a=this.statSync(w.dirname(t),!1);if(!a.isDirectory())throw p.ENOTDIR(w.dirname(t));return this.createFileSync(t,r,e);case A.THROW_EXCEPTION:throw p.ENOENT(t);default:throw new p(f.EINVAL,"Invalid FileFlag object.")}}if(n.isDirectory())throw p.EISDIR(t);switch(r.pathExistsAction()){case A.THROW_EXCEPTION:throw p.EEXIST(t);case A.TRUNCATE_FILE:return this.unlinkSync(t),this.createFileSync(t,r,n.mode);case A.NOP:return this.openFileSync(t,r,e);default:throw new p(f.EINVAL,"Invalid FileFlag object.")}},it.prototype.unlink=function(t,r){r(new p(f.ENOTSUP))},it.prototype.unlinkSync=function(t){throw new p(f.ENOTSUP)},it.prototype.rmdir=function(t,r){r(new p(f.ENOTSUP))},it.prototype.rmdirSync=function(t){throw new p(f.ENOTSUP)},it.prototype.mkdir=function(t,r,e){e(new p(f.ENOTSUP))},it.prototype.mkdirSync=function(t,r){throw new p(f.ENOTSUP)},it.prototype.readdir=function(t,r){r(new p(f.ENOTSUP))},it.prototype.readdirSync=function(t){throw new p(f.ENOTSUP)},it.prototype.exists=function(t,r){this.stat(t,null,function(e){r(!e)})},it.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch{return!1}},it.prototype.realpath=function(t,r,e){if(this.supportsLinks())for(var n=t.split(w.sep),a=0;a<n.length;a++){var u=n.slice(0,a+1);n[a]=w.join.apply(null,u)}else this.exists(t,function(h){h?e(null,t):e(p.ENOENT(t))})},it.prototype.realpathSync=function(t,r){if(this.supportsLinks()){for(var e=t.split(w.sep),n=0;n<e.length;n++){var a=e.slice(0,n+1);e[n]=w.join.apply(w,a)}return e.join(w.sep)}else{if(this.existsSync(t))return t;throw p.ENOENT(t)}},it.prototype.truncate=function(t,r,e){this.open(t,b.getFileFlag("r+"),420,function(n,a){if(n)return e(n);a.truncate(r,function(u){a.close(function(h){e(u||h)})})})},it.prototype.truncateSync=function(t,r){var e=this.openSync(t,b.getFileFlag("r+"),420);try{e.truncateSync(r)}catch(n){throw n}finally{e.closeSync()}},it.prototype.readFile=function(t,r,e,n){var a=n;this.open(t,e,420,function(u,h){if(u)return n(u);n=function(S,x){h.close(function(O){return S||(S=O),a(S,x)})},h.stat(function(S,x){if(S)return n(S);var O=c.alloc(x.size);h.read(O,0,x.size,0,function(D){if(D)return n(D);if(r===null)return n(D,O);try{n(null,O.toString(r))}catch(V){n(V)}})})})},it.prototype.readFileSync=function(t,r,e){var n=this.openSync(t,e,420);try{var a=n.statSync(),u=c.alloc(a.size);return n.readSync(u,0,a.size,0),n.closeSync(),r===null?u:u.toString(r)}finally{n.closeSync()}},it.prototype.writeFile=function(t,r,e,n,a,u){var h=u;this.open(t,n,420,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){h(O||D)})};try{typeof r=="string"&&(r=c.from(r,e))}catch(O){return u(O)}x.write(r,0,r.length,0,u)})},it.prototype.writeFileSync=function(t,r,e,n,a){var u=this.openSync(t,n,a);try{typeof r=="string"&&(r=c.from(r,e)),u.writeSync(r,0,r.length,0)}finally{u.closeSync()}},it.prototype.appendFile=function(t,r,e,n,a,u){var h=u;this.open(t,n,a,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){h(O||D)})},typeof r=="string"&&(r=c.from(r,e)),x.write(r,0,r.length,null,u)})},it.prototype.appendFileSync=function(t,r,e,n,a){var u=this.openSync(t,n,a);try{typeof r=="string"&&(r=c.from(r,e)),u.writeSync(r,0,r.length,null)}finally{u.closeSync()}},it.prototype.chmod=function(t,r,e,n){n(new p(f.ENOTSUP))},it.prototype.chmodSync=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.chown=function(t,r,e,n,a){a(new p(f.ENOTSUP))},it.prototype.chownSync=function(t,r,e,n){throw new p(f.ENOTSUP)},it.prototype.utimes=function(t,r,e,n){n(new p(f.ENOTSUP))},it.prototype.utimesSync=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.link=function(t,r,e){e(new p(f.ENOTSUP))},it.prototype.linkSync=function(t,r){throw new p(f.ENOTSUP)},it.prototype.symlink=function(t,r,e,n){n(new p(f.ENOTSUP))},it.prototype.symlinkSync=function(t,r,e){throw new p(f.ENOTSUP)},it.prototype.readlink=function(t,r){r(new p(f.ENOTSUP))},it.prototype.readlinkSync=function(t){throw new p(f.ENOTSUP)};var _t=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,n,a){try{this.renameSync(e,n),a()}catch(u){a(u)}},t.prototype.stat=function(e,n,a){try{a(null,this.statSync(e,n))}catch(u){a(u)}},t.prototype.open=function(e,n,a,u){try{u(null,this.openSync(e,n,a))}catch(h){u(h)}},t.prototype.unlink=function(e,n){try{this.unlinkSync(e),n()}catch(a){n(a)}},t.prototype.rmdir=function(e,n){try{this.rmdirSync(e),n()}catch(a){n(a)}},t.prototype.mkdir=function(e,n,a){try{this.mkdirSync(e,n),a()}catch(u){a(u)}},t.prototype.readdir=function(e,n){try{n(null,this.readdirSync(e))}catch(a){n(a)}},t.prototype.chmod=function(e,n,a,u){try{this.chmodSync(e,n,a),u()}catch(h){u(h)}},t.prototype.chown=function(e,n,a,u,h){try{this.chownSync(e,n,a,u),h()}catch(S){h(S)}},t.prototype.utimes=function(e,n,a,u){try{this.utimesSync(e,n,a),u()}catch(h){u(h)}},t.prototype.link=function(e,n,a){try{this.linkSync(e,n),a()}catch(u){a(u)}},t.prototype.symlink=function(e,n,a,u){try{this.symlinkSync(e,n,a),u()}catch(h){u(h)}},t.prototype.readlink=function(e,n){try{n(null,this.readlinkSync(e))}catch(a){n(a)}},t}(it),gt=function(){};gt.prototype.sync=function(t){t(new p(f.ENOTSUP))},gt.prototype.syncSync=function(){throw new p(f.ENOTSUP)},gt.prototype.datasync=function(t){this.sync(t)},gt.prototype.datasyncSync=function(){return this.syncSync()},gt.prototype.chown=function(t,r,e){e(new p(f.ENOTSUP))},gt.prototype.chownSync=function(t,r){throw new p(f.ENOTSUP)},gt.prototype.chmod=function(t,r){r(new p(f.ENOTSUP))},gt.prototype.chmodSync=function(t){throw new p(f.ENOTSUP)},gt.prototype.utimes=function(t,r,e){e(new p(f.ENOTSUP))},gt.prototype.utimesSync=function(t,r){throw new p(f.ENOTSUP)};var Yt=function(i){function t(r,e,n,a,u){if(i.call(this),this._pos=0,this._dirty=!1,this._fs=r,this._path=e,this._flag=n,this._stat=a,u?this._buffer=u:this._buffer=Ct(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStats=function(){return this._stat},t.prototype.getFlag=function(){return this._flag},t.prototype.getPath=function(){return this._path},t.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},t.prototype.advancePos=function(e){return this._pos+=e},t.prototype.setPos=function(e){return this._pos=e},t.prototype.sync=function(e){try{this.syncSync(),e()}catch(n){e(n)}},t.prototype.syncSync=function(){throw new p(f.ENOTSUP)},t.prototype.close=function(e){try{this.closeSync(),e()}catch(n){e(n)}},t.prototype.closeSync=function(){throw new p(f.ENOTSUP)},t.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(n){e(n)}},t.prototype.statSync=function(){return this._stat.clone()},t.prototype.truncate=function(e,n){try{this.truncateSync(e),this._flag.isSynchronous()&&!ft.getRootFS().supportsSynch()&&this.sync(n),n()}catch(a){return n(a)}},t.prototype.truncateSync=function(e){if(this._dirty=!0,!this._flag.isWriteable())throw new p(f.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,e>this._buffer.length){var n=c.alloc(e-this._buffer.length,0);this.writeSync(n,0,n.length,this._buffer.length),this._flag.isSynchronous()&&ft.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;var a=c.alloc(e);this._buffer.copy(a,0,0,e),this._buffer=a,this._flag.isSynchronous()&&ft.getRootFS().supportsSynch()&&this.syncSync()},t.prototype.write=function(e,n,a,u,h){try{h(null,this.writeSync(e,n,a,u),e)}catch(S){h(S)}},t.prototype.writeSync=function(e,n,a,u){if(this._dirty=!0,u==null&&(u=this.getPos()),!this._flag.isWriteable())throw new p(f.EPERM,"File not opened with a writeable mode.");var h=u+a;if(h>this._stat.size&&(this._stat.size=h,h>this._buffer.length)){var S=c.alloc(h);this._buffer.copy(S),this._buffer=S}var x=e.copy(this._buffer,u,n,n+a);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),x):(this.setPos(u+x),x)},t.prototype.read=function(e,n,a,u,h){try{h(null,this.readSync(e,n,a,u),e)}catch(S){h(S)}},t.prototype.readSync=function(e,n,a,u){if(!this._flag.isReadable())throw new p(f.EPERM,"File not opened with a readable mode.");u==null&&(u=this.getPos());var h=u+a;h>this._stat.size&&(a=this._stat.size-u);var S=this._buffer.copy(e,n,u,u+a);return this._stat.atime=new Date,this._pos=u+a,S},t.prototype.chmod=function(e,n){try{this.chmodSync(e),n()}catch(a){n(a)}},t.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new p(f.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},t.prototype.isDirty=function(){return this._dirty},t.prototype.resetDirty=function(){this._dirty=!1},t}(gt),ue=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t}(Yt),Fe=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),I=function(i){function t(r,e,n){if(n===void 0&&(n=!0),i.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=r,this._async=e,!r.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");kt(n,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{var a=new t(e.sync,e.async,!1);a.initialize(function(u){u?n(u):n(null,a)},!1)}catch(u){n(u)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,b.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,n){var a=this;n===void 0&&(n=!0),n&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var u=this._initializeCallbacks,h=function(D){a._isInitialized=!D,a._initializeCallbacks=[],u.forEach(function(V){return V(D)})};if(this._isInitialized)e();else if(u.push(e)===1){var S=function(D,V,$){D!=="/"&&a._sync.mkdirSync(D,V),a._async.readdir(D,function(rt,ct){var yt=0;function Ft(Vt){Vt?$(Vt):yt<ct.length?(O(w.join(D,ct[yt]),Ft),yt++):$()}rt?$(rt):Ft()})},x=function(D,V,$){a._async.readFile(D,null,b.getFileFlag("r"),function(rt,ct){if(rt)$(rt);else try{a._sync.writeFileSync(D,ct,null,b.getFileFlag("w"),V)}catch(yt){rt=yt}finally{$(rt)}})},O=function(D,V){a._async.stat(D,!1,function($,rt){$?V($):rt.isDirectory()?S(D,rt.mode,V):x(D,rt.mode,V)})};S("/",0,h)}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,n){this.checkInitialized(),this._sync.renameSync(e,n),this.enqueueOp({apiMethod:"rename",arguments:[e,n]})},t.prototype.statSync=function(e,n){return this.checkInitialized(),this._sync.statSync(e,n)},t.prototype.openSync=function(e,n,a){this.checkInitialized();var u=this._sync.openSync(e,n,a);return u.closeSync(),new Fe(this,e,n,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,b.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,n){this.checkInitialized(),this._sync.mkdirSync(e,n),this.enqueueOp({apiMethod:"mkdir",arguments:[e,n]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,n,a){this.checkInitialized(),this._sync.chmodSync(e,n,a),this.enqueueOp({apiMethod:"chmod",arguments:[e,n,a]})},t.prototype.chownSync=function(e,n,a,u){this.checkInitialized(),this._sync.chownSync(e,n,a,u),this.enqueueOp({apiMethod:"chown",arguments:[e,n,a,u]})},t.prototype.utimesSync=function(e,n,a){this.checkInitialized(),this._sync.utimesSync(e,n,a),this.enqueueOp({apiMethod:"utimes",arguments:[e,n,a]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new p(f.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var n=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var a=function(u){if(u&&console.error("WARNING: File system has desynchronized. Received following error: "+u+`
$`),n._queue.length>0){var h=n._queue.shift(),S=h.arguments;S.push(a),n._async[h.apiMethod].apply(n._async,S)}else n._queueRunning=!1};a()}},t}(_t);I.Name="AsyncMirror",I.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function v(i,t,r){switch(r.length){case 0:return i.call(t);case 1:return i.call(t,r[0]);case 2:return i.call(t,r[0],r[1]);case 3:return i.call(t,r[0],r[1],r[2])}return i.apply(t,r)}var m=Math.max;function k(i,t,r){return t=m(t===void 0?i.length-1:t,0),function(){for(var e=arguments,n=-1,a=m(e.length-t,0),u=Array(a);++n<a;)u[n]=e[t+n];n=-1;for(var h=Array(t+1);++n<t;)h[n]=e[n];return h[t]=r(u),v(i,this,h)}}function B(i){return i}function q(i,t){return k(i,t,B)}var J=function(i){return q(function(t){var r=t.pop();i.call(this,t,r)})};function bt(i){return q(function(t,r){var e=J(function(n,a){var u=this;return i(t,function(h,S){h.apply(u,n.concat(S))},a)});return r.length?e.apply(this,r):e})}var At=typeof d=="object"&&d&&d.Object===Object&&d,Bt=typeof self=="object"&&self&&self.Object===Object&&self,Gt=At||Bt||Function("return this")(),Dt=Gt.Symbol,Ie=Object.prototype,nr=Ie.hasOwnProperty,Ve=Ie.toString,qe=Dt?Dt.toStringTag:void 0;function si(i){var t=nr.call(i,qe),r=i[qe];try{i[qe]=void 0;var e=!0}catch{}var n=Ve.call(i);return e&&(t?i[qe]=r:delete i[qe]),n}var ai=Object.prototype,ui=ai.toString;function j(i){return ui.call(i)}var ot="[object Null]",F="[object Undefined]",at=Dt?Dt.toStringTag:void 0;function Mt(i){return i==null?i===void 0?F:ot:at&&at in Object(i)?si(i):j(i)}function nt(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var ce="[object AsyncFunction]",st="[object Function]",Jt="[object GeneratorFunction]",X="[object Proxy]";function Z(i){if(!nt(i))return!1;var t=Mt(i);return t==st||t==Jt||t==ce||t==X}var or=9007199254740991;function Ut(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=or}function lt(i){return i!=null&&Ut(i.length)&&!Z(i)}var Ze={};function De(){}function Wt(i){return function(){if(i!==null){var t=i;i=null,t.apply(this,arguments)}}}var Tt=typeof Symbol=="function"&&Symbol.iterator,re=function(i){return Tt&&i[Tt]&&i[Tt]()};function ae(i,t){for(var r=-1,e=Array(i);++r<i;)e[r]=t(r);return e}function ie(i){return i!=null&&typeof i=="object"}var sr="[object Arguments]";function Xe(i){return ie(i)&&Mt(i)==sr}var qt=Object.prototype,fe=qt.hasOwnProperty,ee=qt.propertyIsEnumerable,be=Xe(function(){return arguments}())?Xe:function(i){return ie(i)&&fe.call(i,"callee")&&!ee.call(i,"callee")},Se=Array.isArray;function Pr(){return!1}var Wi=typeof o=="object"&&o&&!o.nodeType&&o,Hi=Wi&&typeof y=="object"&&y&&!y.nodeType&&y,Yo=Hi&&Hi.exports===Wi,Vi=Yo?Gt.Buffer:void 0,Go=Vi?Vi.isBuffer:void 0,Jo=Go||Pr,Ko=9007199254740991,Qo=/^(?:0|[1-9]\d*)$/;function $o(i,t){return t=t??Ko,!!t&&(typeof i=="number"||Qo.test(i))&&i>-1&&i%1==0&&i<t}var ts="[object Arguments]",es="[object Array]",rs="[object Boolean]",is="[object Date]",ns="[object Error]",os="[object Function]",ss="[object Map]",as="[object Number]",us="[object Object]",cs="[object RegExp]",ls="[object Set]",hs="[object String]",ps="[object WeakMap]",ds="[object ArrayBuffer]",ys="[object DataView]",gs="[object Float32Array]",vs="[object Float64Array]",ms="[object Int8Array]",ws="[object Int16Array]",Ss="[object Int32Array]",Es="[object Uint8Array]",_s="[object Uint8ClampedArray]",xs="[object Uint16Array]",Fs="[object Uint32Array]",Pt={};Pt[gs]=Pt[vs]=Pt[ms]=Pt[ws]=Pt[Ss]=Pt[Es]=Pt[_s]=Pt[xs]=Pt[Fs]=!0,Pt[ts]=Pt[es]=Pt[ds]=Pt[rs]=Pt[ys]=Pt[is]=Pt[ns]=Pt[os]=Pt[ss]=Pt[as]=Pt[us]=Pt[cs]=Pt[ls]=Pt[hs]=Pt[ps]=!1;function Is(i){return ie(i)&&Ut(i.length)&&!!Pt[Mt(i)]}function bs(i){return function(t){return i(t)}}var qi=typeof o=="object"&&o&&!o.nodeType&&o,Zi=qi&&typeof y=="object"&&y&&!y.nodeType&&y,ks=Zi&&Zi.exports===qi,ci=ks&&At.process,Xi=function(){try{return ci&&ci.binding&&ci.binding("util")}catch{}}(),Yi=Xi&&Xi.isTypedArray,Rs=Yi?bs(Yi):Is,Ns=Object.prototype,Ts=Ns.hasOwnProperty;function Os(i,t){var r=Se(i),e=!r&&be(i),n=!r&&!e&&Jo(i),a=!r&&!e&&!n&&Rs(i),u=r||e||n||a,h=u?ae(i.length,String):[],S=h.length;for(var x in i)(t||Ts.call(i,x))&&!(u&&(x=="length"||n&&(x=="offset"||x=="parent")||a&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||$o(x,S)))&&h.push(x);return h}var As=Object.prototype;function Ls(i){var t=i&&i.constructor,r=typeof t=="function"&&t.prototype||As;return i===r}function Ds(i,t){return function(r){return i(t(r))}}var Cs=Ds(Object.keys,Object),Bs=Object.prototype,Ms=Bs.hasOwnProperty;function Us(i){if(!Ls(i))return Cs(i);var t=[];for(var r in Object(i))Ms.call(i,r)&&r!="constructor"&&t.push(r);return t}function Gi(i){return lt(i)?Os(i):Us(i)}function Ps(i){var t=-1,r=i.length;return function(){return++t<r?{value:i[t],key:t}:null}}function zs(i){var t=-1;return function(){var e=i.next();return e.done?null:(t++,{value:e.value,key:t})}}function js(i){var t=Gi(i),r=-1,e=t.length;return function(){var a=t[++r];return r<e?{value:i[a],key:a}:null}}function Ws(i){if(lt(i))return Ps(i);var t=re(i);return t?zs(t):js(i)}function Ji(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function Ki(i){return function(t,r,e){if(e=Wt(e||De),i<=0||!t)return e(null);var n=Ws(t),a=!1,u=0;function h(x,O){if(u-=1,x)a=!0,e(x);else{if(O===Ze||a&&u<=0)return a=!0,e(null);S()}}function S(){for(;u<i&&!a;){var x=n();if(x===null){a=!0,u<=0&&e(null);return}u+=1,r(x.value,x.key,Ji(h))}}S()}}function Qi(i,t,r,e){Ki(t)(i,r,e)}function fi(i,t){return function(r,e,n){return i(r,t,e,n)}}function Hs(i,t,r){r=Wt(r||De);var e=0,n=0,a=i.length;a===0&&r(null);function u(h,S){h?r(h):(++n===a||S===Ze)&&r(null)}for(;e<a;e++)t(i[e],e,Ji(u))}var Vs=fi(Qi,1/0),$i=function(i,t,r){var e=lt(i)?Hs:Vs;e(i,t,r)};function qs(i){return function(t,r,e){return i($i,t,r,e)}}function tn(i,t,r,e){e=e||De,t=t||[];var n=[],a=0;i(t,function(u,h,S){var x=a++;r(u,function(O,D){n[x]=D,S(O)})},function(u){e(u,n)})}var Zs=qs(tn);bt(Zs);function Xs(i){return function(t,r,e,n){return i(Ki(r),t,e,n)}}var Ys=Xs(tn),Gs=fi(Ys,1);bt(Gs),q(function(i,t){return q(function(r){return i.apply(null,t.concat(r))})});function Js(i,t){for(var r=-1,e=i==null?0:i.length;++r<e&&t(i[r],r,i)!==!1;);return i}function Ks(i){return function(t,r,e){for(var n=-1,a=Object(t),u=e(t),h=u.length;h--;){var S=u[i?h:++n];if(r(a[S],S,a)===!1)break}return t}}var Qs=Ks();function Ku(i,t){return i&&Qs(i,t,Gi)}function $s(i,t,r,e){for(var n=i.length,a=r+(e?1:-1);e?a--:++a<n;)if(t(i[a],a,i))return a;return-1}function ta(i){return i!==i}function ea(i,t,r){for(var e=r-1,n=i.length;++e<n;)if(i[e]===t)return e;return-1}function Qu(i,t,r){return t===t?ea(i,t,r):$s(i,ta,r)}var en="\\ud800-\\udfff",ra="\\u0300-\\u036f",ia="\\ufe20-\\ufe2f",na="\\u20d0-\\u20ff",oa=ra+ia+na,sa="\\ufe0e\\ufe0f",aa="["+en+"]",li="["+oa+"]",ua="\\ud83c[\\udffb-\\udfff]",ca="(?:"+li+"|"+ua+")",rn="[^"+en+"]",nn="(?:\\ud83c[\\udde6-\\uddff]){2}",on="[\\ud800-\\udbff][\\udc00-\\udfff]",fa="\\u200d",sn=ca+"?",an="["+sa+"]?",la="(?:"+fa+"(?:"+[rn,nn,on].join("|")+")"+an+sn+")*",$u=an+sn+la,tc="(?:"+[rn+li+"?",li,nn,on,aa].join("|")+")",un=typeof setImmediate=="function"&&setImmediate,cn=typeof g=="object"&&typeof g.nextTick=="function";function fn(i){setTimeout(i,0)}function ln(i){return q(function(t,r){i(function(){t.apply(null,r)})})}var zr;un?zr=setImmediate:cn?zr=g.nextTick:zr=fn,ln(zr);var ha=fi(Qi,1);function pa(i,t,r,e){e=Wt(e||De),ha(i,function(n,a,u){r(t,n,function(h,S){t=S,u(h)})},function(n){e(n,t)})}var da=q(function(t){return q(function(r){var e=this,n=r[r.length-1];typeof n=="function"?r.pop():n=De,pa(t,r,function(a,u,h){u.apply(e,a.concat(q(function(S,x){h(S,x)})))},function(a,u){n.apply(e,[a].concat(u))})})});q(function(i){return da.apply(null,i.reverse())}),q(function(i){var t=[null].concat(i);return J(function(r,e){return e.apply(this,t)})});function hn(i){return q(function(t,r){t.apply(null,r.concat(q(function(e,n){typeof console=="object"&&(e?console.error&&console.error(e):console[i]&&Js(n,function(a){console[i](a)}))})))})}hn("dir");function ya(i){return function(t,r,e){return i(t,e)}}function pn(i,t,r){$i(i,ya(t),r)}hn("log");var jr;cn?jr=g.nextTick:un?jr=setImmediate:jr=fn,ln(jr);var ec=Math.ceil,rc=Math.max,le;function ga(){le||(le={},le[Dropbox.ApiError.NETWORK_ERROR]=f.EIO,le[Dropbox.ApiError.INVALID_PARAM]=f.EINVAL,le[Dropbox.ApiError.INVALID_TOKEN]=f.EPERM,le[Dropbox.ApiError.OAUTH_ERROR]=f.EPERM,le[Dropbox.ApiError.NOT_FOUND]=f.ENOENT,le[Dropbox.ApiError.INVALID_METHOD]=f.EINVAL,le[Dropbox.ApiError.NOT_ACCEPTABLE]=f.EINVAL,le[Dropbox.ApiError.CONFLICT]=f.EINVAL,le[Dropbox.ApiError.RATE_LIMITED]=f.EBUSY,le[Dropbox.ApiError.SERVER_ERROR]=f.EBUSY,le[Dropbox.ApiError.OVER_QUOTA]=f.ENOSPC)}function va(i){return i&&i.stat.isFile}function ma(i){return i&&i.stat.isFolder}function wa(i){return i==null||typeof i=="object"&&typeof i.byteLength=="number"}var oe=function(t){this._cache={},this._client=t};oe.prototype.readdir=function(t,r){var e=this,n=this.getCachedDirInfo(t);this._wrap(function(a){n!==null&&n.contents?e._client.readdir(t,{contentHash:n.stat.contentHash},a):e._client.readdir(t,a)},function(a,u,h,S){a?a.status===Dropbox.ApiError.NO_CONTENT&&n!==null?r(null,n.contents.slice(0)):r(a):(e.updateCachedDirInfo(t,h,u.slice(0)),S.forEach(function(x){e.updateCachedInfo(w.join(t,x.name),x)}),r(null,u))})},oe.prototype.remove=function(t,r){var e=this;this._wrap(function(n){e._client.remove(t,n)},function(n,a){n||e.updateCachedInfo(t,a),r(n)})},oe.prototype.move=function(t,r,e){var n=this;this._wrap(function(a){n._client.move(t,r,a)},function(a,u){a||(n.deleteCachedInfo(t),n.updateCachedInfo(r,u)),e(a)})},oe.prototype.stat=function(t,r){var e=this;this._wrap(function(n){e._client.stat(t,n)},function(n,a){n||e.updateCachedInfo(t,a),r(n,a)})},oe.prototype.readFile=function(t,r){var e=this,n=this.getCachedFileInfo(t);n!==null&&n.contents!==null?this.stat(t,function(a,u){a?r(a):u.contentHash===n.stat.contentHash?r(a,n.contents.slice(0),n.stat):e.readFile(t,r)}):this._wrap(function(a){e._client.readFile(t,{arrayBuffer:!0},a)},function(a,u,h){a||e.updateCachedInfo(t,h,u.slice(0)),r(a,u,h)})},oe.prototype.writeFile=function(t,r,e){var n=this;this._wrap(function(a){n._client.writeFile(t,r,a)},function(a,u){a||n.updateCachedInfo(t,u,r.slice(0)),e(a,u)})},oe.prototype.mkdir=function(t,r){var e=this;this._wrap(function(n){e._client.mkdir(t,n)},function(n,a){n||e.updateCachedInfo(t,a,[]),r(n)})},oe.prototype._wrap=function(t,r){var e=0,n=function(a){var u=2;if(a&&3>++e)switch(a.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){t(n)},u*1e3);break;default:r.apply(null,arguments);break}else r.apply(null,arguments)};t(n)},oe.prototype.getCachedInfo=function(t){return this._cache[t.toLowerCase()]},oe.prototype.putCachedInfo=function(t,r){this._cache[t.toLowerCase()]=r},oe.prototype.deleteCachedInfo=function(t){delete this._cache[t.toLowerCase()]},oe.prototype.getCachedDirInfo=function(t){var r=this.getCachedInfo(t);return ma(r)?r:null},oe.prototype.getCachedFileInfo=function(t){var r=this.getCachedInfo(t);return va(r)?r:null},oe.prototype.updateCachedDirInfo=function(t,r,e){e===void 0&&(e=null);var n=this.getCachedInfo(t);r.contentHash!==null&&(n===void 0||n.stat.contentHash!==r.contentHash)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedFileInfo=function(t,r,e){e===void 0&&(e=null);var n=this.getCachedInfo(t);r.versionTag!==null&&(n===void 0||n.stat.versionTag!==r.versionTag)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedInfo=function(t,r,e){e===void 0&&(e=null),r.isFile&&wa(e)?this.updateCachedFileInfo(t,r,e):r.isFolder&&Array.isArray(e)&&this.updateCachedDirInfo(t,r,e)};var Sa=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(this.isDirty()){var a=this.getBuffer(),u=K(a);this._fs._writeFileStrict(this.getPath(),u,function(h){h||n.resetDirty(),e(h)})}else e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),Wr=function(i){function t(r,e){e===void 0&&(e=!0),i.call(this),this._client=new oe(r),kt(e,t.Name,{client:"authenticated dropbox client instance"}),ga()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.client,!1))},t.isAvailable=function(){return typeof Dropbox<"u"},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var n=this;this._client.readdir("/",function(a,u){if(a)e(n.convert(a,"/"));else{var h=function(x,O){var D=w.join("/",x);n._client.remove(D,function(V){O(V?n.convert(V,D):null)})},S=function(x){x?e(x):e()};pn(u,h,S)}})},t.prototype.rename=function(e,n,a){var u=this;this._client.move(e,n,function(h){h?u._client.stat(n,function(S,x){if(S||x.isFolder){var O=h.response.error.indexOf(e)>-1?e:n;a(u.convert(h,O))}else u._client.remove(n,function(D){D?a(u.convert(D,n)):u.rename(e,n,a)})}):a()})},t.prototype.stat=function(e,n,a){var u=this;this._client.stat(e,function(h,S){if(h)a(u.convert(h,e));else if(S&&S.isRemoved)a(p.FileError(f.ENOENT,e));else{var x=new C(u._statType(S),S.size);return a(null,x)}})},t.prototype.open=function(e,n,a,u){var h=this;this._client.readFile(e,function(S,x,O){if(S)if(n.isReadable())u(h.convert(S,e));else switch(S.status){case Dropbox.ApiError.NOT_FOUND:var D=new ArrayBuffer(0);return h._writeFileStrict(e,D,function(rt,ct){if(rt)u(rt);else{var yt=h._makeFile(e,n,ct,xt(D));u(null,yt)}});default:return u(h.convert(S,e))}else{var V;x===null?V=Ct():V=xt(x);var $=h._makeFile(e,n,O,V);return u(null,$)}})},t.prototype._writeFileStrict=function(e,n,a){var u=this,h=w.dirname(e);this.stat(h,!1,function(S,x){S?a(p.FileError(f.ENOENT,h)):u._client.writeFile(e,n,function(O,D){O?a(u.convert(O,e)):a(null,D)})})},t.prototype._statType=function(e){return e.isFile?L.FILE:L.DIRECTORY},t.prototype._makeFile=function(e,n,a,u){var h=this._statType(a),S=new C(h,a.size);return new Sa(this,e,n,S,u)},t.prototype._remove=function(e,n,a){var u=this;this._client.stat(e,function(h,S){h?n(u.convert(h,e)):S.isFile&&!a?n(p.FileError(f.ENOTDIR,e)):!S.isFile&&a?n(p.FileError(f.EISDIR,e)):u._client.remove(e,function(x){n(x?u.convert(x,e):null)})})},t.prototype.unlink=function(e,n){this._remove(e,n,!0)},t.prototype.rmdir=function(e,n){this._remove(e,n,!1)},t.prototype.mkdir=function(e,n,a){var u=this,h=w.dirname(e);this._client.stat(h,function(S,x){S?a(u.convert(S,h)):u._client.mkdir(e,function(O){a(O?p.FileError(f.EEXIST,e):null)})})},t.prototype.readdir=function(e,n){var a=this;this._client.readdir(e,function(u,h){return u?n(a.convert(u)):n(null,h)})},t.prototype.convert=function(e,n){n===void 0&&(n=null);var a=le[e.status];return a===void 0&&(a=f.EIO),n?p.FileError(a,n):new p(a)},t}(it);Wr.Name="Dropbox",Wr.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(i,t){i.isAuthenticated&&i.isAuthenticated()?t():t(new p(f.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function Zt(i,t){t===void 0&&(t="");for(var r=i.errno,e=i.node,n=[];e&&(n.unshift(e.name),e!==e.parent);)e=e.parent;return new p(r,_[r],n.length>0?"/"+n.join("/"):t)}var Ea=function(i){function t(r,e,n,a){i.call(this),this._fs=r,this._FS=e,this._path=n,this._stream=a}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var n=null;try{this.closeSync()}catch(a){n=a}finally{e(n)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw Zt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(n){e(n)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw Zt(e,this._path)}},t.prototype.truncate=function(e,n){var a=null;try{this.truncateSync(e)}catch(u){a=u}finally{n(a)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(n){throw Zt(n,this._path)}},t.prototype.write=function(e,n,a,u,h){try{h(null,this.writeSync(e,n,a,u),e)}catch(S){h(S)}},t.prototype.writeSync=function(e,n,a,u){try{var h=ut(e),S=u===null?void 0:u;return this._FS.write(this._stream,h,n,a,S)}catch(x){throw Zt(x,this._path)}},t.prototype.read=function(e,n,a,u,h){try{h(null,this.readSync(e,n,a,u),e)}catch(S){h(S)}},t.prototype.readSync=function(e,n,a,u){try{var h=ut(e),S=u===null?void 0:u;return this._FS.read(this._stream,h,n,a,S)}catch(x){throw Zt(x,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,n,a){var u=null;try{this.chownSync(e,n)}catch(h){u=h}finally{a(u)}},t.prototype.chownSync=function(e,n){try{this._FS.fchown(this._stream.fd,e,n)}catch(a){throw Zt(a,this._path)}},t.prototype.chmod=function(e,n){var a=null;try{this.chmodSync(e)}catch(u){a=u}finally{n(a)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(n){throw Zt(n,this._path)}},t.prototype.utimes=function(e,n,a){var u=null;try{this.utimesSync(e,n)}catch(h){u=h}finally{a(u)}},t.prototype.utimesSync=function(e,n){this._fs.utimesSync(this._path,e,n)},t}(gt),Hr=function(i){function t(r){i.call(this),this._FS=r}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.FS))},t.isAvailable=function(){return!0},t.prototype.getName=function(){return this._FS.DB_NAME()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!0},t.prototype.supportsProps=function(){return!0},t.prototype.supportsSynch=function(){return!0},t.prototype.renameSync=function(e,n){try{this._FS.rename(e,n)}catch(a){throw a.errno===f.ENOENT?Zt(a,this.existsSync(e)?n:e):Zt(a)}},t.prototype.statSync=function(e,n){try{var a=n?this._FS.lstat(e):this._FS.stat(e),u=this.modeToFileType(a.mode);return new C(u,a.size,a.mode,a.atime,a.mtime,a.ctime)}catch(h){throw Zt(h,e)}},t.prototype.openSync=function(e,n,a){try{var u=this._FS.open(e,n.getFlagString(),a);if(this._FS.isDir(u.node.mode))throw this._FS.close(u),p.EISDIR(e);return new Ea(this,this._FS,e,u)}catch(h){throw Zt(h,e)}},t.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(n){throw Zt(n,e)}},t.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(n){throw Zt(n,e)}},t.prototype.mkdirSync=function(e,n){try{this._FS.mkdir(e,n)}catch(a){throw Zt(a,e)}},t.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter(function(n){return n!=="."&&n!==".."})}catch(n){throw Zt(n,e)}},t.prototype.truncateSync=function(e,n){try{this._FS.truncate(e,n)}catch(a){throw Zt(a,e)}},t.prototype.readFileSync=function(e,n,a){try{var u=this._FS.readFile(e,{flags:a.getFlagString()}),h=vt(u);return n?h.toString(n):h}catch(S){throw Zt(S,e)}},t.prototype.writeFileSync=function(e,n,a,u,h){try{a&&(n=c.from(n,a));var S=ut(n);this._FS.writeFile(e,S,{flags:u.getFlagString(),encoding:"binary"}),this._FS.chmod(e,h)}catch(x){throw Zt(x,e)}},t.prototype.chmodSync=function(e,n,a){try{n?this._FS.lchmod(e,a):this._FS.chmod(e,a)}catch(u){throw Zt(u,e)}},t.prototype.chownSync=function(e,n,a,u){try{n?this._FS.lchown(e,a,u):this._FS.chown(e,a,u)}catch(h){throw Zt(h,e)}},t.prototype.symlinkSync=function(e,n,a){try{this._FS.symlink(e,n)}catch(u){throw Zt(u)}},t.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(n){throw Zt(n,e)}},t.prototype.utimesSync=function(e,n,a){try{this._FS.utime(e,n.getTime(),a.getTime())}catch(u){throw Zt(u,e)}},t.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return L.DIRECTORY;if(this._FS.isFile(e))return L.FILE;if(this._FS.isLink(e))return L.SYMLINK;throw p.EPERM("Invalid mode: "+e)},t}(_t);Hr.Name="EmscriptenFileSystem",Hr.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var ar=function(i){function t(r,e){i.call(this),this._folder=r,this._wrapped=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var n=this;this._wrapped.exists(this._folder,function(a){a?e():n._wrapped.isReadOnly()?e(p.ENOENT(n._folder)):n._wrapped.mkdir(n._folder,511,e)})},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t}(it);ar.Name="FolderAdapter",ar.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function dn(i,t){if(t!==null&&typeof t=="object"){var r=t,e=r.path;e&&(e="/"+w.relative(i,e),r.message=r.message.replace(r.path,e),r.path=e)}return t}function _a(i,t){return typeof t=="function"?function(r){arguments.length>0&&(arguments[0]=dn(i,r)),t.apply(null,arguments)}:t}function yn(i,t,r){return i.slice(i.length-4)!=="Sync"?function(){return arguments.length>0&&(t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),arguments[arguments.length-1]=_a(this._folder,arguments[arguments.length-1])),this._wrapped[i].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),this._wrapped[i].apply(this._wrapped,arguments)}catch(e){throw dn(this._folder,e)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(i){ar.prototype[i]=yn(i,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(i){ar.prototype[i]=yn(i,!0,!0)});var Vr;typeof window<"u"?Vr=window:typeof self<"u"?Vr=self:Vr=d;var Kt=Vr;function xa(i){return i.isDirectory}var hi=Kt.webkitRequestFileSystem||Kt.requestFileSystem||null;function Fa(i,t,r,e){if(typeof navigator.webkitPersistentStorage<"u")switch(i){case Kt.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,r,e);break;case Kt.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,r,e);break;default:e(new TypeError("Invalid storage type: "+i));break}else Kt.webkitStorageInfo.requestQuota(i,t,r,e)}function Ia(i){return Array.prototype.slice.call(i||[],0)}function ke(i,t,r){switch(i.name){case"PathExistsError":return p.EEXIST(t);case"QuotaExceededError":return p.FileError(f.ENOSPC,t);case"NotFoundError":return p.ENOENT(t);case"SecurityError":return p.FileError(f.EACCES,t);case"InvalidModificationError":return p.FileError(f.EPERM,t);case"TypeMismatchError":return p.FileError(r?f.ENOTDIR:f.EISDIR,t);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return p.FileError(f.EINVAL,t)}}var ba=function(i){function t(r,e,n,a,u,h){i.call(this,r,n,a,u,h),this._entry=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(!this.isDirty())return e();this._entry.createWriter(function(a){var u=n.getBuffer(),h=new Blob([K(u)]),S=h.size;a.onwriteend=function(x){a.onwriteend=null,a.onerror=null,a.truncate(S),n.resetDirty(),e()},a.onerror=function(x){e(ke(x,n.getPath(),!1))},a.write(h)})},t.prototype.close=function(e){this.sync(e)},t}(Yt),qr=function(i){function t(r,e,n){r===void 0&&(r=5),e===void 0&&(e=Kt.PERSISTENT),n===void 0&&(n=!0),i.call(this),this.size=1024*1024*r,this.type=e,kt(n,t.Name,{size:r,type:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t(e.size,e.type,!1);a.allocate(function(u){return u?n(u):n(null,a)},!1)},t.isAvailable=function(){return!!hi},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,n){var a=this;e===void 0&&(e=function(){}),n===void 0&&(n=!0),n&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var u=function(S){a.fs=S,e()},h=function(S){e(ke(S,"/",!0))};this.type===Kt.PERSISTENT?Fa(this.type,this.size,function(S){hi(a.type,S,u,h)},h):hi(this.type,this.size,u,h)},t.prototype.empty=function(e){this._readdir("/",function(n,a){if(n)console.error("Failed to empty FS"),e(n);else{var u=function(S){n?(console.error("Failed to empty FS"),e(n)):e()},h=function(S,x){var O=function(){x()},D=function(V){x(ke(V,S.fullPath,!S.isDirectory))};xa(S)?S.removeRecursively(O,D):S.remove(O,D)};pn(a,h,u)}})},t.prototype.rename=function(e,n,a){var u=this,h=2,S=0,x=this.fs.root,O=e,D=function($){--h<=0&&a(ke($,O,!1))},V=function($){if(++S===2)return a(new p(f.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(e===n)return a();O=w.dirname(n),x.getDirectory(O,{},function(rt){O=w.basename(n),$.moveTo(rt,O,function(ct){a()},function(ct){$.isDirectory?(O=n,u.unlink(n,function(yt){yt?D(ct):u.rename(e,n,a)})):D(ct)})},D)};x.getFile(e,{},V,D),x.getDirectory(e,{},V,D)},t.prototype.stat=function(e,n,a){var u=this,h={create:!1},S=function(V){var $=function(rt){var ct=new C(L.FILE,rt.size);a(null,ct)};V.file($,O)},x=function(V){var $=4096,rt=new C(L.DIRECTORY,$);a(null,rt)},O=function(V){a(ke(V,e,!1))},D=function(){u.fs.root.getDirectory(e,h,x,O)};this.fs.root.getFile(e,h,S,D)},t.prototype.open=function(e,n,a,u){var h=this,S=function(x){x.name==="InvalidModificationError"&&n.isExclusive()?u(p.EEXIST(e)):u(ke(x,e,!1))};this.fs.root.getFile(e,{create:n.pathNotExistsAction()===A.CREATE_FILE,exclusive:n.isExclusive()},function(x){x.file(function(O){var D=new FileReader;D.onloadend=function(V){var $=h._makeFile(e,x,n,O,D.result);u(null,$)},D.onerror=function(V){S(D.error)},D.readAsArrayBuffer(O)},S)},S)},t.prototype.unlink=function(e,n){this._remove(e,n,!0)},t.prototype.rmdir=function(e,n){var a=this;this.readdir(e,function(u,h){u?n(u):h.length>0?n(p.ENOTEMPTY(e)):a._remove(e,n,!1)})},t.prototype.mkdir=function(e,n,a){var u={create:!0,exclusive:!0},h=function(x){a()},S=function(x){a(ke(x,e,!0))};this.fs.root.getDirectory(e,u,h,S)},t.prototype.readdir=function(e,n){this._readdir(e,function(a,u){if(u){for(var h=[],S=0,x=u;S<x.length;S+=1){var O=x[S];h.push(O.name)}n(null,h)}else return n(a)})},t.prototype._makeFile=function(e,n,a,u,h){h===void 0&&(h=new ArrayBuffer(0));var S=new C(L.FILE,u.size),x=xt(h);return new ba(this,n,e,a,S,x)},t.prototype._readdir=function(e,n){var a=function(u){n(ke(u,e,!0))};this.fs.root.getDirectory(e,{create:!1},function(u){var h=u.createReader(),S=[],x=function(){h.readEntries(function(O){O.length?(S=S.concat(Ia(O)),x()):n(null,S)},a)};x()},a)},t.prototype._remove=function(e,n,a){var u=function(x){var O=function(){n()},D=function(V){n(ke(V,e,!a))};x.remove(O,D)},h=function(x){n(ke(x,e,!a))},S={create:!1};a?this.fs.root.getFile(e,S,u,h):this.fs.root.getDirectory(e,S,u,h)},t}(it);qr.Name="HTML5FS",qr.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var he=function(t,r,e,n,a,u){this.id=t,this.size=r,this.mode=e,this.atime=n,this.mtime=a,this.ctime=u};he.fromBuffer=function(t){if(t===void 0)throw new Error("NO");return new he(t.toString("ascii",30),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22))},he.prototype.toStats=function(){return new C((this.mode&61440)===L.DIRECTORY?L.DIRECTORY:L.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},he.prototype.getSize=function(){return 30+this.id.length},he.prototype.toBuffer=function(t){return t===void 0&&(t=c.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},he.prototype.update=function(t){var r=!1;this.size!==t.size&&(this.size=t.size,r=!0),this.mode!==t.mode&&(this.mode=t.mode,r=!0);var e=t.atime.getTime();this.atime!==e&&(this.atime=e,r=!0);var n=t.mtime.getTime();this.mtime!==n&&(this.mtime=n,r=!0);var a=t.ctime.getTime();return this.ctime!==a&&(this.ctime=a,r=!0),r},he.prototype.isFile=function(){return(this.mode&61440)===L.FILE},he.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY};var je="/",pi=null;function gn(){return pi||(pi=c.from("{}"))}function Zr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=Math.random()*16|0,r=i==="x"?t:t&3|8;return r.toString(16)})}function ge(i,t){return i?(t(i),!1):!0}function $t(i,t,r){return i?(t.abort(function(){r(i)}),!1):!0}var Ce=function(t){this.store=t,this.originalData={},this.modifiedKeys=[]};Ce.prototype.get=function(t){var r=this.store.get(t);return this.stashOldValue(t,r),r},Ce.prototype.put=function(t,r,e){return this.markModified(t),this.store.put(t,r,e)},Ce.prototype.del=function(t){this.markModified(t),this.store.del(t)},Ce.prototype.commit=function(){},Ce.prototype.abort=function(){for(var t=this,r=0,e=t.modifiedKeys;r<e.length;r+=1){var n=e[r],a=t.originalData[n];a?t.store.put(n,a,!0):t.store.del(n)}},Ce.prototype.stashOldValue=function(t,r){this.originalData.hasOwnProperty(t)||(this.originalData[t]=r)},Ce.prototype.markModified=function(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))};var vn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),mn=function(i){function t(r){i.call(this),this.store=r.store,this.makeRootDirectory()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},t.prototype.renameSync=function(e,n){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),h=w.basename(e),S=w.dirname(n),x=w.basename(n),O=this.findINode(a,u),D=this.getDirListing(a,u,O);if(!D[h])throw p.ENOENT(e);var V=D[h];if(delete D[h],(S+"/").indexOf(e+"/")===0)throw new p(f.EBUSY,u);var $,rt;if(S===u?($=O,rt=D):($=this.findINode(a,S),rt=this.getDirListing(a,S,$)),rt[x]){var ct=this.getINode(a,n,rt[x]);if(ct.isFile())try{a.del(ct.id),a.del(rt[x])}catch(yt){throw a.abort(),yt}else throw p.EPERM(n)}rt[x]=V;try{a.put(O.id,c.from(JSON.stringify(D)),!0),a.put($.id,c.from(JSON.stringify(rt)),!0)}catch(yt){throw a.abort(),yt}a.commit()},t.prototype.statSync=function(e,n){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},t.prototype.createFileSync=function(e,n,a){var u=this.store.beginTransaction("readwrite"),h=Ct(),S=this.commitNewFile(u,e,L.FILE,a,h);return new vn(this,e,n,S.toStats(),h)},t.prototype.openFileSync=function(e,n){var a=this.store.beginTransaction("readonly"),u=this.findINode(a,e),h=a.get(u.id);if(h===void 0)throw p.ENOENT(e);return new vn(this,e,n,u.toStats(),h)},t.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},t.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.removeEntry(e,!0)},t.prototype.mkdirSync=function(e,n){var a=this.store.beginTransaction("readwrite"),u=c.from("{}");this.commitNewFile(a,e,L.DIRECTORY,n,u)},t.prototype.readdirSync=function(e){var n=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(n,e,this.findINode(n,e)))},t.prototype._syncSync=function(e,n,a){var u=this.store.beginTransaction("readwrite"),h=this._findINode(u,w.dirname(e),w.basename(e)),S=this.getINode(u,e,h),x=S.update(a);try{u.put(S.id,n,!0),x&&u.put(h,S.toBuffer(),!0)}catch(O){throw u.abort(),O}u.commit()},t.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(e.get(je)===void 0){var n=new Date().getTime(),a=new he(Zr(),4096,511|L.DIRECTORY,n,n,n);e.put(a.id,gn(),!1),e.put(je,a.toBuffer(),!1),e.commit()}},t.prototype._findINode=function(e,n,a){var u=this,h=function(S){var x=u.getDirListing(e,n,S);if(x[a])return x[a];throw p.ENOENT(w.resolve(n,a))};return n==="/"?a===""?je:h(this.getINode(e,n,je)):h(this.getINode(e,n+w.sep+a,this._findINode(e,w.dirname(n),w.basename(n))))},t.prototype.findINode=function(e,n){return this.getINode(e,n,this._findINode(e,w.dirname(n),w.basename(n)))},t.prototype.getINode=function(e,n,a){var u=e.get(a);if(u===void 0)throw p.ENOENT(n);return he.fromBuffer(u)},t.prototype.getDirListing=function(e,n,a){if(!a.isDirectory())throw p.ENOTDIR(n);var u=e.get(a.id);if(u===void 0)throw p.ENOENT(n);return JSON.parse(u.toString())},t.prototype.addNewNode=function(e,n){for(var a=0,u;a<5;)try{return u=Zr(),e.put(u,n,!1),u}catch{}throw new p(f.EIO,"Unable to commit data to key-value store.")},t.prototype.commitNewFile=function(e,n,a,u,h){var S=w.dirname(n),x=w.basename(n),O=this.findINode(e,S),D=this.getDirListing(e,S,O),V=new Date().getTime();if(n==="/"||D[x])throw p.EEXIST(n);var $;try{var rt=this.addNewNode(e,h);$=new he(rt,h.length,u|a,V,V,V);var ct=this.addNewNode(e,$.toBuffer());D[x]=ct,e.put(O.id,c.from(JSON.stringify(D)),!0)}catch(yt){throw e.abort(),yt}return e.commit(),$},t.prototype.removeEntry=function(e,n){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),h=this.findINode(a,u),S=this.getDirListing(a,u,h),x=w.basename(e);if(!S[x])throw p.ENOENT(e);var O=S[x];delete S[x];var D=this.getINode(a,e,O);if(!n&&D.isDirectory())throw p.EISDIR(e);if(n&&!D.isDirectory())throw p.ENOTDIR(e);try{a.del(D.id),a.del(O),a.put(h.id,c.from(JSON.stringify(S)),!0)}catch(V){throw a.abort(),V}a.commit()},t}(_t),wn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(a){a||n.resetDirty(),e(a)}):e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),ka=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.init=function(e,n){this.store=e,this.makeRootDirectory(n)},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var n=this;this.store.clear(function(a){ge(a,e)&&n.makeRootDirectory(e)})},t.prototype.rename=function(e,n,a){var u=this,h=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e),O=w.dirname(n),D=w.basename(n),V={},$={},rt=!1;if((O+"/").indexOf(e+"/")===0)return a(new p(f.EBUSY,S));var ct=function(){if(!(rt||!$.hasOwnProperty(S)||!$.hasOwnProperty(O))){var Ft=$[S],Vt=V[S],se=$[O],Te=V[O];if(!Ft[x])a(p.ENOENT(e));else{var Oe=Ft[x];delete Ft[x];var dr=function(){se[D]=Oe,h.put(Vt.id,c.from(JSON.stringify(Ft)),!0,function(Ue){$t(Ue,h,a)&&(S===O?h.commit(a):h.put(Te.id,c.from(JSON.stringify(se)),!0,function(Pe){$t(Pe,h,a)&&h.commit(a)}))})};se[D]?u.getINode(h,n,se[D],function(Ue,Pe){$t(Ue,h,a)&&(Pe.isFile()?h.del(Pe.id,function(uo){$t(uo,h,a)&&h.del(se[D],function(eu){$t(eu,h,a)&&dr()})}):h.abort(function(uo){a(p.EPERM(n))}))}):dr()}}},yt=function(Ft){u.findINodeAndDirListing(h,Ft,function(Vt,se,Te){Vt?rt||(rt=!0,h.abort(function(){a(Vt)})):(V[Ft]=se,$[Ft]=Te,ct())})};yt(S),S!==O&&yt(O)},t.prototype.stat=function(e,n,a){var u=this.store.beginTransaction("readonly");this.findINode(u,e,function(h,S){ge(h,a)&&a(null,S.toStats())})},t.prototype.createFile=function(e,n,a,u){var h=this,S=this.store.beginTransaction("readwrite"),x=Ct();this.commitNewFile(S,e,L.FILE,a,x,function(O,D){ge(O,u)&&u(null,new wn(h,e,n,D.toStats(),x))})},t.prototype.openFile=function(e,n,a){var u=this,h=this.store.beginTransaction("readonly");this.findINode(h,e,function(S,x){ge(S,a)&&h.get(x.id,function(O,D){ge(O,a)&&(D===void 0?a(p.ENOENT(e)):a(null,new wn(u,e,n,x.toStats(),D)))})})},t.prototype.unlink=function(e,n){this.removeEntry(e,!1,n)},t.prototype.rmdir=function(e,n){var a=this;this.readdir(e,function(u,h){u?n(u):h.length>0?n(p.ENOTEMPTY(e)):a.removeEntry(e,!0,n)})},t.prototype.mkdir=function(e,n,a){var u=this.store.beginTransaction("readwrite"),h=c.from("{}");this.commitNewFile(u,e,L.DIRECTORY,n,h,a)},t.prototype.readdir=function(e,n){var a=this,u=this.store.beginTransaction("readonly");this.findINode(u,e,function(h,S){ge(h,n)&&a.getDirListing(u,e,S,function(x,O){ge(x,n)&&n(null,Object.keys(O))})})},t.prototype._sync=function(e,n,a,u){var h=this,S=this.store.beginTransaction("readwrite");this._findINode(S,w.dirname(e),w.basename(e),function(x,O){$t(x,S,u)&&h.getINode(S,e,O,function(D,V){if($t(D,S,u)){var $=V.update(a);S.put(V.id,n,!0,function(rt){$t(rt,S,u)&&($?S.put(O,V.toBuffer(),!0,function(ct){$t(ct,S,u)&&S.commit(u)}):S.commit(u))})}})})},t.prototype.makeRootDirectory=function(e){var n=this.store.beginTransaction("readwrite");n.get(je,function(a,u){if(a||u===void 0){var h=new Date().getTime(),S=new he(Zr(),4096,511|L.DIRECTORY,h,h,h);n.put(S.id,gn(),!1,function(x){$t(x,n,e)&&n.put(je,S.toBuffer(),!1,function(O){O?n.abort(function(){e(O)}):n.commit(e)})})}else n.commit(e)})},t.prototype._findINode=function(e,n,a,u){var h=this,S=function(x,O,D){x?u(x):D[a]?u(null,D[a]):u(p.ENOENT(w.resolve(n,a)))};n==="/"?a===""?u(null,je):this.getINode(e,n,je,function(x,O){ge(x,u)&&h.getDirListing(e,n,O,function(D,V){S(D,O,V)})}):this.findINodeAndDirListing(e,n,S)},t.prototype.findINode=function(e,n,a){var u=this;this._findINode(e,w.dirname(n),w.basename(n),function(h,S){ge(h,a)&&u.getINode(e,n,S,a)})},t.prototype.getINode=function(e,n,a,u){e.get(a,function(h,S){ge(h,u)&&(S===void 0?u(p.ENOENT(n)):u(null,he.fromBuffer(S)))})},t.prototype.getDirListing=function(e,n,a,u){a.isDirectory()?e.get(a.id,function(h,S){if(ge(h,u))try{u(null,JSON.parse(S.toString()))}catch{u(p.ENOENT(n))}}):u(p.ENOTDIR(n))},t.prototype.findINodeAndDirListing=function(e,n,a){var u=this;this.findINode(e,n,function(h,S){ge(h,a)&&u.getDirListing(e,n,S,function(x,O){ge(x,a)&&a(null,S,O)})})},t.prototype.addNewNode=function(e,n,a){var u=0,h,S=function(){++u===5?a(new p(f.EIO,"Unable to commit data to key-value store.")):(h=Zr(),e.put(h,n,!1,function(x,O){x||!O?S():a(null,h)}))};S()},t.prototype.commitNewFile=function(e,n,a,u,h,S){var x=this,O=w.dirname(n),D=w.basename(n),V=new Date().getTime();if(n==="/")return S(p.EEXIST(n));this.findINodeAndDirListing(e,O,function($,rt,ct){$t($,e,S)&&(ct[D]?e.abort(function(){S(p.EEXIST(n))}):x.addNewNode(e,h,function(yt,Ft){if($t(yt,e,S)){var Vt=new he(Ft,h.length,u|a,V,V,V);x.addNewNode(e,Vt.toBuffer(),function(se,Te){$t(se,e,S)&&(ct[D]=Te,e.put(rt.id,c.from(JSON.stringify(ct)),!0,function(Oe){$t(Oe,e,S)&&e.commit(function(dr){$t(dr,e,S)&&S(null,Vt)})}))})}}))})},t.prototype.removeEntry=function(e,n,a){var u=this,h=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e);this.findINodeAndDirListing(h,S,function(O,D,V){if($t(O,h,a))if(!V[x])h.abort(function(){a(p.ENOENT(e))});else{var $=V[x];delete V[x],u.getINode(h,e,$,function(rt,ct){$t(rt,h,a)&&(!n&&ct.isDirectory()?h.abort(function(){a(p.EISDIR(e))}):n&&!ct.isDirectory()?h.abort(function(){a(p.ENOTDIR(e))}):h.del(ct.id,function(yt){$t(yt,h,a)&&h.del($,function(Ft){$t(Ft,h,a)&&h.put(D.id,c.from(JSON.stringify(V)),!0,function(Vt){$t(Vt,h,a)&&h.commit(a)})})}))})}})},t}(it),Ye=function(){this.store={}};Ye.prototype.name=function(){return ur.Name},Ye.prototype.clear=function(){this.store={}},Ye.prototype.beginTransaction=function(t){return new Ce(this)},Ye.prototype.get=function(t){return this.store[t]},Ye.prototype.put=function(t,r,e){return!e&&this.store.hasOwnProperty(t)?!1:(this.store[t]=r,!0)},Ye.prototype.del=function(t){delete this.store[t]};var ur=function(i){function t(){i.call(this,{store:new Ye})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t)},t}(mn);ur.Name="InMemory",ur.Options={};var di=Kt.indexedDB||Kt.mozIndexedDB||Kt.webkitIndexedDB||Kt.msIndexedDB;function _r(i,t){switch(t===void 0&&(t=i.toString()),i.name){case"NotFoundError":return new p(f.ENOENT,t);case"QuotaExceededError":return new p(f.ENOSPC,t);default:return new p(f.EIO,t)}}function xr(i,t,r){return t===void 0&&(t=f.EIO),r===void 0&&(r=null),function(e){e.preventDefault(),i(new p(t,r!==null?r:void 0))}}var yi=function(t,r){this.tx=t,this.store=r};yi.prototype.get=function(t,r){try{var e=this.store.get(t);e.onerror=xr(r),e.onsuccess=function(n){var a=n.target.result;a===void 0?r(null,a):r(null,xt(a))}}catch(n){r(_r(n))}};var Ra=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.put=function(e,n,a,u){try{var h=K(n),S;a?S=this.store.put(h,e):S=this.store.add(h,e),S.onerror=xr(u),S.onsuccess=function(x){u(null,!0)}}catch(x){u(_r(x))}},t.prototype.del=function(e,n){try{var a=this.store.delete(e);a.onerror=xr(n),a.onsuccess=function(u){n()}}catch(u){n(_r(u))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var n=null;try{this.tx.abort()}catch(a){n=_r(a)}finally{e(n)}},t}(yi),Xr=function(t,r){var e=this;r===void 0&&(r="browserfs"),this.storeName=r;var n=di.open(this.storeName,1);n.onupgradeneeded=function(a){var u=a.target.result;u.objectStoreNames.contains(e.storeName)&&u.deleteObjectStore(e.storeName),u.createObjectStore(e.storeName)},n.onsuccess=function(a){e.db=a.target.result,t(null,e)},n.onerror=xr(t,f.EACCES)};Xr.prototype.name=function(){return Fr.Name+" - "+this.storeName},Xr.prototype.clear=function(t){try{var r=this.db.transaction(this.storeName,"readwrite"),e=r.objectStore(this.storeName),n=e.clear();n.onsuccess=function(a){setTimeout(t,0)},n.onerror=xr(t)}catch(a){t(_r(a))}},Xr.prototype.beginTransaction=function(t){t===void 0&&(t="readonly");var r=this.db.transaction(this.storeName,t),e=r.objectStore(this.storeName);if(t==="readwrite")return new Ra(r,e);if(t==="readonly")return new yi(r,e);throw new p(f.EINVAL,"Invalid transaction type.")};var Fr=function(i){function t(r,e,n){var a=this;n===void 0&&(n=!0),i.call(this),this.store=new Xr(function(u){u?r(u):a.init(a.store,function(h){r(h,a)})},e),kt(n,t.Name,{storeName:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){new t(n,e.storeName,!1)},t.isAvailable=function(){try{return typeof di<"u"&&di.open("__browserfs_test__")!==null}catch{return!1}},t}(ka);Fr.Name="IndexedDB",Fr.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var gi=!1,Ir;try{Kt.localStorage.setItem("__test__",String.fromCharCode(55296)),gi=Kt.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch{gi=!1}Ir=gi?"binary_string":"binary_string_ie",c.isEncoding(Ir)||(Ir="base64");var Ge=function(){};Ge.prototype.name=function(){return br.Name},Ge.prototype.clear=function(){Kt.localStorage.clear()},Ge.prototype.beginTransaction=function(t){return new Ce(this)},Ge.prototype.get=function(t){try{var r=Kt.localStorage.getItem(t);if(r!==null)return c.from(r,Ir)}catch{}},Ge.prototype.put=function(t,r,e){try{return!e&&Kt.localStorage.getItem(t)!==null?!1:(Kt.localStorage.setItem(t,r.toString(Ir)),!0)}catch{throw new p(f.ENOSPC,"LocalStorage is full.")}},Ge.prototype.del=function(t){try{Kt.localStorage.removeItem(t)}catch(r){throw new p(f.EIO,"Unable to delete key "+t+": "+r)}};var br=function(i){function t(){i.call(this,{store:new Ge})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){n(null,new t)},t.isAvailable=function(){return typeof Kt.localStorage<"u"},t}(mn);br.Name="LocalStorage",br.Options={};var cr=function(i){function t(){i.call(this),this.mountList=[],this.mntMap={},this.rootFs=new ur}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t;Object.keys(e).forEach(function(u){a.mount(u,e[u])}),n(null,a)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,n){if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),this.mntMap[e])throw new p(f.EINVAL,"Mount point "+e+" is already taken.");z(e,511,this.rootFs),this.mntMap[e]=n,this.mountList.push(e),this.mountList=this.mountList.sort(function(a,u){return u.length-a.length})},t.prototype.umount=function(e){var n=this;if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),!this.mntMap[e])throw new p(f.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&n.rootFs.readdirSync(e).length===0;)n.rootFs.rmdirSync(e),e=w.dirname(e)},t.prototype._getFs=function(e){for(var n=this,a=this.mountList,u=a.length,h=0;h<u;h++){var S=a[h];if(S.length<=e.length&&e.indexOf(S)===0)return e=e.substr(S.length>1?S.length:0),e===""&&(e="/"),{fs:n.mntMap[S],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,n){n(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,n,a){var u=e.message.indexOf(n);return u!==-1&&(e.message=e.message.substr(0,u)+a+e.message.substr(u+n.length),e.path=a),e},t.prototype.rename=function(e,n,a){var u=this,h=this._getFs(e),S=this._getFs(n);return h.fs===S.fs?h.fs.rename(h.path,S.path,function(x){x&&u.standardizeError(u.standardizeError(x,h.path,e),S.path,n),a(x)}):ft.readFile(e,function(x,O){if(x)return a(x);ft.writeFile(n,O,function(D){if(D)return a(D);ft.unlink(e,a)})})},t.prototype.renameSync=function(e,n){var a=this._getFs(e),u=this._getFs(n);if(a.fs===u.fs)try{return a.fs.renameSync(a.path,u.path)}catch(S){throw this.standardizeError(this.standardizeError(S,a.path,e),u.path,n),S}var h=ft.readFileSync(e);return ft.writeFileSync(n,h),ft.unlinkSync(e)},t.prototype.readdirSync=function(e){var n=this._getFs(e),a=null;if(n.fs!==this.rootFs)try{a=this.rootFs.readdirSync(e)}catch{}try{var u=n.fs.readdirSync(n.path);return a===null?u:u.concat(a.filter(function(h){return u.indexOf(h)===-1}))}catch(h){if(a===null)throw this.standardizeError(h,n.path,e);return a}},t.prototype.readdir=function(e,n){var a=this,u=this._getFs(e);u.fs.readdir(u.path,function(h,S){if(u.fs!==a.rootFs)try{var x=a.rootFs.readdirSync(e);S?S=S.concat(x.filter(function(O){return S.indexOf(O)===-1})):S=x}catch{if(h)return n(a.standardizeError(h,u.path,e))}else if(h)return n(a.standardizeError(h,u.path,e));n(null,S)})},t.prototype.rmdirSync=function(e){var n=this._getFs(e);if(this._containsMountPt(e))throw p.ENOTEMPTY(e);try{n.fs.rmdirSync(n.path)}catch(a){throw this.standardizeError(a,n.path,e)}},t.prototype.rmdir=function(e,n){var a=this,u=this._getFs(e);this._containsMountPt(e)?n(p.ENOTEMPTY(e)):u.fs.rmdir(u.path,function(h){n(h?a.standardizeError(h,u.path,e):null)})},t.prototype._containsMountPt=function(e){for(var n=this.mountList,a=n.length,u=0;u<a;u++){var h=n[u];if(h.length>=e.length&&h.slice(0,e.length)===e)return!0}return!1},t}(it);cr.Name="MountableFileSystem",cr.Options={};function Sn(i,t,r){return t?function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var a=e[0],u=this._getFs(a);e[0]=u.path;try{return u.fs[i].apply(u.fs,e)}catch(h){throw this.standardizeError(h,u.path,a),h}}:function(){for(var e=this,n=[],a=arguments.length;a--;)n[a]=arguments[a];var u=n[0],h=this._getFs(u);if(n[0]=h.path,typeof n[n.length-1]=="function"){var S=n[n.length-1];n[n.length-1]=function(){for(var x=[],O=arguments.length;O--;)x[O]=arguments[O];x.length>0&&x[0]instanceof p&&e.standardizeError(x[0],h.path,u),S.apply(null,x)}}return h.fs[i].apply(h.fs,n)}}for(var En=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],kr=0;kr<En.length;kr++)for(var Na=En[kr],vi=0,_n=Na;vi<_n.length;vi+=1){var Yr=_n[vi];cr.prototype[Yr]=Sn(Yr,!1,kr+1),cr.prototype[Yr+"Sync"]=Sn(Yr+"Sync",!0,kr+1)}var Rr;if(typeof setImmediate<"u")Rr=setImmediate;else{var Ee=Kt,fr=[],xn="zero-timeout-message",Ta=function(){if(typeof Ee.importScripts<"u"||!Ee.postMessage)return!1;var i=!0,t=Ee.onmessage;return Ee.onmessage=function(){i=!1},Ee.postMessage("","*"),Ee.onmessage=t,i};if(Ta()){Rr=function(i){fr.push(i),Ee.postMessage(xn,"*")};var Fn=function(i){if(i.source===self&&i.data===xn&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,fr.length>0)){var t=fr.shift();return t()}};Ee.addEventListener?Ee.addEventListener("message",Fn,!0):Ee.attachEvent("onmessage",Fn)}else if(Ee.MessageChannel){var In=new Ee.MessageChannel;In.port1.onmessage=function(i){if(fr.length>0)return fr.shift()()},Rr=function(i){fr.push(i),In.port2.postMessage("")}}else Rr=function(i){return setTimeout(i,0)}}var mi=Rr,Nr=function(){this._locked=!1,this._waiters=[]};Nr.prototype.lock=function(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()},Nr.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var t=this._waiters.shift();if(t){mi(t);return}this._locked=!1},Nr.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},Nr.prototype.isLocked=function(){return this._locked};var mt=function(t){this._fs=t,this._mu=new Nr};mt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},mt.prototype.getFSUnlocked=function(){return this._fs},mt.prototype.initialize=function(t){this._fs.initialize(t)},mt.prototype.diskSpace=function(t,r){this._fs.diskSpace(t,r)},mt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},mt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},mt.prototype.supportsProps=function(){return this._fs.supportsProps()},mt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},mt.prototype.rename=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.rename(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.renameSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,r)},mt.prototype.stat=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.stat(t,r,function(a,u){n._mu.unlock(),e(a,u)})})},mt.prototype.statSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,r)},mt.prototype.open=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.open(t,r,e,function(u,h){a._mu.unlock(),n(u,h)})})},mt.prototype.openSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,r,e)},mt.prototype.unlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.unlink(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.unlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t)},mt.prototype.rmdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.rmdir(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.rmdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t)},mt.prototype.mkdir=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.mkdir(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.mkdirSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,r)},mt.prototype.readdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.readdir(t,function(n,a){e._mu.unlock(),r(n,a)})})},mt.prototype.readdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t)},mt.prototype.exists=function(t,r){var e=this;this._mu.lock(function(){e._fs.exists(t,function(n){e._mu.unlock(),r(n)})})},mt.prototype.existsSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t)},mt.prototype.realpath=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.realpath(t,r,function(a,u){n._mu.unlock(),e(a,u)})})},mt.prototype.realpathSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,r)},mt.prototype.truncate=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.truncate(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.truncateSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,r)},mt.prototype.readFile=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.readFile(t,r,e,function(u,h){a._mu.unlock(),n(u,h)})})},mt.prototype.readFileSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,r,e)},mt.prototype.writeFile=function(t,r,e,n,a,u){var h=this;this._mu.lock(function(){h._fs.writeFile(t,r,e,n,a,function(S){h._mu.unlock(),u(S)})})},mt.prototype.writeFileSync=function(t,r,e,n,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,r,e,n,a)},mt.prototype.appendFile=function(t,r,e,n,a,u){var h=this;this._mu.lock(function(){h._fs.appendFile(t,r,e,n,a,function(S){h._mu.unlock(),u(S)})})},mt.prototype.appendFileSync=function(t,r,e,n,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,r,e,n,a)},mt.prototype.chmod=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.chmod(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.chmodSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,r,e)},mt.prototype.chown=function(t,r,e,n,a){var u=this;this._mu.lock(function(){u._fs.chown(t,r,e,n,function(h){u._mu.unlock(),a(h)})})},mt.prototype.chownSync=function(t,r,e,n){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,r,e,n)},mt.prototype.utimes=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.utimes(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.utimesSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,r,e)},mt.prototype.link=function(t,r,e){var n=this;this._mu.lock(function(){n._fs.link(t,r,function(a){n._mu.unlock(),e(a)})})},mt.prototype.linkSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,r)},mt.prototype.symlink=function(t,r,e,n){var a=this;this._mu.lock(function(){a._fs.symlink(t,r,e,function(u){a._mu.unlock(),n(u)})})},mt.prototype.symlinkSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,r,e)},mt.prototype.readlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.readlink(t,function(n,a){e._mu.unlock(),r(n,a)})})},mt.prototype.readlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t)};var Be="/.deletedFiles.log";function bn(i){return 146|i}function ve(i){return b.getFileFlag(i)}var kn=function(i){function t(r,e,n,a,u){i.call(this,r,e,n,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var n=this;if(!this.isDirty()){e(null);return}this._fs._syncAsync(this,function(a){n.resetDirty(),e(a)})},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),Rn=function(i){function t(r,e){if(i.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=r,this._readable=e,this._writable.isReadOnly())throw new p(f.EINVAL,"Writable file system must be writable.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,n){var a=this;this.createParentDirectoriesAsync(e.getPath(),function(u){if(u)return n(u);a._writable.writeFile(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode,n)})},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode)},t.prototype.getName=function(){return Tr.Name},t.prototype.initialize=function(e){var n=this,a=this._initializeCallbacks,u=function(h){n._isInitialized=!h,n._initializeCallbacks=[],a.forEach(function(S){return S(h)})};if(this._isInitialized)return e();a.push(e),a.length===1&&this._writable.readFile(Be,"utf8",ve("r"),function(h,S){if(h){if(h.errno!==f.ENOENT)return u(h)}else n._deleteLog=S;n._reparseDeletionLog(),u()})},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,n,a){var u=this;if(!(!this.checkInitAsync(a)||this.checkPathAsync(e,a)||this.checkPathAsync(n,a))){if(e===Be||n===Be)return a(p.EPERM("Cannot rename deletion log."));if(e===n)return a();this.stat(e,!1,function(h,S){return h?a(h):u.stat(n,!1,function(x,O){var D=u;function V(rt){var ct=rt.shift();if(!ct)return a();var yt=w.resolve(e,ct),Ft=w.resolve(n,ct);D.rename(yt,Ft,function(Vt){if(Vt)return a(Vt);V(rt)})}var $=511;if(S.isDirectory()){if(x)return x.errno!==f.ENOENT?a(x):u._writable.exists(e,function(rt){if(rt)return u._writable.rename(e,n,a);u._writable.mkdir(n,$,function(ct){if(ct)return a(ct);u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})});if($=O.mode,!O.isDirectory())return a(p.ENOTDIR(n));u.readdir(n,function(rt,ct){if(ct&&ct.length)return a(p.ENOTEMPTY(n));u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})}if(O&&O.isDirectory())return a(p.EISDIR(n));u.readFile(e,null,ve("r"),function(rt,ct){return rt?a(rt):u.writeFile(n,ct,null,ve("w"),S.mode,function(yt){return yt?a(yt):u.unlink(e,a)})})})})}},t.prototype.renameSync=function(e,n){var a=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(n),e===Be||n===Be)throw p.EPERM("Cannot rename deletion log.");var u=this.statSync(e,!1);if(u.isDirectory()){if(e===n)return;var h=511;if(this.existsSync(n)){var S=this.statSync(n,!1);if(h=S.mode,S.isDirectory()){if(this.readdirSync(n).length>0)throw p.ENOTEMPTY(n)}else throw p.ENOTDIR(n)}this._writable.existsSync(e)?this._writable.renameSync(e,n):this._writable.existsSync(n)||this._writable.mkdirSync(n,h),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach(function(x){a.renameSync(w.resolve(e,x),w.resolve(n,x))})}else{if(this.existsSync(n)&&this.statSync(n,!1).isDirectory())throw p.EISDIR(n);this.writeFileSync(n,this.readFileSync(e,null,ve("r")),null,ve("w"),u.mode)}e!==n&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,n,a){var u=this;!this.checkInitAsync(a)||this._writable.stat(e,n,function(h,S){h&&h.errno===f.ENOENT?(u._deletedFiles[e]&&a(p.ENOENT(e)),u._readable.stat(e,n,function(x,O){O&&(O=O.clone(),O.mode=bn(O.mode)),a(x,O)})):a(h,S)})},t.prototype.statSync=function(e,n){this.checkInitialized();try{return this._writable.statSync(e,n)}catch{if(this._deletedFiles[e])throw p.ENOENT(e);var a=this._readable.statSync(e,n).clone();return a.mode=bn(a.mode),a}},t.prototype.open=function(e,n,a,u){var h=this;!this.checkInitAsync(u)||this.checkPathAsync(e,u)||this.stat(e,!1,function(S,x){if(x)switch(n.pathExistsAction()){case A.TRUNCATE_FILE:return h.createParentDirectoriesAsync(e,function(O){if(O)return u(O);h._writable.open(e,n,a,u)});case A.NOP:return h._writable.exists(e,function(O){O?h._writable.open(e,n,a,u):(x=x.clone(),x.mode=a,h._readable.readFile(e,null,ve("r"),function(D,V){if(D)return u(D);x.size===-1&&(x.size=V.length);var $=new kn(h,e,n,x,V);u(null,$)}))});default:return u(p.EEXIST(e))}else switch(n.pathNotExistsAction()){case A.CREATE_FILE:return h.createParentDirectoriesAsync(e,function(O){return O?u(O):h._writable.open(e,n,a,u)});default:return u(p.ENOENT(e))}})},t.prototype.openSync=function(e,n,a){if(this.checkInitialized(),this.checkPath(e),e===Be)throw p.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(n.pathExistsAction()){case A.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,n,a);case A.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,n,a);var u=this._readable.readFileSync(e,null,ve("r")),h=this._readable.statSync(e,!1).clone();return h.mode=a,new kn(this,e,n,h,u);default:throw p.EEXIST(e)}else switch(n.pathNotExistsAction()){case A.CREATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,n,a);default:throw p.ENOENT(e)}},t.prototype.unlink=function(e,n){var a=this;!this.checkInitAsync(n)||this.checkPathAsync(e,n)||this.exists(e,function(u){if(!u)return n(p.ENOENT(e));a._writable.exists(e,function(h){if(h)return a._writable.unlink(e,function(S){if(S)return n(S);a.exists(e,function(x){x&&a.deletePath(e),n(null)})});a.deletePath(e),n(null)})})},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e))this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e);else throw p.ENOENT(e)},t.prototype.rmdir=function(e,n){var a=this;if(!!this.checkInitAsync(n)){var u=function(){a.readdir(e,function(h,S){if(h)return n(h);if(S.length)return n(p.ENOTEMPTY(e));a.deletePath(e),n(null)})};this.exists(e,function(h){if(!h)return n(p.ENOENT(e));a._writable.exists(e,function(S){S?a._writable.rmdir(e,function(x){if(x)return n(x);a._readable.exists(e,function(O){O?u():n()})}):u()})})}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),this.existsSync(e)){if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.deletePath(e)}}else throw p.ENOENT(e)},t.prototype.mkdir=function(e,n,a){var u=this;!this.checkInitAsync(a)||this.exists(e,function(h){if(h)return a(p.EEXIST(e));u.createParentDirectoriesAsync(e,function(S){if(S)return a(S);u._writable.mkdir(e,n,a)})})},t.prototype.mkdirSync=function(e,n){if(this.checkInitialized(),this.existsSync(e))throw p.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,n)},t.prototype.readdir=function(e,n){var a=this;!this.checkInitAsync(n)||this.stat(e,!1,function(u,h){if(u)return n(u);if(!h.isDirectory())return n(p.ENOTDIR(e));a._writable.readdir(e,function(S,x){if(S&&S.code!=="ENOENT")return n(S);(S||!x)&&(x=[]),a._readable.readdir(e,function(O,D){(O||!D)&&(D=[]);var V={},$=x.concat(D.filter(function(rt){return!a._deletedFiles[e+"/"+rt]})).filter(function(rt){var ct=!V[rt];return V[rt]=!0,ct});n(null,$)})})})},t.prototype.readdirSync=function(e){var n=this;this.checkInitialized();var a=this.statSync(e,!1);if(!a.isDirectory())throw p.ENOTDIR(e);var u=[];try{u=u.concat(this._writable.readdirSync(e))}catch{}try{u=u.concat(this._readable.readdirSync(e).filter(function(S){return!n._deletedFiles[e+"/"+S]}))}catch{}var h={};return u.filter(function(S){var x=!h[S];return h[S]=!0,x})},t.prototype.exists=function(e,n){var a=this;this.checkInitialized(),this._writable.exists(e,function(u){if(u)return n(!0);a._readable.exists(e,function(h){n(h&&a._deletedFiles[e]!==!0)})})},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&this._deletedFiles[e]!==!0},t.prototype.chmod=function(e,n,a,u){var h=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);h._writable.chmod(e,n,a,u)})},t.prototype.chmodSync=function(e,n,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.chmodSync(e,n,a)})},t.prototype.chown=function(e,n,a,u,h){var S=this;!this.checkInitAsync(h)||this.operateOnWritableAsync(e,function(x){if(x)return h(x);S._writable.chown(e,n,a,u,h)})},t.prototype.chownSync=function(e,n,a,u){var h=this;this.checkInitialized(),this.operateOnWritable(e,function(){h._writable.chownSync(e,n,a,u)})},t.prototype.utimes=function(e,n,a,u){var h=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);h._writable.utimes(e,n,a,u)})},t.prototype.utimesSync=function(e,n,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.utimesSync(e,n,a)})},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+`
`)},t.prototype.updateLog=function(e){var n=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Be,this._deleteLog,"utf8",b.getFileFlag("w"),420,function(a){n._deleteLogUpdatePending=!1,a?n._deleteLogError=a:n._deleteLogUpdateNeeded&&(n._deleteLogUpdateNeeded=!1,n.updateLog(""))}))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(n){e._deletedFiles[n.slice(1)]=n.slice(0,1)==="d"})},t.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new p(f.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},t.prototype.checkInitAsync=function(e){if(this._isInitialized){if(this._deleteLogError!==null){var n=this._deleteLogError;return this._deleteLogError=null,e(n),!1}}else return e(new p(f.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},t.prototype.checkPath=function(e){if(e===Be)throw p.EPERM(e)},t.prototype.checkPathAsync=function(e,n){return e===Be?(n(p.EPERM(e)),!0):!1},t.prototype.createParentDirectoriesAsync=function(e,n){var a=w.dirname(e),u=[],h=this;this._writable.stat(a,!1,S);function S(O,D){O?(u.push(a),a=w.dirname(a),h._writable.stat(a,!1,S)):x()}function x(){if(!u.length)return n();var O=u.pop();h._readable.stat(O,!1,function(D,V){if(!V)return n();h._writable.mkdir(O,V.mode,function($){if($)return n($);x()})})}},t.prototype.createParentDirectories=function(e){for(var n=this,a=w.dirname(e),u=[];!this._writable.existsSync(a);)u.push(a),a=w.dirname(a);u=u.reverse(),u.forEach(function(h){n._writable.mkdirSync(h,n.statSync(h,!1).mode)})},t.prototype.operateOnWritable=function(e,n){if(this.existsSync(e))this._writable.existsSync(e)||this.copyToWritable(e),n();else throw p.ENOENT(e)},t.prototype.operateOnWritableAsync=function(e,n){var a=this;this.exists(e,function(u){if(!u)return n(p.ENOENT(e));a._writable.exists(e,function(h){if(h)n();else return a.copyToWritableAsync(e,n)})})},t.prototype.copyToWritable=function(e){var n=this.statSync(e,!1);n.isDirectory()?this._writable.mkdirSync(e,n.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,ve("r")),null,ve("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,n){var a=this;this.stat(e,!1,function(u,h){if(u)return n(u);if(h.isDirectory())return a._writable.mkdir(e,h.mode,n);a._readable.readFile(e,null,ve("r"),function(S,x){if(S)return n(S);a.writeFile(e,x,null,ve("w"),h.mode,n)})})},t}(it),Tr=function(i){function t(r,e,n){n===void 0&&(n=!0),i.call(this,new Rn(r,e)),kt(n,t.Name,{readable:"readable file system",writable:"writable file system"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{var a=new t(e.writable,e.readable,!1);a.initialize(function(u){n(u,a)},!1)}catch(u){n(u)}},t.isAvailable=function(){return Rn.isAvailable()},t.prototype.initialize=function(e,n){n===void 0&&(n=!0),n&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),i.prototype.initialize.call(this,e)},t.prototype.getOverlayedFileSystems=function(){return i.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return i.prototype.getFSUnlocked.call(this)},t}(mt);Tr.Name="OverlayFS",Tr.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var Ht;(function(i){i[i.CB=0]="CB",i[i.FD=1]="FD",i[i.API_ERROR=2]="API_ERROR",i[i.STATS=3]="STATS",i[i.PROBE=4]="PROBE",i[i.FILEFLAG=5]="FILEFLAG",i[i.BUFFER=6]="BUFFER",i[i.ERROR=7]="ERROR"})(Ht||(Ht={}));var wi=function(){this._callbacks={},this._nextId=0};wi.prototype.toRemoteArg=function(t){var r=this._nextId++;return this._callbacks[r]=t,{type:Ht.CB,id:r}},wi.prototype.toLocalArg=function(t){var r=this._callbacks[t];return delete this._callbacks[t],r};var Gr=function(){this._fileDescriptors={},this._nextId=0};Gr.prototype.toRemoteArg=function(t,r,e,n){var a=this._nextId++,u,h;this._fileDescriptors[a]=t,t.stat(function(S,x){S?n(S):(h=Je(x.toBuffer()),e.isReadable()?t.read(c.alloc(x.size),0,x.size,0,function(O,D,V){O?n(O):(u=Je(V),n(null,{type:Ht.FD,id:a,data:u,stat:h,path:r,flag:e.getFlagString()}))}):n(null,{type:Ht.FD,id:a,data:new ArrayBuffer(0),stat:h,path:r,flag:e.getFlagString()}))})},Gr.prototype.applyFdAPIRequest=function(t,r){var e=this,n=t.args[0];this._applyFdChanges(n,function(a,u){a?r(a):u[t.method](function(h){t.method==="close"&&delete e._fileDescriptors[n.id],r(h)})})},Gr.prototype._applyFdChanges=function(t,r){var e=this._fileDescriptors[t.id],n=Ke(t.data),a=C.fromBuffer(Ke(t.stat)),u=b.getFileFlag(t.flag);u.isWriteable()?e.write(n,0,n.length,u.isAppendable()?e.getPos():0,function(h){function S(){e.stat(function(x,O){x?r(x):O.mode!==a.mode?e.chmod(a.mode,function(D){r(D,e)}):r(x,e)})}h?r(h):u.isAppendable()?S():e.truncate(n.length,function(){S()})}):r(null,e)};function Jr(i){return{type:Ht.API_ERROR,errorData:Je(i.writeToBuffer())}}function Nn(i){return p.fromBuffer(Ke(i.errorData))}function Tn(i){return{type:Ht.ERROR,name:i.name,message:i.message,stack:i.stack}}function On(i){var t=Kt[i.name];typeof t!="function"&&(t=Error);var r=new t(i.message);return r.stack=i.stack,r}function An(i){return{type:Ht.STATS,statsData:Je(i.toBuffer())}}function Ln(i){return C.fromBuffer(Ke(i.statsData))}function Dn(i){return{type:Ht.FILEFLAG,flagStr:i.getFlagString()}}function Cn(i){return b.getFileFlag(i.flagStr)}function Je(i){return K(i)}function Ke(i){return xt(i)}function Bn(i){return{type:Ht.BUFFER,data:Je(i)}}function Mn(i){return Ke(i.data)}function Oa(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}function Aa(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}var Un=function(i){function t(r,e,n,a,u,h){i.call(this,r,e,n,a,h),this._remoteFdId=u}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:Ht.FD,id:this._remoteFdId,data:Je(this.getBuffer()),stat:Je(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,n){var a=this;this.isDirty()?this._fs.syncClose(e,this,function(u){u||a.resetDirty(),n(u)}):n()},t}(Yt),Kr=function(i){function t(r,e){var n=this;e===void 0&&(e=!0),i.call(this),this._callbackConverter=new wi,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=r,kt(e,t.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(a){var u=a.data;if(Aa(u)){var h,S=u.args,x=new Array(S.length);for(h=0;h<x.length;h++)x[h]=n._argRemote2Local(S[h]);n._callbackConverter.toLocalArg(u.cbId).apply(null,x)}})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a=new t(e.worker,!1);a.initialize(function(){n(null,a)})},t.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},t.attachRemoteListener=function(e){var n=new Gr;function a(h,S,x){switch(typeof h){case"object":h instanceof C?x(null,An(h)):h instanceof p?x(null,Jr(h)):h instanceof gt?x(null,n.toRemoteArg(h,S[0],S[1],x)):h instanceof b?x(null,Dn(h)):h instanceof c?x(null,Bn(h)):h instanceof Error?x(null,Tn(h)):x(null,h);break;default:x(null,h);break}}function u(h,S){if(!h)return h;switch(typeof h){case"object":if(typeof h.type=="number"){var x=h;switch(x.type){case Ht.CB:var O=h.id;return function(){var D=arguments,V,$=new Array(arguments.length),rt,ct=arguments.length;function yt(Ft){ct>0&&(ct=-1,rt={browserfsMessage:!0,cbId:O,args:[Jr(Ft)]},e.postMessage(rt))}for(V=0;V<arguments.length;V++)(function(Ft,Vt){a(Vt,S,function(se,Te){$[Ft]=Te,se?yt(se):--ct===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))})})(V,D[V]);arguments.length===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))};case Ht.API_ERROR:return Nn(x);case Ht.STATS:return Ln(x);case Ht.FILEFLAG:return Cn(x);case Ht.BUFFER:return Mn(x);case Ht.ERROR:return On(x);default:return h}}else return h;default:return h}}e.addEventListener("message",function(h){var S=h.data;if(Oa(S)){var x=S.args,O=new Array(x.length);switch(S.method){case"close":case"sync":(function(){var $=x[1];n.applyFdAPIRequest(S,function(rt){var ct={browserfsMessage:!0,cbId:$.id,args:rt?[Jr(rt)]:[]};e.postMessage(ct)})})();break;case"probe":(function(){var $=ft.getRootFS(),rt=x[1],ct={type:Ht.PROBE,isReadOnly:$.isReadOnly(),supportsLinks:$.supportsLinks(),supportsProps:$.supportsProps()},yt={browserfsMessage:!0,cbId:rt.id,args:[ct]};e.postMessage(yt)})();break;default:for(var D=0;D<x.length;D++)O[D]=u(x[D],O);var V=ft.getRootFS();V[S.method].apply(V,O);break}}})},t.prototype.getName=function(){return t.Name},t.prototype.initialize=function(e){var n=this;if(this._isInitialized)e();else{var a={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(Ct()),this._callbackConverter.toRemoteArg(function(u){n._isInitialized=!0,n._isReadOnly=u.isReadOnly,n._supportLinks=u.supportsLinks,n._supportProps=u.supportsProps,e()})]};this._worker.postMessage(a)}},t.prototype.isReadOnly=function(){return this._isReadOnly},t.prototype.supportsSynch=function(){return!1},t.prototype.supportsLinks=function(){return this._supportLinks},t.prototype.supportsProps=function(){return this._supportProps},t.prototype.rename=function(e,n,a){this._rpc("rename",arguments)},t.prototype.stat=function(e,n,a){this._rpc("stat",arguments)},t.prototype.open=function(e,n,a,u){this._rpc("open",arguments)},t.prototype.unlink=function(e,n){this._rpc("unlink",arguments)},t.prototype.rmdir=function(e,n){this._rpc("rmdir",arguments)},t.prototype.mkdir=function(e,n,a){this._rpc("mkdir",arguments)},t.prototype.readdir=function(e,n){this._rpc("readdir",arguments)},t.prototype.exists=function(e,n){this._rpc("exists",arguments)},t.prototype.realpath=function(e,n,a){this._rpc("realpath",arguments)},t.prototype.truncate=function(e,n,a){this._rpc("truncate",arguments)},t.prototype.readFile=function(e,n,a,u){this._rpc("readFile",arguments)},t.prototype.writeFile=function(e,n,a,u,h,S){this._rpc("writeFile",arguments)},t.prototype.appendFile=function(e,n,a,u,h,S){this._rpc("appendFile",arguments)},t.prototype.chmod=function(e,n,a,u){this._rpc("chmod",arguments)},t.prototype.chown=function(e,n,a,u,h){this._rpc("chown",arguments)},t.prototype.utimes=function(e,n,a,u){this._rpc("utimes",arguments)},t.prototype.link=function(e,n,a){this._rpc("link",arguments)},t.prototype.symlink=function(e,n,a,u){this._rpc("symlink",arguments)},t.prototype.readlink=function(e,n){this._rpc("readlink",arguments)},t.prototype.syncClose=function(e,n,a){this._worker.postMessage({browserfsMessage:!0,method:e,args:[n.toRemoteArg(),this._callbackConverter.toRemoteArg(a)]})},t.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){var n=e;switch(n.type){case Ht.API_ERROR:return Nn(n);case Ht.FD:var a=n;return new Un(this,a.path,b.getFileFlag(a.flag),C.fromBuffer(Ke(a.stat)),a.id,Ke(a.data));case Ht.STATS:return Ln(n);case Ht.FILEFLAG:return Cn(n);case Ht.BUFFER:return Mn(n);case Ht.ERROR:return On(n);default:return e}}else return e;default:return e}},t.prototype._rpc=function(e,n){for(var a=this,u=new Array(n.length),h=0;h<n.length;h++)u[h]=a._argLocal2Remote(n[h]);var S={browserfsMessage:!0,method:e,args:u};this._worker.postMessage(S)},t.prototype._argLocal2Remote=function(e){if(!e)return e;switch(typeof e){case"object":return e instanceof C?An(e):e instanceof p?Jr(e):e instanceof Un?e.toRemoteArg():e instanceof b?Dn(e):e instanceof c?Bn(e):e instanceof Error?Tn(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}},t}(it);Kr.Name="WorkerFS",Kr.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(i,t){i.postMessage?t():t(new p(f.EINVAL,"option must be a Web Worker instance."))}}};function La(i,t,r){var e=new XMLHttpRequest;e.open("GET",i,!0);var n=!0;switch(t){case"buffer":e.responseType="arraybuffer";break;case"json":try{e.responseType="json",n=e.responseType==="json"}catch{n=!1}break;default:return r(new p(f.EINVAL,"Invalid download type: "+t))}e.onreadystatechange=function(a){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":return r(null,e.response?c.from(e.response):Ct());case"json":return n?r(null,e.response):r(null,JSON.parse(e.responseText))}else return r(new p(e.status,"XHR error."))},e.send()}function Da(i,t){var r=new XMLHttpRequest;r.open("GET",i,!1);var e=null,n=null;if(r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":var u=r.responseText;e=c.alloc(u.length);for(var h=0;h<u.length;h++)e[h]=u.charCodeAt(h);return;case"json":e=JSON.parse(r.responseText);return}else{n=new p(r.status,"XHR error.");return}},r.send(),n)throw n;return e}function Ca(i,t){var r=new XMLHttpRequest;switch(r.open("GET",i,!1),t){case"buffer":r.responseType="arraybuffer";break;case"json":break;default:throw new p(f.EINVAL,"Invalid download type: "+t)}var e,n;if(r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":e=c.from(r.response);break;case"json":e=JSON.parse(r.response);break}else n=new p(r.status,"XHR error.")},r.send(),n)throw n;return e}function Pn(i,t,r){var e=new XMLHttpRequest;e.open("HEAD",t,i),e.onreadystatechange=function(n){if(e.readyState===4)if(e.status===200)try{return r(null,parseInt(e.getResponseHeader("Content-Length")||"-1",10))}catch{return r(new p(f.EIO,"XHR HEAD error: Could not read content-length."))}else return r(new p(e.status,"XHR HEAD error."))},e.send()}var zn=La,Ba=St&&typeof Blob<"u"?Ca:Da;function Ma(i){var t=-1;return Pn(!1,i,function(r,e){if(r)throw r;t=e}),t}function Ua(i,t){Pn(!0,i,t)}var _e=function(){this._index={},this.addPath("/",new pe)};_e.fromListing=function(t){var r=new _e,e=new pe;r._index["/"]=e;for(var n=[["",t,e]];n.length>0;){var a=void 0,u=n.pop(),h=u[0],S=u[1],x=u[2];for(var O in S)if(S.hasOwnProperty(O)){var D=S[O],V=h+"/"+O;D?(r._index[V]=a=new pe,n.push([V,D,a])):a=new lr(new C(L.FILE,-1,365)),x&&(x._ls[O]=a)}}return r},_e.prototype.fileIterator=function(t){var r=this;for(var e in r._index)if(r._index.hasOwnProperty(e))for(var n=r._index[e],a=n.getListing(),u=0,h=a;u<h.length;u+=1){var S=h[u],x=n.getItem(S);Me(x)&&t(x.getData())}},_e.prototype.addPath=function(t,r){if(!r)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(this._index.hasOwnProperty(t))return this._index[t]===r;var e=this._split_path(t),n=e[0],a=e[1],u=this._index[n];return u===void 0&&t!=="/"&&(u=new pe,!this.addPath(n,u))||t!=="/"&&!u.addItem(a,r)?!1:(We(r)&&(this._index[t]=r),!0)},_e.prototype.addPathFast=function(t,r){var e=t.lastIndexOf("/"),n=e===0?"/":t.substring(0,e),a=t.substring(e+1),u=this._index[n];return u===void 0&&(u=new pe,this.addPathFast(n,u)),u.addItem(a,r)?(r.isDir()&&(this._index[t]=r),!0):!1},_e.prototype.removePath=function(t){var r=this,e=this._split_path(t),n=e[0],a=e[1],u=this._index[n];if(u===void 0)return null;var h=u.remItem(a);if(h===null)return null;if(We(h)){for(var S=h.getListing(),x=0,O=S;x<O.length;x+=1){var D=O[x];r.removePath(t+"/"+D)}t!=="/"&&delete this._index[t]}return h},_e.prototype.ls=function(t){var r=this._index[t];return r===void 0?null:r.getListing()},_e.prototype.getInode=function(t){var r=this._split_path(t),e=r[0],n=r[1],a=this._index[e];return a===void 0?null:e===t?a:a.getItem(n)},_e.prototype._split_path=function(t){var r=w.dirname(t),e=t.substr(r.length+(r==="/"?0:1));return[r,e]};var lr=function(t){this.data=t};lr.prototype.isFile=function(){return!0},lr.prototype.isDir=function(){return!1},lr.prototype.getData=function(){return this.data},lr.prototype.setData=function(t){this.data=t};var pe=function(t){t===void 0&&(t=null),this.data=t,this._ls={}};pe.prototype.isFile=function(){return!1},pe.prototype.isDir=function(){return!0},pe.prototype.getData=function(){return this.data},pe.prototype.getStats=function(){return new C(L.DIRECTORY,4096,365)},pe.prototype.getListing=function(){return Object.keys(this._ls)},pe.prototype.getItem=function(t){var r=this._ls[t];return r||null},pe.prototype.addItem=function(t,r){return t in this._ls?!1:(this._ls[t]=r,!0)},pe.prototype.remItem=function(t){var r=this._ls[t];return r===void 0?null:(delete this._ls[t],r)};function Me(i){return!!i&&i.isFile()}function We(i){return!!i&&i.isDir()}function Pa(i,t,r){try{r(null,i.toString(t))}catch(e){r(e)}}var Qr=function(i){function t(r,e,n){e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),r||(r="index.json"),e.length>0&&e.charAt(e.length-1)!=="/"&&(e=e+"/"),this.prefixUrl=e;var a=null;if(typeof r=="string"){if(a=this._requestFileSync(r,"json"),!a)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else a=r;kt(n,t.Name,{index:typeof r=="string"?r:"file index as an object",baseUrl:e}),this._index=_e.fromListing(a)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?t.FromURL(e.index,n,e.baseUrl,!1):n(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},t.FromURL=function(e,n,a,u){a===void 0&&(a=e.slice(0,e.lastIndexOf("/")+1)),u===void 0&&(u=!0),u&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+e+'", baseUrl: "'+a+`" }, cb)' instead.`),zn(e,"json",function(h,S){h?n(h):n(null,new t(S,a,!1))})},t.prototype.empty=function(){this._index.fileIterator(function(e){e.fileData=null})},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,n){n(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,n){var a=this._index.getInode(e);if(Me(a)){if(a===null)throw p.ENOENT(e);var u=a.getData();u.size=n.length,u.fileData=n}else throw p.EISDIR(e)},t.prototype.stat=function(e,n,a){var u=this._index.getInode(e);if(u===null)return a(p.ENOENT(e));var h;Me(u)?(h=u.getData(),h.size<0?this._requestFileSizeAsync(e,function(S,x){if(S)return a(S);h.size=x,a(null,h.clone())}):a(null,h.clone())):We(u)?(h=u.getStats(),a(null,h)):a(p.FileError(f.EINVAL,e))},t.prototype.statSync=function(e,n){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Me(a))u=a.getData(),u.size<0&&(u.size=this._requestFileSizeSync(e));else if(We(a))u=a.getStats();else throw p.FileError(f.EINVAL,e);return u},t.prototype.open=function(e,n,a,u){if(n.isWriteable())return u(new p(f.EPERM,e));var h=this,S=this._index.getInode(e);if(S===null)return u(p.ENOENT(e));if(Me(S)){var x=S.getData();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:return u(p.EEXIST(e));case A.NOP:if(x.fileData)return u(null,new ue(h,e,n,x.clone(),x.fileData));this._requestFileAsync(e,"buffer",function(O,D){return O?u(O):(x.size=D.length,x.fileData=D,u(null,new ue(h,e,n,x.clone(),D)))});break;default:return u(new p(f.EINVAL,"Invalid FileMode object."))}}else return u(p.EISDIR(e))},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(f.EPERM,e);var u=this._index.getInode(e);if(u===null)throw p.ENOENT(e);if(Me(u)){var h=u.getData();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:if(h.fileData)return new ue(this,e,n,h.clone(),h.fileData);var S=this._requestFileSync(e,"buffer");return h.size=S.length,h.fileData=S,new ue(this,e,n,h.clone(),S);default:throw new p(f.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e)},t.prototype.readdir=function(e,n){try{n(null,this.readdirSync(e))}catch(a){n(a)}},t.prototype.readdirSync=function(e){var n=this._index.getInode(e);if(n===null)throw p.ENOENT(e);if(We(n))return n.getListing();throw p.ENOTDIR(e)},t.prototype.readFile=function(e,n,a,u){var h=u;this.open(e,a,420,function(S,x){if(S)return u(S);u=function(V,$){x.close(function(rt){return V||(V=rt),h(V,$)})};var O=x,D=O.getBuffer();n===null?u(S,Nt(D)):Pa(D,n,u)})},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return n===null?Nt(S):S.toString(n)}finally{u.closeSync()}},t.prototype.getXhrPath=function(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,n,a){zn(this.getXhrPath(e),n,a)},t.prototype._requestFileSync=function(e,n){return Ba(this.getXhrPath(e),n)},t.prototype._requestFileSizeAsync=function(e,n){Ua(this.getXhrPath(e),n)},t.prototype._requestFileSizeSync=function(e){return Ma(this.getXhrPath(e))},t}(it);Qr.Name="XmlHttpRequest",Qr.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Qe=function(){};Qe.str2byte=function(t,r){for(var e=t.length>r.length?r.length:t.length,n=0;n<e;n++){var a=t.charCodeAt(n);if(a>127){var u=Qe.extendedChars.indexOf(t.charAt(n));u>-1&&(a=u+128)}r[a]=n}return e},Qe.byte2str=function(t){for(var r=new Array(t.length),e=0;e<t.length;e++){var n=t[e];n>127?r[e]=Qe.extendedChars[n-128]:r[e]=String.fromCharCode(n)}return r.join("")},Qe.byteLength=function(t){return t.length},Qe.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var za=s(31).inflateRaw,jn={},Wn;(function(i){i[i.MSDOS=0]="MSDOS",i[i.AMIGA=1]="AMIGA",i[i.OPENVMS=2]="OPENVMS",i[i.UNIX=3]="UNIX",i[i.VM_CMS=4]="VM_CMS",i[i.ATARI_ST=5]="ATARI_ST",i[i.OS2_HPFS=6]="OS2_HPFS",i[i.MAC=7]="MAC",i[i.Z_SYSTEM=8]="Z_SYSTEM",i[i.CP_M=9]="CP_M",i[i.NTFS=10]="NTFS",i[i.MVS=11]="MVS",i[i.VSE=12]="VSE",i[i.ACORN_RISC=13]="ACORN_RISC",i[i.VFAT=14]="VFAT",i[i.ALT_MVS=15]="ALT_MVS",i[i.BEOS=16]="BEOS",i[i.TANDEM=17]="TANDEM",i[i.OS_400=18]="OS_400",i[i.OSX=19]="OSX"})(Wn||(Wn={}));var hr;(function(i){i[i.STORED=0]="STORED",i[i.SHRUNK=1]="SHRUNK",i[i.REDUCED_1=2]="REDUCED_1",i[i.REDUCED_2=3]="REDUCED_2",i[i.REDUCED_3=4]="REDUCED_3",i[i.REDUCED_4=5]="REDUCED_4",i[i.IMPLODE=6]="IMPLODE",i[i.DEFLATE=8]="DEFLATE",i[i.DEFLATE64=9]="DEFLATE64",i[i.TERSE_OLD=10]="TERSE_OLD",i[i.BZIP2=12]="BZIP2",i[i.LZMA=14]="LZMA",i[i.TERSE_NEW=18]="TERSE_NEW",i[i.LZ77=19]="LZ77",i[i.WAVPACK=97]="WAVPACK",i[i.PPMD=98]="PPMD"})(hr||(hr={}));function Hn(i,t){var r=t&31,e=(t>>5&15)-1,n=(t>>9)+1980,a=i&31,u=i>>5&63,h=i>>11;return new Date(n,e,r,h,u,a)}function $r(i,t,r,e){return e===0?"":t?i.toString("utf8",r,r+e):Qe.byte2str(i.slice(r,r+e))}var me=function(t){if(this.data=t,t.readUInt32LE(0)!==67324752)throw new p(f.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};me.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},me.prototype.flags=function(){return this.data.readUInt16LE(6)},me.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},me.prototype.lastModFileTime=function(){return Hn(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},me.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},me.prototype.crc32=function(){return this.data.readUInt32LE(14)},me.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},me.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},me.prototype.fileName=function(){return $r(this.data,this.useUTF8(),30,this.fileNameLength())},me.prototype.extraField=function(){var t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},me.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},me.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var Or=function(t,r,e){this.header=t,this.record=r,this.data=e};Or.prototype.decompress=function(){var t=this.header.compressionMethod(),r=jn[t];if(r)return r(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var e=hr[t];throw e||(e="Unknown: "+t),new p(f.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+e)},Or.prototype.getHeader=function(){return this.header},Or.prototype.getRecord=function(){return this.record},Or.prototype.getRawData=function(){return this.data};var Si=function(t){this.data=t};Si.prototype.crc32=function(){return this.data.readUInt32LE(0)},Si.prototype.compressedSize=function(){return this.data.readUInt32LE(4)},Si.prototype.uncompressedSize=function(){return this.data.readUInt32LE(8)};var Vn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==134630224)throw new p(f.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))};Vn.prototype.length=function(){return this.data.readUInt32LE(4)},Vn.prototype.extraFieldData=function(){return this.data.slice(8,8+this.length())};var qn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==84233040)throw new p(f.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))};qn.prototype.size=function(){return this.data.readUInt16LE(4)},qn.prototype.signatureData=function(){return this.data.slice(6,6+this.size())};var Ot=function(t,r){if(this.zipData=t,this.data=r,this.data.readUInt32LE(0)!==33639248)throw new p(f.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Ot.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Ot.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Ot.prototype.flag=function(){return this.data.readUInt16LE(8)},Ot.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Ot.prototype.lastModFileTime=function(){return Hn(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Ot.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Ot.prototype.crc32=function(){return this.data.readUInt32LE(16)},Ot.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Ot.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Ot.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Ot.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Ot.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Ot.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Ot.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Ot.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Ot.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Ot.prototype.produceFilename=function(){var t=$r(this.data,this.useUTF8(),46,this.fileNameLength());return t.replace(/\\/g,"/")},Ot.prototype.fileName=function(){return this._filename},Ot.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Ot.prototype.extraField=function(){var t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},Ot.prototype.fileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return $r(this.data,this.useUTF8(),t,this.fileCommentLength())},Ot.prototype.rawFileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())},Ot.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Ot.prototype.isDirectory=function(){var t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"},Ot.prototype.isFile=function(){return!this.isDirectory()},Ot.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Ot.prototype.isEncrypted=function(){return(this.flag()&1)===1},Ot.prototype.getFileData=function(){var t=this.headerRelativeOffset(),r=new me(this.zipData.slice(t));return new Or(r,this,this.zipData.slice(t+r.totalSize()))},Ot.prototype.getData=function(){return this.getFileData().decompress()},Ot.prototype.getRawData=function(){return this.getFileData().getRawData()},Ot.prototype.getStats=function(){return new C(L.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var Re=function(t){if(this.data=t,this.data.readUInt32LE(0)!==101010256)throw new p(f.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};Re.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},Re.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},Re.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},Re.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},Re.prototype.cdSize=function(){return this.data.readUInt32LE(12)},Re.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},Re.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},Re.prototype.cdZipComment=function(){return $r(this.data,!0,22,this.cdZipCommentLength())},Re.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var Zn=function(t,r,e,n){this.index=t,this.directoryEntries=r,this.eocd=e,this.data=n},$e=function(i){function t(r,e,n){e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),this.name=e,this._index=new _e,this._directoryEntries=[],this._eocd=null,kt(n,t.Name,{zipData:"zip data as a Buffer",name:e}),r instanceof Zn?(this._index=r.index,this._directoryEntries=r.directoryEntries,this._eocd=r.eocd,this.data=r.data):(this.data=r,this.populateIndex())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){try{t.computeIndex(e.zipData,function(a){var u=new t(a,e.name,!1);n(null,u)},!1)}catch(a){n(a)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,n){jn[e]=n},t.computeIndex=function(e,n,a){a===void 0&&(a=!0),a&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var u=new _e,h=t.getEOCD(e);if(h.diskNumber()!==h.cdDiskNumber())throw new p(f.EINVAL,"ZipFS does not support spanned zip files.");var S=h.cdOffset();if(S===4294967295)throw new p(f.EINVAL,"ZipFS does not support Zip64.");var x=S+h.cdSize();t.computeIndexResponsive(e,u,S,x,n,[],h)},t.getEOCD=function(e){for(var n=22,a=Math.min(n+65535,e.length-1),u=n;u<a;u++)if(e.readUInt32LE(e.length-u)===101010256)return new Re(e.slice(e.length-u));throw new p(f.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,n){var a=e.fileName();if(a.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");a.charAt(a.length-1)==="/"&&(a=a.substr(0,a.length-1)),e.isDirectory()?n.addPathFast("/"+a,new pe(e)):n.addPathFast("/"+a,new lr(e))},t.computeIndexResponsive=function(e,n,a,u,h,S,x){if(a<u){for(var O=0;O++<200&&a<u;){var D=new Ot(e,e.slice(a));t.addToIndex(D,n),a+=D.totalSize(),S.push(D)}mi(function(){t.computeIndexResponsive(e,n,a,u,h,S,x)})}else h(new Zn(n,S,x,e))},t.prototype.getName=function(){return t.Name+(this.name!==""?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var n=this._index.getInode(e);if(n===null)throw p.ENOENT(e);if(Me(n))return n.getData();if(We(n))return n.getData();throw p.EPERM("Invalid inode: "+n)},t.prototype.getCentralDirectoryEntryAt=function(e){var n=this._directoryEntries[e];if(!n)throw new RangeError("Invalid directory index: "+e+".");return n},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,n){n(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,n){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Me(a))u=a.getData().getStats();else if(We(a))u=a.getStats();else throw new p(f.EINVAL,"Invalid inode.");return u},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(f.EPERM,e);var u=this._index.getInode(e);if(u)if(Me(u)){var h=u.getData(),S=h.getStats();switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,n,S,h.getData());default:throw new p(f.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e);else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var n=this._index.getInode(e);if(n){if(We(n))return n.getListing();throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return n===null?Nt(S):S.toString(n)}finally{u.closeSync()}},t.prototype.populateIndex=function(){var e=this,n=this._eocd=t.getEOCD(this.data);if(n.diskNumber()!==n.cdDiskNumber())throw new p(f.EINVAL,"ZipFS does not support spanned zip files.");var a=n.cdOffset();if(a===4294967295)throw new p(f.EINVAL,"ZipFS does not support Zip64.");for(var u=a+n.cdSize();a<u;){var h=new Ot(e.data,e.data.slice(a));a+=h.totalSize(),t.addToIndex(h,e._index),e._directoryEntries.push(h)}},t}(_t);$e.Name="ZipFS",$e.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:te},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},$e.CompressionMethod=hr,$e.RegisterDecompressionMethod(hr.DEFLATE,function(i,t,r){return It(za(i.slice(0,t),{chunkSize:r}))}),$e.RegisterDecompressionMethod(hr.STORED,function(i,t,r){return Nt(i,0,r)});var ja="IEEE_P1282";function de(i,t,r){return i.toString("ascii",t,t+r).trim()}function Ei(i,t,r){if(r===1)return String.fromCharCode(i[t]);for(var e=Math.floor(r/2),n=new Array(e),a=0;a<e;a++){var u=t+(a<<1);n[a]=String.fromCharCode(i[u+1]|i[u]<<8)}return n.join("")}function Ne(i,t){var r=parseInt(de(i,t,4),10),e=parseInt(de(i,t+4,2),10),n=parseInt(de(i,t+6,2),10),a=parseInt(de(i,t+8,2),10),u=parseInt(de(i,t+10,2),10),h=parseInt(de(i,t+12,2),10),S=parseInt(de(i,t+14,2),10);return new Date(r,e,n,a,u,h,S*100)}function tr(i,t){var r=i[t],e=i[t+1],n=i[t+2],a=i[t+3],u=i[t+4],h=i[t+5];return new Date(r,e-1,n,a,u,h)}function Wa(i,t){var r=i.slice(t),e=new Qt(r);switch(e.signatureWord()){case 17221:return new Kn(r);case 20548:return new qa(r);case 21328:return new Qn(r);case 21332:return new $n(r);case 17746:return new to(r);case 17747:return new Za(r);case 20568:return new ro(r);case 20558:return new Xa(r);case 21324:return new _i(r);case 20045:return new io(r);case 17228:return new xi(r);case 20556:return new Ya(r);case 21061:return new no(r);case 21574:return new oo(r);case 21318:return new Ga(r);case 21074:return new eo(r);default:return e}}function Xn(i,t,r,e){r=r-4;for(var n=new Array;t<r;){var a=Wa(i,t),u=a.length();if(u===0)return n;if(t+=u,a instanceof $n)break;a instanceof Kn?n=n.concat(a.getEntries(e)):n.push(a)}return n}var pr=function(t){this._data=t};pr.prototype.type=function(){return this._data[0]},pr.prototype.standardIdentifier=function(){return de(this._data,1,5)},pr.prototype.version=function(){return this._data[6]},pr.prototype.data=function(){return this._data.slice(7,2048)};var Yn=function(i){function t(r){i.call(this,r),this._root=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return Ne(this._data,813)},t.prototype.volumeModificationDate=function(){return Ne(this._data,830)},t.prototype.volumeExpirationDate=function(){return Ne(this._data,847)},t.prototype.volumeEffectiveDate=function(){return Ne(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,883+512)},t.prototype.reserved=function(){return this._data.slice(1395,1395+653)},t.prototype._getString32=function(e){return this._getString(e,32)},t}(pr),Ha=function(i){function t(r){if(i.call(this,r),this.type()!==1)throw new p(f.EIO,"Invalid primary volume descriptor.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new Gn(e,-1)},t.prototype._getString=function(e,n){return this._getString(e,n)},t}(Yn),Va=function(i){function t(r){if(i.call(this,r),this.type()!==2)throw new p(f.EIO,"Invalid supplementary volume descriptor.");var e=this.escapeSequence(),n=e[2];if(e[0]!==37||e[1]!==47||n!==64&&n!==67&&n!==69)throw new p(f.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+e.toString())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new Jn(e,-1)},t.prototype._getString=function(e,n){return Ei(this._data,e,n)},t}(Yn),zt=function(t,r){this._suEntries=null,this._fileOrDir=null,this._data=t,this._rockRidgeOffset=r};zt.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},zt.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},zt.prototype.rootCheckForRockRidge=function(t){var r=this.getDirectory(t);this._rockRidgeOffset=r.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},zt.prototype.length=function(){return this._data[0]},zt.prototype.extendedAttributeRecordLength=function(){return this._data[1]},zt.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},zt.prototype.dataLength=function(){return this._data.readUInt32LE(10)},zt.prototype.recordingDate=function(){return tr(this._data,18)},zt.prototype.fileFlags=function(){return this._data[25]},zt.prototype.fileUnitSize=function(){return this._data[26]},zt.prototype.interleaveGapSize=function(){return this._data[27]},zt.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},zt.prototype.identifier=function(){return this._getString(33,this._data[32])},zt.prototype.fileName=function(t){if(this.hasRockRidge()){var r=this._rockRidgeFilename(t);if(r!==null)return r}var e=this.identifier();if(this.isDirectory(t))return e;var n=e.indexOf(";");return n===-1?e:e[n-1]==="."?e.slice(0,n-1):e.slice(0,n)},zt.prototype.isDirectory=function(t){var r=!!(this.fileFlags()&2);return!r&&this.hasRockRidge()&&(r=this.getSUEntries(t).filter(function(e){return e instanceof xi}).length>0),r},zt.prototype.isSymlink=function(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(function(r){return r instanceof _i}).length>0},zt.prototype.getSymlinkPath=function(t){for(var r="",e=this.getSUEntries(t),n=this._getGetString(),a=0,u=e;a<u.length;a+=1){var h=u[a];if(h instanceof _i){for(var S=h.componentRecords(),x=0,O=S;x<O.length;x+=1){var D=O[x],V=D.flags();V&2?r+="./":V&4?r+="../":V&8?r+="/":(r+=D.content(n),V&1||(r+="/"))}if(!h.continueFlag())break}}return r.length>1&&r[r.length-1]==="/"?r.slice(0,r.length-1):r},zt.prototype.getFile=function(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},zt.prototype.getDirectory=function(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir},zt.prototype.getSUEntries=function(t){return this._suEntries||this._constructSUEntries(t),this._suEntries},zt.prototype._rockRidgeFilename=function(t){var r=this.getSUEntries(t).filter(function(S){return S instanceof io});if(r.length===0||r[0].flags()&6)return null;for(var e="",n=this._getGetString(),a=0,u=r;a<u.length;a+=1){var h=u[a];if(e+=h.name(n),!(h.flags()&1))break}return e},zt.prototype._constructSUEntries=function(t){var r=33+this._data[32];r%2===1&&r++,r+=this._rockRidgeOffset,this._suEntries=Xn(this._data,r,this.length(),t)},zt.prototype._getRockRidgeOffset=function(t){this._rockRidgeOffset=0;var r=this.getSUEntries(t);if(r.length>0){var e=r[0];if(e instanceof Qn&&e.checkBytesPass())for(var n=1;n<r.length;n++){var a=r[n];if(a instanceof eo||a instanceof to&&a.extensionIdentifier()===ja)return e.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var Gn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,n){return de(this._data,e,n)},t.prototype._constructDirectory=function(e){return new Ja(this,e)},t.prototype._getGetString=function(){return de},t}(zt),Jn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,n){return Ei(this._data,e,n)},t.prototype._constructDirectory=function(e){return new Ka(this,e)},t.prototype._getGetString=function(){return Ei},t}(zt),Qt=function(t){this._data=t};Qt.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qt.prototype.signatureWordString=function(){return de(this._data,0,2)},Qt.prototype.length=function(){return this._data[2]},Qt.prototype.suVersion=function(){return this._data[3]};var Kn=function(i){function t(r){i.call(this,r),this._entries=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var n=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=Xn(e,n,this.continuationLength(),e)}return this._entries},t}(Qt),qa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),Qn=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},t.prototype.bytesSkipped=function(){return this._data[6]},t}(Qt),$n=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),to=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return de(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return de(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return de(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t}(Qt),Za=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t}(Qt),eo=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),ro=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t}(Qt),Xa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t}(Qt),_i=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return this.flags()&1},t.prototype.componentRecords=function(){for(var e=this,n=new Array,a=5;a<this.length();){var u=new Ar(e._data.slice(a));n.push(u),a+=u.length()}return n},t}(Qt),Ar=function(t){this._data=t};Ar.prototype.flags=function(){return this._data[0]},Ar.prototype.length=function(){return 2+this.componentLength()},Ar.prototype.componentLength=function(){return this._data[1]},Ar.prototype.content=function(t){return t(this._data,2,this.componentLength())};var io=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t}(Qt),xi=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),Ya=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),no=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),oo=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return this.flags()&1?this._longFormDates()?Ne(this._data,5):tr(this._data,5):null},t.prototype.modify=function(){if(this.flags()&2){var e=this.flags()&1?1:0;return this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.access=function(){if(this.flags()&4){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.backup=function(){if(this.flags()&16){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.expiration=function(){if(this.flags()&32){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.effective=function(){if(this.flags()&64){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,e+=this.flags()&32?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype._longFormDates=function(){return!!this.flags()},t}(Qt),Ga=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t}(Qt),Lr=function(t,r){var e=this;this._fileList=[],this._fileMap={},this._record=t;var n=t.lba(),a=n+t.dataLength();if(!(t.fileFlags()&2)){var u=t.getSUEntries(r).filter(function(O){return O instanceof xi})[0];n=u.childDirectoryLba()*2048,a=1/0}for(;n<a;){var h=r[n];if(h===0){n++;continue}var S=e._constructDirectoryRecord(r.slice(n)),x=S.fileName(r);x!=="\0"&&x!==""?(!S.hasRockRidge()||S.getSUEntries(r).filter(function(O){return O instanceof no}).length===0)&&(e._fileMap[x]=S,e._fileList.push(x)):a===1/0&&(a=n+S.dataLength()),n+=S.length()}};Lr.prototype.getRecord=function(t){return this._fileMap[t]},Lr.prototype.getFileList=function(){return this._fileList},Lr.prototype.getDotEntry=function(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))};var Ja=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Gn(e,this._record.getRockRidgeOffset())},t}(Lr),Ka=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Jn(e,this._record.getRockRidgeOffset())},t}(Lr),ti=function(i){function t(r,e,n){var a=this;e===void 0&&(e=""),n===void 0&&(n=!0),i.call(this),this._data=r,kt(n,t.Name,{data:"ISO data as a Buffer",name:e});for(var u=!1,h=16*2048,S=new Array;!u;){var x=r.slice(h),O=new pr(x);switch(O.type()){case 1:S.push(new Ha(x));break;case 2:S.push(new Va(x));break;case 255:u=!0;break}h+=2048}if(S.length===0)throw new p(f.EIO,"Unable to find a suitable volume descriptor.");S.forEach(function(D){(!a._pvd||a._pvd.type()!==2)&&(a._pvd=D)}),this._root=this._pvd.rootDirectoryEntry(r),this._name=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,n){var a,u;try{a=new t(e.data,e.name,!1)}catch(h){h=h}finally{n(u,a)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,n){n(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,n){var a=this._getDirectoryRecord(e);if(a===null)throw p.ENOENT(e);return this._getStats(e,a)},t.prototype.openSync=function(e,n,a){if(n.isWriteable())throw new p(f.EPERM,e);var u=this._getDirectoryRecord(e);if(u){if(u.isSymlink(this._data))return this.openSync(w.resolve(e,u.getSymlinkPath(this._data)),n,a);if(u.isDirectory(this._data))throw p.EISDIR(e);var h=u.getFile(this._data),S=this._getStats(e,u);switch(n.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,n,S,h);default:throw new p(f.EINVAL,"Invalid FileMode object.")}}else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var n=this._getDirectoryRecord(e);if(n){if(n.isDirectory(this._data))return n.getDirectory(this._data).getFileList().slice(0);throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,n,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return n===null?Nt(S):S.toString(n)}finally{u.closeSync()}},t.prototype._getDirectoryRecord=function(e){var n=this;if(e==="/")return this._root;for(var a=e.split("/").slice(1),u=this._root,h=0,S=a;h<S.length;h+=1){var x=S[h];if(u.isDirectory(n._data)){if(u=u.getDirectory(n._data).getRecord(x),!u)return null}else return null}return u},t.prototype._getStats=function(e,n){if(n.isSymlink(this._data)){var a=w.resolve(e,n.getSymlinkPath(this._data)),u=this._getDirectoryRecord(a);return u?this._getStats(a,u):null}else{var h=n.dataLength(),S=365,x=n.recordingDate(),O=x,D=x,V=x;if(n.hasRockRidge())for(var $=n.getSUEntries(this._data),rt=0,ct=$;rt<ct.length;rt+=1){var yt=ct[rt];if(yt instanceof ro)S=yt.mode();else if(yt instanceof oo){var Ft=yt.flags();Ft&4&&(O=yt.access()),Ft&2&&(D=yt.modify()),Ft&1&&(V=yt.creation())}}return S=S&365,new C(n.isDirectory(this._data)?L.DIRECTORY:L.FILE,h,S,O,D,V)}},t}(_t);ti.Name="IsoFS",ti.Options={data:{type:"object",description:"The ISO file in a buffer",validator:te}},[I,Wr,Hr,ar,qr,ur,Fr,ti,br,cr,Tr,Kr,Qr,$e].forEach(function(i){var t=i.Create;i.Create=function(r,e){var n=typeof r=="function",a=n?r:e,u=n?{}:r;function h(S){S?a(S):t.call(i,u,a)}R(i,u,h)}});var ei={AsyncMirror:I,Dropbox:Wr,Emscripten:Hr,FolderAdapter:ar,HTML5FS:qr,InMemory:ur,IndexedDB:Fr,IsoFS:ti,LocalStorage:br,MountableFileSystem:cr,OverlayFS:Tr,WorkerFS:Kr,XmlHttpRequest:Qr,ZipFS:$e};g.initializeTTYs&&g.initializeTTYs();function Qa(i){i.Buffer=c,i.process=g;var t=i.require?i.require:null;i.require=function(r){var e=so(r);return e||t.apply(null,Array.prototype.slice.call(arguments,0))}}function $a(i,t){ei[i]=t}function so(i){switch(i){case"fs":return ft;case"path":return w;case"buffer":return E;case"process":return g;case"bfs_utils":return N;default:return ei[i]}}function ao(i){return ft.initialize(i)}function tu(i,t){Fi(i,function(r,e){e?(ao(e),t()):t(r)})}function Fi(i,t){var r=i.fs;if(!r)return t(new p(f.EPERM,'Missing "fs" property on configuration object.'));var e=i.options,n=0,a=!1;function u(){if(!a){a=!0;var x=ei[r];x?x.Create(e,t):t(new p(f.EPERM,"File system "+r+" is not available in BrowserFS."))}}if(e!==null&&typeof e=="object"){var h=!1,S=Object.keys(e).filter(function(x){return x!=="fs"});S.forEach(function(x){var O=e[x];O!==null&&typeof O=="object"&&O.fs&&(n++,Fi(O,function(D,V){if(n--,D){if(a)return;a=!0,t(D)}else e[x]=V,n===0&&h&&u()}))}),h=!0}n===0&&u()}"ab".substr(-1)!=="b"&&(String.prototype.substr=function(i){return function(t,r){return t<0&&(t=this.length+t),i.call(this,t,r)}}(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(i,t){i===void 0&&(i=0),t===void 0&&(t=this.length);var r=this;return i<0&&(i=this.length+i,i<0&&(i=0)),t<0&&(t=this.length+t,t<0&&(t=0)),t<i&&(t=i),new Uint8Array(r.buffer,r.byteOffset+i,t-i)})),o.install=Qa,o.registerFileSystem=$a,o.BFSRequire=so,o.initialize=ao,o.configure=tu,o.getFileSystem=Fi,o.EmscriptenFS=ht,o.FileSystem=ei,o.Errors=T,o.setImmediate=mi}).call(o,s(1),function(){return this}(),s(5)(l),s(6))},function(l,o,s){l.exports=s(2).Buffer},function(l,o,s){(function(f){"use strict";var d=s(3),y=s(4);o.Buffer=f,o.SlowBuffer=M,o.INSPECT_MAX_BYTES=50;var g=2147483647;o.kMaxLength=g,f.TYPED_ARRAY_SUPPORT=E(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function E(){try{var I=new Uint8Array(1);return I.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},I.foo()===42}catch{return!1}}function w(I){if(I>g)throw new RangeError("Invalid typed array length");var v=new Uint8Array(I);return v.__proto__=f.prototype,v}function f(I,v,m){if(typeof I=="number"){if(typeof v=="string")throw new Error("If encoding is specified then the first argument must be a string");return A(I)}return _(I,v,m)}typeof Symbol<"u"&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192;function _(I,v,m){if(typeof I=="number")throw new TypeError('"value" argument must not be a number');return Yt(I)?C(I,v,m):typeof I=="string"?b(I,v):G(I)}f.from=function(I,v,m){return _(I,v,m)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array;function p(I){if(typeof I!="number")throw new TypeError('"size" argument must be a number');if(I<0)throw new RangeError('"size" argument must not be negative')}function T(I,v,m){return p(I),I<=0?w(I):v!==void 0?typeof m=="string"?w(I).fill(v,m):w(I).fill(v):w(I)}f.alloc=function(I,v,m){return T(I,v,m)};function A(I){return p(I),w(I<0?0:W(I)|0)}f.allocUnsafe=function(I){return A(I)},f.allocUnsafeSlow=function(I){return A(I)};function b(I,v){if((typeof v!="string"||v==="")&&(v="utf8"),!f.isEncoding(v))throw new TypeError('"encoding" must be a valid string encoding');var m=Et(I,v)|0,k=w(m),B=k.write(I,v);return B!==m&&(k=k.slice(0,B)),k}function L(I){for(var v=I.length<0?0:W(I.length)|0,m=w(v),k=0;k<v;k+=1)m[k]=I[k]&255;return m}function C(I,v,m){if(v<0||I.byteLength<v)throw new RangeError("'offset' is out of bounds");if(I.byteLength<v+(m||0))throw new RangeError("'length' is out of bounds");var k;return v===void 0&&m===void 0?k=new Uint8Array(I):m===void 0?k=new Uint8Array(I,v):k=new Uint8Array(I,v,m),k.__proto__=f.prototype,k}function G(I){if(f.isBuffer(I)){var v=W(I.length)|0,m=w(v);return m.length===0||I.copy(m,0,0,v),m}if(I){if(ue(I)||"length"in I)return typeof I.length!="number"||Fe(I.length)?w(0):L(I);if(I.type==="Buffer"&&Array.isArray(I.data))return L(I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function W(I){if(I>=g)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g.toString(16)+" bytes");return I|0}function M(I){return+I!=I&&(I=0),f.alloc(+I)}f.isBuffer=function(v){return v!=null&&v._isBuffer===!0},f.compare=function(v,m){if(!f.isBuffer(v)||!f.isBuffer(m))throw new TypeError("Arguments must be Buffers");if(v===m)return 0;for(var k=v.length,B=m.length,q=0,J=Math.min(k,B);q<J;++q)if(v[q]!==m[q]){k=v[q],B=m[q];break}return k<B?-1:B<k?1:0},f.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(v,m){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return f.alloc(0);var k;if(m===void 0)for(m=0,k=0;k<v.length;++k)m+=v[k].length;var B=f.allocUnsafe(m),q=0;for(k=0;k<v.length;++k){var J=v[k];if(!f.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(B,q),q+=J.length}return B};function Et(I,v){if(f.isBuffer(I))return I.length;if(ue(I)||Yt(I))return I.byteLength;typeof I!="string"&&(I=""+I);var m=I.length;if(m===0)return 0;for(var k=!1;;)switch(v){case"ascii":case"latin1":case"binary":return m;case"utf8":case"utf-8":case void 0:return Q(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m*2;case"hex":return m>>>1;case"base64":return _t(I).length;default:if(k)return Q(I).length;v=(""+v).toLowerCase(),k=!0}}f.byteLength=Et;function et(I,v,m){var k=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((m===void 0||m>this.length)&&(m=this.length),m<=0)||(m>>>=0,v>>>=0,m<=v))return"";for(I||(I="utf8");;)switch(I){case"hex":return It(this,v,m);case"utf8":case"utf-8":return Xt(this,v,m);case"ascii":return K(this,v,m);case"latin1":case"binary":return ut(this,v,m);case"base64":return St(this,v,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,v,m);default:if(k)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),k=!0}}f.prototype._isBuffer=!0;function wt(I,v,m){var k=I[v];I[v]=I[m],I[m]=k}f.prototype.swap16=function(){var v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<v;m+=2)wt(this,m,m+1);return this},f.prototype.swap32=function(){var v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<v;m+=4)wt(this,m,m+3),wt(this,m+1,m+2);return this},f.prototype.swap64=function(){var v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<v;m+=8)wt(this,m,m+7),wt(this,m+1,m+6),wt(this,m+2,m+5),wt(this,m+3,m+4);return this},f.prototype.toString=function(){var v=this.length;return v===0?"":arguments.length===0?Xt(this,0,v):et.apply(this,arguments)},f.prototype.equals=function(v){if(!f.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:f.compare(this,v)===0},f.prototype.inspect=function(){var v="",m=o.INSPECT_MAX_BYTES;return this.length>0&&(v=this.toString("hex",0,m).match(/.{2}/g).join(" "),this.length>m&&(v+=" ... ")),"<Buffer "+v+">"},f.prototype.compare=function(v,m,k,B,q){if(!f.isBuffer(v))throw new TypeError("Argument must be a Buffer");if(m===void 0&&(m=0),k===void 0&&(k=v?v.length:0),B===void 0&&(B=0),q===void 0&&(q=this.length),m<0||k>v.length||B<0||q>this.length)throw new RangeError("out of range index");if(B>=q&&m>=k)return 0;if(B>=q)return-1;if(m>=k)return 1;if(m>>>=0,k>>>=0,B>>>=0,q>>>=0,this===v)return 0;for(var J=q-B,bt=k-m,At=Math.min(J,bt),Bt=this.slice(B,q),Gt=v.slice(m,k),Dt=0;Dt<At;++Dt)if(Bt[Dt]!==Gt[Dt]){J=Bt[Dt],bt=Gt[Dt];break}return J<bt?-1:bt<J?1:0};function pt(I,v,m,k,B){if(I.length===0)return-1;if(typeof m=="string"?(k=m,m=0):m>2147483647?m=2147483647:m<-2147483648&&(m=-2147483648),m=+m,Fe(m)&&(m=B?0:I.length-1),m<0&&(m=I.length+m),m>=I.length){if(B)return-1;m=I.length-1}else if(m<0)if(B)m=0;else return-1;if(typeof v=="string"&&(v=f.from(v,k)),f.isBuffer(v))return v.length===0?-1:U(I,v,m,k,B);if(typeof v=="number")return v=v&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(I,v,m):Uint8Array.prototype.lastIndexOf.call(I,v,m):U(I,[v],m,k,B);throw new TypeError("val must be string, number or Buffer")}function U(I,v,m,k,B){var q=1,J=I.length,bt=v.length;if(k!==void 0&&(k=String(k).toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(I.length<2||v.length<2)return-1;q=2,J/=2,bt/=2,m/=2}function At(nr,Ve){return q===1?nr[Ve]:nr.readUInt16BE(Ve*q)}var Bt;if(B){var Gt=-1;for(Bt=m;Bt<J;Bt++)if(At(I,Bt)===At(v,Gt===-1?0:Bt-Gt)){if(Gt===-1&&(Gt=Bt),Bt-Gt+1===bt)return Gt*q}else Gt!==-1&&(Bt-=Bt-Gt),Gt=-1}else for(m+bt>J&&(m=J-bt),Bt=m;Bt>=0;Bt--){for(var Dt=!0,Ie=0;Ie<bt;Ie++)if(At(I,Bt+Ie)!==At(v,Ie)){Dt=!1;break}if(Dt)return Bt}return-1}f.prototype.includes=function(v,m,k){return this.indexOf(v,m,k)!==-1},f.prototype.indexOf=function(v,m,k){return pt(this,v,m,k,!0)},f.prototype.lastIndexOf=function(v,m,k){return pt(this,v,m,k,!1)};function tt(I,v,m,k){m=Number(m)||0;var B=I.length-m;k?(k=Number(k),k>B&&(k=B)):k=B;var q=v.length;if(q%2!==0)throw new TypeError("Invalid hex string");k>q/2&&(k=q/2);for(var J=0;J<k;++J){var bt=parseInt(v.substr(J*2,2),16);if(Fe(bt))return J;I[m+J]=bt}return J}function ft(I,v,m,k){return gt(Q(v,I.length-m),I,m,k)}function Rt(I,v,m,k){return gt(ht(v),I,m,k)}function dt(I,v,m,k){return Rt(I,v,m,k)}function Lt(I,v,m,k){return gt(_t(v),I,m,k)}function kt(I,v,m,k){return gt(it(v,I.length-m),I,m,k)}f.prototype.write=function(v,m,k,B){if(m===void 0)B="utf8",k=this.length,m=0;else if(k===void 0&&typeof m=="string")B=m,k=this.length,m=0;else if(isFinite(m))m=m>>>0,isFinite(k)?(k=k>>>0,B===void 0&&(B="utf8")):(B=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var q=this.length-m;if((k===void 0||k>q)&&(k=q),v.length>0&&(k<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");for(var J=!1;;)switch(B){case"hex":return tt(this,v,m,k);case"utf8":case"utf-8":return ft(this,v,m,k);case"ascii":return Rt(this,v,m,k);case"latin1":case"binary":return dt(this,v,m,k);case"base64":return Lt(this,v,m,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return kt(this,v,m,k);default:if(J)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),J=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function St(I,v,m){return v===0&&m===I.length?d.fromByteArray(I):d.fromByteArray(I.slice(v,m))}function Xt(I,v,m){m=Math.min(I.length,m);for(var k=[],B=v;B<m;){var q=I[B],J=null,bt=q>239?4:q>223?3:q>191?2:1;if(B+bt<=m){var At,Bt,Gt,Dt;switch(bt){case 1:q<128&&(J=q);break;case 2:At=I[B+1],(At&192)===128&&(Dt=(q&31)<<6|At&63,Dt>127&&(J=Dt));break;case 3:At=I[B+1],Bt=I[B+2],(At&192)===128&&(Bt&192)===128&&(Dt=(q&15)<<12|(At&63)<<6|Bt&63,Dt>2047&&(Dt<55296||Dt>57343)&&(J=Dt));break;case 4:At=I[B+1],Bt=I[B+2],Gt=I[B+3],(At&192)===128&&(Bt&192)===128&&(Gt&192)===128&&(Dt=(q&15)<<18|(At&63)<<12|(Bt&63)<<6|Gt&63,Dt>65535&&Dt<1114112&&(J=Dt))}}J===null?(J=65533,bt=1):J>65535&&(J-=65536,k.push(J>>>10&1023|55296),J=56320|J&1023),k.push(J),B+=bt}return z(k)}var P=4096;function z(I){var v=I.length;if(v<=P)return String.fromCharCode.apply(String,I);for(var m="",k=0;k<v;)m+=String.fromCharCode.apply(String,I.slice(k,k+=P));return m}function K(I,v,m){var k="";m=Math.min(I.length,m);for(var B=v;B<m;++B)k+=String.fromCharCode(I[B]&127);return k}function ut(I,v,m){var k="";m=Math.min(I.length,m);for(var B=v;B<m;++B)k+=String.fromCharCode(I[B]);return k}function It(I,v,m){var k=I.length;(!v||v<0)&&(v=0),(!m||m<0||m>k)&&(m=k);for(var B="",q=v;q<m;++q)B+=Y(I[q]);return B}function vt(I,v,m){for(var k=I.slice(v,m),B="",q=0;q<k.length;q+=2)B+=String.fromCharCode(k[q]+k[q+1]*256);return B}f.prototype.slice=function(v,m){var k=this.length;v=~~v,m=m===void 0?k:~~m,v<0?(v+=k,v<0&&(v=0)):v>k&&(v=k),m<0?(m+=k,m<0&&(m=0)):m>k&&(m=k),m<v&&(m=v);var B=this.subarray(v,m);return B.__proto__=f.prototype,B};function xt(I,v,m){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+v>m)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUIntLE=function(v,m,k){v=v>>>0,m=m>>>0,k||xt(v,m,this.length);for(var B=this[v],q=1,J=0;++J<m&&(q*=256);)B+=this[v+J]*q;return B},f.prototype.readUIntBE=function(v,m,k){v=v>>>0,m=m>>>0,k||xt(v,m,this.length);for(var B=this[v+--m],q=1;m>0&&(q*=256);)B+=this[v+--m]*q;return B},f.prototype.readUInt8=function(v,m){return v=v>>>0,m||xt(v,1,this.length),this[v]},f.prototype.readUInt16LE=function(v,m){return v=v>>>0,m||xt(v,2,this.length),this[v]|this[v+1]<<8},f.prototype.readUInt16BE=function(v,m){return v=v>>>0,m||xt(v,2,this.length),this[v]<<8|this[v+1]},f.prototype.readUInt32LE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},f.prototype.readUInt32BE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},f.prototype.readIntLE=function(v,m,k){v=v>>>0,m=m>>>0,k||xt(v,m,this.length);for(var B=this[v],q=1,J=0;++J<m&&(q*=256);)B+=this[v+J]*q;return q*=128,B>=q&&(B-=Math.pow(2,8*m)),B},f.prototype.readIntBE=function(v,m,k){v=v>>>0,m=m>>>0,k||xt(v,m,this.length);for(var B=m,q=1,J=this[v+--B];B>0&&(q*=256);)J+=this[v+--B]*q;return q*=128,J>=q&&(J-=Math.pow(2,8*m)),J},f.prototype.readInt8=function(v,m){return v=v>>>0,m||xt(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},f.prototype.readInt16LE=function(v,m){v=v>>>0,m||xt(v,2,this.length);var k=this[v]|this[v+1]<<8;return k&32768?k|4294901760:k},f.prototype.readInt16BE=function(v,m){v=v>>>0,m||xt(v,2,this.length);var k=this[v+1]|this[v]<<8;return k&32768?k|4294901760:k},f.prototype.readInt32LE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},f.prototype.readInt32BE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},f.prototype.readFloatLE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),y.read(this,v,!0,23,4)},f.prototype.readFloatBE=function(v,m){return v=v>>>0,m||xt(v,4,this.length),y.read(this,v,!1,23,4)},f.prototype.readDoubleLE=function(v,m){return v=v>>>0,m||xt(v,8,this.length),y.read(this,v,!0,52,8)},f.prototype.readDoubleBE=function(v,m){return v=v>>>0,m||xt(v,8,this.length),y.read(this,v,!1,52,8)};function Nt(I,v,m,k,B,q){if(!f.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>B||v<q)throw new RangeError('"value" argument is out of bounds');if(m+k>I.length)throw new RangeError("Index out of range")}f.prototype.writeUIntLE=function(v,m,k,B){if(v=+v,m=m>>>0,k=k>>>0,!B){var q=Math.pow(2,8*k)-1;Nt(this,v,m,k,q,0)}var J=1,bt=0;for(this[m]=v&255;++bt<k&&(J*=256);)this[m+bt]=v/J&255;return m+k},f.prototype.writeUIntBE=function(v,m,k,B){if(v=+v,m=m>>>0,k=k>>>0,!B){var q=Math.pow(2,8*k)-1;Nt(this,v,m,k,q,0)}var J=k-1,bt=1;for(this[m+J]=v&255;--J>=0&&(bt*=256);)this[m+J]=v/bt&255;return m+k},f.prototype.writeUInt8=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,1,255,0),this[m]=v&255,m+1},f.prototype.writeUInt16LE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,2,65535,0),this[m]=v&255,this[m+1]=v>>>8,m+2},f.prototype.writeUInt16BE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,2,65535,0),this[m]=v>>>8,this[m+1]=v&255,m+2},f.prototype.writeUInt32LE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,4,4294967295,0),this[m+3]=v>>>24,this[m+2]=v>>>16,this[m+1]=v>>>8,this[m]=v&255,m+4},f.prototype.writeUInt32BE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,4,4294967295,0),this[m]=v>>>24,this[m+1]=v>>>16,this[m+2]=v>>>8,this[m+3]=v&255,m+4},f.prototype.writeIntLE=function(v,m,k,B){if(v=+v,m=m>>>0,!B){var q=Math.pow(2,8*k-1);Nt(this,v,m,k,q-1,-q)}var J=0,bt=1,At=0;for(this[m]=v&255;++J<k&&(bt*=256);)v<0&&At===0&&this[m+J-1]!==0&&(At=1),this[m+J]=(v/bt>>0)-At&255;return m+k},f.prototype.writeIntBE=function(v,m,k,B){if(v=+v,m=m>>>0,!B){var q=Math.pow(2,8*k-1);Nt(this,v,m,k,q-1,-q)}var J=k-1,bt=1,At=0;for(this[m+J]=v&255;--J>=0&&(bt*=256);)v<0&&At===0&&this[m+J+1]!==0&&(At=1),this[m+J]=(v/bt>>0)-At&255;return m+k},f.prototype.writeInt8=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,1,127,-128),v<0&&(v=255+v+1),this[m]=v&255,m+1},f.prototype.writeInt16LE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,2,32767,-32768),this[m]=v&255,this[m+1]=v>>>8,m+2},f.prototype.writeInt16BE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,2,32767,-32768),this[m]=v>>>8,this[m+1]=v&255,m+2},f.prototype.writeInt32LE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,4,2147483647,-2147483648),this[m]=v&255,this[m+1]=v>>>8,this[m+2]=v>>>16,this[m+3]=v>>>24,m+4},f.prototype.writeInt32BE=function(v,m,k){return v=+v,m=m>>>0,k||Nt(this,v,m,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[m]=v>>>24,this[m+1]=v>>>16,this[m+2]=v>>>8,this[m+3]=v&255,m+4};function jt(I,v,m,k,B,q){if(m+k>I.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("Index out of range")}function Ct(I,v,m,k,B){return v=+v,m=m>>>0,B||jt(I,v,m,4,34028234663852886e22,-34028234663852886e22),y.write(I,v,m,k,23,4),m+4}f.prototype.writeFloatLE=function(v,m,k){return Ct(this,v,m,!0,k)},f.prototype.writeFloatBE=function(v,m,k){return Ct(this,v,m,!1,k)};function te(I,v,m,k,B){return v=+v,m=m>>>0,B||jt(I,v,m,8,17976931348623157e292,-17976931348623157e292),y.write(I,v,m,k,52,8),m+8}f.prototype.writeDoubleLE=function(v,m,k){return te(this,v,m,!0,k)},f.prototype.writeDoubleBE=function(v,m,k){return te(this,v,m,!1,k)},f.prototype.copy=function(v,m,k,B){if(k||(k=0),!B&&B!==0&&(B=this.length),m>=v.length&&(m=v.length),m||(m=0),B>0&&B<k&&(B=k),B===k||v.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("sourceStart out of bounds");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),v.length-m<B-k&&(B=v.length-m+k);var q=B-k,J;if(this===v&&k<m&&m<B)for(J=q-1;J>=0;--J)v[J+m]=this[J+k];else if(q<1e3)for(J=0;J<q;++J)v[J+m]=this[J+k];else Uint8Array.prototype.set.call(v,this.subarray(k,k+q),m);return q},f.prototype.fill=function(v,m,k,B){if(typeof v=="string"){if(typeof m=="string"?(B=m,m=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),v.length===1){var q=v.charCodeAt(0);q<256&&(v=q)}if(B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!f.isEncoding(B))throw new TypeError("Unknown encoding: "+B)}else typeof v=="number"&&(v=v&255);if(m<0||this.length<m||this.length<k)throw new RangeError("Out of range index");if(k<=m)return this;m=m>>>0,k=k===void 0?this.length:k>>>0,v||(v=0);var J;if(typeof v=="number")for(J=m;J<k;++J)this[J]=v;else{var bt=f.isBuffer(v)?v:new f(v,B),At=bt.length;for(J=0;J<k-m;++J)this[J+m]=bt[J%At]}return this};var R=/[^+/0-9A-Za-z-_]/g;function N(I){if(I=I.trim().replace(R,""),I.length<2)return"";for(;I.length%4!==0;)I=I+"=";return I}function Y(I){return I<16?"0"+I.toString(16):I.toString(16)}function Q(I,v){v=v||1/0;for(var m,k=I.length,B=null,q=[],J=0;J<k;++J){if(m=I.charCodeAt(J),m>55295&&m<57344){if(!B){if(m>56319){(v-=3)>-1&&q.push(239,191,189);continue}else if(J+1===k){(v-=3)>-1&&q.push(239,191,189);continue}B=m;continue}if(m<56320){(v-=3)>-1&&q.push(239,191,189),B=m;continue}m=(B-55296<<10|m-56320)+65536}else B&&(v-=3)>-1&&q.push(239,191,189);if(B=null,m<128){if((v-=1)<0)break;q.push(m)}else if(m<2048){if((v-=2)<0)break;q.push(m>>6|192,m&63|128)}else if(m<65536){if((v-=3)<0)break;q.push(m>>12|224,m>>6&63|128,m&63|128)}else if(m<1114112){if((v-=4)<0)break;q.push(m>>18|240,m>>12&63|128,m>>6&63|128,m&63|128)}else throw new Error("Invalid code point")}return q}function ht(I){for(var v=[],m=0;m<I.length;++m)v.push(I.charCodeAt(m)&255);return v}function it(I,v){for(var m,k,B,q=[],J=0;J<I.length&&!((v-=2)<0);++J)m=I.charCodeAt(J),k=m>>8,B=m%256,q.push(B),q.push(k);return q}function _t(I){return d.toByteArray(N(I))}function gt(I,v,m,k){for(var B=0;B<k&&!(B+m>=v.length||B>=I.length);++B)v[B+m]=I[B];return B}function Yt(I){return I instanceof ArrayBuffer||I!=null&&I.constructor!=null&&I.constructor.name==="ArrayBuffer"&&typeof I.byteLength=="number"}function ue(I){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(I)}function Fe(I){return I!==I}}).call(o,s(1))},function(l,o){"use strict";o.byteLength=f,o.toByteArray=_,o.fromByteArray=A;for(var s=[],c=[],d=typeof Uint8Array<"u"?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,E=y.length;g<E;++g)s[g]=y[g],c[y.charCodeAt(g)]=g;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;function w(b){var L=b.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return b[L-2]==="="?2:b[L-1]==="="?1:0}function f(b){return b.length*3/4-w(b)}function _(b){var L,C,G,W,M,Et,et=b.length;M=w(b),Et=new d(et*3/4-M),G=M>0?et-4:et;var wt=0;for(L=0,C=0;L<G;L+=4,C+=3)W=c[b.charCodeAt(L)]<<18|c[b.charCodeAt(L+1)]<<12|c[b.charCodeAt(L+2)]<<6|c[b.charCodeAt(L+3)],Et[wt++]=W>>16&255,Et[wt++]=W>>8&255,Et[wt++]=W&255;return M===2?(W=c[b.charCodeAt(L)]<<2|c[b.charCodeAt(L+1)]>>4,Et[wt++]=W&255):M===1&&(W=c[b.charCodeAt(L)]<<10|c[b.charCodeAt(L+1)]<<4|c[b.charCodeAt(L+2)]>>2,Et[wt++]=W>>8&255,Et[wt++]=W&255),Et}function p(b){return s[b>>18&63]+s[b>>12&63]+s[b>>6&63]+s[b&63]}function T(b,L,C){for(var G,W=[],M=L;M<C;M+=3)G=(b[M]<<16)+(b[M+1]<<8)+b[M+2],W.push(p(G));return W.join("")}function A(b){for(var L,C=b.length,G=C%3,W="",M=[],Et=16383,et=0,wt=C-G;et<wt;et+=Et)M.push(T(b,et,et+Et>wt?wt:et+Et));return G===1?(L=b[C-1],W+=s[L>>2],W+=s[L<<4&63],W+="=="):G===2&&(L=(b[C-2]<<8)+b[C-1],W+=s[L>>10],W+=s[L>>4&63],W+=s[L<<2&63],W+="="),M.push(W),M.join("")}},function(l,o){o.read=function(s,c,d,y,g){var E,w,f=g*8-y-1,_=(1<<f)-1,p=_>>1,T=-7,A=d?g-1:0,b=d?-1:1,L=s[c+A];for(A+=b,E=L&(1<<-T)-1,L>>=-T,T+=f;T>0;E=E*256+s[c+A],A+=b,T-=8);for(w=E&(1<<-T)-1,E>>=-T,T+=y;T>0;w=w*256+s[c+A],A+=b,T-=8);if(E===0)E=1-p;else{if(E===_)return w?NaN:(L?-1:1)*(1/0);w=w+Math.pow(2,y),E=E-p}return(L?-1:1)*w*Math.pow(2,E-y)},o.write=function(s,c,d,y,g,E){var w,f,_,p=E*8-g-1,T=(1<<p)-1,A=T>>1,b=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=y?0:E-1,C=y?1:-1,G=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(f=isNaN(c)?1:0,w=T):(w=Math.floor(Math.log(c)/Math.LN2),c*(_=Math.pow(2,-w))<1&&(w--,_*=2),w+A>=1?c+=b/_:c+=b*Math.pow(2,1-A),c*_>=2&&(w++,_/=2),w+A>=T?(f=0,w=T):w+A>=1?(f=(c*_-1)*Math.pow(2,g),w=w+A):(f=c*Math.pow(2,A-1)*Math.pow(2,g),w=0));g>=8;s[d+L]=f&255,L+=C,f/=256,g-=8);for(w=w<<g|f,p+=g;p>0;s[d+L]=w&255,L+=C,w/=256,p-=8);s[d+L-C]|=G*128}},function(l,o){l.exports=function(s){return s.webpackPolyfill||(s.deprecate=function(){},s.paths=[],s.children=[],s.webpackPolyfill=1),s}},function(l,o,s){"use strict";var c=s(7),d=new c,y={};function g(w){y[w]||(typeof d[w]=="function"?y[w]=function(){return d[w].apply(d,arguments)}:y[w]=d[w])}for(var E in d)g(E);y.initializeTTYs=function(){d.stdin===null&&(d.initializeTTYs(),y.stdin=d.stdin,y.stdout=d.stdout,y.stderr=d.stderr)},d.nextTick(function(){y.initializeTTYs()}),l.exports=y},function(l,o,s){(function(c){"use strict";var d=this&&this.__extends||function(_,p){for(var T in p)p.hasOwnProperty(T)&&(_[T]=p[T]);function A(){this.constructor=_}_.prototype=p===null?Object.create(p):(A.prototype=p.prototype,new A)},y=s(8),g=null,E=function(){function _(p,T){this.fun=p,this.array=T}return _.prototype.run=function(){this.fun.apply(null,this.array)},_}(),w=function(){function _(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return _.prototype.push=function(p){var T=this;this._queue.push(p)===1&&!this._draining&&setTimeout(function(){return T._drainQueue()},0)},_.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},_.prototype._drainQueue=function(){var p=this;if(!this._draining){var T=setTimeout(function(){return p._cleanUpNextTick()});this._draining=!0;for(var A=this._queue.length;A;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<A;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,A=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(T)}},_}(),f=function(_){d(p,_);function p(){_.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new w,this.execPath=c,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return p.prototype.chdir=function(T){g===null&&(g=s(9)),this._cwd=g.resolve(T)},p.prototype.cwd=function(){return this._cwd},p.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},p.prototype.nextTick=function(T){for(var A=[],b=1;b<arguments.length;b++)A[b-1]=arguments[b];this._queue.push(new E(T,A))},p.prototype.abort=function(){this.emit("abort")},p.prototype.exit=function(T){this.exitCode=T,this.emit("exit",[T])},p.prototype.getgid=function(){return this._gid},p.prototype.setgid=function(T){typeof T=="number"?this._gid=T:this._gid=1},p.prototype.getuid=function(){return this._uid},p.prototype.setuid=function(T){typeof T=="number"?this._uid=T:this._uid=1},p.prototype.kill=function(T,A){this.emit("kill",[T,A])},p.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},p.prototype.umask=function(T){T===void 0&&(T=this._mask);var A=this._mask;return this._mask=T,this.emit("umask",[T]),A},p.prototype.hrtime=function(){var T;typeof performance<"u"?T=performance.now():Date.now?T=Date.now():T=new Date().getTime();var A=T/1e3|0;return T-=A*1e3,T=T*1e6|0,[A,T]},p.prototype.initializeTTYs=function(){if(this.stdout===null){var T=s(10);this.stdout=new T,this.stderr=new T,this.stdin=new T}},p.prototype.disconnect=function(){},p}(y.EventEmitter);l.exports=f}).call(o,"/")},function(l,o){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}l.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(E){if(!d(E)||E<0||isNaN(E))throw TypeError("n must be a positive number");return this._maxListeners=E,this},s.prototype.emit=function(E){var w,f,_,p,T,A;if(this._events||(this._events={}),E==="error"&&(!this._events.error||y(this._events.error)&&!this._events.error.length)){if(w=arguments[1],w instanceof Error)throw w;var b=new Error('Uncaught, unspecified "error" event. ('+w+")");throw b.context=w,b}if(f=this._events[E],g(f))return!1;if(c(f))switch(arguments.length){case 1:f.call(this);break;case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),f.apply(this,p)}else if(y(f))for(p=Array.prototype.slice.call(arguments,1),A=f.slice(),_=A.length,T=0;T<_;T++)A[T].apply(this,p);return!0},s.prototype.addListener=function(E,w){var f;if(!c(w))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",E,c(w.listener)?w.listener:w),this._events[E]?y(this._events[E])?this._events[E].push(w):this._events[E]=[this._events[E],w]:this._events[E]=w,y(this._events[E])&&!this._events[E].warned&&(g(this._maxListeners)?f=s.defaultMaxListeners:f=this._maxListeners,f&&f>0&&this._events[E].length>f&&(this._events[E].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[E].length),typeof console.trace=="function"&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(E,w){if(!c(w))throw TypeError("listener must be a function");var f=!1;function _(){this.removeListener(E,_),f||(f=!0,w.apply(this,arguments))}return _.listener=w,this.on(E,_),this},s.prototype.removeListener=function(E,w){var f,_,p,T;if(!c(w))throw TypeError("listener must be a function");if(!this._events||!this._events[E])return this;if(f=this._events[E],p=f.length,_=-1,f===w||c(f.listener)&&f.listener===w)delete this._events[E],this._events.removeListener&&this.emit("removeListener",E,w);else if(y(f)){for(T=p;T-- >0;)if(f[T]===w||f[T].listener&&f[T].listener===w){_=T;break}if(_<0)return this;f.length===1?(f.length=0,delete this._events[E]):f.splice(_,1),this._events.removeListener&&this.emit("removeListener",E,w)}return this},s.prototype.removeAllListeners=function(E){var w,f;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[E]&&delete this._events[E],this;if(arguments.length===0){for(w in this._events)w!=="removeListener"&&this.removeAllListeners(w);return this.removeAllListeners("removeListener"),this._events={},this}if(f=this._events[E],c(f))this.removeListener(E,f);else if(f)for(;f.length;)this.removeListener(E,f[f.length-1]);return delete this._events[E],this},s.prototype.listeners=function(E){var w;return!this._events||!this._events[E]?w=[]:c(this._events[E])?w=[this._events[E]]:w=this._events[E].slice(),w},s.prototype.listenerCount=function(E){if(this._events){var w=this._events[E];if(c(w))return 1;if(w)return w.length}return 0},s.listenerCount=function(E,w){return E.listenerCount(w)};function c(E){return typeof E=="function"}function d(E){return typeof E=="number"}function y(E){return typeof E=="object"&&E!==null}function g(E){return E===void 0}},function(l,o,s){(function(c){"use strict";var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function y(w){var f=d.exec(w);return f.shift(),f}var g=function(){function w(){}return w.normalize=function(f){f===""&&(f=".");var _=f.charAt(0)===w.sep;f=w._removeDuplicateSeps(f);for(var p=f.split(w.sep),T=[],A=0;A<p.length;A++){var b=p[A];b!=="."&&(b===".."&&(_||!_&&T.length>0&&T[0]!=="..")?T.pop():T.push(b))}if(!_&&T.length<2)switch(T.length){case 1:T[0]===""&&T.unshift(".");break;default:T.push(".")}return f=T.join(w.sep),_&&f.charAt(0)!==w.sep&&(f=w.sep+f),f},w.join=function(){for(var f=[],_=0;_<arguments.length;_++)f[_-0]=arguments[_];for(var p=[],T=0;T<f.length;T++){var A=f[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&p.push(A)}return w.normalize(p.join(w.sep))},w.resolve=function(){for(var f=[],_=0;_<arguments.length;_++)f[_-0]=arguments[_];for(var p=[],T=0;T<f.length;T++){var A=f[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&(A.charAt(0)===w.sep&&(p=[]),p.push(A))}var b=w.normalize(p.join(w.sep));if(b.length>1&&b.charAt(b.length-1)===w.sep)return b.substr(0,b.length-1);if(b.charAt(0)!==w.sep){b.charAt(0)==="."&&(b.length===1||b.charAt(1)===w.sep)&&(b=b.length===1?"":b.substr(2));var L=c.cwd();b!==""?b=this.normalize(L+(L!=="/"?w.sep:"")+b):b=L}return b},w.relative=function(f,_){var p;f=w.resolve(f),_=w.resolve(_);var T=f.split(w.sep),A=_.split(w.sep);A.shift(),T.shift();var b=0,L=[];for(p=0;p<T.length;p++){var C=T[p];if(C!==A[p]){b=T.length-p;break}}L=A.slice(p),T.length===1&&T[0]===""&&(b=0),b>T.length&&(b=T.length);var G="";for(p=0;p<b;p++)G+="../";return G+=L.join(w.sep),G.length>1&&G.charAt(G.length-1)===w.sep&&(G=G.substr(0,G.length-1)),G},w.dirname=function(f){f=w._removeDuplicateSeps(f);var _=f.charAt(0)===w.sep,p=f.split(w.sep);return p.pop()===""&&p.length>0&&p.pop(),p.length>1||p.length===1&&!_?p.join(w.sep):_?w.sep:"."},w.basename=function(f,_){if(_===void 0&&(_=""),f==="")return f;f=w.normalize(f);var p=f.split(w.sep),T=p[p.length-1];if(T===""&&p.length>1)return p[p.length-2];if(_.length>0){var A=T.substr(T.length-_.length);if(A===_)return T.substr(0,T.length-_.length)}return T},w.extname=function(f){f=w.normalize(f);var _=f.split(w.sep);if(f=_.pop(),f===""&&_.length>0&&(f=_.pop()),f==="..")return"";var p=f.lastIndexOf(".");return p===-1||p===0?"":f.substr(p)},w.isAbsolute=function(f){return f.length>0&&f.charAt(0)===w.sep},w._makeLong=function(f){return f},w.parse=function(f){var _=y(f);return{root:_[0],dir:_[0]+_[1].slice(0,-1),base:_[2],ext:_[3],name:_[2].slice(0,_[2].length-_[3].length)}},w.format=function(f){if(f===null||typeof f!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof f);var _=f.root||"";if(typeof _!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof f.root);var p=f.dir?f.dir+w.sep:"",T=f.base||"";return p+T},w._removeDuplicateSeps=function(f){return f=f.replace(this._replaceRegex,this.sep),f},w.sep="/",w._replaceRegex=new RegExp("//+","g"),w.delimiter=":",w.posix=w,w.win32=w,w}(),E=g;l.exports=g}).call(o,s(6))},function(l,o,s){(function(c){"use strict";var d=this&&this.__extends||function(E,w){for(var f in w)w.hasOwnProperty(f)&&(E[f]=w[f]);function _(){this.constructor=E}E.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)},y=s(11),g=function(E){d(w,E);function w(){E.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return w.prototype.setRawMode=function(f){this.isRaw!==f&&(this.isRaw=f,this.emit("modeChange"))},w.prototype.changeColumns=function(f){f!==this.columns&&(this.columns=f,this.emit("resize"))},w.prototype.changeRows=function(f){f!==this.rows&&(this.rows=f,this.emit("resize"))},w.isatty=function(f){return f&&f instanceof w},w.prototype._write=function(f,_,p){var T;try{var A;typeof f=="string"?A=new c(f,_):A=f,this._bufferedWrites.push(A),this._waitingForWrites&&this._read(1024)}catch(b){T=b}finally{p(T)}},w.prototype._read=function(f){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},w}(y.Duplex);l.exports=g}).call(o,s(1))},function(l,o,s){l.exports=y;var c=s(8).EventEmitter,d=s(12);d(y,c),y.Readable=s(13),y.Writable=s(27),y.Duplex=s(28),y.Transform=s(29),y.PassThrough=s(30),y.Stream=y;function y(){c.call(this)}y.prototype.pipe=function(g,E){var w=this;function f(C){g.writable&&g.write(C)===!1&&w.pause&&w.pause()}w.on("data",f);function _(){w.readable&&w.resume&&w.resume()}g.on("drain",_),!g._isStdio&&(!E||E.end!==!1)&&(w.on("end",T),w.on("close",A));var p=!1;function T(){p||(p=!0,g.end())}function A(){p||(p=!0,typeof g.destroy=="function"&&g.destroy())}function b(C){if(L(),c.listenerCount(this,"error")===0)throw C}w.on("error",b),g.on("error",b);function L(){w.removeListener("data",f),g.removeListener("drain",_),w.removeListener("end",T),w.removeListener("close",A),w.removeListener("error",b),g.removeListener("error",b),w.removeListener("end",L),w.removeListener("close",L),g.removeListener("close",L)}return w.on("end",L),w.on("close",L),g.on("close",L),g.emit("pipe",w),g}},function(l,o){typeof Object.create=="function"?l.exports=function(c,d){c.super_=d,c.prototype=Object.create(d.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:l.exports=function(c,d){c.super_=d;var y=function(){};y.prototype=d.prototype,c.prototype=new y,c.prototype.constructor=c}},function(l,o,s){(function(c){var d=function(){try{return s(11)}catch{}}();o=l.exports=s(14),o.Stream=d||o,o.Readable=o,o.Writable=s(22),o.Duplex=s(21),o.Transform=s(25),o.PassThrough=s(26),!c.browser&&c.env.READABLE_STREAM==="disable"&&d&&(l.exports=d)}).call(o,s(6))},function(l,o,s){(function(c){"use strict";l.exports=M;var d=s(15),y=s(16),g;M.ReadableState=W;var E=s(8).EventEmitter,w=function(R,N){return R.listeners(N).length},f;(function(){try{f=s(11)}catch{}finally{f||(f=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17),T=s(18);T.inherits=s(12);var A=s(19),b=void 0;A&&A.debuglog?b=A.debuglog("stream"):b=function(){};var L=s(20),C;T.inherits(M,f);function G(R,N,Y){if(typeof R.prependListener=="function")return R.prependListener(N,Y);!R._events||!R._events[N]?R.on(N,Y):y(R._events[N])?R._events[N].unshift(Y):R._events[N]=[Y,R._events[N]]}function W(R,N){g=g||s(21),R=R||{},this.objectMode=!!R.objectMode,N instanceof g&&(this.objectMode=this.objectMode||!!R.readableObjectMode);var Y=R.highWaterMark,Q=this.objectMode?16:16*1024;this.highWaterMark=Y||Y===0?Y:Q,this.highWaterMark=~~this.highWaterMark,this.buffer=new L,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=R.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,R.encoding&&(C||(C=s(24).StringDecoder),this.decoder=new C(R.encoding),this.encoding=R.encoding)}function M(R){if(g=g||s(21),!(this instanceof M))return new M(R);this._readableState=new W(R,this),this.readable=!0,R&&typeof R.read=="function"&&(this._read=R.read),f.call(this)}M.prototype.push=function(R,N){var Y=this._readableState;return!Y.objectMode&&typeof R=="string"&&(N=N||Y.defaultEncoding,N!==Y.encoding&&(R=p.from(R,N),N="")),Et(this,Y,R,N,!1)},M.prototype.unshift=function(R){var N=this._readableState;return Et(this,N,R,"",!0)},M.prototype.isPaused=function(){return this._readableState.flowing===!1};function Et(R,N,Y,Q,ht){var it=tt(N,Y);if(it)R.emit("error",it);else if(Y===null)N.reading=!1,ft(R,N);else if(N.objectMode||Y&&Y.length>0)if(N.ended&&!ht){var _t=new Error("stream.push() after EOF");R.emit("error",_t)}else if(N.endEmitted&&ht){var gt=new Error("stream.unshift() after end event");R.emit("error",gt)}else{var Yt;N.decoder&&!ht&&!Q&&(Y=N.decoder.write(Y),Yt=!N.objectMode&&Y.length===0),ht||(N.reading=!1),Yt||(N.flowing&&N.length===0&&!N.sync?(R.emit("data",Y),R.read(0)):(N.length+=N.objectMode?1:Y.length,ht?N.buffer.unshift(Y):N.buffer.push(Y),N.needReadable&&Rt(R))),Lt(R,N)}else ht||(N.reading=!1);return et(N)}function et(R){return!R.ended&&(R.needReadable||R.length<R.highWaterMark||R.length===0)}M.prototype.setEncoding=function(R){return C||(C=s(24).StringDecoder),this._readableState.decoder=new C(R),this._readableState.encoding=R,this};var wt=8388608;function pt(R){return R>=wt?R=wt:(R--,R|=R>>>1,R|=R>>>2,R|=R>>>4,R|=R>>>8,R|=R>>>16,R++),R}function U(R,N){return R<=0||N.length===0&&N.ended?0:N.objectMode?1:R!==R?N.flowing&&N.length?N.buffer.head.data.length:N.length:(R>N.highWaterMark&&(N.highWaterMark=pt(R)),R<=N.length?R:N.ended?N.length:(N.needReadable=!0,0))}M.prototype.read=function(R){b("read",R),R=parseInt(R,10);var N=this._readableState,Y=R;if(R!==0&&(N.emittedReadable=!1),R===0&&N.needReadable&&(N.length>=N.highWaterMark||N.ended))return b("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?Nt(this):Rt(this),null;if(R=U(R,N),R===0&&N.ended)return N.length===0&&Nt(this),null;var Q=N.needReadable;b("need readable",Q),(N.length===0||N.length-R<N.highWaterMark)&&(Q=!0,b("length less than watermark",Q)),N.ended||N.reading?(Q=!1,b("reading or ended",Q)):Q&&(b("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(R=U(Y,N)));var ht;return R>0?ht=ut(R,N):ht=null,ht===null?(N.needReadable=!0,R=0):N.length-=R,N.length===0&&(N.ended||(N.needReadable=!0),Y!==R&&N.ended&&Nt(this)),ht!==null&&this.emit("data",ht),ht};function tt(R,N){var Y=null;return!_.isBuffer(N)&&typeof N!="string"&&N!==null&&N!==void 0&&!R.objectMode&&(Y=new TypeError("Invalid non-string/buffer chunk")),Y}function ft(R,N){if(!N.ended){if(N.decoder){var Y=N.decoder.end();Y&&Y.length&&(N.buffer.push(Y),N.length+=N.objectMode?1:Y.length)}N.ended=!0,Rt(R)}}function Rt(R){var N=R._readableState;N.needReadable=!1,N.emittedReadable||(b("emitReadable",N.flowing),N.emittedReadable=!0,N.sync?d(dt,R):dt(R))}function dt(R){b("emit readable"),R.emit("readable"),K(R)}function Lt(R,N){N.readingMore||(N.readingMore=!0,d(kt,R,N))}function kt(R,N){for(var Y=N.length;!N.reading&&!N.flowing&&!N.ended&&N.length<N.highWaterMark&&(b("maybeReadMore read 0"),R.read(0),Y!==N.length);)Y=N.length;N.readingMore=!1}M.prototype._read=function(R){this.emit("error",new Error("_read() is not implemented"))},M.prototype.pipe=function(R,N){var Y=this,Q=this._readableState;switch(Q.pipesCount){case 0:Q.pipes=R;break;case 1:Q.pipes=[Q.pipes,R];break;default:Q.pipes.push(R);break}Q.pipesCount+=1,b("pipe count=%d opts=%j",Q.pipesCount,N);var ht=(!N||N.end!==!1)&&R!==c.stdout&&R!==c.stderr,it=ht?gt:Fe;Q.endEmitted?d(it):Y.once("end",it),R.on("unpipe",_t);function _t(J){b("onunpipe"),J===Y&&Fe()}function gt(){b("onend"),R.end()}var Yt=St(Y);R.on("drain",Yt);var ue=!1;function Fe(){b("cleanup"),R.removeListener("close",k),R.removeListener("finish",B),R.removeListener("drain",Yt),R.removeListener("error",m),R.removeListener("unpipe",_t),Y.removeListener("end",gt),Y.removeListener("end",Fe),Y.removeListener("data",v),ue=!0,Q.awaitDrain&&(!R._writableState||R._writableState.needDrain)&&Yt()}var I=!1;Y.on("data",v);function v(J){b("ondata"),I=!1;var bt=R.write(J);bt===!1&&!I&&((Q.pipesCount===1&&Q.pipes===R||Q.pipesCount>1&&te(Q.pipes,R)!==-1)&&!ue&&(b("false write response, pause",Y._readableState.awaitDrain),Y._readableState.awaitDrain++,I=!0),Y.pause())}function m(J){b("onerror",J),q(),R.removeListener("error",m),w(R,"error")===0&&R.emit("error",J)}G(R,"error",m);function k(){R.removeListener("finish",B),q()}R.once("close",k);function B(){b("onfinish"),R.removeListener("close",k),q()}R.once("finish",B);function q(){b("unpipe"),Y.unpipe(R)}return R.emit("pipe",Y),Q.flowing||(b("pipe resume"),Y.resume()),R};function St(R){return function(){var N=R._readableState;b("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&w(R,"data")&&(N.flowing=!0,K(R))}}M.prototype.unpipe=function(R){var N=this._readableState;if(N.pipesCount===0)return this;if(N.pipesCount===1)return R&&R!==N.pipes?this:(R||(R=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,R&&R.emit("unpipe",this),this);if(!R){var Y=N.pipes,Q=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var ht=0;ht<Q;ht++)Y[ht].emit("unpipe",this);return this}var it=te(N.pipes,R);return it===-1?this:(N.pipes.splice(it,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),R.emit("unpipe",this),this)},M.prototype.on=function(R,N){var Y=f.prototype.on.call(this,R,N);if(R==="data")this._readableState.flowing!==!1&&this.resume();else if(R==="readable"){var Q=this._readableState;!Q.endEmitted&&!Q.readableListening&&(Q.readableListening=Q.needReadable=!0,Q.emittedReadable=!1,Q.reading?Q.length&&Rt(this,Q):d(Xt,this))}return Y},M.prototype.addListener=M.prototype.on;function Xt(R){b("readable nexttick read 0"),R.read(0)}M.prototype.resume=function(){var R=this._readableState;return R.flowing||(b("resume"),R.flowing=!0,P(this,R)),this};function P(R,N){N.resumeScheduled||(N.resumeScheduled=!0,d(z,R,N))}function z(R,N){N.reading||(b("resume read 0"),R.read(0)),N.resumeScheduled=!1,N.awaitDrain=0,R.emit("resume"),K(R),N.flowing&&!N.reading&&R.read(0)}M.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function K(R){var N=R._readableState;for(b("flow",N.flowing);N.flowing&&R.read()!==null;);}M.prototype.wrap=function(R){var N=this._readableState,Y=!1,Q=this;R.on("end",function(){if(b("wrapped end"),N.decoder&&!N.ended){var _t=N.decoder.end();_t&&_t.length&&Q.push(_t)}Q.push(null)}),R.on("data",function(_t){if(b("wrapped data"),N.decoder&&(_t=N.decoder.write(_t)),!(N.objectMode&&_t==null)&&!(!N.objectMode&&(!_t||!_t.length))){var gt=Q.push(_t);gt||(Y=!0,R.pause())}});for(var ht in R)this[ht]===void 0&&typeof R[ht]=="function"&&(this[ht]=function(_t){return function(){return R[_t].apply(R,arguments)}}(ht));var it=["error","close","destroy","pause","resume"];return Ct(it,function(_t){R.on(_t,Q.emit.bind(Q,_t))}),Q._read=function(_t){b("wrapped _read",_t),Y&&(Y=!1,R.resume())},Q},M._fromList=ut;function ut(R,N){if(N.length===0)return null;var Y;return N.objectMode?Y=N.buffer.shift():!R||R>=N.length?(N.decoder?Y=N.buffer.join(""):N.buffer.length===1?Y=N.buffer.head.data:Y=N.buffer.concat(N.length),N.buffer.clear()):Y=It(R,N.buffer,N.decoder),Y}function It(R,N,Y){var Q;return R<N.head.data.length?(Q=N.head.data.slice(0,R),N.head.data=N.head.data.slice(R)):R===N.head.data.length?Q=N.shift():Q=Y?vt(R,N):xt(R,N),Q}function vt(R,N){var Y=N.head,Q=1,ht=Y.data;for(R-=ht.length;Y=Y.next;){var it=Y.data,_t=R>it.length?it.length:R;if(_t===it.length?ht+=it:ht+=it.slice(0,R),R-=_t,R===0){_t===it.length?(++Q,Y.next?N.head=Y.next:N.head=N.tail=null):(N.head=Y,Y.data=it.slice(_t));break}++Q}return N.length-=Q,ht}function xt(R,N){var Y=p.allocUnsafe(R),Q=N.head,ht=1;for(Q.data.copy(Y),R-=Q.data.length;Q=Q.next;){var it=Q.data,_t=R>it.length?it.length:R;if(it.copy(Y,Y.length-R,0,_t),R-=_t,R===0){_t===it.length?(++ht,Q.next?N.head=Q.next:N.head=N.tail=null):(N.head=Q,Q.data=it.slice(_t));break}++ht}return N.length-=ht,Y}function Nt(R){var N=R._readableState;if(N.length>0)throw new Error('"endReadable()" called on non-empty stream');N.endEmitted||(N.ended=!0,d(jt,N,R))}function jt(R,N){!R.endEmitted&&R.length===0&&(R.endEmitted=!0,N.readable=!1,N.emit("end"))}function Ct(R,N){for(var Y=0,Q=R.length;Y<Q;Y++)N(R[Y],Y)}function te(R,N){for(var Y=0,Q=R.length;Y<Q;Y++)if(R[Y]===N)return Y;return-1}}).call(o,s(6))},function(l,o,s){(function(c){"use strict";!c.version||c.version.indexOf("v0.")===0||c.version.indexOf("v1.")===0&&c.version.indexOf("v1.8.")!==0?l.exports=d:l.exports=c.nextTick;function d(y,g,E,w){if(typeof y!="function")throw new TypeError('"callback" argument must be a function');var f=arguments.length,_,p;switch(f){case 0:case 1:return c.nextTick(y);case 2:return c.nextTick(function(){y.call(null,g)});case 3:return c.nextTick(function(){y.call(null,g,E)});case 4:return c.nextTick(function(){y.call(null,g,E,w)});default:for(_=new Array(f-1),p=0;p<_.length;)_[p++]=arguments[p];return c.nextTick(function(){y.apply(null,_)})}}}).call(o,s(6))},function(l,o){var s={}.toString;l.exports=Array.isArray||function(c){return s.call(c)=="[object Array]"}},function(l,o,s){(function(c){"use strict";var d=s(2),y=d.Buffer,g=d.SlowBuffer,E=d.kMaxLength||2147483647;o.alloc=function(f,_,p){if(typeof y.alloc=="function")return y.alloc(f,_,p);if(typeof p=="number")throw new TypeError("encoding must not be number");if(typeof f!="number")throw new TypeError("size must be a number");if(f>E)throw new RangeError("size is too large");var T=p,A=_;A===void 0&&(T=void 0,A=0);var b=new y(f);if(typeof A=="string")for(var L=new y(A,T),C=L.length,G=-1;++G<f;)b[G]=L[G%C];else b.fill(A);return b},o.allocUnsafe=function(f){if(typeof y.allocUnsafe=="function")return y.allocUnsafe(f);if(typeof f!="number")throw new TypeError("size must be a number");if(f>E)throw new RangeError("size is too large");return new y(f)},o.from=function(f,_,p){if(typeof y.from=="function"&&(!c.Uint8Array||Uint8Array.from!==y.from))return y.from(f,_,p);if(typeof f=="number")throw new TypeError('"value" argument must not be a number');if(typeof f=="string")return new y(f,_);if(typeof ArrayBuffer<"u"&&f instanceof ArrayBuffer){var T=_;if(arguments.length===1)return new y(f);typeof T>"u"&&(T=0);var A=p;if(typeof A>"u"&&(A=f.byteLength-T),T>=f.byteLength)throw new RangeError("'offset' is out of bounds");if(A>f.byteLength-T)throw new RangeError("'length' is out of bounds");return new y(f.slice(T,T+A))}if(y.isBuffer(f)){var b=new y(f.length);return f.copy(b,0,0,f.length),b}if(f){if(Array.isArray(f)||typeof ArrayBuffer<"u"&&f.buffer instanceof ArrayBuffer||"length"in f)return new y(f);if(f.type==="Buffer"&&Array.isArray(f.data))return new y(f.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},o.allocUnsafeSlow=function(f){if(typeof y.allocUnsafeSlow=="function")return y.allocUnsafeSlow(f);if(typeof f!="number")throw new TypeError("size must be a number");if(f>=E)throw new RangeError("size is too large");return new g(f)}}).call(o,function(){return this}())},function(l,o,s){(function(c){function d(M){return Array.isArray?Array.isArray(M):W(M)==="[object Array]"}o.isArray=d;function y(M){return typeof M=="boolean"}o.isBoolean=y;function g(M){return M===null}o.isNull=g;function E(M){return M==null}o.isNullOrUndefined=E;function w(M){return typeof M=="number"}o.isNumber=w;function f(M){return typeof M=="string"}o.isString=f;function _(M){return typeof M=="symbol"}o.isSymbol=_;function p(M){return M===void 0}o.isUndefined=p;function T(M){return W(M)==="[object RegExp]"}o.isRegExp=T;function A(M){return typeof M=="object"&&M!==null}o.isObject=A;function b(M){return W(M)==="[object Date]"}o.isDate=b;function L(M){return W(M)==="[object Error]"||M instanceof Error}o.isError=L;function C(M){return typeof M=="function"}o.isFunction=C;function G(M){return M===null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||typeof M=="symbol"||typeof M>"u"}o.isPrimitive=G,o.isBuffer=c.isBuffer;function W(M){return Object.prototype.toString.call(M)}}).call(o,s(1))},function(l,o){},function(l,o,s){"use strict";var c=s(2).Buffer,d=s(17);l.exports=y;function y(){this.head=null,this.tail=null,this.length=0}y.prototype.push=function(g){var E={data:g,next:null};this.length>0?this.tail.next=E:this.head=E,this.tail=E,++this.length},y.prototype.unshift=function(g){var E={data:g,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length},y.prototype.shift=function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}},y.prototype.clear=function(){this.head=this.tail=null,this.length=0},y.prototype.join=function(g){if(this.length===0)return"";for(var E=this.head,w=""+E.data;E=E.next;)w+=g+E.data;return w},y.prototype.concat=function(g){if(this.length===0)return d.alloc(0);if(this.length===1)return this.head.data;for(var E=d.allocUnsafe(g>>>0),w=this.head,f=0;w;)w.data.copy(E,f),f+=w.data.length,w=w.next;return E}},function(l,o,s){"use strict";var c=Object.keys||function(L){var C=[];for(var G in L)C.push(G);return C};l.exports=p;var d=s(15),y=s(18);y.inherits=s(12);var g=s(14),E=s(22);y.inherits(p,g);for(var w=c(E.prototype),f=0;f<w.length;f++){var _=w[f];p.prototype[_]||(p.prototype[_]=E.prototype[_])}function p(L){if(!(this instanceof p))return new p(L);g.call(this,L),E.call(this,L),L&&L.readable===!1&&(this.readable=!1),L&&L.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,L&&L.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",T)}function T(){this.allowHalfOpen||this._writableState.ended||d(A,this)}function A(L){L.end()}function b(L,C){for(var G=0,W=L.length;G<W;G++)C(L[G],G)}},function(l,o,s){(function(c){"use strict";l.exports=C;var d=s(15),y=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:d,g;C.WritableState=b;var E=s(18);E.inherits=s(12);var w={deprecate:s(23)},f;(function(){try{f=s(11)}catch{}finally{f||(f=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17);E.inherits(C,f);function T(){}function A(P,z,K){this.chunk=P,this.encoding=z,this.callback=K,this.next=null}function b(P,z){g=g||s(21),P=P||{},this.objectMode=!!P.objectMode,z instanceof g&&(this.objectMode=this.objectMode||!!P.writableObjectMode);var K=P.highWaterMark,ut=this.objectMode?16:16*1024;this.highWaterMark=K||K===0?K:ut,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var It=P.decodeStrings===!1;this.decodeStrings=!It,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(vt){U(z,vt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Xt(this)}b.prototype.getBuffer=function(){for(var z=this.bufferedRequest,K=[];z;)K.push(z),z=z.next;return K},function(){try{Object.defineProperty(b.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(P){return L.call(this,P)?!0:P&&P._writableState instanceof b}})):L=function(P){return P instanceof this};function C(P){if(g=g||s(21),!L.call(C,this)&&!(this instanceof g))return new C(P);this._writableState=new b(P,this),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev)),f.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function G(P,z){var K=new Error("write after end");P.emit("error",K),d(z,K)}function W(P,z,K,ut){var It=!0,vt=!1;return K===null?vt=new TypeError("May not write null values to stream"):typeof K!="string"&&K!==void 0&&!z.objectMode&&(vt=new TypeError("Invalid non-string/buffer chunk")),vt&&(P.emit("error",vt),d(ut,vt),It=!1),It}C.prototype.write=function(P,z,K){var ut=this._writableState,It=!1,vt=_.isBuffer(P);return typeof z=="function"&&(K=z,z=null),vt?z="buffer":z||(z=ut.defaultEncoding),typeof K!="function"&&(K=T),ut.ended?G(this,K):(vt||W(this,ut,P,K))&&(ut.pendingcb++,It=Et(this,ut,vt,P,z,K)),It},C.prototype.cork=function(){var P=this._writableState;P.corked++},C.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,!P.writing&&!P.corked&&!P.finished&&!P.bufferProcessing&&P.bufferedRequest&&Rt(this,P))},C.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+z);return this._writableState.defaultEncoding=z,this};function M(P,z,K){return!P.objectMode&&P.decodeStrings!==!1&&typeof z=="string"&&(z=p.from(z,K)),z}function Et(P,z,K,ut,It,vt){K||(ut=M(z,ut,It),_.isBuffer(ut)&&(It="buffer"));var xt=z.objectMode?1:ut.length;z.length+=xt;var Nt=z.length<z.highWaterMark;if(Nt||(z.needDrain=!0),z.writing||z.corked){var jt=z.lastBufferedRequest;z.lastBufferedRequest=new A(ut,It,vt),jt?jt.next=z.lastBufferedRequest:z.bufferedRequest=z.lastBufferedRequest,z.bufferedRequestCount+=1}else et(P,z,!1,xt,ut,It,vt);return Nt}function et(P,z,K,ut,It,vt,xt){z.writelen=ut,z.writecb=xt,z.writing=!0,z.sync=!0,K?P._writev(It,z.onwrite):P._write(It,vt,z.onwrite),z.sync=!1}function wt(P,z,K,ut,It){--z.pendingcb,K?d(It,ut):It(ut),P._writableState.errorEmitted=!0,P.emit("error",ut)}function pt(P){P.writing=!1,P.writecb=null,P.length-=P.writelen,P.writelen=0}function U(P,z){var K=P._writableState,ut=K.sync,It=K.writecb;if(pt(K),z)wt(P,K,ut,z,It);else{var vt=dt(K);!vt&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&Rt(P,K),ut?y(tt,P,K,vt,It):tt(P,K,vt,It)}}function tt(P,z,K,ut){K||ft(P,z),z.pendingcb--,ut(),kt(P,z)}function ft(P,z){z.length===0&&z.needDrain&&(z.needDrain=!1,P.emit("drain"))}function Rt(P,z){z.bufferProcessing=!0;var K=z.bufferedRequest;if(P._writev&&K&&K.next){var ut=z.bufferedRequestCount,It=new Array(ut),vt=z.corkedRequestsFree;vt.entry=K;for(var xt=0;K;)It[xt]=K,K=K.next,xt+=1;et(P,z,!0,z.length,It,"",vt.finish),z.pendingcb++,z.lastBufferedRequest=null,vt.next?(z.corkedRequestsFree=vt.next,vt.next=null):z.corkedRequestsFree=new Xt(z)}else{for(;K;){var Nt=K.chunk,jt=K.encoding,Ct=K.callback,te=z.objectMode?1:Nt.length;if(et(P,z,!1,te,Nt,jt,Ct),K=K.next,z.writing)break}K===null&&(z.lastBufferedRequest=null)}z.bufferedRequestCount=0,z.bufferedRequest=K,z.bufferProcessing=!1}C.prototype._write=function(P,z,K){K(new Error("_write() is not implemented"))},C.prototype._writev=null,C.prototype.end=function(P,z,K){var ut=this._writableState;typeof P=="function"?(K=P,P=null,z=null):typeof z=="function"&&(K=z,z=null),P!=null&&this.write(P,z),ut.corked&&(ut.corked=1,this.uncork()),!ut.ending&&!ut.finished&&St(this,ut,K)};function dt(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function Lt(P,z){z.prefinished||(z.prefinished=!0,P.emit("prefinish"))}function kt(P,z){var K=dt(z);return K&&(z.pendingcb===0?(Lt(P,z),z.finished=!0,P.emit("finish")):Lt(P,z)),K}function St(P,z,K){z.ending=!0,kt(P,z),K&&(z.finished?d(K):P.once("finish",K)),z.ended=!0,P.writable=!1}function Xt(P){var z=this;this.next=null,this.entry=null,this.finish=function(K){var ut=z.entry;for(z.entry=null;ut;){var It=ut.callback;P.pendingcb--,It(K),ut=ut.next}P.corkedRequestsFree?P.corkedRequestsFree.next=z:P.corkedRequestsFree=z}}}).call(o,s(6))},function(l,o){(function(s){l.exports=c;function c(y,g){if(d("noDeprecation"))return y;var E=!1;function w(){if(!E){if(d("throwDeprecation"))throw new Error(g);d("traceDeprecation")?console.trace(g):console.warn(g),E=!0}return y.apply(this,arguments)}return w}function d(y){try{if(!s.localStorage)return!1}catch{return!1}var g=s.localStorage[y];return g==null?!1:String(g).toLowerCase()==="true"}}).call(o,function(){return this}())},function(l,o,s){var c=s(2).Buffer,d=c.isEncoding||function(_){switch(_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function y(_){if(_&&!d(_))throw new Error("Unknown encoding: "+_)}var g=o.StringDecoder=function(_){switch(this.encoding=(_||"utf8").toLowerCase().replace(/[-_]/,""),y(_),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=w;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=f;break;default:this.write=E;return}this.charBuffer=new c(6),this.charReceived=0,this.charLength=0};g.prototype.write=function(_){for(var p="";this.charLength;){var T=_.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:_.length;if(_.copy(this.charBuffer,this.charReceived,0,T),this.charReceived+=T,this.charReceived<this.charLength)return"";_=_.slice(T,_.length),p=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var b=p.charCodeAt(p.length-1);if(b>=55296&&b<=56319){this.charLength+=this.surrogateSize,p="";continue}if(this.charReceived=this.charLength=0,_.length===0)return p;break}this.detectIncompleteChar(_);var A=_.length;this.charLength&&(_.copy(this.charBuffer,0,_.length-this.charReceived,A),A-=this.charReceived),p+=_.toString(this.encoding,0,A);var A=p.length-1,b=p.charCodeAt(A);if(b>=55296&&b<=56319){var L=this.surrogateSize;return this.charLength+=L,this.charReceived+=L,this.charBuffer.copy(this.charBuffer,L,0,L),_.copy(this.charBuffer,0,0,L),p.substring(0,A)}return p},g.prototype.detectIncompleteChar=function(_){for(var p=_.length>=3?3:_.length;p>0;p--){var T=_[_.length-p];if(p==1&&T>>5==6){this.charLength=2;break}if(p<=2&&T>>4==14){this.charLength=3;break}if(p<=3&&T>>3==30){this.charLength=4;break}}this.charReceived=p},g.prototype.end=function(_){var p="";if(_&&_.length&&(p=this.write(_)),this.charReceived){var T=this.charReceived,A=this.charBuffer,b=this.encoding;p+=A.slice(0,T).toString(b)}return p};function E(_){return _.toString(this.encoding)}function w(_){this.charReceived=_.length%2,this.charLength=this.charReceived?2:0}function f(_){this.charReceived=_.length%3,this.charLength=this.charReceived?3:0}},function(l,o,s){"use strict";l.exports=E;var c=s(21),d=s(18);d.inherits=s(12),d.inherits(E,c);function y(f){this.afterTransform=function(_,p){return g(f,_,p)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function g(f,_,p){var T=f._transformState;T.transforming=!1;var A=T.writecb;if(!A)return f.emit("error",new Error("no writecb in Transform class"));T.writechunk=null,T.writecb=null,p!=null&&f.push(p),A(_);var b=f._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&f._read(b.highWaterMark)}function E(f){if(!(this instanceof E))return new E(f);c.call(this,f),this._transformState=new y(this);var _=this;this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(p,T){w(_,p,T)}):w(_)})}E.prototype.push=function(f,_){return this._transformState.needTransform=!1,c.prototype.push.call(this,f,_)},E.prototype._transform=function(f,_,p){throw new Error("_transform() is not implemented")},E.prototype._write=function(f,_,p){var T=this._transformState;if(T.writecb=p,T.writechunk=f,T.writeencoding=_,!T.transforming){var A=this._readableState;(T.needTransform||A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}},E.prototype._read=function(f){var _=this._transformState;_.writechunk!==null&&_.writecb&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0};function w(f,_,p){if(_)return f.emit("error",_);p!=null&&f.push(p);var T=f._writableState,A=f._transformState;if(T.length)throw new Error("Calling transform done when ws.length != 0");if(A.transforming)throw new Error("Calling transform done when still transforming");return f.push(null)}},function(l,o,s){"use strict";l.exports=y;var c=s(25),d=s(18);d.inherits=s(12),d.inherits(y,c);function y(g){if(!(this instanceof y))return new y(g);c.call(this,g)}y.prototype._transform=function(g,E,w){w(null,g)}},function(l,o,s){l.exports=s(22)},function(l,o,s){l.exports=s(21)},function(l,o,s){l.exports=s(25)},function(l,o,s){l.exports=s(26)},function(l,o,s){"use strict";var c=s(32),d=s(33),y=s(38),g=s(39),E=s(40),w=s(41),f=s(42),_=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},b||{});var L=this.options;L.raw&&L.windowBits>=0&&L.windowBits<16&&(L.windowBits=-L.windowBits,L.windowBits===0&&(L.windowBits=-15)),L.windowBits>=0&&L.windowBits<16&&!(b&&b.windowBits)&&(L.windowBits+=32),L.windowBits>15&&L.windowBits<48&&(L.windowBits&15)===0&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var C=c.inflateInit2(this.strm,L.windowBits);if(C!==g.Z_OK)throw new Error(E[C]);this.header=new f,c.inflateGetHeader(this.strm,this.header)}p.prototype.push=function(b,L){var C=this.strm,G=this.options.chunkSize,W=this.options.dictionary,M,Et,et,wt,pt,U,tt=!1;if(this.ended)return!1;Et=L===~~L?L:L===!0?g.Z_FINISH:g.Z_NO_FLUSH,typeof b=="string"?C.input=y.binstring2buf(b):_.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new d.Buf8(G),C.next_out=0,C.avail_out=G),M=c.inflate(C,g.Z_NO_FLUSH),M===g.Z_NEED_DICT&&W&&(typeof W=="string"?U=y.string2buf(W):_.call(W)==="[object ArrayBuffer]"?U=new Uint8Array(W):U=W,M=c.inflateSetDictionary(this.strm,U)),M===g.Z_BUF_ERROR&&tt===!0&&(M=g.Z_OK,tt=!1),M!==g.Z_STREAM_END&&M!==g.Z_OK)return this.onEnd(M),this.ended=!0,!1;C.next_out&&(C.avail_out===0||M===g.Z_STREAM_END||C.avail_in===0&&(Et===g.Z_FINISH||Et===g.Z_SYNC_FLUSH))&&(this.options.to==="string"?(et=y.utf8border(C.output,C.next_out),wt=C.next_out-et,pt=y.buf2string(C.output,et),C.next_out=wt,C.avail_out=G-wt,wt&&d.arraySet(C.output,C.output,et,wt,0),this.onData(pt)):this.onData(d.shrinkBuf(C.output,C.next_out))),C.avail_in===0&&C.avail_out===0&&(tt=!0)}while((C.avail_in>0||C.avail_out===0)&&M!==g.Z_STREAM_END);return M===g.Z_STREAM_END&&(Et=g.Z_FINISH),Et===g.Z_FINISH?(M=c.inflateEnd(this.strm),this.onEnd(M),this.ended=!0,M===g.Z_OK):(Et===g.Z_SYNC_FLUSH&&(this.onEnd(g.Z_OK),C.avail_out=0),!0)},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===g.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function T(b,L){var C=new p(L);if(C.push(b,!0),C.err)throw C.msg||E[C.err];return C.result}function A(b,L){return L=L||{},L.raw=!0,T(b,L)}o.Inflate=p,o.inflate=T,o.inflateRaw=A,o.ungzip=T},function(l,o,s){"use strict";var c=s(33),d=s(34),y=s(35),g=s(36),E=s(37),w=0,f=1,_=2,p=4,T=5,A=6,b=0,L=1,C=2,G=-2,W=-3,M=-4,Et=-5,et=8,wt=1,pt=2,U=3,tt=4,ft=5,Rt=6,dt=7,Lt=8,kt=9,St=10,Xt=11,P=12,z=13,K=14,ut=15,It=16,vt=17,xt=18,Nt=19,jt=20,Ct=21,te=22,R=23,N=24,Y=25,Q=26,ht=27,it=28,_t=29,gt=30,Yt=31,ue=32,Fe=852,I=592,v=15,m=v;function k(j){return(j>>>24&255)+(j>>>8&65280)+((j&65280)<<8)+((j&255)<<24)}function B(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new c.Buf16(320),this.work=new c.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function q(j){var ot;return!j||!j.state?G:(ot=j.state,j.total_in=j.total_out=ot.total=0,j.msg="",ot.wrap&&(j.adler=ot.wrap&1),ot.mode=wt,ot.last=0,ot.havedict=0,ot.dmax=32768,ot.head=null,ot.hold=0,ot.bits=0,ot.lencode=ot.lendyn=new c.Buf32(Fe),ot.distcode=ot.distdyn=new c.Buf32(I),ot.sane=1,ot.back=-1,b)}function J(j){var ot;return!j||!j.state?G:(ot=j.state,ot.wsize=0,ot.whave=0,ot.wnext=0,q(j))}function bt(j,ot){var F,at;return!j||!j.state||(at=j.state,ot<0?(F=0,ot=-ot):(F=(ot>>4)+1,ot<48&&(ot&=15)),ot&&(ot<8||ot>15))?G:(at.window!==null&&at.wbits!==ot&&(at.window=null),at.wrap=F,at.wbits=ot,J(j))}function At(j,ot){var F,at;return j?(at=new B,j.state=at,at.window=null,F=bt(j,ot),F!==b&&(j.state=null),F):G}function Bt(j){return At(j,m)}var Gt=!0,Dt,Ie;function nr(j){if(Gt){var ot;for(Dt=new c.Buf32(512),Ie=new c.Buf32(32),ot=0;ot<144;)j.lens[ot++]=8;for(;ot<256;)j.lens[ot++]=9;for(;ot<280;)j.lens[ot++]=7;for(;ot<288;)j.lens[ot++]=8;for(E(f,j.lens,0,288,Dt,0,j.work,{bits:9}),ot=0;ot<32;)j.lens[ot++]=5;E(_,j.lens,0,32,Ie,0,j.work,{bits:5}),Gt=!1}j.lencode=Dt,j.lenbits=9,j.distcode=Ie,j.distbits=5}function Ve(j,ot,F,at){var Mt,nt=j.state;return nt.window===null&&(nt.wsize=1<<nt.wbits,nt.wnext=0,nt.whave=0,nt.window=new c.Buf8(nt.wsize)),at>=nt.wsize?(c.arraySet(nt.window,ot,F-nt.wsize,nt.wsize,0),nt.wnext=0,nt.whave=nt.wsize):(Mt=nt.wsize-nt.wnext,Mt>at&&(Mt=at),c.arraySet(nt.window,ot,F-at,Mt,nt.wnext),at-=Mt,at?(c.arraySet(nt.window,ot,F-at,at,0),nt.wnext=at,nt.whave=nt.wsize):(nt.wnext+=Mt,nt.wnext===nt.wsize&&(nt.wnext=0),nt.whave<nt.wsize&&(nt.whave+=Mt))),0}function qe(j,ot){var F,at,Mt,nt,ce,st,Jt,X,Z,or,Ut,lt,Ze,De,Wt=0,Tt,re,ae,ie,sr,Xe,qt,fe,ee=new c.Buf8(4),be,Se,Pr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return G;F=j.state,F.mode===P&&(F.mode=z),ce=j.next_out,Mt=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,Z=F.bits,or=st,Ut=Jt,fe=b;t:for(;;)switch(F.mode){case wt:if(F.wrap===0){F.mode=z;break}for(;Z<16;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(F.wrap&2&&X===35615){F.check=0,ee[0]=X&255,ee[1]=X>>>8&255,F.check=y(F.check,ee,2,0),X=0,Z=0,F.mode=pt;break}if(F.flags=0,F.head&&(F.head.done=!1),!(F.wrap&1)||(((X&255)<<8)+(X>>8))%31){j.msg="incorrect header check",F.mode=gt;break}if((X&15)!==et){j.msg="unknown compression method",F.mode=gt;break}if(X>>>=4,Z-=4,qt=(X&15)+8,F.wbits===0)F.wbits=qt;else if(qt>F.wbits){j.msg="invalid window size",F.mode=gt;break}F.dmax=1<<qt,j.adler=F.check=1,F.mode=X&512?St:P,X=0,Z=0;break;case pt:for(;Z<16;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(F.flags=X,(F.flags&255)!==et){j.msg="unknown compression method",F.mode=gt;break}if(F.flags&57344){j.msg="unknown header flags set",F.mode=gt;break}F.head&&(F.head.text=X>>8&1),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=y(F.check,ee,2,0)),X=0,Z=0,F.mode=U;case U:for(;Z<32;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.head&&(F.head.time=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,ee[2]=X>>>16&255,ee[3]=X>>>24&255,F.check=y(F.check,ee,4,0)),X=0,Z=0,F.mode=tt;case tt:for(;Z<16;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.head&&(F.head.xflags=X&255,F.head.os=X>>8),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=y(F.check,ee,2,0)),X=0,Z=0,F.mode=ft;case ft:if(F.flags&1024){for(;Z<16;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.length=X,F.head&&(F.head.extra_len=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=y(F.check,ee,2,0)),X=0,Z=0}else F.head&&(F.head.extra=null);F.mode=Rt;case Rt:if(F.flags&1024&&(lt=F.length,lt>st&&(lt=st),lt&&(F.head&&(qt=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),c.arraySet(F.head.extra,at,nt,lt,qt)),F.flags&512&&(F.check=y(F.check,at,lt,nt)),st-=lt,nt+=lt,F.length-=lt),F.length))break t;F.length=0,F.mode=dt;case dt:if(F.flags&2048){if(st===0)break t;lt=0;do qt=at[nt+lt++],F.head&&qt&&F.length<65536&&(F.head.name+=String.fromCharCode(qt));while(qt&&lt<st);if(F.flags&512&&(F.check=y(F.check,at,lt,nt)),st-=lt,nt+=lt,qt)break t}else F.head&&(F.head.name=null);F.length=0,F.mode=Lt;case Lt:if(F.flags&4096){if(st===0)break t;lt=0;do qt=at[nt+lt++],F.head&&qt&&F.length<65536&&(F.head.comment+=String.fromCharCode(qt));while(qt&&lt<st);if(F.flags&512&&(F.check=y(F.check,at,lt,nt)),st-=lt,nt+=lt,qt)break t}else F.head&&(F.head.comment=null);F.mode=kt;case kt:if(F.flags&512){for(;Z<16;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(X!==(F.check&65535)){j.msg="header crc mismatch",F.mode=gt;break}X=0,Z=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),j.adler=F.check=0,F.mode=P;break;case St:for(;Z<32;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}j.adler=F.check=k(X),X=0,Z=0,F.mode=Xt;case Xt:if(F.havedict===0)return j.next_out=ce,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=Z,C;j.adler=F.check=1,F.mode=P;case P:if(ot===T||ot===A)break t;case z:if(F.last){X>>>=Z&7,Z-=Z&7,F.mode=ht;break}for(;Z<3;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}switch(F.last=X&1,X>>>=1,Z-=1,X&3){case 0:F.mode=K;break;case 1:if(nr(F),F.mode=jt,ot===A){X>>>=2,Z-=2;break t}break;case 2:F.mode=vt;break;case 3:j.msg="invalid block type",F.mode=gt}X>>>=2,Z-=2;break;case K:for(X>>>=Z&7,Z-=Z&7;Z<32;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if((X&65535)!==(X>>>16^65535)){j.msg="invalid stored block lengths",F.mode=gt;break}if(F.length=X&65535,X=0,Z=0,F.mode=ut,ot===A)break t;case ut:F.mode=It;case It:if(lt=F.length,lt){if(lt>st&&(lt=st),lt>Jt&&(lt=Jt),lt===0)break t;c.arraySet(Mt,at,nt,lt,ce),st-=lt,nt+=lt,Jt-=lt,ce+=lt,F.length-=lt;break}F.mode=P;break;case vt:for(;Z<14;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(F.nlen=(X&31)+257,X>>>=5,Z-=5,F.ndist=(X&31)+1,X>>>=5,Z-=5,F.ncode=(X&15)+4,X>>>=4,Z-=4,F.nlen>286||F.ndist>30){j.msg="too many length or distance symbols",F.mode=gt;break}F.have=0,F.mode=xt;case xt:for(;F.have<F.ncode;){for(;Z<3;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.lens[Pr[F.have++]]=X&7,X>>>=3,Z-=3}for(;F.have<19;)F.lens[Pr[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,be={bits:F.lenbits},fe=E(w,F.lens,0,19,F.lencode,0,F.work,be),F.lenbits=be.bits,fe){j.msg="invalid code lengths set",F.mode=gt;break}F.have=0,F.mode=Nt;case Nt:for(;F.have<F.nlen+F.ndist;){for(;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=Z);){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(ae<16)X>>>=Tt,Z-=Tt,F.lens[F.have++]=ae;else{if(ae===16){for(Se=Tt+2;Z<Se;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(X>>>=Tt,Z-=Tt,F.have===0){j.msg="invalid bit length repeat",F.mode=gt;break}qt=F.lens[F.have-1],lt=3+(X&3),X>>>=2,Z-=2}else if(ae===17){for(Se=Tt+3;Z<Se;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}X>>>=Tt,Z-=Tt,qt=0,lt=3+(X&7),X>>>=3,Z-=3}else{for(Se=Tt+7;Z<Se;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}X>>>=Tt,Z-=Tt,qt=0,lt=11+(X&127),X>>>=7,Z-=7}if(F.have+lt>F.nlen+F.ndist){j.msg="invalid bit length repeat",F.mode=gt;break}for(;lt--;)F.lens[F.have++]=qt}}if(F.mode===gt)break;if(F.lens[256]===0){j.msg="invalid code -- missing end-of-block",F.mode=gt;break}if(F.lenbits=9,be={bits:F.lenbits},fe=E(f,F.lens,0,F.nlen,F.lencode,0,F.work,be),F.lenbits=be.bits,fe){j.msg="invalid literal/lengths set",F.mode=gt;break}if(F.distbits=6,F.distcode=F.distdyn,be={bits:F.distbits},fe=E(_,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,be),F.distbits=be.bits,fe){j.msg="invalid distances set",F.mode=gt;break}if(F.mode=jt,ot===A)break t;case jt:F.mode=Ct;case Ct:if(st>=6&&Jt>=258){j.next_out=ce,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=Z,g(j,Ut),ce=j.next_out,Mt=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,Z=F.bits,F.mode===P&&(F.back=-1);break}for(F.back=0;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=Z);){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(re&&(re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.lencode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=Z);){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}X>>>=ie,Z-=ie,F.back+=ie}if(X>>>=Tt,Z-=Tt,F.back+=Tt,F.length=ae,re===0){F.mode=Q;break}if(re&32){F.back=-1,F.mode=P;break}if(re&64){j.msg="invalid literal/length code",F.mode=gt;break}F.extra=re&15,F.mode=te;case te:if(F.extra){for(Se=F.extra;Z<Se;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.length+=X&(1<<F.extra)-1,X>>>=F.extra,Z-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=R;case R:for(;Wt=F.distcode[X&(1<<F.distbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=Z);){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if((re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.distcode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=Z);){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}X>>>=ie,Z-=ie,F.back+=ie}if(X>>>=Tt,Z-=Tt,F.back+=Tt,re&64){j.msg="invalid distance code",F.mode=gt;break}F.offset=ae,F.extra=re&15,F.mode=N;case N:if(F.extra){for(Se=F.extra;Z<Se;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}F.offset+=X&(1<<F.extra)-1,X>>>=F.extra,Z-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){j.msg="invalid distance too far back",F.mode=gt;break}F.mode=Y;case Y:if(Jt===0)break t;if(lt=Ut-Jt,F.offset>lt){if(lt=F.offset-lt,lt>F.whave&&F.sane){j.msg="invalid distance too far back",F.mode=gt;break}lt>F.wnext?(lt-=F.wnext,Ze=F.wsize-lt):Ze=F.wnext-lt,lt>F.length&&(lt=F.length),De=F.window}else De=Mt,Ze=ce-F.offset,lt=F.length;lt>Jt&&(lt=Jt),Jt-=lt,F.length-=lt;do Mt[ce++]=De[Ze++];while(--lt);F.length===0&&(F.mode=Ct);break;case Q:if(Jt===0)break t;Mt[ce++]=F.length,Jt--,F.mode=Ct;break;case ht:if(F.wrap){for(;Z<32;){if(st===0)break t;st--,X|=at[nt++]<<Z,Z+=8}if(Ut-=Jt,j.total_out+=Ut,F.total+=Ut,Ut&&(j.adler=F.check=F.flags?y(F.check,Mt,Ut,ce-Ut):d(F.check,Mt,Ut,ce-Ut)),Ut=Jt,(F.flags?X:k(X))!==F.check){j.msg="incorrect data check",F.mode=gt;break}X=0,Z=0}F.mode=it;case it:if(F.wrap&&F.flags){for(;Z<32;){if(st===0)break t;st--,X+=at[nt++]<<Z,Z+=8}if(X!==(F.total&4294967295)){j.msg="incorrect length check",F.mode=gt;break}X=0,Z=0}F.mode=_t;case _t:fe=L;break t;case gt:fe=W;break t;case Yt:return M;case ue:default:return G}return j.next_out=ce,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=Z,(F.wsize||Ut!==j.avail_out&&F.mode<gt&&(F.mode<ht||ot!==p))&&Ve(j,j.output,j.next_out,Ut-j.avail_out)?(F.mode=Yt,M):(or-=j.avail_in,Ut-=j.avail_out,j.total_in+=or,j.total_out+=Ut,F.total+=Ut,F.wrap&&Ut&&(j.adler=F.check=F.flags?y(F.check,Mt,Ut,j.next_out-Ut):d(F.check,Mt,Ut,j.next_out-Ut)),j.data_type=F.bits+(F.last?64:0)+(F.mode===P?128:0)+(F.mode===jt||F.mode===ut?256:0),(or===0&&Ut===0||ot===p)&&fe===b&&(fe=Et),fe)}function si(j){if(!j||!j.state)return G;var ot=j.state;return ot.window&&(ot.window=null),j.state=null,b}function ai(j,ot){var F;return!j||!j.state||(F=j.state,(F.wrap&2)===0)?G:(F.head=ot,ot.done=!1,b)}function ui(j,ot){var F=ot.length,at,Mt,nt;return!j||!j.state||(at=j.state,at.wrap!==0&&at.mode!==Xt)?G:at.mode===Xt&&(Mt=1,Mt=d(Mt,ot,F,0),Mt!==at.check)?W:(nt=Ve(j,ot,F,F),nt?(at.mode=Yt,M):(at.havedict=1,b))}o.inflateReset=J,o.inflateReset2=bt,o.inflateResetKeep=q,o.inflateInit=Bt,o.inflateInit2=At,o.inflate=qe,o.inflateEnd=si,o.inflateGetHeader=ai,o.inflateSetDictionary=ui,o.inflateInfo="pako inflate (from Nodeca project)"},function(l,o){"use strict";var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(y){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var E=g.shift();if(!!E){if(typeof E!="object")throw new TypeError(E+"must be non-object");for(var w in E)E.hasOwnProperty(w)&&(y[w]=E[w])}}return y},o.shrinkBuf=function(y,g){return y.length===g?y:y.subarray?y.subarray(0,g):(y.length=g,y)};var c={arraySet:function(y,g,E,w,f){if(g.subarray&&y.subarray){y.set(g.subarray(E,E+w),f);return}for(var _=0;_<w;_++)y[f+_]=g[E+_]},flattenChunks:function(y){var g,E,w,f,_,p;for(w=0,g=0,E=y.length;g<E;g++)w+=y[g].length;for(p=new Uint8Array(w),f=0,g=0,E=y.length;g<E;g++)_=y[g],p.set(_,f),f+=_.length;return p}},d={arraySet:function(y,g,E,w,f){for(var _=0;_<w;_++)y[f+_]=g[E+_]},flattenChunks:function(y){return[].concat.apply([],y)}};o.setTyped=function(y){y?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,c)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,d))},o.setTyped(s)},function(l,o){"use strict";function s(c,d,y,g){for(var E=c&65535|0,w=c>>>16&65535|0,f=0;y!==0;){f=y>2e3?2e3:y,y-=f;do E=E+d[g++]|0,w=w+E|0;while(--f);E%=65521,w%=65521}return E|w<<16|0}l.exports=s},function(l,o){"use strict";function s(){for(var y,g=[],E=0;E<256;E++){y=E;for(var w=0;w<8;w++)y=y&1?3988292384^y>>>1:y>>>1;g[E]=y}return g}var c=s();function d(y,g,E,w){var f=c,_=w+E;y^=-1;for(var p=w;p<_;p++)y=y>>>8^f[(y^g[p])&255];return y^-1}l.exports=d},function(l,o){"use strict";var s=30,c=12;l.exports=function(y,g){var E,w,f,_,p,T,A,b,L,C,G,W,M,Et,et,wt,pt,U,tt,ft,Rt,dt,Lt,kt,St;E=y.state,w=y.next_in,kt=y.input,f=w+(y.avail_in-5),_=y.next_out,St=y.output,p=_-(g-y.avail_out),T=_+(y.avail_out-257),A=E.dmax,b=E.wsize,L=E.whave,C=E.wnext,G=E.window,W=E.hold,M=E.bits,Et=E.lencode,et=E.distcode,wt=(1<<E.lenbits)-1,pt=(1<<E.distbits)-1;t:do{M<15&&(W+=kt[w++]<<M,M+=8,W+=kt[w++]<<M,M+=8),U=Et[W&wt];e:for(;;){if(tt=U>>>24,W>>>=tt,M-=tt,tt=U>>>16&255,tt===0)St[_++]=U&65535;else if(tt&16){ft=U&65535,tt&=15,tt&&(M<tt&&(W+=kt[w++]<<M,M+=8),ft+=W&(1<<tt)-1,W>>>=tt,M-=tt),M<15&&(W+=kt[w++]<<M,M+=8,W+=kt[w++]<<M,M+=8),U=et[W&pt];r:for(;;){if(tt=U>>>24,W>>>=tt,M-=tt,tt=U>>>16&255,tt&16){if(Rt=U&65535,tt&=15,M<tt&&(W+=kt[w++]<<M,M+=8,M<tt&&(W+=kt[w++]<<M,M+=8)),Rt+=W&(1<<tt)-1,Rt>A){y.msg="invalid distance too far back",E.mode=s;break t}if(W>>>=tt,M-=tt,tt=_-p,Rt>tt){if(tt=Rt-tt,tt>L&&E.sane){y.msg="invalid distance too far back",E.mode=s;break t}if(dt=0,Lt=G,C===0){if(dt+=b-tt,tt<ft){ft-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}}else if(C<tt){if(dt+=b+C-tt,tt-=C,tt<ft){ft-=tt;do St[_++]=G[dt++];while(--tt);if(dt=0,C<ft){tt=C,ft-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}}}else if(dt+=C-tt,tt<ft){ft-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}for(;ft>2;)St[_++]=Lt[dt++],St[_++]=Lt[dt++],St[_++]=Lt[dt++],ft-=3;ft&&(St[_++]=Lt[dt++],ft>1&&(St[_++]=Lt[dt++]))}else{dt=_-Rt;do St[_++]=St[dt++],St[_++]=St[dt++],St[_++]=St[dt++],ft-=3;while(ft>2);ft&&(St[_++]=St[dt++],ft>1&&(St[_++]=St[dt++]))}}else if((tt&64)===0){U=et[(U&65535)+(W&(1<<tt)-1)];continue r}else{y.msg="invalid distance code",E.mode=s;break t}break}}else if((tt&64)===0){U=Et[(U&65535)+(W&(1<<tt)-1)];continue e}else if(tt&32){E.mode=c;break t}else{y.msg="invalid literal/length code",E.mode=s;break t}break}}while(w<f&&_<T);ft=M>>3,w-=ft,M-=ft<<3,W&=(1<<M)-1,y.next_in=w,y.next_out=_,y.avail_in=w<f?5+(f-w):5-(w-f),y.avail_out=_<T?257+(T-_):257-(_-T),E.hold=W,E.bits=M}},function(l,o,s){"use strict";var c=s(33),d=15,y=852,g=592,E=0,w=1,f=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],A=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];l.exports=function(L,C,G,W,M,Et,et,wt){var pt=wt.bits,U=0,tt=0,ft=0,Rt=0,dt=0,Lt=0,kt=0,St=0,Xt=0,P=0,z,K,ut,It,vt,xt=null,Nt=0,jt,Ct=new c.Buf16(d+1),te=new c.Buf16(d+1),R=null,N=0,Y,Q,ht;for(U=0;U<=d;U++)Ct[U]=0;for(tt=0;tt<W;tt++)Ct[C[G+tt]]++;for(dt=pt,Rt=d;Rt>=1&&Ct[Rt]===0;Rt--);if(dt>Rt&&(dt=Rt),Rt===0)return M[Et++]=1<<24|64<<16|0,M[Et++]=1<<24|64<<16|0,wt.bits=1,0;for(ft=1;ft<Rt&&Ct[ft]===0;ft++);for(dt<ft&&(dt=ft),St=1,U=1;U<=d;U++)if(St<<=1,St-=Ct[U],St<0)return-1;if(St>0&&(L===E||Rt!==1))return-1;for(te[1]=0,U=1;U<d;U++)te[U+1]=te[U]+Ct[U];for(tt=0;tt<W;tt++)C[G+tt]!==0&&(et[te[C[G+tt]]++]=tt);if(L===E?(xt=R=et,jt=19):L===w?(xt=_,Nt-=257,R=p,N-=257,jt=256):(xt=T,R=A,jt=-1),P=0,tt=0,U=ft,vt=Et,Lt=dt,kt=0,ut=-1,Xt=1<<dt,It=Xt-1,L===w&&Xt>y||L===f&&Xt>g)return 1;for(;;){Y=U-kt,et[tt]<jt?(Q=0,ht=et[tt]):et[tt]>jt?(Q=R[N+et[tt]],ht=xt[Nt+et[tt]]):(Q=32+64,ht=0),z=1<<U-kt,K=1<<Lt,ft=K;do K-=z,M[vt+(P>>kt)+K]=Y<<24|Q<<16|ht|0;while(K!==0);for(z=1<<U-1;P&z;)z>>=1;if(z!==0?(P&=z-1,P+=z):P=0,tt++,--Ct[U]===0){if(U===Rt)break;U=C[G+et[tt]]}if(U>dt&&(P&It)!==ut){for(kt===0&&(kt=dt),vt+=ft,Lt=U-kt,St=1<<Lt;Lt+kt<Rt&&(St-=Ct[Lt+kt],!(St<=0));)Lt++,St<<=1;if(Xt+=1<<Lt,L===w&&Xt>y||L===f&&Xt>g)return 1;ut=P&It,M[ut]=dt<<24|Lt<<16|vt-Et|0}}return P!==0&&(M[vt+P]=U-kt<<24|64<<16|0),wt.bits=dt,0}},function(l,o,s){"use strict";var c=s(33),d=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{d=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var g=new c.Buf8(256),E=0;E<256;E++)g[E]=E>=252?6:E>=248?5:E>=240?4:E>=224?3:E>=192?2:1;g[254]=g[254]=1,o.string2buf=function(f){var _,p,T,A,b,L=f.length,C=0;for(A=0;A<L;A++)p=f.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=f.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),C+=p<128?1:p<2048?2:p<65536?3:4;for(_=new c.Buf8(C),b=0,A=0;b<C;A++)p=f.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=f.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),p<128?_[b++]=p:p<2048?(_[b++]=192|p>>>6,_[b++]=128|p&63):p<65536?(_[b++]=224|p>>>12,_[b++]=128|p>>>6&63,_[b++]=128|p&63):(_[b++]=240|p>>>18,_[b++]=128|p>>>12&63,_[b++]=128|p>>>6&63,_[b++]=128|p&63);return _};function w(f,_){if(_<65537&&(f.subarray&&y||!f.subarray&&d))return String.fromCharCode.apply(null,c.shrinkBuf(f,_));for(var p="",T=0;T<_;T++)p+=String.fromCharCode(f[T]);return p}o.buf2binstring=function(f){return w(f,f.length)},o.binstring2buf=function(f){for(var _=new c.Buf8(f.length),p=0,T=_.length;p<T;p++)_[p]=f.charCodeAt(p);return _},o.buf2string=function(f,_){var p,T,A,b,L=_||f.length,C=new Array(L*2);for(T=0,p=0;p<L;){if(A=f[p++],A<128){C[T++]=A;continue}if(b=g[A],b>4){C[T++]=65533,p+=b-1;continue}for(A&=b===2?31:b===3?15:7;b>1&&p<L;)A=A<<6|f[p++]&63,b--;if(b>1){C[T++]=65533;continue}A<65536?C[T++]=A:(A-=65536,C[T++]=55296|A>>10&1023,C[T++]=56320|A&1023)}return w(C,T)},o.utf8border=function(f,_){var p;for(_=_||f.length,_>f.length&&(_=f.length),p=_-1;p>=0&&(f[p]&192)===128;)p--;return p<0||p===0?_:p+g[f[p]]>_?p:_}},function(l,o){"use strict";l.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(l,o){"use strict";l.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(l,o){"use strict";function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}l.exports=s},function(l,o){"use strict";function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}l.exports=s}])})});var mo=yr(ri=>{"use strict";ri.byteLength=fu;ri.toByteArray=hu;ri.fromByteArray=yu;var Ae=[],xe=[],cu=typeof Uint8Array<"u"?Uint8Array:Array,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(rr=0,go=ki.length;rr<go;++rr)Ae[rr]=ki[rr],xe[ki.charCodeAt(rr)]=rr;var rr,go;xe["-".charCodeAt(0)]=62;xe["_".charCodeAt(0)]=63;function vo(l){var o=l.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=l.indexOf("=");s===-1&&(s=o);var c=s===o?0:4-s%4;return[s,c]}function fu(l){var o=vo(l),s=o[0],c=o[1];return(s+c)*3/4-c}function lu(l,o,s){return(o+s)*3/4-s}function hu(l){var o,s=vo(l),c=s[0],d=s[1],y=new cu(lu(l,c,d)),g=0,E=d>0?c-4:c,w;for(w=0;w<E;w+=4)o=xe[l.charCodeAt(w)]<<18|xe[l.charCodeAt(w+1)]<<12|xe[l.charCodeAt(w+2)]<<6|xe[l.charCodeAt(w+3)],y[g++]=o>>16&255,y[g++]=o>>8&255,y[g++]=o&255;return d===2&&(o=xe[l.charCodeAt(w)]<<2|xe[l.charCodeAt(w+1)]>>4,y[g++]=o&255),d===1&&(o=xe[l.charCodeAt(w)]<<10|xe[l.charCodeAt(w+1)]<<4|xe[l.charCodeAt(w+2)]>>2,y[g++]=o>>8&255,y[g++]=o&255),y}function pu(l){return Ae[l>>18&63]+Ae[l>>12&63]+Ae[l>>6&63]+Ae[l&63]}function du(l,o,s){for(var c,d=[],y=o;y<s;y+=3)c=(l[y]<<16&16711680)+(l[y+1]<<8&65280)+(l[y+2]&255),d.push(pu(c));return d.join("")}function yu(l){for(var o,s=l.length,c=s%3,d=[],y=16383,g=0,E=s-c;g<E;g+=y)d.push(du(l,g,g+y>E?E:g+y));return c===1?(o=l[s-1],d.push(Ae[o>>2]+Ae[o<<4&63]+"==")):c===2&&(o=(l[s-2]<<8)+l[s-1],d.push(Ae[o>>10]+Ae[o>>4&63]+Ae[o<<2&63]+"=")),d.join("")}});var wo=yr(Ri=>{Ri.read=function(l,o,s,c,d){var y,g,E=d*8-c-1,w=(1<<E)-1,f=w>>1,_=-7,p=s?d-1:0,T=s?-1:1,A=l[o+p];for(p+=T,y=A&(1<<-_)-1,A>>=-_,_+=E;_>0;y=y*256+l[o+p],p+=T,_-=8);for(g=y&(1<<-_)-1,y>>=-_,_+=c;_>0;g=g*256+l[o+p],p+=T,_-=8);if(y===0)y=1-f;else{if(y===w)return g?NaN:(A?-1:1)*(1/0);g=g+Math.pow(2,c),y=y-f}return(A?-1:1)*g*Math.pow(2,y-c)};Ri.write=function(l,o,s,c,d,y){var g,E,w,f=y*8-d-1,_=(1<<f)-1,p=_>>1,T=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=c?0:y-1,b=c?1:-1,L=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(E=isNaN(o)?1:0,g=_):(g=Math.floor(Math.log(o)/Math.LN2),o*(w=Math.pow(2,-g))<1&&(g--,w*=2),g+p>=1?o+=T/w:o+=T*Math.pow(2,1-p),o*w>=2&&(g++,w/=2),g+p>=_?(E=0,g=_):g+p>=1?(E=(o*w-1)*Math.pow(2,d),g=g+p):(E=o*Math.pow(2,p-1)*Math.pow(2,d),g=0));d>=8;l[s+A]=E&255,A+=b,E/=256,d-=8);for(g=g<<d|E,f+=d;f>0;l[s+A]=g&255,A+=b,g/=256,f-=8);l[s+A-b]|=L*128}});var Bo=yr(Sr=>{"use strict";var Ni=mo(),mr=wo(),So=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Sr.Buffer=H;Sr.SlowBuffer=Eu;Sr.INSPECT_MAX_BYTES=50;var ii=2147483647;Sr.kMaxLength=ii;H.TYPED_ARRAY_SUPPORT=gu();!H.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function gu(){try{let l=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(l,o),l.foo()===42}catch{return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.byteOffset}});function ze(l){if(l>ii)throw new RangeError('The value "'+l+'" is invalid for option "size"');let o=new Uint8Array(l);return Object.setPrototypeOf(o,H.prototype),o}function H(l,o,s){if(typeof l=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Li(l)}return Fo(l,o,s)}H.poolSize=8192;function Fo(l,o,s){if(typeof l=="string")return mu(l,o);if(ArrayBuffer.isView(l))return wu(l);if(l==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l);if(Le(l,ArrayBuffer)||l&&Le(l.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Le(l,SharedArrayBuffer)||l&&Le(l.buffer,SharedArrayBuffer)))return Oi(l,o,s);if(typeof l=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let c=l.valueOf&&l.valueOf();if(c!=null&&c!==l)return H.from(c,o,s);let d=Su(l);if(d)return d;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof l[Symbol.toPrimitive]=="function")return H.from(l[Symbol.toPrimitive]("string"),o,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l)}H.from=function(l,o,s){return Fo(l,o,s)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function Io(l){if(typeof l!="number")throw new TypeError('"size" argument must be of type number');if(l<0)throw new RangeError('The value "'+l+'" is invalid for option "size"')}function vu(l,o,s){return Io(l),l<=0?ze(l):o!==void 0?typeof s=="string"?ze(l).fill(o,s):ze(l).fill(o):ze(l)}H.alloc=function(l,o,s){return vu(l,o,s)};function Li(l){return Io(l),ze(l<0?0:Di(l)|0)}H.allocUnsafe=function(l){return Li(l)};H.allocUnsafeSlow=function(l){return Li(l)};function mu(l,o){if((typeof o!="string"||o==="")&&(o="utf8"),!H.isEncoding(o))throw new TypeError("Unknown encoding: "+o);let s=bo(l,o)|0,c=ze(s),d=c.write(l,o);return d!==s&&(c=c.slice(0,d)),c}function Ti(l){let o=l.length<0?0:Di(l.length)|0,s=ze(o);for(let c=0;c<o;c+=1)s[c]=l[c]&255;return s}function wu(l){if(Le(l,Uint8Array)){let o=new Uint8Array(l);return Oi(o.buffer,o.byteOffset,o.byteLength)}return Ti(l)}function Oi(l,o,s){if(o<0||l.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(l.byteLength<o+(s||0))throw new RangeError('"length" is outside of buffer bounds');let c;return o===void 0&&s===void 0?c=new Uint8Array(l):s===void 0?c=new Uint8Array(l,o):c=new Uint8Array(l,o,s),Object.setPrototypeOf(c,H.prototype),c}function Su(l){if(H.isBuffer(l)){let o=Di(l.length)|0,s=ze(o);return s.length===0||l.copy(s,0,0,o),s}if(l.length!==void 0)return typeof l.length!="number"||Bi(l.length)?ze(0):Ti(l);if(l.type==="Buffer"&&Array.isArray(l.data))return Ti(l.data)}function Di(l){if(l>=ii)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ii.toString(16)+" bytes");return l|0}function Eu(l){return+l!=l&&(l=0),H.alloc(+l)}H.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==H.prototype};H.compare=function(o,s){if(Le(o,Uint8Array)&&(o=H.from(o,o.offset,o.byteLength)),Le(s,Uint8Array)&&(s=H.from(s,s.offset,s.byteLength)),!H.isBuffer(o)||!H.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===s)return 0;let c=o.length,d=s.length;for(let y=0,g=Math.min(c,d);y<g;++y)if(o[y]!==s[y]){c=o[y],d=s[y];break}return c<d?-1:d<c?1:0};H.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(o,s){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return H.alloc(0);let c;if(s===void 0)for(s=0,c=0;c<o.length;++c)s+=o[c].length;let d=H.allocUnsafe(s),y=0;for(c=0;c<o.length;++c){let g=o[c];if(Le(g,Uint8Array))y+g.length>d.length?(H.isBuffer(g)||(g=H.from(g)),g.copy(d,y)):Uint8Array.prototype.set.call(d,g,y);else if(H.isBuffer(g))g.copy(d,y);else throw new TypeError('"list" argument must be an Array of Buffers');y+=g.length}return d};function bo(l,o){if(H.isBuffer(l))return l.length;if(ArrayBuffer.isView(l)||Le(l,ArrayBuffer))return l.byteLength;if(typeof l!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof l);let s=l.length,c=arguments.length>2&&arguments[2]===!0;if(!c&&s===0)return 0;let d=!1;for(;;)switch(o){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return Ai(l).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return Co(l).length;default:if(d)return c?-1:Ai(l).length;o=(""+o).toLowerCase(),d=!0}}H.byteLength=bo;function _u(l,o,s){let c=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,o>>>=0,s<=o))return"";for(l||(l="utf8");;)switch(l){case"hex":return Au(this,o,s);case"utf8":case"utf-8":return Ro(this,o,s);case"ascii":return Tu(this,o,s);case"latin1":case"binary":return Ou(this,o,s);case"base64":return Ru(this,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lu(this,o,s);default:if(c)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),c=!0}}H.prototype._isBuffer=!0;function ir(l,o,s){let c=l[o];l[o]=l[s],l[s]=c}H.prototype.swap16=function(){let o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<o;s+=2)ir(this,s,s+1);return this};H.prototype.swap32=function(){let o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<o;s+=4)ir(this,s,s+3),ir(this,s+1,s+2);return this};H.prototype.swap64=function(){let o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<o;s+=8)ir(this,s,s+7),ir(this,s+1,s+6),ir(this,s+2,s+5),ir(this,s+3,s+4);return this};H.prototype.toString=function(){let o=this.length;return o===0?"":arguments.length===0?Ro(this,0,o):_u.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(o){if(!H.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:H.compare(this,o)===0};H.prototype.inspect=function(){let o="",s=Sr.INSPECT_MAX_BYTES;return o=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(o+=" ... "),"<Buffer "+o+">"};So&&(H.prototype[So]=H.prototype.inspect);H.prototype.compare=function(o,s,c,d,y){if(Le(o,Uint8Array)&&(o=H.from(o,o.offset,o.byteLength)),!H.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(s===void 0&&(s=0),c===void 0&&(c=o?o.length:0),d===void 0&&(d=0),y===void 0&&(y=this.length),s<0||c>o.length||d<0||y>this.length)throw new RangeError("out of range index");if(d>=y&&s>=c)return 0;if(d>=y)return-1;if(s>=c)return 1;if(s>>>=0,c>>>=0,d>>>=0,y>>>=0,this===o)return 0;let g=y-d,E=c-s,w=Math.min(g,E),f=this.slice(d,y),_=o.slice(s,c);for(let p=0;p<w;++p)if(f[p]!==_[p]){g=f[p],E=_[p];break}return g<E?-1:E<g?1:0};function ko(l,o,s,c,d){if(l.length===0)return-1;if(typeof s=="string"?(c=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,Bi(s)&&(s=d?0:l.length-1),s<0&&(s=l.length+s),s>=l.length){if(d)return-1;s=l.length-1}else if(s<0)if(d)s=0;else return-1;if(typeof o=="string"&&(o=H.from(o,c)),H.isBuffer(o))return o.length===0?-1:Eo(l,o,s,c,d);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?d?Uint8Array.prototype.indexOf.call(l,o,s):Uint8Array.prototype.lastIndexOf.call(l,o,s):Eo(l,[o],s,c,d);throw new TypeError("val must be string, number or Buffer")}function Eo(l,o,s,c,d){let y=1,g=l.length,E=o.length;if(c!==void 0&&(c=String(c).toLowerCase(),c==="ucs2"||c==="ucs-2"||c==="utf16le"||c==="utf-16le")){if(l.length<2||o.length<2)return-1;y=2,g/=2,E/=2,s/=2}function w(_,p){return y===1?_[p]:_.readUInt16BE(p*y)}let f;if(d){let _=-1;for(f=s;f<g;f++)if(w(l,f)===w(o,_===-1?0:f-_)){if(_===-1&&(_=f),f-_+1===E)return _*y}else _!==-1&&(f-=f-_),_=-1}else for(s+E>g&&(s=g-E),f=s;f>=0;f--){let _=!0;for(let p=0;p<E;p++)if(w(l,f+p)!==w(o,p)){_=!1;break}if(_)return f}return-1}H.prototype.includes=function(o,s,c){return this.indexOf(o,s,c)!==-1};H.prototype.indexOf=function(o,s,c){return ko(this,o,s,c,!0)};H.prototype.lastIndexOf=function(o,s,c){return ko(this,o,s,c,!1)};function xu(l,o,s,c){s=Number(s)||0;let d=l.length-s;c?(c=Number(c),c>d&&(c=d)):c=d;let y=o.length;c>y/2&&(c=y/2);let g;for(g=0;g<c;++g){let E=parseInt(o.substr(g*2,2),16);if(Bi(E))return g;l[s+g]=E}return g}function Fu(l,o,s,c){return ni(Ai(o,l.length-s),l,s,c)}function Iu(l,o,s,c){return ni(Mu(o),l,s,c)}function bu(l,o,s,c){return ni(Co(o),l,s,c)}function ku(l,o,s,c){return ni(Uu(o,l.length-s),l,s,c)}H.prototype.write=function(o,s,c,d){if(s===void 0)d="utf8",c=this.length,s=0;else if(c===void 0&&typeof s=="string")d=s,c=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(c)?(c=c>>>0,d===void 0&&(d="utf8")):(d=c,c=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let y=this.length-s;if((c===void 0||c>y)&&(c=y),o.length>0&&(c<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let g=!1;for(;;)switch(d){case"hex":return xu(this,o,s,c);case"utf8":case"utf-8":return Fu(this,o,s,c);case"ascii":case"latin1":case"binary":return Iu(this,o,s,c);case"base64":return bu(this,o,s,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ku(this,o,s,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ru(l,o,s){return o===0&&s===l.length?Ni.fromByteArray(l):Ni.fromByteArray(l.slice(o,s))}function Ro(l,o,s){s=Math.min(l.length,s);let c=[],d=o;for(;d<s;){let y=l[d],g=null,E=y>239?4:y>223?3:y>191?2:1;if(d+E<=s){let w,f,_,p;switch(E){case 1:y<128&&(g=y);break;case 2:w=l[d+1],(w&192)===128&&(p=(y&31)<<6|w&63,p>127&&(g=p));break;case 3:w=l[d+1],f=l[d+2],(w&192)===128&&(f&192)===128&&(p=(y&15)<<12|(w&63)<<6|f&63,p>2047&&(p<55296||p>57343)&&(g=p));break;case 4:w=l[d+1],f=l[d+2],_=l[d+3],(w&192)===128&&(f&192)===128&&(_&192)===128&&(p=(y&15)<<18|(w&63)<<12|(f&63)<<6|_&63,p>65535&&p<1114112&&(g=p))}}g===null?(g=65533,E=1):g>65535&&(g-=65536,c.push(g>>>10&1023|55296),g=56320|g&1023),c.push(g),d+=E}return Nu(c)}var _o=4096;function Nu(l){let o=l.length;if(o<=_o)return String.fromCharCode.apply(String,l);let s="",c=0;for(;c<o;)s+=String.fromCharCode.apply(String,l.slice(c,c+=_o));return s}function Tu(l,o,s){let c="";s=Math.min(l.length,s);for(let d=o;d<s;++d)c+=String.fromCharCode(l[d]&127);return c}function Ou(l,o,s){let c="";s=Math.min(l.length,s);for(let d=o;d<s;++d)c+=String.fromCharCode(l[d]);return c}function Au(l,o,s){let c=l.length;(!o||o<0)&&(o=0),(!s||s<0||s>c)&&(s=c);let d="";for(let y=o;y<s;++y)d+=Pu[l[y]];return d}function Lu(l,o,s){let c=l.slice(o,s),d="";for(let y=0;y<c.length-1;y+=2)d+=String.fromCharCode(c[y]+c[y+1]*256);return d}H.prototype.slice=function(o,s){let c=this.length;o=~~o,s=s===void 0?c:~~s,o<0?(o+=c,o<0&&(o=0)):o>c&&(o=c),s<0?(s+=c,s<0&&(s=0)):s>c&&(s=c),s<o&&(s=o);let d=this.subarray(o,s);return Object.setPrototypeOf(d,H.prototype),d};function ne(l,o,s){if(l%1!==0||l<0)throw new RangeError("offset is not uint");if(l+o>s)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(o,s,c){o=o>>>0,s=s>>>0,c||ne(o,s,this.length);let d=this[o],y=1,g=0;for(;++g<s&&(y*=256);)d+=this[o+g]*y;return d};H.prototype.readUintBE=H.prototype.readUIntBE=function(o,s,c){o=o>>>0,s=s>>>0,c||ne(o,s,this.length);let d=this[o+--s],y=1;for(;s>0&&(y*=256);)d+=this[o+--s]*y;return d};H.prototype.readUint8=H.prototype.readUInt8=function(o,s){return o=o>>>0,s||ne(o,1,this.length),this[o]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(o,s){return o=o>>>0,s||ne(o,2,this.length),this[o]|this[o+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(o,s){return o=o>>>0,s||ne(o,2,this.length),this[o]<<8|this[o+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])};H.prototype.readBigUInt64LE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],c=this[o+7];(s===void 0||c===void 0)&&Br(o,this.length-8);let d=s+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24,y=this[++o]+this[++o]*2**8+this[++o]*2**16+c*2**24;return BigInt(d)+(BigInt(y)<<BigInt(32))});H.prototype.readBigUInt64BE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],c=this[o+7];(s===void 0||c===void 0)&&Br(o,this.length-8);let d=s*2**24+this[++o]*2**16+this[++o]*2**8+this[++o],y=this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+c;return(BigInt(d)<<BigInt(32))+BigInt(y)});H.prototype.readIntLE=function(o,s,c){o=o>>>0,s=s>>>0,c||ne(o,s,this.length);let d=this[o],y=1,g=0;for(;++g<s&&(y*=256);)d+=this[o+g]*y;return y*=128,d>=y&&(d-=Math.pow(2,8*s)),d};H.prototype.readIntBE=function(o,s,c){o=o>>>0,s=s>>>0,c||ne(o,s,this.length);let d=s,y=1,g=this[o+--d];for(;d>0&&(y*=256);)g+=this[o+--d]*y;return y*=128,g>=y&&(g-=Math.pow(2,8*s)),g};H.prototype.readInt8=function(o,s){return o=o>>>0,s||ne(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]};H.prototype.readInt16LE=function(o,s){o=o>>>0,s||ne(o,2,this.length);let c=this[o]|this[o+1]<<8;return c&32768?c|4294901760:c};H.prototype.readInt16BE=function(o,s){o=o>>>0,s||ne(o,2,this.length);let c=this[o+1]|this[o]<<8;return c&32768?c|4294901760:c};H.prototype.readInt32LE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24};H.prototype.readInt32BE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]};H.prototype.readBigInt64LE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],c=this[o+7];(s===void 0||c===void 0)&&Br(o,this.length-8);let d=this[o+4]+this[o+5]*2**8+this[o+6]*2**16+(c<<24);return(BigInt(d)<<BigInt(32))+BigInt(s+this[++o]*2**8+this[++o]*2**16+this[++o]*2**24)});H.prototype.readBigInt64BE=He(function(o){o=o>>>0,wr(o,"offset");let s=this[o],c=this[o+7];(s===void 0||c===void 0)&&Br(o,this.length-8);let d=(s<<24)+this[++o]*2**16+this[++o]*2**8+this[++o];return(BigInt(d)<<BigInt(32))+BigInt(this[++o]*2**24+this[++o]*2**16+this[++o]*2**8+c)});H.prototype.readFloatLE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),mr.read(this,o,!0,23,4)};H.prototype.readFloatBE=function(o,s){return o=o>>>0,s||ne(o,4,this.length),mr.read(this,o,!1,23,4)};H.prototype.readDoubleLE=function(o,s){return o=o>>>0,s||ne(o,8,this.length),mr.read(this,o,!0,52,8)};H.prototype.readDoubleBE=function(o,s){return o=o>>>0,s||ne(o,8,this.length),mr.read(this,o,!1,52,8)};function ye(l,o,s,c,d,y){if(!H.isBuffer(l))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>d||o<y)throw new RangeError('"value" argument is out of bounds');if(s+c>l.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(o,s,c,d){if(o=+o,s=s>>>0,c=c>>>0,!d){let E=Math.pow(2,8*c)-1;ye(this,o,s,c,E,0)}let y=1,g=0;for(this[s]=o&255;++g<c&&(y*=256);)this[s+g]=o/y&255;return s+c};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(o,s,c,d){if(o=+o,s=s>>>0,c=c>>>0,!d){let E=Math.pow(2,8*c)-1;ye(this,o,s,c,E,0)}let y=c-1,g=1;for(this[s+y]=o&255;--y>=0&&(g*=256);)this[s+y]=o/g&255;return s+c};H.prototype.writeUint8=H.prototype.writeUInt8=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,1,255,0),this[s]=o&255,s+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,2,65535,0),this[s]=o&255,this[s+1]=o>>>8,s+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,2,65535,0),this[s]=o>>>8,this[s+1]=o&255,s+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,4,4294967295,0),this[s+3]=o>>>24,this[s+2]=o>>>16,this[s+1]=o>>>8,this[s]=o&255,s+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,4,4294967295,0),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};function No(l,o,s,c,d){Do(o,c,d,l,s,7);let y=Number(o&BigInt(4294967295));l[s++]=y,y=y>>8,l[s++]=y,y=y>>8,l[s++]=y,y=y>>8,l[s++]=y;let g=Number(o>>BigInt(32)&BigInt(4294967295));return l[s++]=g,g=g>>8,l[s++]=g,g=g>>8,l[s++]=g,g=g>>8,l[s++]=g,s}function To(l,o,s,c,d){Do(o,c,d,l,s,7);let y=Number(o&BigInt(4294967295));l[s+7]=y,y=y>>8,l[s+6]=y,y=y>>8,l[s+5]=y,y=y>>8,l[s+4]=y;let g=Number(o>>BigInt(32)&BigInt(4294967295));return l[s+3]=g,g=g>>8,l[s+2]=g,g=g>>8,l[s+1]=g,g=g>>8,l[s]=g,s+8}H.prototype.writeBigUInt64LE=He(function(o,s=0){return No(this,o,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=He(function(o,s=0){return To(this,o,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(o,s,c,d){if(o=+o,s=s>>>0,!d){let w=Math.pow(2,8*c-1);ye(this,o,s,c,w-1,-w)}let y=0,g=1,E=0;for(this[s]=o&255;++y<c&&(g*=256);)o<0&&E===0&&this[s+y-1]!==0&&(E=1),this[s+y]=(o/g>>0)-E&255;return s+c};H.prototype.writeIntBE=function(o,s,c,d){if(o=+o,s=s>>>0,!d){let w=Math.pow(2,8*c-1);ye(this,o,s,c,w-1,-w)}let y=c-1,g=1,E=0;for(this[s+y]=o&255;--y>=0&&(g*=256);)o<0&&E===0&&this[s+y+1]!==0&&(E=1),this[s+y]=(o/g>>0)-E&255;return s+c};H.prototype.writeInt8=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,1,127,-128),o<0&&(o=255+o+1),this[s]=o&255,s+1};H.prototype.writeInt16LE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,2,32767,-32768),this[s]=o&255,this[s+1]=o>>>8,s+2};H.prototype.writeInt16BE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,2,32767,-32768),this[s]=o>>>8,this[s+1]=o&255,s+2};H.prototype.writeInt32LE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,4,2147483647,-2147483648),this[s]=o&255,this[s+1]=o>>>8,this[s+2]=o>>>16,this[s+3]=o>>>24,s+4};H.prototype.writeInt32BE=function(o,s,c){return o=+o,s=s>>>0,c||ye(this,o,s,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};H.prototype.writeBigInt64LE=He(function(o,s=0){return No(this,o,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=He(function(o,s=0){return To(this,o,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Oo(l,o,s,c,d,y){if(s+c>l.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function Ao(l,o,s,c,d){return o=+o,s=s>>>0,d||Oo(l,o,s,4,34028234663852886e22,-34028234663852886e22),mr.write(l,o,s,c,23,4),s+4}H.prototype.writeFloatLE=function(o,s,c){return Ao(this,o,s,!0,c)};H.prototype.writeFloatBE=function(o,s,c){return Ao(this,o,s,!1,c)};function Lo(l,o,s,c,d){return o=+o,s=s>>>0,d||Oo(l,o,s,8,17976931348623157e292,-17976931348623157e292),mr.write(l,o,s,c,52,8),s+8}H.prototype.writeDoubleLE=function(o,s,c){return Lo(this,o,s,!0,c)};H.prototype.writeDoubleBE=function(o,s,c){return Lo(this,o,s,!1,c)};H.prototype.copy=function(o,s,c,d){if(!H.isBuffer(o))throw new TypeError("argument should be a Buffer");if(c||(c=0),!d&&d!==0&&(d=this.length),s>=o.length&&(s=o.length),s||(s=0),d>0&&d<c&&(d=c),d===c||o.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),o.length-s<d-c&&(d=o.length-s+c);let y=d-c;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,c,d):Uint8Array.prototype.set.call(o,this.subarray(c,d),s),y};H.prototype.fill=function(o,s,c,d){if(typeof o=="string"){if(typeof s=="string"?(d=s,s=0,c=this.length):typeof c=="string"&&(d=c,c=this.length),d!==void 0&&typeof d!="string")throw new TypeError("encoding must be a string");if(typeof d=="string"&&!H.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(o.length===1){let g=o.charCodeAt(0);(d==="utf8"&&g<128||d==="latin1")&&(o=g)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(s<0||this.length<s||this.length<c)throw new RangeError("Out of range index");if(c<=s)return this;s=s>>>0,c=c===void 0?this.length:c>>>0,o||(o=0);let y;if(typeof o=="number")for(y=s;y<c;++y)this[y]=o;else{let g=H.isBuffer(o)?o:H.from(o,d),E=g.length;if(E===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(y=0;y<c-s;++y)this[y+s]=g[y%E]}return this};var vr={};function Ci(l,o,s){vr[l]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:o.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${l}]`,this.stack,delete this.name}get code(){return l}set code(d){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:d,writable:!0})}toString(){return`${this.name} [${l}]: ${this.message}`}}}Ci("ERR_BUFFER_OUT_OF_BOUNDS",function(l){return l?`${l} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ci("ERR_INVALID_ARG_TYPE",function(l,o){return`The "${l}" argument must be of type number. Received type ${typeof o}`},TypeError);Ci("ERR_OUT_OF_RANGE",function(l,o,s){let c=`The value of "${l}" is out of range.`,d=s;return Number.isInteger(s)&&Math.abs(s)>2**32?d=xo(String(s)):typeof s=="bigint"&&(d=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(d=xo(d)),d+="n"),c+=` It must be ${o}. Received ${d}`,c},RangeError);function xo(l){let o="",s=l.length,c=l[0]==="-"?1:0;for(;s>=c+4;s-=3)o=`_${l.slice(s-3,s)}${o}`;return`${l.slice(0,s)}${o}`}function Du(l,o,s){wr(o,"offset"),(l[o]===void 0||l[o+s]===void 0)&&Br(o,l.length-(s+1))}function Do(l,o,s,c,d,y){if(l>s||l<o){let g=typeof o=="bigint"?"n":"",E;throw y>3?o===0||o===BigInt(0)?E=`>= 0${g} and < 2${g} ** ${(y+1)*8}${g}`:E=`>= -(2${g} ** ${(y+1)*8-1}${g}) and < 2 ** ${(y+1)*8-1}${g}`:E=`>= ${o}${g} and <= ${s}${g}`,new vr.ERR_OUT_OF_RANGE("value",E,l)}Du(c,d,y)}function wr(l,o){if(typeof l!="number")throw new vr.ERR_INVALID_ARG_TYPE(o,"number",l)}function Br(l,o,s){throw Math.floor(l)!==l?(wr(l,s),new vr.ERR_OUT_OF_RANGE(s||"offset","an integer",l)):o<0?new vr.ERR_BUFFER_OUT_OF_BOUNDS:new vr.ERR_OUT_OF_RANGE(s||"offset",`>= ${s?1:0} and <= ${o}`,l)}var Cu=/[^+/0-9A-Za-z-_]/g;function Bu(l){if(l=l.split("=")[0],l=l.trim().replace(Cu,""),l.length<2)return"";for(;l.length%4!==0;)l=l+"=";return l}function Ai(l,o){o=o||1/0;let s,c=l.length,d=null,y=[];for(let g=0;g<c;++g){if(s=l.charCodeAt(g),s>55295&&s<57344){if(!d){if(s>56319){(o-=3)>-1&&y.push(239,191,189);continue}else if(g+1===c){(o-=3)>-1&&y.push(239,191,189);continue}d=s;continue}if(s<56320){(o-=3)>-1&&y.push(239,191,189),d=s;continue}s=(d-55296<<10|s-56320)+65536}else d&&(o-=3)>-1&&y.push(239,191,189);if(d=null,s<128){if((o-=1)<0)break;y.push(s)}else if(s<2048){if((o-=2)<0)break;y.push(s>>6|192,s&63|128)}else if(s<65536){if((o-=3)<0)break;y.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((o-=4)<0)break;y.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return y}function Mu(l){let o=[];for(let s=0;s<l.length;++s)o.push(l.charCodeAt(s)&255);return o}function Uu(l,o){let s,c,d,y=[];for(let g=0;g<l.length&&!((o-=2)<0);++g)s=l.charCodeAt(g),c=s>>8,d=s%256,y.push(d),y.push(c);return y}function Co(l){return Ni.toByteArray(Bu(l))}function ni(l,o,s,c){let d;for(d=0;d<c&&!(d+s>=o.length||d>=l.length);++d)o[d+s]=l[d];return d}function Le(l,o){return l instanceof o||l!=null&&l.constructor!=null&&l.constructor.name!=null&&l.constructor.name===o.name}function Bi(l){return l!==l}var Pu=function(){let l="0123456789abcdef",o=new Array(256);for(let s=0;s<16;++s){let c=s*16;for(let d=0;d<16;++d)o[c+d]=l[s]+l[d]}return o}();function He(l){return typeof BigInt>"u"?zu:l}function zu(){throw new Error("BigInt not supported")}});var Zo=yr((Fc,Zu)=>{Zu.exports=""});var Xo=yr((Nc,Yu)=>{Yu.exports=`\r
\r
\r
<!--\r
\r
<ImageOrVid><Result watched image>\r
<Menu>\r
<Result Spectrogram> <Compared Spectrogram> (can overlay)\r
<Res2>               <Comp2>\r
    ...                 ...\r
\r
todo:\r
\r
Concise menu, finish file loading\r
Result list + comparison\r
Result saving/loading files\r
mediarecorder on canvas result too for vod\r
webworkers probably good idea for processing image on secondary canvases\r
\r
frame buffering stuff cuz graphs\r
\r
\r
-->\r
\r
        <div id="pickerDiv" style="position: relative; display:flex; align-items:center;" title="Source Image or Video. Click in two places to create a snippet on the right then click Analyze when the spectrogram is in view."> <!-- We want the source canvas to maintain the source image/video's aspect ratio so it looks correct, the capture can be stretched otherwise-->\r
            <div id="sourcedeets" style="position:absolute; z-index:4; color:white; font-size:10px; top:0px; right:0px;"></div>\r
            <img src="" style="position: absolute; z-index:1;" ></img>\r
            <video src="" style="position: absolute; display:none; z-index:2;" ></video>\r
            <canvas id="picker" style="position: absolute; z-index:3;" ></canvas>\r
        </div>\r
        <div id="captureDiv" title="Capture View">\r
            <div style="position:absolute; z-index:5; color:white; font-size:10px;  right:0px;" id="capturedeets"></div>\r
            <canvas id="capture" style="height:100%; width:100%;" height="100%" width="100%"></canvas>\r
            <canvas id="capturegraph" style="position:absolute; width:100%; height:100px; z-index:5; bottom:0px;"></canvas>\r
        </div>\r
        \r
        <button id="toggleMenu" style="display:none;">Toggle Menu</button>\r
\r
        <div id="menu" title="Source controls">\r
            <button id="snip" title="Capture and Analyze Spectrogram?">Analyze \u{1F4BB}</button>\r
            <span id="videomenu" style="display:none;">\r
                <button id="showgraph" title="Show live spectrogram? May cause slowdown.">\u{1F4C8}</button>\r
                <button id="record" title="Record MP4 of capture? (graph not included)">\u{1F534}</button>\r
            </span>\r
            <button id="webcam">Use Camera \u{1F3A5}</button>\r
            <button id="fileinput">Upload File \u{1F4E5}</button>\r
            <button id="useurl">Use URL \u{1F310}</button>\r
            <button id="image">Use Image \u{1F5BC}\uFE0F</button>\r
            <button style="float:right;" id="help" title="Help!">\u2753</button>\r
            <span id="imgmenu">\r
                <span style="color:white;">Preloaded Images:</span>\r
                <select id="imgselect"></select>\r
            </span>\r
            <span id="urlmenu" style="display:none;">\r
                <input type="url" id="urlinput" placeholder="Image or Video File URL"></input>\r
                <span style="color:white;">File type:</span>\r
                <select id="urlselect">\r
                    <option value="img" selected>Image</option>\r
                    <option value="video">Video</option>\r
                </select>\r
                <button id="seturl">Set URL</button>\r
            </span>\r
            <br>\r
            <div id="instructions" style="color:white; display:none;">\r
                Instructions: Click to draw a rectangle around the portion of the image or video you want to snip, \r
                then click Analyze to create a downloadable spectrogram you can compare with other results!\r
            </div>\r
            <br>\r
        <hr>\r
            </div>\r
        <div  id="compare" style="overflow-y:scroll;" title="Compare spectrogram results directly.">\r
            <span style="position:relative; top:0px; right:0px;">Mix & Compare</span>\r
            <div id="comparelist">\r
            </div>\r
        </div>\r
        <div id="captured" style="overflow-y:scroll;" title="All captures made this session.">\r
            <span style="position:relative; top:0px; right:0px;">Captures</span>\r
            <div id="capturelist">\r
            </div>\r
        </div>\r
        <div id="saved" style="overflow-y:scroll; overflow-x:hidden;" title="Captures that can be restored from cache.">\r
            <span style="position:relative; top:0px; right:0px;">Saved</span>\r
            <div id="savedlist">\r
            </div>\r
        </div>`});var Dr=class{constructor(o=this.onOpen,s=null,c=null){this.onOpen=o,this.notes=[{idx:0,text:"comment"}],s!==null&&document.getElementById(s).addEventListener("click",this.saveCSV),c!==null&&document.getElementById(c).addEventListener("click",this.openCSV)}processArraysForCSV(o=["1|2|3","3|2|1"],s="|",c="a,b,c",d=!1){let y=c+`
`,g=0;return o.forEach((E,w)=>{o[w]==="string"&&s!==","?y+=E.split(s).join(","):csvData+=E.join(","),d===!0&&this.notes[g].idx===w&&(E+=this.notes[g].text,g++),E.indexOf(`
`)<0&&(y+=`
`)}),y}static saveCSV(o=`a,b,c
1,2,3
3,2,1
`,s=new Date().toISOString()){var c=document.createElement("a");c.href="data:text/csv;charset=utf-8,"+encodeURI(o),c.target="_blank",s!==""?c.download=s+".csv":c.download=Date().toISOString()+".csv",c.click()}static openCSV(o=",",s=(c,d,y)=>y){var c=document.createElement("input");c.accept=".csv",c.type="file",c.onchange=d=>{var y=d.target.files[0],g=new FileReader;g.onload=E=>{var w=E.target.result,f=w.split(`
`);let _=[];var p=[];f.pop(),f.forEach((T,A)=>{if(A==0)_=T.split(o);else{var b=T.split(o);p.push(b)}}),s(p,_,c.value),c.value=""},g.readAsText(y)},c.click()}static openCSVRaw(o=(s,c)=>c){var s=document.createElement("input");s.accept=".csv",s.type="file",s.onchange=c=>{var d=c.target.files[0],y=new FileReader;y.onload=g=>{var E=g.target.result;o(E,s.value),s.value=""},y.readAsText(d)},s.click()}onOpen(o=[],s=[]){console.log("CSV Opened!",s,o)}};var er=fo(lo()),ho=!1,bi=er.BFSRequire("fs"),sc=er.BFSRequire("buffer").Buffer,po=async(l=["data","projects","extensions","settings","plugins"],o=()=>{},s=()=>{})=>ho?!0:new Promise(c=>{let d=bi.getRootFS();er.FileSystem.IndexedDB.Create({},(y,g)=>{if(y)throw y;if(!g)throw s(),new Error("Error creating BrowserFS");er.initialize(g);let E=[];l.forEach(async w=>{E.push(uu(bi,w))}),Promise.all(E).then(w=>{o(),ho=!0,c(!0)})})});var yo=async(l,o,s="data",c=d=>{})=>new Promise(d=>{bi.writeFile("/"+s+"/"+l,o,y=>{if(y)throw y;c(o),d(!0)})});var gr={},uu=async(l,o)=>new Promise(s=>{gr[o]==="exists"||gr[o]==="created"?s():l.exists(`/${o}`,c=>{c?(gr[o]="exists",console.log(`/${o} exists!`),s()):gr[o]==="creating"?(console.log(o+" is still being created."),s()):(console.log("creating "+o),gr[o]="creating",l.mkdir(o,d=>{if(d)throw d;gr[o]="created",setTimeout(s,500)}))})});var Mi=fo(Bo());var Ui={getImageData:function(l){var o=l.width,s=l.height,c=l.getContext("2d").getImageData(0,0,o,s);return c},toArrayBuffer:function(l){var o=canvas.width,s=canvas.height,c=o*4,d=new Uint32Array(l.data.buffer),y=Math.floor((32*o+31)/32)*4,g=y*s,E=122+g,w=new ArrayBuffer(E),f=new DataView(w),_=0,p,T=0,A,b=0,L,C;for(G(19778),W(E),_+=4,W(122),W(108),W(o),W(-s>>>0),G(1),G(32),W(3),W(g),W(2835),W(2835),_+=8,W(16711680),W(65280),W(255),W(4278190080),W(1466527264);T<s;){for(A=122+T*y,p=0;p<c;)C=d[b++],L=C>>>24,f.setUint32(A+p,C<<8|L),p+=4;T++}return w;function G(M){f.setUint16(_,M,!0),_+=2}function W(M){f.setUint32(_,M,!0),_+=4}},toBlob:function(l){return new Blob([this.toArrayBuffer(this.getImageData(l))],{type:"image/bmp"})},ImageDatatoBlob:function(l){return new Blob([this.toArrayBuffer(l)],{type:"image/bmp"})},toDataURL:function(l){for(var o=new Uint8Array(this.toArrayBuffer(this.getImageData(l))),s="",c=0,d=o.length;c<d;)s+=String.fromCharCode(o[c++]);return"data:image/bmp;base64,"+Mi.Buffer.from(s,"base64").toString("ascii")},ImageDatatoDataURL:function(l){for(var o=new Uint8Array(this.toArrayBuffer(l)),s="",c=0,d=o.length;c<d;)s+=String.fromCharCode(o[c++]);return"data:image/bmp;base64,"+Mi.Buffer.from(s,"base64").toString("ascii")}};function Mr(l,o,s,c,d=0,y=0){if(l.naturalWidth)return{x:l.naturalWidth*(s-d)/o.width,y:l.naturalHeight*(c-y)/o.height};if(l.videoWidth)return{x:l.videoWidth*(s-d)/o.width,y:l.videoHeight*(c-y)/o.height};if(l.width)return{x:l.width*(s-d)/o.width,y:l.height*(c-y)/o.height}}function ju(l){let o=Array.from(l.data),s=[],c=0;for(let f=0;f<o.length;f+=4)f/4%l.width===0&&(c=0),s[c]?(s[c].i+=parseFloat(o[f]+o[f+1]+o[f+2]),s[c].r+=parseFloat(o[f]),s[c].g+=parseFloat(o[f+1]),s[c].b+=parseFloat(o[f+2])):s[c]={i:parseFloat(o[f]+o[f+1]+o[f+2]),r:parseFloat(o[f]),g:parseFloat(o[f+1]),b:parseFloat(o[f+2])},c++;let d=Math.max(...s.map(f=>f.i)),y=Math.max(...s.map(f=>f.r)),g=Math.max(...s.map(f=>f.b)),E=Math.max(...s.map(f=>f.g)),w=Math.max(y,g,E);return{bitmap:l,width:l.width,height:l.height,bitarr:o,xrgbintensities:s,xintmax:d,xrintmax:y,xbintmax:g,xgintmax:E,xrgbmax:w}}async function Mo(l,o){let s=Object.assign({},l);delete s.bitmap;let c=JSON.stringify(s);return await yo(o,c,"processed")}function Uo(l,o,s){return new ImageData(Uint8ClampedArray.from(l),o,s)}function Po(l,o,s=0,c=0,d=o.width,y=o.height,g=0,E=0,w=l.canvas.width,f=l.canvas.height){return l.drawImage(o,s,c,d,y,g,E,w,f)}function Pi(l,o,s=0,c=0,d=l.canvas.width,y=l.canvas.height){let g=ju(o);l.fillStyle="white",l.strokeStyle="ghostwhite",l.lineWidth=1,l.beginPath();let E=g.xrgbintensities.length,w=d/E;return g.xrgbintensities.forEach((f,_)=>{_===0?l.moveTo(s,c+y*(1-f.i/g.xintmax)):l.lineTo(s+_*w,c+y*(1-f.i/g.xintmax))}),l.stroke(),l.strokeStyle="tomato",l.lineWidth=1,l.beginPath(),g.xrgbintensities.forEach((f,_)=>{_===0?l.moveTo(s,c+y*(1-f.r/g.xintmax)):l.lineTo(s+_*w,c+y*(1-f.r/g.xintmax))}),l.stroke(),l.strokeStyle="#00b8f5",l.beginPath(),g.xrgbintensities.forEach((f,_)=>{_===0?l.moveTo(s,c+y*(1-f.b/g.xintmax)):l.lineTo(s+_*w,c+y*(1-f.b/g.xintmax))}),l.stroke(),l.strokeStyle="chartreuse",l.beginPath(),g.xrgbintensities.forEach((f,_)=>{_===0?l.moveTo(s,c+y*(1-f.g/g.xintmax)):l.lineTo(s+_*w,c+y*(1-f.g/g.xintmax))}),l.stroke(),g}function zo(l,o=30,s=Wu){let c=l.captureStream(o),d=new MediaRecorder(c),y=[];return d.ondataavailable=function(g){y.push(g.data)},d.onstop=function(g){let E=new Blob(y,{type:"video/mp4"});y=[];let w=URL.createObjectURL(E);s(w)},d}function Wu(l,o=new Date().toISOString()){var s=document.createElement("a");s.href=l,s.target="_blank",o!==""?s.download=o+".mp4":s.download=new Date().toISOString()+".mp4",s.click()}function jo(l){var o=new DataView(l),s={};s.fileheader={},s.fileheader.bfType=o.getUint16(0,!0),s.fileheader.bfSize=o.getUint32(2,!0),s.fileheader.bfReserved1=o.getUint16(6,!0),s.fileheader.bfReserved2=o.getUint16(8,!0),s.fileheader.bfOffBits=o.getUint32(10,!0),s.infoheader={},s.infoheader.biSize=o.getUint32(14,!0),s.infoheader.biWidth=o.getUint32(18,!0),s.infoheader.biHeight=o.getUint32(22,!0),s.infoheader.biPlanes=o.getUint16(26,!0),s.infoheader.biBitCount=o.getUint16(28,!0),s.infoheader.biCompression=o.getUint32(30,!0),s.infoheader.biSizeImage=o.getUint32(34,!0),s.infoheader.biXPelsPerMeter=o.getUint32(38,!0),s.infoheader.biYPelsPerMeter=o.getUint32(42,!0),s.infoheader.biClrUsed=o.getUint32(46,!0),s.infoheader.biClrImportant=o.getUint32(50,!0);var c=s.fileheader.bfOffBits;return s.stride=Math.floor((s.infoheader.biBitCount*s.infoheader.biWidth+31)/32)*4,s.pixels=new Uint8Array(l,c),s}function Wo(l){canvas=document.createElement("canvas");var o=canvas.getContext("2d"),s=l.infoheader.biWidth,c=l.infoheader.biHeight;canvas.width=s,canvas.height=c;for(var d=o.createImageData(s,c),y=d.data,g=l.pixels,E=l.stride,w=0;w<c;++w)for(var f=0;f<s;++f){var _=(f+s*(c-w))*4,p=f*3+E*w;y[_]=g[p+2],y[_+1]=g[p+1],y[_+2]=g[p],y[_+3]=255}return o.putImageData(d,0,0),canvas.toDataURL("image/png")}function Ho(l,o){let s=`x,r,g,b,i
`,c="";l.forEach((y,g)=>{c+=`${g},${y.r},${y.g},${y.b},${y.i}
`});let d=s+c;Dr.saveCSV(d,o+"_"+new Date().toISOString())}var oi=class extends HTMLElement{template=o=>`<div> Custom Fragment Props: ${JSON.stringify(o)} </div>`;props={test:!0};useShadow=!1;oncreate=void 0;onresize=void 0;ondelete=void 0;onchanged=void 0;FRAGMENT=void 0;attachedShadow=!1;obsAttributes=["props","options","onchanged","onresize","ondelete","oncreate","template"];get observedAttributes(){return this.obsAttributes}get obsAttributes(){return this.obsAttributes}set obsAttributes(o){typeof o=="string"?this.obsAttributes.push(o):Array.isArray(o)&&(this.obsAttributes=o)}static get tag(){return this.name.toLowerCase()+"-"}static addElement(o=this.tag,s=this,c=void 0){Hu(s,o,c)}attributeChangedCallback(o,s,c){if(o==="onchanged"){let d=c;if(typeof d=="string"&&(d=Er(d)),typeof d=="function"){this.onchanged=d,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged);let y=new CustomEvent("changed",{detail:{props:this.props}});this.state.subscribeTrigger("props",()=>{this.dispatchEvent(y)})}}else if(o==="onresize"){let d=c;if(typeof d=="string"&&(d=Er(d)),typeof d=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=y=>{this.onresize(this.props)},this.onresize=d,window.addEventListener("resize",this.ONRESIZE)}}else if(o==="ondelete"){let d=c;typeof d=="string"&&(d=Er(d)),typeof d=="function"&&(this.ondelete=()=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),d&&d(this.props)})}else if(o==="oncreate"){let d=c;typeof d=="string"&&(d=Er(d)),typeof d=="function"&&(this.oncreate=d)}else if(o==="props"){let d=c;typeof d=="string"&&(d=JSON.parse(d)),Object.assign(this.props,d),this.state.setState({props:this.props})}else if(o==="template"){let d=c;this.template=options.template,typeof d=="function"?this.templateString=this.template(this.props):this.templateString=d,this.render(this.props);let y=new CustomEvent("created",{detail:{props:this.props}});this.dispatchEvent(y)}else{let d=c;if(o.includes("eval_"))o=o.split("_"),o.shift(),o=o.join(),d=Er(c);else if(typeof c=="string")try{d=JSON.parse(c)}catch{d=c}this[o]=d,o!=="props"&&(this.props[o]=d)}}connectedCallback(){let o=this.getAttribute("props");typeof o=="string"&&(o=JSON.parse(o)),Object.assign(this.props,o),this.state.setState({props:this.props}),Array.from(this.attributes).forEach(g=>{let E=g.name,w=g.value;if(E.includes("eval_"))E=E.split("_"),E.shift(),E=E.join(),w=Er(g.value);else if(typeof g.value=="string")try{w=JSON.parse(g.value)}catch{w=g.value}this[E]||Object.defineProperties(this,g,{value:w,writable:!0,get(){return this[E]},set(f){this.setAttribute(E,f)}}),this[E]=w,E!=="props"&&(this.props[E]=w),this.obsAttributes.push(E)});let s=new CustomEvent("resized",{detail:{props:this.props}}),c=new CustomEvent("changed",{detail:{props:this.props}}),d=new CustomEvent("deleted",{detail:{props:this.props}}),y=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(y),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(c)}),typeof this.onresize=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=g=>{this.onresize(this.props),this.dispatchEvent(s)},window.addEventListener("resize",this.ONRESIZE)}if(typeof this.ondelete=="function"){let g=this.ondelete;this.ondelete=(E=this.props)=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),this.dispatchEvent(d),g(E)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}constructor(){super()}delete=()=>{this.remove(),typeof this.ondelete=="function"&&this.ondelete(this.props)};render=(o=this.props)=>{typeof this.template=="function"?this.templateString=this.template(o):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let c=s.content;this.FRAGMENT&&(this.useShadow?this.shadowRoot.removeChild(this.FRAGMENT):this.removeChild(this.FRAGMENT)),this.useShadow?(this.attachedShadow||this.attachShadow({mode:"open"}),this.shadowRoot.prepend(c),this.FRAGMENT=this.shadowRoot.childNodes[0]):this.prepend(c),this.FRAGMENT=this.childNodes[0],this.oncreate&&this.oncreate(o)};state={pushToState:{},data:{},triggers:{},setState(o){if(Object.assign(this.pushToState,o),Object.keys(this.triggers).length>0)for(let s of Object.getOwnPropertyNames(this.triggers))this.pushToState[s]&&(this.data[s]=this.pushToState[s],delete this.pushToState[s],this.triggers[s].forEach(c=>{c.onchanged(this.data[s])}));return this.pushToState},subscribeTrigger(o,s=c=>{}){if(o){this.triggers[o]||(this.triggers[o]=[]);let c=this.triggers[o].length;return this.triggers[o].push({idx:c,onchanged:s}),this.triggers[o].length-1}else return},unsubscribeTrigger(o,s){let c,d=this.triggers[o];if(d)if(!s)delete this.triggers[o];else return d.find(g=>{if(g.idx===s)return!0})&&d.splice(c,1),!0},subscribeTriggerOnce(o=void 0,s=c=>{}){let c,d=y=>{s(y),this.unsubscribeTrigger(o,c)};c=this.subscribeTrigger(o,d)}};get props(){return this.props}set props(o={}){this.setAttribute("props",o)}get template(){return this.template}set template(o){this.setAttribute("template",o)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(o){this.setAttribute("onchanged",o)}get onresize(){return this.props}set onresize(o){this.setAttribute("onresize",o)}get ondelete(){return this.props}set ondelete(o){this.setAttribute("ondelete",o)}get oncreate(){return this.oncreate}set oncreate(o){this.setAttribute("oncreated",o)}};function Hu(l,o,s=null){try{s?o?window.customElements.define(o,l,{extends:s}):window.customElements.define(l.name.toLowerCase()+"-",l,{extends:s}):o?window.customElements.define(o,l):window.customElements.define(l.name.toLowerCase()+"-",l)}catch{}}function mc(l=""){return l+Math.floor(Math.random()*1e15)}function Er(method){let getFunctionBody=l=>l.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=l=>{let o=l.indexOf(")");return l.slice(0,l.indexOf("{",o)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;try{if(newFuncHead.includes("function ")){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else try{newFunc=eval(newFuncHead+newFuncBody+"}")}catch(err){newFunc=eval(method)}}catch(l){}return newFunc}var qo={pushToState:{},data:{},triggers:{},setState(l){Object.assign(this.data,l);for(let o of Object.getOwnPropertyNames(l))this.triggers[o]&&this.triggers[o].forEach(s=>s.onchange(this.data[o]));return this.data},subscribeTrigger(l,o=s=>{}){if(l){this.triggers[l]||(this.triggers[l]=[]);let s=this.triggers[l].length;return this.triggers[l].push({idx:s,onchange:o}),this.triggers[l].length-1}else return},unsubscribeTrigger(l,o){let s,c=this.triggers[l];if(c)if(!o)delete this.triggers[l];else return c.find(y=>{if(y.idx===o)return!0})&&c.splice(s,1),!0},subscribeTriggerOnce(l=void 0,o=s=>{}){let s,c=d=>{o(d),this.unsubscribeTrigger(l,s)};s=this.subscribeTrigger(l,c)}},Vo=class{state=qo;nodes=new Map;nNodes=0;constructor(){}convertChildrenToNodes(o){o.convertChildrenToNodes(o)}addNode(o={}){return new we(o,void 0,this)}getNode(o){return this.nodes.get(o)}run(o,s,c){if(typeof o=="string"&&(o=this.nodes.get(o)),o)return o.run(s,o,c)}runNode=this.run;removeTree(o){if(typeof o=="string"&&(o=this.nodes.get(o)),o){let s=function(c){c.children&&(Array.isArray(c.children)?c.children.forEach(d=>{d.stopNode&&d.stopNode(),d.tag&&this.nodes.get(d.tag)&&this.nodes.delete(d.tag),this.nodes.forEach(y=>{y.nodes.get(d.tag)&&y.nodes.delete(d.tag)}),s(d)}):typeof c.children=="object"&&(c.stopNode&&c.stopNode(),c.tag&&this.nodes.get(c.tag)&&this.nodes.delete(c.tag),this.nodes.forEach(d=>{d.nodes.get(c.tag)&&d.nodes.delete(c.tag)}),s(c)))};o.stopNode&&o.stopNode(),o.tag&&(this.nodes.delete(o.tag),this.nodes.forEach(c=>{c.nodes.get(o.tag)&&c.nodes.delete(o.tag)}),s(o))}}removeNode(o){typeof o=="string"&&(o=this.nodes.get(o)),o?.tag&&this.nodes.delete(o.tag),o?.tag&&this.nodes.get(o.tag)&&(this.nodes.delete(o.tag),this.nodes.forEach(s=>{s.nodes.get(o.tag)&&s.nodes.delete(o.tag)}))}appendNode(o={},s){s.addChildren(o)}async callParent(o,s,c=o,d){if(o?.parent)return await o.callParent(s,o.parent,c,d)}async callChildren(o,s,c=o,d,y){if(o?.children)return await o.callChildren(s,c,d,y)}subscribe(o,s=c=>{}){return this.state.subscribeTrigger(o,s)}unsubscribe(o,s){this.state.unsubscribeTrigger(o,s)}subscribeNode(o,s){return this.state.subscribeTrigger(o.tag,c=>{this.run(s,c,this)})}create(o=(d,y,g,E)=>{},s,c){return Vu(o,s,c,this)}print(o,s=!0){if(typeof o=="object"&&o.operator)return o.print(o,s)}reconstruct(o="{}"){let s=zi(o);s&&this.addNode(s)}},we=class{tag;parent;children;graph;state=qo;nodes=new Map;ANIMATE="animate";LOOP="loop";looper=void 0;animation=void 0;constructor(o={},s,c){!o.tag&&c?o.tag=`node${c.nNodes}`:o.tag||(o.tag=`node${Math.floor(Math.random()*1e10)}`),Object.assign(this,o),this.parent=s,this.graph=c,c&&(c.nNodes++,c.nodes.set(o.tag,this)),this.children&&this.convertChildrenToNodes(this)}operator(o,s=this,c,d){return o}runOp(o,s=this,c,d){let y=s.operator(o,s,c,d);return y instanceof Promise?y.then(g=>(this.state.setState({[s.tag]:g}),g)):this.state.setState({[s.tag]:y}),y}runNode(o,s,c){if(typeof o=="string"&&(o=this.nodes.get(o)),o)return o.run(s,o,c)}run(o,s=this,c){if(typeof s=="string"){let d;if(this.graph&&(d=this.graph.nodes.get(s)),d||(d=this.nodes.get(s)),s=d,!s)return}if(!(s.children&&s.forward||s.parent&&s.backward||s.repeat||s.delay||s.frame||s.recursive||s.operator.constructor.name==="AsyncFunction")){let d=s.runOp(s,o,c);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,o,s,c),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,o,s,c),d}return new Promise(async d=>{if(s){let y=(E,w,f=0)=>new Promise(async _=>{f++;let p=await E.runOp(w,E,c,f);if(typeof E.repeat=="number"){for(;f<E.repeat;){if(E.delay){setTimeout(async()=>{_(await y(E,w,f))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await y(E,w,f))});break}else p=await E.runOp(w,E,c,f);f++}if(f===E.repeat){_(p);return}}else if(typeof E.recursive=="number"){for(;f<E.recursive;){if(E.delay){setTimeout(async()=>{_(await y(E,p,f))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await y(E,p,f))});break}else p=await E.runOp(p,E,c,f);f++}if(f===E.recursive){_(p);return}}else{_(p);return}}),g=async()=>{let E=await y(s,o);if(s.backward&&s.parent&&await this.runNode(s.parent,E,s),s.children&&s.forward)if(Array.isArray(s.children))for(let w=0;w<s.children.length;w++)await this.runNode(s.children[w],E,s);else await this.runNode(s.children,E,s);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,o,s,c),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,o,s,c),E};s.delay?setTimeout(async()=>{d(await g())},s.delay):s.frame&&requestAnimationFrame?requestAnimationFrame(async()=>{d(await g())}):d(await g())}else d(void 0)})}runAnimation(o=this.animation,s,c=this,d){if(this.animation=o,o||(this.animation=this.operator),c.animate&&!c.isAnimating){c.isAnimating=!0;let y=async()=>{if(c.isAnimating){let g=await this.animation(s,c,d,this.ANIMATE);if(this.tag&&typeof g<"u"&&(this.state.setState({[this.tag]:g}),c.backward&&c.parent&&await this.runNode(c.parent,g,c),c.children&&c.forward))if(Array.isArray(c.children))for(let E=0;E<c.children.length;E++)await this.runNode(c.children[E],g,c);else await this.runNode(c.children,g,c);requestAnimationFrame(async()=>{await y()})}};requestAnimationFrame(y)}}runLoop(o=this.looper,s,c=this,d){if(this.looper=o,o||(this.looper=this.operator),typeof c.loop=="number"&&!c.isLooping){c.isLooping=!0;let y=async()=>{if(c.looping){let g=await this.looper(s,c,d);if(this.tag&&typeof g<"u"&&(this.state.setState({[this.tag]:g}),c.backward&&c.parent&&await this.runNode(c.parent,g,c),c.children&&c.forward))if(Array.isArray(c.children))for(let E=0;E<c.children.length;E++)await this.runNode(c.children[E],g,c);else await this.runNode(c.children,g,c);setTimeout(async()=>{await y()},c.loop)}}}}setOperator(o=function(c,d=this,y,g){return c}){this.operator=o}setParent(o){this.parent=o}setChildren(o){this.children=o}removeTree(o){if(typeof o=="string"&&(o=this.nodes.get(o)),o){let s=function(c){c.children&&(Array.isArray(c.children)?c.children.forEach(d=>{d.stopNode&&d.stopNode(),d.tag&&this.nodes.get(d.tag)&&this.nodes.delete(d.tag),this.nodes.forEach(y=>{y.nodes.get(d.tag)&&y.nodes.delete(d.tag)}),s(d)}):typeof c.children=="object"&&(c.stopNode&&c.stopNode(),c.tag&&this.nodes.get(c.tag)&&this.nodes.delete(c.tag),this.nodes.forEach(d=>{d.nodes.get(c.tag)&&d.nodes.delete(c.tag)}),s(c)))};o.stopNode&&o.stopNode(),o.tag&&(this.nodes.delete(o.tag),this.nodes.forEach(c=>{c.nodes.get(o.tag)&&c.nodes.delete(o.tag)}),s(o),this.graph&&this.graph.nodes.removeTree(o))}}addNode(o={}){let s=new we(o,this,this.graph);return this.nodes.set(convertedtag,s),this.graph&&this.graph.nodes.set(s.tag,s),s}removeNode(o){typeof o=="string"&&(o=this.nodes.get(o)),o?.tag&&this.nodes.delete(o.tag),o?.tag&&this.nodes.get(o.tag)&&(this.nodes.delete(o.tag),this.graph&&this.graph.nodes.delete(o.tag),this.nodes.forEach(s=>{s.nodes.get(o.tag)&&s.nodes.delete(o.tag)}))}appendNode(o,s=this){typeof o=="string"&&(o=this.nodes.get(o)),o&&s.addChildren(o)}getNode(o){return this.nodes.get(o)}stopLooping(o=this){o.isLooping=!1}stopAnimating(o=this){o.isAnimating=!1}stopNode(o=this){o.stopAnimating(o),o.stopLooping(o)}addChildren(o){this.children||(this.children=[]),Array.isArray(this.children)?Array.isArray(o)?(this.children.push(...o),o.forEach(s=>{typeof s=="object"&&s.tag&&(this.nodes.set(s.tag,s),this.graph&&this.graph.nodes.set(s.tag,s))})):(this.children.push(o),typeof o=="object"&&o.tag&&(this.nodes.set(o.tag,o),this.graph&&this.graph.nodes.set(o.tag,o))):(this.children=[o],typeof o=="object"&&o.tag&&(this.nodes.set(o.tag,o),this.graph&&this.graph.nodes.set(o.tag,o)))}convertChildrenToNodes(o=this){if(o.children?.name==="GraphNode")this.graph?.nodes.get(o.tag)||this.graph.nodes.set(o.tag,o),this.nodes.get(o.tag)||this.nodes.set(o.tag,o);else if(Array.isArray(o.children))for(let s=0;s<o.children.length;s++)if(o.children[s].name==="GraphNode"){this.graph?.nodes.get(o.children[s].tag)||this.graph.nodes.set(o.children[s].tag,o.children[s]),this.nodes.get(o.children[s].tag)||this.nodes.set(o.children[s].tag,o.children[s]);continue}else typeof o.children[s]=="object"?(o.children[s]=new we(o.children[s],o,this.graph),this.nodes.set(o.children[s].tag,o.children[s]),this.convertChildrenToNodes(o.children[s])):typeof o.children[s]=="string"&&(this.graph&&(o.children[s]=this.graph.getNode(o.children[s]),this.nodes.get(o.children[s].tag)||this.nodes.set(o.children[s].tag,o.children[s])),o.children[s]||(o.children[s]=this.nodes.get(o.children[s])));else typeof o.children=="object"?(o.children=new we(o.children,o,this.graph),this.nodes.set(o.children.tag,o.children),this.convertChildrenToNodes(o.children)):typeof o.children=="string"&&(this.graph&&(o.children=this.graph.getNode(o.children),this.nodes.get(o.children.tag)||this.nodes.set(o.children.tag,o.children)),o.children||(o.children=this.nodes.get(o.children)));return o.children}async callParent(o,s=this,c){if(typeof this.parent?.operator=="function")return await this.parent.runOp(o,this.parent,s,c)}async callChildren(o,s=this,c,d){let y;if(Array.isArray(this.children))if(d)y=await this.children[d]?.runOp(o,this.children[d],s,c);else{y=[];for(let g=0;g<this.children.length;g++)y.push(await this.children[g]?.runOp(o,this.children[g],s,c))}else this.children&&(y=await this.children.runOp(o,this.children,s,c));return y}setProps(o={}){Object.assign(this,o)}subscribe(o=c=>{},s=this.tag){return typeof o=="object"?this.subscribeNode(o):this.state.subscribeTrigger(s,o)}unsubscribe(o,s=this.tag){this.state.unsubscribeTrigger(s,o)}subscribeNode(o,s=this.tag){return this.state.subscribeTrigger(s,c=>{this.runNode(o,c,this)})}print(o=this,s=!0,c=[]){let d=new we;c.push(o.tag);let y={tag:o.tag,operator:o.operator.toString()};o.parent&&(y.parent=o.parent.tag),o.children&&(Array.isArray(o.children)?o.children=o.children.map(g=>typeof g=="string"?g:c.includes(g.tag)?g.tag:s?g.print(g,s,c):g.tag):typeof o.children=="object"?(s||(y.children=[o.children.tag]),c.includes(o.children.tag)?y.children=[o.children.tag]:y.children=[o.children.print(o.children,s,c)]):typeof o.children=="string"&&(y.children=[o.children]));for(let g in o)g==="parent"||g==="children"||typeof d[g]>"u"&&(typeof o[g]=="function"?y[g]=o[g].toString():typeof o[g]=="object"?y[g]=JSON.stringifyWithCircularRefs(o[g]):y[g]=o[g]);return JSON.stringify(y)}reconstruct(o="{}"){let s=zi(o);s&&this.addNode(s)}};function Vu(l,o,s,c){return typeof s=="object"?(s.operator=l,new we(s,o,c)):new we({operator:l},o,c)}function _c(l="{}",o,s){let c=zi(l);if(c)return new we(c,o,s)}function zi(l="{}"){try{let s=function(c){for(let d in c)if(typeof c[d]=="string"){let y=qu(c[d]);typeof y=="function"&&(c[d]=y)}else typeof c[d]=="object"&&s(c[d]);return c},o=JSON.parse(l);return s(o)}catch(o){console.error(o);return}}JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=function(){let l=new Map,o=[],s=["this"];function c(){l.clear(),o.length=0,s.length=1}function d(g,E){var w=o.length-1,f=o[w];if(typeof f=="object")if(f[g]===E||w===0)s.push(g),o.push(E.pushed);else for(;w-->=0;){if(f=o[w],typeof f=="object"&&f[g]===E){w+=2,o.length=w,s.length=w,--w,o[w]=E,s[w]=g;break}w--}}function y(g,E){if(E!=null&&typeof E=="object"){g&&d(g,E);let w=l.get(E);if(w)return"[Circular Reference]"+w;l.set(E,s.join("."))}return E}return function(E,w){try{return o.push(E),JSON.stringify(E,y,w)}finally{c()}}}());function qu(method=""){let getFunctionBody=l=>l.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=l=>{let o=l.indexOf(")");return l.slice(0,l.indexOf("{",o)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var Xu=Zo(),Ur=class extends oi{props={operator:(o,s,c,d)=>(console.log(o),o),forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};input_delay=1;template=Xu;render=(o=this.props)=>{typeof this.template=="function"?this.templateString=this.template(o):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let c=s.content;this.fragment&&this.removeChild(this.fragment),this.fragment=c,this.appendChild(c),this.setupNode(this.props),this.props.input&&setTimeout(async()=>{this.props.node.runNode(this.props.node,this.props.input,this.props.graph)},this.input_delay),this.oncreate&&this.oncreate(o)};setupNode(o){let s=this.parentNode;if(s.props?.operator&&s.props?.node&&(o.parent=s.props.node),!o.graph){for(;!s.props?.nodes&&!(s.constructor.name==="HTMLBodyElement"||s.constructor.name==="HTMLHeadElement"||s.constructor.name==="HTMLHtmlElement"||s.constructor.name==="HTMLDocument");)s=s.parentNode;s.props?.nodes&&(o.graph=s.props.graph,o.input_delay=s.props.input_delay)}this.id&&!o.tag&&(o.tag=this.id),o.graph&&!o.node&&o.tag?o.node=o.graph.nodes.get(o.tag):o.graph&&typeof o.node=="string"&&(o.node=o.graph.nodes.get(o.node)),o.node||(o.node=new we(o,o.parent,o.graph)),o.tag=o.node.tag,this.id||(this.id=o.tag),o.parent&&o.parent.addChildren(o.node)}};Ur.addElement("graph-node");var Gu=Xo(),ji=class extends Ur{bitmap;bitslice;canvas;ctx;offscreen;offscreenctx;capture;capturectx;capturegraph;capturegraphctx;graphVideoSnip=!1;img;video;imgselect;captures={};loaded={};imgfiles={"Test Image":"src/assets/spectrum_full.png","Spectrum 1":"src/assets/spectrum1.png","Spectrum 2":"src/assets/spectrum2.jpg",Shrimp:"src/assets/shrimp.jpg","Chicken Fat":"src/assets/chickenfat.png","Chicken Breast":"src/assets/chickenbreast.png","Brown Beer Bottle":"src/assets/brownbeerbottle.png"};comparing={};template=Gu;props={picking:0,picked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},imgpicked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},running:!1,mode:"img",animation:(o,s,c,d)=>{},operator:(o,s,c,d)=>{},forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};oncreate=o=>{this.canvas=this.querySelector("#picker"),this.pickerDiv=this.querySelector("#pickerDiv"),this.captureDiv=this.querySelector("#captureDiv"),this.imgmenu=this.querySelector("#imgmenu"),this.videomenu=this.querySelector("#videomenu"),this.urlmenu=this.querySelector("#urlmenu"),this.imgselect=this.querySelector("#imgselect"),this.select=this.querySelector("#imgselect"),this.capture=this.querySelector("#capture"),this.capturectx=this.capture.getContext("2d"),this.capturegraph=this.querySelector("#capturegraph"),this.capturegraphctx=this.capturegraph.getContext("2d"),this.menu=this.querySelector("#menu"),this.toggleMenu=this.querySelector("#toggleMenu");for(let c in this.imgfiles){let d=`<option value="${this.imgfiles[c]}">${c}</option>`;this.imgselect.insertAdjacentHTML("beforeend",d)}this.imgselect.options[0].selected=!0,this.imgselect.oninput=this.useImage,this.querySelector("#useurl").onclick=()=>{this.urlmenu.style.display=="none"?this.urlmenu.style.display="":this.urlmenu.style.display="none"},this.querySelector("#help").onclick=()=>{let c=this.querySelector("#instructions");c.style.display=="none"?c.style.display="":c.style.display="none"},this.querySelector("#showgraph").onclick=()=>{this.graphVideoSnip=!this.graphVideoSnip},this.img=this.querySelector("img"),this.img.addEventListener("load",c=>{this.props.mode="img",this.imgmenu.style.display="",this.videomenu.style.display="none",this.urlmenu.style.display="none",this.querySelector("#sourcedeets").innerHTML=`Source Resolution: ${this.img.naturalWidth}x${this.img.naturalHeight}`,this.onresize()}),this.video=this.querySelector("video"),this.video.addEventListener("canplay",c=>{this.props.mode="video",this.imgmenu.style.display="none",this.videomenu.style.display="",this.urlmenu.style.display="none",this.querySelector("#sourcedeets").innerHTML=`Source Resolution: ${this.video.videoWidth}x${this.video.videoHeight}`,this.onresize()}),this.toggleMenu.onclick=()=>{this.menu.style.display==="none"?this.menu.style.display="":this.menu.style.display="none"},this.querySelector("#fileinput").onchange=this.handleFileInput,this.querySelector("#snip").onclick=c=>{this.props.picked.y1&&this.props.picked.x1&&this.canvasCapture(c)};let s=()=>{if(this.props.mode==="video"&&this.props.picked.y1&&this.props.picked.x1){this.props.running=!0;let c=zo(this.capture);this.querySelector("#record").innerHTML="\u2B1C",this.querySelector("#record").onclick=()=>{this.props.running=!1,c.stop(),this.querySelector("#record").innerHTML="\u{1F534}",this.querySelector("#record").onclick=s},c.start()}};this.querySelector("#record").onclick=s,this.select.onchange=c=>{},this.querySelector("#webcam").onclick=this.useWebcam,this.querySelector("#image").onclick=this.useImage,this.querySelector("#seturl").onclick=()=>{this.querySelector("#urlselect").value==img?this.inputImgUrl():this.inputVideoSrc()},this.querySelector("#fileinput").onclick=this.loadFile,o.canvas=this.canvas,o.context?o.context=this.canvas.getContext(o.context):o.context=this.canvas.getContext("2d"),this.context=o.context,this.ctx=this.context,o.ctx=this.context,this.offscreen=new OffscreenCanvas(this.canvas.width,this.canvas.height),this.offscreenctx=this.offscreen.getContext("2d"),this.canvas.onclick=this.canvasClicked,setTimeout(()=>{o.animate&&o.node.runAnimation()},10);try{this.useImage()}catch(c){console.error(c)}this.img.width=0,setTimeout(()=>{this.onresize()},50)};onresize=o=>{let s,c=this.pickerDiv.clientWidth;this.props.mode==="img"?(s=this.img.naturalHeight/this.img.naturalWidth,this.correctForRatio(this.img,c,this.pickerDiv.clientHeight,s)):this.props.mode==="video"&&(s=this.video.videoHeight/this.video.videoWidth,this.correctForRatio(this.video,c,this.pickerDiv.clientHeight,s)),this.canvas&&(this.props.mode==="img"&&this.img?.naturalWidth>0?this.correctForRatio(this.canvas,c,this.pickerDiv.clientHeight,s):this.props.mode==="video"&&this.video&&this.video?.videoWidth>0?this.correctForRatio(this.canvas,c,this.pickerDiv.clientHeight,s):(this.canvas.width=this.canvas.parentNode.clientWidth,this.canvas.height=this.canvas.parentNode.clientHeight,this.canvas.style.width=this.canvas.parentNode.clientWidth,this.canvas.style.height=this.canvas.parentNode.clientHeight))};useWebcam=()=>{this.props.running=!1,this.img.style.display="none",this.video.src&&(this.graphVideoSnip=!1,this.capturegraphctx.clearRect(0,0,this.capturegraph.width,this.capturegraph.height),this.video.pause(),this.video.src=""),this.video.style.display="",navigator.getUserMedia&&navigator.getUserMedia({video:!0},o=>{this.video.srcObject=o,this.video.play(),this.props.mode="video"},console.error)};useImage=()=>{this.props.running=!1,this.video.src&&(this.graphVideoSnip=!1,this.capturegraphctx.clearRect(0,0,this.capturegraph.width,this.capturegraph.height),this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=this.select.options[this.select.selectedIndex].value,this.img.style.display="",this.props.mode="img",this.onresize()};inputImgUrl(){this.props.running=!1;let o=this.querySelector("#urlinput").value;o&&(this.video.src&&(this.graphVideoSnip=!1,this.capturegraphctx.clearRect(0,0,this.capturegraph.width,this.capturegraph.height),this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=o,this.img.style.display="",this.props.mode="img",this.onresize())}inputVideoSrc(){this.props.running=!1,this.img.style.display="none",this.video.style.display="";let o=this.querySelector("#urlinput").value;o&&(this.video.src&&(this.graphVideoSnip=!1,this.capturegraphctx.clearRect(0,0,this.capturegraph.width,this.capturegraph.height),this.video.pause(),this.video.src=""),this.video.src=o,this.video.play(),this.props.mode="video",this.onresize())}loadFile=()=>{var o=document.createElement("input");o.accept=".mp4,.png,.bmp,.jpg",o.type="file",o.onchange=s=>{let c=s.target.files[0],d=URL.createObjectURL(c);if(this.loaded[o.value]=d,this.video.src&&(this.graphVideoSnip=!1,this.capturegraphctx.clearRect(0,0,this.capturegraph.width,this.capturegraph.height),this.video.pause(),this.video.src="",this.video.style.display="none"),o.value.endsWith(".mp4"))this.props.mode="video",this.video.src=d,this.video.play();else if(this.props.mode="img",o.value.endsWith(".bmp")){var y=new FileReader;y.onload=g=>{var E=g.target.result,w=jo(E);let f=Wo(w);this.img.src=f},y.readAsArrayBuffer(c)}else this.img.src=d},o.click()};drawCircle(o,s,c,d="green",y=5,g="#003300",E=this.ctx){E.beginPath(),E.arc(o,s,c,0,2*Math.PI,!1),E.fillStyle=d,E.fill(),E.lineWidth=y,E.strokeStyle=g,E.closePath(),E.stroke()}drawLine(o={x:0,y:0},s={x:1,y:1},c=5,d="#003300",y=this.ctx){y.beginPath(),y.lineWidth=c,y.strokeStyle=d,y.moveTo(o.x,o.y),y.lineTo(s.x,s.y),y.stroke()}canvasClicked=o=>{if(this.props.running=!1,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.props.picking===0){this.props.picked.x0=o.pageX-this.canvas.offsetLeft,this.props.picked.y0=o.pageY-this.canvas.offsetTop,this.props.picked.x1=void 0,this.props.picked.y1=void 0;let s;this.props.mode==="img"?s=Mr(this.img,this.canvas,this.props.picked.x0,this.props.picked.y0):this.props.mode==="video"&&(s=Mr(this.video,this.canvas,this.props.picked.x0,this.props.picked.y0)),this.props.imgpicked.x0=s.x,this.props.imgpicked.y0=s.y,this.props.imgpicked.x1=void 0,this.props.imgpicked.y1=void 0,this.drawCircle(this.props.picked.x0,this.props.picked.y0,2.5,"orange",1,"orange"),this.props.picking=1}else{this.props.picked.x1=o.pageX-this.canvas.offsetLeft,this.props.picked.y1=o.pageY-this.canvas.offsetTop;let s;if(this.props.mode==="img"?s=Mr(this.img,this.canvas,this.props.picked.x1,this.props.picked.y1):this.props.mode==="video"&&(s=Mr(this.video,this.canvas,this.props.picked.x1,this.props.picked.y1)),this.props.imgpicked.x1=s.x,this.props.imgpicked.y1=s.y,this.props.picked.x1<this.props.picked.x0){let c=this.props.picked.x1;this.props.picked.x1=this.props.picked.x0,this.props.picked.x0=c,c=this.props.imgpicked.x1,this.props.imgpicked.x1=this.props.imgpicked.x0,this.props.imgpicked.x0=c}if(this.props.picked.y1<this.props.picked.y0){let c=this.props.picked.y1;this.props.picked.y1=this.props.picked.y0,this.props.picked.y0=c,c=this.props.imgpicked.y1,this.props.imgpicked.y1=this.props.imgpicked.y0,this.props.imgpicked.y0=c}this.props.picking=0,this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.strokeStyle="orange",this.ctx.rect(this.props.picked.x0,this.props.picked.y0,Math.abs(this.props.picked.x1-this.props.picked.x0),Math.abs(this.props.picked.y1-this.props.picked.y0)),this.ctx.stroke(),this.querySelector("#capturedeets").innerHTML=`Snip Resolution (actual): ${Math.round(Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0))}x${Math.round(Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0))}`,this.capture.width=this.captureDiv.clientWidth,this.capture.height=this.captureDiv.clientHeight,this.props.mode==="video"?this.continuousCapture(this.video):Po(this.capturectx,this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capture.width,this.capture.height)}};async continuousCapture(o){if(this.props.imgpicked.x1&&this.props.imgpicked.x0&&this.props.imgpicked.y1&&this.props.imgpicked.y0){if(this.capturectx.drawImage(o,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capture.width,this.capture.height),this.graphVideoSnip){let s=this.capturectx.getImageData(0,0,this.capture.width,this.capture.height),c=Pi(this.capturectx,s)}setTimeout(()=>{requestAnimationFrame(async()=>{this.continuousCapture(o)})},33.3333)}}processCapture=o=>{let s=this.createBitmapCanvasWithMenu(o,this.querySelector("#capturelist"),"100%");s.timestamp&&(this.captures[s.timestamp]=s)};canvasCapture(o){if(this.props.mode==="img"){if(!this.img.src)return;createImageBitmap(this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}else if(this.props.mode==="video"){if(!this.video.src)return;createImageBitmap(this.video,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}}correctForRatio=(o,s,c,d)=>{s*d>c?(o.height=c,o.width=o.height/d):(o.width=s,o.height=o.width*d)};async createBitmapCanvasWithMenu(o,s,c="320px",d="180px"){let y=`
        <div style='width:${c}; max-height:${d}; border: 1px solid white; border-radius:3px; padding:2px;'>
            <span style='height:6%;'>
                <input id='title' type='text' placeholder='Name/Tag' style='padding:4px; font-size:8px; width:15%;'>
                <button id='savepng' title='Save PNG?' style='font-size:8px;'>\u{1F5BC}\uFE0F(png)</button>
                <button id='savecsv' title='Save CSV?' style='font-size:8px;'>\u{1F4C4}(csv)</button>
                <button id='savebmp' title='Save BMP?' style='font-size:8px;'>\u{1F5BC}\uFE0F(bmp)</button>
                <button id='backup' title='Backup (cache)?' style='font-size:8px;'>\u{1F4CB}
                </button><button  title='Close?' id='X' style='font-size:8px; float:right;'>\u274C</button>
                <button id='toggledisplay' title='Toggle display?' style='font-size:8px; float:right;'>\u{1F453}</button>
                
            </span><br>
            <canvas id='capturecanvas' style='width:100%; max-height:30%;'></canvas>
            <canvas id='graphcanvas' style='width:100%; height:54%; background-color:black;'></canvas>
        </div><br>`;if(typeof s=="string"&&(s=document.getElementById(s)),s){s.insertAdjacentHTML("afterbegin",y);let g=document.querySelector("#capturecanvas");g.width=o.width,g.height=o.height;let E=g.getContext("2d");E.drawImage(o,0,0);let w=document.querySelector("#title"),f=E.getImageData(0,0,g.width,g.height),_=document.querySelector("#graphcanvas");_.width=g.width,_.height=g.height;let p=Pi(_.getContext("2d"),f),T={node:g.parentNode,parentNode:s,width:o.width,height:o.height,canvas:g,input:w,timestamp:Date.now(),mapped:p};return s.querySelector("#toggledisplay").onclick=()=>{g.style.display==""&&_.style.display==""?g.style.display="none":g.style.display=="none"?(g.style.display="",_.style.display="none"):_.style.display=="none"&&(_.style.display="")},s.querySelector("#backup").onclick=()=>{Mo(T.mapped,w.value+"_"+new Date().toISOString())},s.querySelector("#savepng").onclick=()=>{let A=new OffscreenCanvas(T.mapped.bitmap.width,T.mapped.bitmap.height);A.getContext("2d").drawImage(o,0,0);let b=new FileReader;b.addEventListener("load",function(){var L=document.createElement("a");L.href=b.result,L.target="_blank",w.value!==""?L.download=w.value+"_"+new Date().toISOString()+".png":L.download=new Date().toISOString()+".png",L.click()},!1),A.convertToBlob({type:"image/png"}).then(L=>{b.readAsDataURL(L)})},s.querySelector("#savebmp").onclick=()=>{let A=Ui.ImageDatatoDataURL(Uo(T.mapped.bitarr,T.mapped.width,T.mapped.height));var b=document.createElement("a");b.href=A,b.target="_blank",w.value!==""?b.download=w.value+"_"+new Date().toISOString()+".bmp":b.download=new Date().toISOString()+".bmp",b.click()},s.querySelector("#savecsv").onclick=()=>{Ho(T.mapped.xrgbintensities,w.value)},s.querySelector("#X").onclick=()=>{g.parentNode.parentNode.removeChild(g.parentNode)},T}return y}async addBitmapComparison(o){}};ji.addElement("spectrometer-node");po(["processed"]);var Ju=document.createElement("spectrometer-node");document.body.appendChild(Ju);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
* @license  MIT
*/
/*! canvas-to-bmp version 1.0 ALPHA https://stackoverflow.com/questions/29652307/canvas-unable-to-generate-bmp-image-dataurl-in-chrome
    (c) 2015 Ken "Epistemex" Fyrstenberg, modified by Josh Brewster 2022
    MIT License (this header required)
*/
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
