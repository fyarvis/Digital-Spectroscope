(()=>{var iu=Object.create;var uo=Object.defineProperty;var nu=Object.getOwnPropertyDescriptor;var ou=Object.getOwnPropertyNames;var su=Object.getPrototypeOf,au=Object.prototype.hasOwnProperty;var yr=(l,n)=>()=>(n||l((n={exports:{}}).exports,n),n.exports);var uu=(l,n,s,f)=>{if(n&&typeof n=="object"||typeof n=="function")for(let y of ou(n))!au.call(l,y)&&y!==s&&uo(l,y,{get:()=>n[y],enumerable:!(f=nu(n,y))||f.enumerable});return l};var fo=(l,n,s)=>(s=l!=null?iu(su(l)):{},uu(n||!l||!l.__esModule?uo(s,"default",{value:l,enumerable:!0}):s,l));var co=yr((Cr,Ii)=>{(function(n,s){typeof Cr=="object"&&typeof Ii=="object"?Ii.exports=s():typeof define=="function"&&define.amd?define([],s):typeof Cr=="object"?Cr.BrowserFS=s():n.BrowserFS=s()})(Cr,function(){return function(l){var n={};function s(f){if(n[f])return n[f].exports;var y=n[f]={exports:{},id:f,loaded:!1};return l[f].call(y.exports,y,y.exports,s),y.loaded=!0,y.exports}return s.m=l,s.c=n,s.p="",s(0)}([function(l,n,s){(function(f,y,d,m){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var E=s(2),w=s(9),c;(function(i){i[i.EPERM=1]="EPERM",i[i.ENOENT=2]="ENOENT",i[i.EIO=5]="EIO",i[i.EBADF=9]="EBADF",i[i.EACCES=13]="EACCES",i[i.EBUSY=16]="EBUSY",i[i.EEXIST=17]="EEXIST",i[i.ENOTDIR=20]="ENOTDIR",i[i.EISDIR=21]="EISDIR",i[i.EINVAL=22]="EINVAL",i[i.EFBIG=27]="EFBIG",i[i.ENOSPC=28]="ENOSPC",i[i.EROFS=30]="EROFS",i[i.ENOTEMPTY=39]="ENOTEMPTY",i[i.ENOTSUP=95]="ENOTSUP"})(c||(c={}));var _={};_[c.EPERM]="Operation not permitted.",_[c.ENOENT]="No such file or directory.",_[c.EIO]="Input/output error.",_[c.EBADF]="Bad file descriptor.",_[c.EACCES]="Permission denied.",_[c.EBUSY]="Resource busy or locked.",_[c.EEXIST]="File exists.",_[c.ENOTDIR]="File is not a directory.",_[c.EISDIR]="File is a directory.",_[c.EINVAL]="Invalid argument.",_[c.EFBIG]="File is too big.",_[c.ENOSPC]="No space left on disk.",_[c.EROFS]="Cannot modify a read-only file system.",_[c.ENOTEMPTY]="Directory is not empty.",_[c.ENOTSUP]="Operation is not supported.";var p=function(i){function t(r,e,o){e===void 0&&(e=_[r]),i.call(this,e),this.syscall="",this.errno=r,this.code=c[r],this.path=o,this.stack=new i().stack,this.message="Error: "+this.code+": "+e+(this.path?", '"+this.path+"'":"")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.fromJSON=function(e){var o=new t(0);return o.errno=e.errno,o.code=e.code,o.path=e.path,o.stack=e.stack,o.message=e.message,o},t.fromBuffer=function(e,o){return o===void 0&&(o=0),t.fromJSON(JSON.parse(e.toString("utf8",o+4,o+4+e.readUInt32LE(o))))},t.FileError=function(e,o){return new t(e,_[e],o)},t.ENOENT=function(e){return this.FileError(c.ENOENT,e)},t.EEXIST=function(e){return this.FileError(c.EEXIST,e)},t.EISDIR=function(e){return this.FileError(c.EISDIR,e)},t.ENOTDIR=function(e){return this.FileError(c.ENOTDIR,e)},t.EPERM=function(e){return this.FileError(c.EPERM,e)},t.ENOTEMPTY=function(e){return this.FileError(c.ENOTEMPTY,e)},t.prototype.toString=function(){return this.message},t.prototype.toJSON=function(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message}},t.prototype.writeToBuffer=function(e,o){e===void 0&&(e=f.alloc(this.bufferSize())),o===void 0&&(o=0);var a=e.write(JSON.stringify(this.toJSON()),o+4);return e.writeUInt32LE(a,o),e},t.prototype.bufferSize=function(){return 4+f.byteLength(JSON.stringify(this.toJSON()))},t}(Error),T=Object.freeze({get ErrorCode(){return c},ErrorStrings:_,ApiError:p}),A;(function(i){i[i.NOP=0]="NOP",i[i.THROW_EXCEPTION=1]="THROW_EXCEPTION",i[i.TRUNCATE_FILE=2]="TRUNCATE_FILE",i[i.CREATE_FILE=3]="CREATE_FILE"})(A||(A={}));var b=function i(t){if(this.flagStr=t,i.validFlagStrs.indexOf(t)<0)throw new p(c.EINVAL,"Invalid flag: "+t)};b.getFileFlag=function(t){return b.flagCache.hasOwnProperty(t)?b.flagCache[t]:b.flagCache[t]=new b(t)},b.prototype.getFlagString=function(){return this.flagStr},b.prototype.isReadable=function(){return this.flagStr.indexOf("r")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isWriteable=function(){return this.flagStr.indexOf("w")!==-1||this.flagStr.indexOf("a")!==-1||this.flagStr.indexOf("+")!==-1},b.prototype.isTruncating=function(){return this.flagStr.indexOf("w")!==-1},b.prototype.isAppendable=function(){return this.flagStr.indexOf("a")!==-1},b.prototype.isSynchronous=function(){return this.flagStr.indexOf("s")!==-1},b.prototype.isExclusive=function(){return this.flagStr.indexOf("x")!==-1},b.prototype.pathExistsAction=function(){return this.isExclusive()?A.THROW_EXCEPTION:this.isTruncating()?A.TRUNCATE_FILE:A.NOP},b.prototype.pathNotExistsAction=function(){return(this.isWriteable()||this.isAppendable())&&this.flagStr!=="r+"?A.CREATE_FILE:A.THROW_EXCEPTION},b.flagCache={},b.validFlagStrs=["r","r+","rs","rs+","w","wx","w+","wx+","a","ax","a+","ax+"];var L;(function(i){i[i.FILE=32768]="FILE",i[i.DIRECTORY=16384]="DIRECTORY",i[i.SYMLINK=40960]="SYMLINK"})(L||(L={}));var C=function(t,r,e,o,a,u){if(o===void 0&&(o=new Date),a===void 0&&(a=new Date),u===void 0&&(u=new Date),this.size=r,this.atime=o,this.mtime=a,this.ctime=u,this.dev=0,this.ino=0,this.rdev=0,this.nlink=1,this.blksize=4096,this.uid=0,this.gid=0,this.birthtime=new Date(0),this.fileData=null,e)this.mode=e;else switch(t){case L.FILE:this.mode=420;break;case L.DIRECTORY:default:this.mode=511}this.blocks=Math.ceil(r/512),this.mode<4096&&(this.mode|=t)};C.fromBuffer=function(t){var r=t.readUInt32LE(0),e=t.readUInt32LE(4),o=t.readDoubleLE(8),a=t.readDoubleLE(16),u=t.readDoubleLE(24);return new C(e&61440,r,e&4095,new Date(o),new Date(a),new Date(u))},C.prototype.toBuffer=function(){var t=f.alloc(32);return t.writeUInt32LE(this.size,0),t.writeUInt32LE(this.mode,4),t.writeDoubleLE(this.atime.getTime(),8),t.writeDoubleLE(this.mtime.getTime(),16),t.writeDoubleLE(this.ctime.getTime(),24),t},C.prototype.clone=function(){return new C(this.mode&61440,this.size,this.mode&4095,this.atime,this.mtime,this.ctime)},C.prototype.isFile=function(){return(this.mode&61440)===L.FILE},C.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY},C.prototype.isSymbolicLink=function(){return(this.mode&61440)===L.SYMLINK},C.prototype.chmod=function(t){this.mode=this.mode&61440|t},C.prototype.isSocket=function(){return!1},C.prototype.isBlockDevice=function(){return!1},C.prototype.isCharacterDevice=function(){return!1},C.prototype.isFIFO=function(){return!1};var G=function(i,t){return i};function W(i){if(i)return i;throw new p(c.EIO,"Initialize BrowserFS with a file system using BrowserFS.initialize(filesystem)")}function U(i,t){switch(typeof i){case"number":return i;case"string":var r=parseInt(i,8);return isNaN(r)?t:r;default:return t}}function Et(i){if(i instanceof Date)return i;if(typeof i=="number")return new Date(i*1e3);throw new p(c.EINVAL,"Invalid time.")}function et(i){if(i.indexOf("\0")>=0)throw new p(c.EINVAL,"Path must be a string without null bytes.");if(i==="")throw new p(c.EINVAL,"Path must not be empty.");return w.resolve(i)}function wt(i,t,r,e){switch(typeof i){case"object":return{encoding:typeof i.encoding<"u"?i.encoding:t,flag:typeof i.flag<"u"?i.flag:r,mode:U(i.mode,e)};case"string":return{encoding:i,flag:r,mode:e};default:return{encoding:t,flag:r,mode:e}}}function pt(){}var M=function(){this.F_OK=0,this.R_OK=4,this.W_OK=2,this.X_OK=1,this.root=null,this.fdMap={},this.nextFd=100};M.prototype.initialize=function(t){if(!t.constructor.isAvailable())throw new p(c.EINVAL,"Tried to instantiate BrowserFS with an unavailable file system.");return this.root=t},M.prototype._toUnixTimestamp=function(t){if(typeof t=="number")return t;if(t instanceof Date)return t.getTime()/1e3;throw new Error("Cannot parse time: "+t)},M.prototype.getRootFS=function(){return this.root?this.root:null},M.prototype.rename=function(t,r,e){e===void 0&&(e=pt);var o=G(e,1);try{W(this.root).rename(et(t),et(r),o)}catch(a){o(a)}},M.prototype.renameSync=function(t,r){W(this.root).renameSync(et(t),et(r))},M.prototype.exists=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).exists(et(t),e)}catch{return e(!1)}},M.prototype.existsSync=function(t){try{return W(this.root).existsSync(et(t))}catch{return!1}},M.prototype.stat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!1,e)}catch(o){return e(o)}},M.prototype.statSync=function(t){return W(this.root).statSync(et(t),!1)},M.prototype.lstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{return W(this.root).stat(et(t),!0,e)}catch(o){return e(o)}},M.prototype.lstatSync=function(t){return W(this.root).statSync(et(t),!0)},M.prototype.truncate=function(t,r,e){r===void 0&&(r=0),e===void 0&&(e=pt);var o=0;typeof r=="function"?e=r:typeof r=="number"&&(o=r);var a=G(e,1);try{if(o<0)throw new p(c.EINVAL);return W(this.root).truncate(et(t),o,a)}catch(u){return a(u)}},M.prototype.truncateSync=function(t,r){if(r===void 0&&(r=0),r<0)throw new p(c.EINVAL);return W(this.root).truncateSync(et(t),r)},M.prototype.unlink=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{return W(this.root).unlink(et(t),e)}catch(o){return e(o)}},M.prototype.unlinkSync=function(t){return W(this.root).unlinkSync(et(t))},M.prototype.open=function(t,r,e,o){var a=this;o===void 0&&(o=pt);var u=U(e,420);o=typeof e=="function"?e:o;var h=G(o,2);try{W(this.root).open(et(t),b.getFileFlag(r),u,function(S,x){x?h(S,a.getFdForFile(x)):h(S)})}catch(S){h(S)}},M.prototype.openSync=function(t,r,e){return e===void 0&&(e=420),this.getFdForFile(W(this.root).openSync(et(t),b.getFileFlag(r),U(e,420)))},M.prototype.readFile=function(t,r,e){r===void 0&&(r={}),e===void 0&&(e=pt);var o=wt(r,null,"r",null);e=typeof r=="function"?r:e;var a=G(e,2);try{var u=b.getFileFlag(o.flag);return u.isReadable()?W(this.root).readFile(et(t),o.encoding,u,a):a(new p(c.EINVAL,"Flag passed to readFile must allow for reading."))}catch(h){return a(h)}},M.prototype.readFileSync=function(t,r){r===void 0&&(r={});var e=wt(r,null,"r",null),o=b.getFileFlag(e.flag);if(!o.isReadable())throw new p(c.EINVAL,"Flag passed to readFile must allow for reading.");return W(this.root).readFileSync(et(t),e.encoding,o)},M.prototype.writeFile=function(t,r,e,o){e===void 0&&(e={}),o===void 0&&(o=pt);var a=wt(e,"utf8","w",420);o=typeof e=="function"?e:o;var u=G(o,1);try{var h=b.getFileFlag(a.flag);return h.isWriteable()?W(this.root).writeFile(et(t),r,a.encoding,h,a.mode,u):u(new p(c.EINVAL,"Flag passed to writeFile must allow for writing."))}catch(S){return u(S)}},M.prototype.writeFileSync=function(t,r,e){var o=wt(e,"utf8","w",420),a=b.getFileFlag(o.flag);if(!a.isWriteable())throw new p(c.EINVAL,"Flag passed to writeFile must allow for writing.");return W(this.root).writeFileSync(et(t),r,o.encoding,a,o.mode)},M.prototype.appendFile=function(t,r,e,o){o===void 0&&(o=pt);var a=wt(e,"utf8","a",420);o=typeof e=="function"?e:o;var u=G(o,1);try{var h=b.getFileFlag(a.flag);if(!h.isAppendable())return u(new p(c.EINVAL,"Flag passed to appendFile must allow for appending."));W(this.root).appendFile(et(t),r,a.encoding,h,a.mode,u)}catch(S){u(S)}},M.prototype.appendFileSync=function(t,r,e){var o=wt(e,"utf8","a",420),a=b.getFileFlag(o.flag);if(!a.isAppendable())throw new p(c.EINVAL,"Flag passed to appendFile must allow for appending.");return W(this.root).appendFileSync(et(t),r,o.encoding,a,o.mode)},M.prototype.fstat=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{var o=this.fd2file(t);o.stat(e)}catch(a){e(a)}},M.prototype.fstatSync=function(t){return this.fd2file(t).statSync()},M.prototype.close=function(t,r){var e=this;r===void 0&&(r=pt);var o=G(r,1);try{this.fd2file(t).close(function(a){a||e.closeFd(t),o(a)})}catch(a){o(a)}},M.prototype.closeSync=function(t){this.fd2file(t).closeSync(),this.closeFd(t)},M.prototype.ftruncate=function(t,r,e){e===void 0&&(e=pt);var o=typeof r=="number"?r:0;e=typeof r=="function"?r:e;var a=G(e,1);try{var u=this.fd2file(t);if(o<0)throw new p(c.EINVAL);u.truncate(o,a)}catch(h){a(h)}},M.prototype.ftruncateSync=function(t,r){r===void 0&&(r=0);var e=this.fd2file(t);if(r<0)throw new p(c.EINVAL);e.truncateSync(r)},M.prototype.fsync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).sync(e)}catch(o){e(o)}},M.prototype.fsyncSync=function(t){this.fd2file(t).syncSync()},M.prototype.fdatasync=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{this.fd2file(t).datasync(e)}catch(o){e(o)}},M.prototype.fdatasyncSync=function(t){this.fd2file(t).datasyncSync()},M.prototype.write=function(t,r,e,o,a,u){u===void 0&&(u=pt);var h,S,x,O=null;if(typeof r=="string"){var D="utf8";switch(typeof e){case"function":u=e;break;case"number":O=e,D=typeof o=="string"?o:"utf8",u=typeof a=="function"?a:u;break;default:return u=typeof o=="function"?o:typeof a=="function"?a:u,u(new p(c.EINVAL,"Invalid arguments."))}h=f.from(r,D),S=0,x=h.length}else h=r,S=e,x=o,O=typeof a=="number"?a:null,u=typeof a=="function"?a:u;var V=G(u,3);try{var $=this.fd2file(t);O==null&&(O=$.getPos()),$.write(h,S,x,O,V)}catch(rt){V(rt)}},M.prototype.writeSync=function(t,r,e,o,a){var u,h=0,S,x;if(typeof r=="string"){x=typeof e=="number"?e:null;var O=typeof o=="string"?o:"utf8";h=0,u=f.from(r,O),S=u.length}else u=r,h=e,S=o,x=typeof a=="number"?a:null;var D=this.fd2file(t);return x==null&&(x=D.getPos()),D.writeSync(u,h,S,x)},M.prototype.read=function(t,r,e,o,a,u){u===void 0&&(u=pt);var h,S,x,O,D;if(typeof r=="number"){x=r,h=e;var V=o;u=typeof a=="function"?a:u,S=0,O=f.alloc(x),D=G(function(rt,ft,yt){if(rt)return u(rt);u(rt,yt.toString(V),ft)},3)}else O=r,S=e,x=o,h=a,D=G(u,3);try{var $=this.fd2file(t);h==null&&(h=$.getPos()),$.read(O,S,x,h,D)}catch(rt){D(rt)}},M.prototype.readSync=function(t,r,e,o,a){var u=!1,h,S,x,O,D="utf8";typeof r=="number"?(x=r,O=e,D=o,S=0,h=f.alloc(x),u=!0):(h=r,S=e,x=o,O=a);var V=this.fd2file(t);O==null&&(O=V.getPos());var $=V.readSync(h,S,x,O);return u?[h.toString(D),$]:$},M.prototype.fchown=function(t,r,e,o){o===void 0&&(o=pt);var a=G(o,1);try{this.fd2file(t).chown(r,e,a)}catch(u){a(u)}},M.prototype.fchownSync=function(t,r,e){this.fd2file(t).chownSync(r,e)},M.prototype.fchmod=function(t,r,e){var o=G(e,1);try{var a=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmod(a,o)}catch(u){o(u)}},M.prototype.fchmodSync=function(t,r){var e=typeof r=="string"?parseInt(r,8):r;this.fd2file(t).chmodSync(e)},M.prototype.futimes=function(t,r,e,o){o===void 0&&(o=pt);var a=G(o,1);try{var u=this.fd2file(t);typeof r=="number"&&(r=new Date(r*1e3)),typeof e=="number"&&(e=new Date(e*1e3)),u.utimes(r,e,a)}catch(h){a(h)}},M.prototype.futimesSync=function(t,r,e){this.fd2file(t).utimesSync(Et(r),Et(e))},M.prototype.rmdir=function(t,r){r===void 0&&(r=pt);var e=G(r,1);try{t=et(t),W(this.root).rmdir(t,e)}catch(o){e(o)}},M.prototype.rmdirSync=function(t){return t=et(t),W(this.root).rmdirSync(t)},M.prototype.mkdir=function(t,r,e){e===void 0&&(e=pt),typeof r=="function"&&(e=r,r=511);var o=G(e,1);try{t=et(t),W(this.root).mkdir(t,r,o)}catch(a){o(a)}},M.prototype.mkdirSync=function(t,r){W(this.root).mkdirSync(et(t),U(r,511))},M.prototype.readdir=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readdir(t,e)}catch(o){e(o)}},M.prototype.readdirSync=function(t){return t=et(t),W(this.root).readdirSync(t)},M.prototype.link=function(t,r,e){e===void 0&&(e=pt);var o=G(e,1);try{t=et(t),r=et(r),W(this.root).link(t,r,o)}catch(a){o(a)}},M.prototype.linkSync=function(t,r){return t=et(t),r=et(r),W(this.root).linkSync(t,r)},M.prototype.symlink=function(t,r,e,o){o===void 0&&(o=pt);var a=typeof e=="string"?e:"file";o=typeof e=="function"?e:o;var u=G(o,1);try{if(a!=="file"&&a!=="dir")return u(new p(c.EINVAL,"Invalid type: "+a));t=et(t),r=et(r),W(this.root).symlink(t,r,a,u)}catch(h){u(h)}},M.prototype.symlinkSync=function(t,r,e){if(!e)e="file";else if(e!=="file"&&e!=="dir")throw new p(c.EINVAL,"Invalid type: "+e);return t=et(t),r=et(r),W(this.root).symlinkSync(t,r,e)},M.prototype.readlink=function(t,r){r===void 0&&(r=pt);var e=G(r,2);try{t=et(t),W(this.root).readlink(t,e)}catch(o){e(o)}},M.prototype.readlinkSync=function(t){return t=et(t),W(this.root).readlinkSync(t)},M.prototype.chown=function(t,r,e,o){o===void 0&&(o=pt);var a=G(o,1);try{t=et(t),W(this.root).chown(t,!1,r,e,a)}catch(u){a(u)}},M.prototype.chownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!1,r,e)},M.prototype.lchown=function(t,r,e,o){o===void 0&&(o=pt);var a=G(o,1);try{t=et(t),W(this.root).chown(t,!0,r,e,a)}catch(u){a(u)}},M.prototype.lchownSync=function(t,r,e){t=et(t),W(this.root).chownSync(t,!0,r,e)},M.prototype.chmod=function(t,r,e){e===void 0&&(e=pt);var o=G(e,1);try{var a=U(r,-1);if(a<0)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!1,a,o)}catch(u){o(u)}},M.prototype.chmodSync=function(t,r){var e=U(r,-1);if(e<0)throw new p(c.EINVAL,"Invalid mode.");t=et(t),W(this.root).chmodSync(t,!1,e)},M.prototype.lchmod=function(t,r,e){e===void 0&&(e=pt);var o=G(e,1);try{var a=U(r,-1);if(a<0)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmod(et(t),!0,a,o)}catch(u){o(u)}},M.prototype.lchmodSync=function(t,r){var e=U(r,-1);if(e<1)throw new p(c.EINVAL,"Invalid mode.");W(this.root).chmodSync(et(t),!0,e)},M.prototype.utimes=function(t,r,e,o){o===void 0&&(o=pt);var a=G(o,1);try{W(this.root).utimes(et(t),Et(r),Et(e),a)}catch(u){a(u)}},M.prototype.utimesSync=function(t,r,e){W(this.root).utimesSync(et(t),Et(r),Et(e))},M.prototype.realpath=function(t,r,e){e===void 0&&(e=pt);var o=typeof r=="object"?r:{};e=typeof r=="function"?r:pt;var a=G(e,2);try{t=et(t),W(this.root).realpath(t,o,a)}catch(u){a(u)}},M.prototype.realpathSync=function(t,r){return r===void 0&&(r={}),t=et(t),W(this.root).realpathSync(t,r)},M.prototype.watchFile=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.unwatchFile=function(t,r){throw r===void 0&&(r=pt),new p(c.ENOTSUP)},M.prototype.watch=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.access=function(t,r,e){throw e===void 0&&(e=pt),new p(c.ENOTSUP)},M.prototype.accessSync=function(t,r){throw new p(c.ENOTSUP)},M.prototype.createReadStream=function(t,r){throw new p(c.ENOTSUP)},M.prototype.createWriteStream=function(t,r){throw new p(c.ENOTSUP)},M.prototype.wrapCallbacks=function(t){G=t},M.prototype.getFdForFile=function(t){var r=this.nextFd++;return this.fdMap[r]=t,r},M.prototype.fd2file=function(t){var r=this.fdMap[t];if(r)return r;throw new p(c.EBADF,"Invalid file descriptor.")},M.prototype.closeFd=function(t){delete this.fdMap[t]},M.Stats=C;var tt=new M,ct={},Rt=M.prototype;Object.keys(Rt).forEach(function(i){typeof tt[i]=="function"?ct[i]=function(){return tt[i].apply(tt,arguments)}:ct[i]=tt[i]}),ct.changeFSModule=function(i){tt=i},ct.getFSModule=function(){return tt},ct.FS=M;function dt(i,t,r,e,o){return i<t||r<t?i>r?r+1:i+1:e===o?t:t+1}function Lt(i,t){if(i===t)return 0;if(i.length>t.length){var r=i;i=t,t=r}for(var e=i.length,o=t.length;e>0&&i.charCodeAt(e-1)===t.charCodeAt(o-1);)e--,o--;for(var a=0;a<e&&i.charCodeAt(a)===t.charCodeAt(a);)a++;if(e-=a,o-=a,e===0||o===1)return o;for(var u=new Array(e<<1),h=0;h<e;)u[e+h]=i.charCodeAt(a+h),u[h]=++h;var S,x,O,D,V;for(S=0;S+3<o;)for(var $=t.charCodeAt(a+(x=S)),rt=t.charCodeAt(a+(O=S+1)),ft=t.charCodeAt(a+(D=S+2)),yt=t.charCodeAt(a+(V=S+3)),Ft=S+=4,Vt=0;Vt<e;){var se=u[e+Vt],Te=u[Vt];x=dt(Te,x,O,$,se),O=dt(x,O,D,rt,se),D=dt(O,D,V,ft,se),Ft=dt(D,V,Ft,yt,se),u[Vt++]=Ft,V=D,D=O,O=x,x=Te}for(var Oe=0;S<o;){var dr=t.charCodeAt(a+(x=S));Oe=++S;for(var Me=0;Me<e;Me++){var Pe=u[Me];u[Me]=Oe=Pe<x||Oe<x?Pe>Oe?Oe+1:Pe+1:dr===u[e+Me]?x:x+1,x=Pe}}return Oe}function kt(i,t,r){i&&console.warn("["+t+"] Direct file system constructor usage is deprecated for this file system, and will be removed in the next major version. Please use the '"+t+".Create("+JSON.stringify(r)+", callback)' method instead. See https://github.com/jvilk/BrowserFS/issues/176 for more details.")}var St=typeof navigator<"u"&&!!(/(msie) ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||navigator.userAgent.indexOf("Trident")!==-1),Xt=typeof window>"u";function P(){throw new Error("BFS has reached an impossible code path; please file a bug.")}function z(i,t,r){r.existsSync(i)||(z(w.dirname(i),t,r),r.mkdirSync(i,t))}function K(i){var t=ut(i),r=t.byteOffset,e=t.byteLength;return r===0&&e===t.buffer.byteLength?t.buffer:t.buffer.slice(r,r+e)}function ut(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function It(i){return i instanceof f?i:i instanceof Uint8Array?vt(i):f.from(i)}function vt(i){return i instanceof f?i:i.byteOffset===0&&i.byteLength===i.buffer.byteLength?xt(i.buffer):f.from(i.buffer,i.byteOffset,i.byteLength)}function xt(i){return f.from(i)}function Nt(i,t,r){if(t===void 0&&(t=0),r===void 0&&(r=i.length),t<0||r<0||r>i.length||t>r)throw new TypeError("Invalid slice bounds on buffer of length "+i.length+": ["+t+", "+r+"]");if(i.length===0)return Ct();var e=ut(i),o=i[0],a=(o+1)%255;return i[0]=a,e[0]===a?(e[0]=o,vt(e.slice(t,r))):(i[0]=o,vt(e.subarray(t,r)))}var jt=null;function Ct(){return jt||(jt=f.alloc(0))}function te(i,t){f.isBuffer(i)?t():t(new p(c.EINVAL,"option must be a Buffer."))}function R(i,t,r){var e=i.Options,o=i.Name,a=0,u=!1,h=!1;function S(V){u||(V&&(u=!0,r(V)),a--,a===0&&h&&r())}var x=function(V){if(e.hasOwnProperty(V)){var $=e[V],rt=t[V];if(rt==null){if(!$.optional){var ft=Object.keys(t).filter(function(Ft){return!(Ft in e)}).map(function(Ft){return{str:Ft,distance:Lt(V,Ft)}}).filter(function(Ft){return Ft.distance<5}).sort(function(Ft,Vt){return Ft.distance-Vt.distance});return u?{}:(u=!0,{v:r(new p(c.EINVAL,"["+o+"] Required option '"+V+"' not provided."+(ft.length>0?" You provided unrecognized option '"+ft[0].str+"'; perhaps you meant to type '"+V+"'.":"")+`
Option description: `+$.description))})}}else{var yt=!1;if(Array.isArray($.type)?yt=$.type.indexOf(typeof rt)!==-1:yt=typeof rt===$.type,yt)$.validator&&(a++,$.validator(rt,S));else return u?{}:(u=!0,{v:r(new p(c.EINVAL,"["+o+"] Value provided for option "+V+" is not the proper type. Expected "+(Array.isArray($.type)?"one of {"+$.type.join(", ")+"}":$.type)+", but received "+typeof rt+`
Option description: `+$.description))})}}};for(var O in e){var D=x(O);if(D)return D.v}h=!0,a===0&&!u&&r()}var N=Object.freeze({deprecationMessage:kt,isIE:St,isWebWorker:Xt,fail:P,mkdirpSync:z,buffer2ArrayBuffer:K,buffer2Uint8array:ut,arrayish2Buffer:It,uint8Array2Buffer:vt,arrayBuffer2Buffer:xt,copyingSlice:Nt,emptyBuffer:Ct,bufferValidator:te,checkOptions:R}),Y=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Y.prototype.open=function(t){var r=this.fs.realPath(t.node),e=this.FS;try{e.isFile(t.node.mode)&&(t.nfd=this.nodefs.openSync(r,this.fs.flagsToPermissionString(t.flags)))}catch(o){throw o.code?new e.ErrnoError(this.ERRNO_CODES[o.code]):o}},Y.prototype.close=function(t){var r=this.FS;try{r.isFile(t.node.mode)&&t.nfd&&this.nodefs.closeSync(t.nfd)}catch(e){throw e.code?new r.ErrnoError(this.ERRNO_CODES[e.code]):e}},Y.prototype.read=function(t,r,e,o,a){try{return this.nodefs.readSync(t.nfd,vt(r),e,o,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.write=function(t,r,e,o,a){try{return this.nodefs.writeSync(t.nfd,vt(r),e,o,a)}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}},Y.prototype.llseek=function(t,r,e){var o=r;if(e===1)o+=t.position;else if(e===2&&this.FS.isFile(t.node.mode))try{var a=this.nodefs.fstatSync(t.nfd);o+=a.size}catch(u){throw new this.FS.ErrnoError(this.ERRNO_CODES[u.code])}if(o<0)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return t.position=o,o};var Q=function(t){this.fs=t,this.nodefs=t.getNodeFS(),this.FS=t.getFS(),this.PATH=t.getPATH(),this.ERRNO_CODES=t.getERRNO_CODES()};Q.prototype.getattr=function(t){var r=this.fs.realPath(t),e;try{e=this.nodefs.lstatSync(r)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}return{dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,size:e.size,atime:e.atime,mtime:e.mtime,ctime:e.ctime,blksize:e.blksize,blocks:e.blocks}},Q.prototype.setattr=function(t,r){var e=this.fs.realPath(t);try{if(r.mode!==void 0&&(this.nodefs.chmodSync(e,r.mode),t.mode=r.mode),r.timestamp!==void 0){var o=new Date(r.timestamp);this.nodefs.utimesSync(e,o,o)}}catch(a){if(!a.code)throw a;if(a.code!=="ENOTSUP")throw new this.FS.ErrnoError(this.ERRNO_CODES[a.code])}if(r.size!==void 0)try{this.nodefs.truncateSync(e,r.size)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.lookup=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r),o=this.fs.getMode(e);return this.fs.createNode(t,r,o)},Q.prototype.mknod=function(t,r,e,o){var a=this.fs.createNode(t,r,e,o),u=this.fs.realPath(a);try{this.FS.isDir(a.mode)?this.nodefs.mkdirSync(u,a.mode):this.nodefs.writeFileSync(u,"",{mode:a.mode})}catch(h){throw h.code?new this.FS.ErrnoError(this.ERRNO_CODES[h.code]):h}return a},Q.prototype.rename=function(t,r,e){var o=this.fs.realPath(t),a=this.PATH.join2(this.fs.realPath(r),e);try{this.nodefs.renameSync(o,a),t.name=e,t.parent=r}catch(u){throw u.code?new this.FS.ErrnoError(this.ERRNO_CODES[u.code]):u}},Q.prototype.unlink=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.unlinkSync(e)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},Q.prototype.rmdir=function(t,r){var e=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.rmdirSync(e)}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},Q.prototype.readdir=function(t){var r=this.fs.realPath(t);try{var e=this.nodefs.readdirSync(r);return e.push(".",".."),e}catch(o){throw o.code?new this.FS.ErrnoError(this.ERRNO_CODES[o.code]):o}},Q.prototype.symlink=function(t,r,e){var o=this.PATH.join2(this.fs.realPath(t),r);try{this.nodefs.symlinkSync(e,o)}catch(a){throw a.code?new this.FS.ErrnoError(this.ERRNO_CODES[a.code]):a}},Q.prototype.readlink=function(t){var r=this.fs.realPath(t);try{return this.nodefs.readlinkSync(r)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}};var ht=function(t,r,e,o){t===void 0&&(t=self.FS),r===void 0&&(r=self.PATH),e===void 0&&(e=self.ERRNO_CODES),o===void 0&&(o=ct),this.flagsToPermissionStringMap={0:"r",1:"r+",2:"r+",64:"r",65:"r+",66:"r+",129:"rx+",193:"rx+",514:"w+",577:"w",578:"w+",705:"wx",706:"wx+",1024:"a",1025:"a",1026:"a+",1089:"a",1090:"a+",1153:"ax",1154:"ax+",1217:"ax",1218:"ax+",4096:"rs",4098:"rs+"},this.nodefs=o,this.FS=t,this.PATH=r,this.ERRNO_CODES=e,this.node_ops=new Q(this),this.stream_ops=new Y(this)};ht.prototype.mount=function(t){return this.createNode(null,"/",this.getMode(t.opts.root),0)},ht.prototype.createNode=function(t,r,e,o){var a=this.FS;if(!a.isDir(e)&&!a.isFile(e)&&!a.isLink(e))throw new a.ErrnoError(this.ERRNO_CODES.EINVAL);var u=a.createNode(t,r,e);return u.node_ops=this.node_ops,u.stream_ops=this.stream_ops,u},ht.prototype.getMode=function(t){var r;try{r=this.nodefs.lstatSync(t)}catch(e){throw e.code?new this.FS.ErrnoError(this.ERRNO_CODES[e.code]):e}return r.mode},ht.prototype.realPath=function(t){for(var r=[];t.parent!==t;)r.push(t.name),t=t.parent;return r.push(t.mount.opts.root),r.reverse(),this.PATH.join.apply(null,r)},ht.prototype.flagsToPermissionString=function(t){var r=typeof t=="string"?parseInt(t,10):t;return r&=8191,r in this.flagsToPermissionStringMap?this.flagsToPermissionStringMap[r]:t},ht.prototype.getNodeFS=function(){return this.nodefs},ht.prototype.getFS=function(){return this.FS},ht.prototype.getPATH=function(){return this.PATH},ht.prototype.getERRNO_CODES=function(){return this.ERRNO_CODES};var it=function(){};it.prototype.supportsLinks=function(){return!1},it.prototype.diskSpace=function(t,r){r(0,0)},it.prototype.openFile=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.createFile=function(t,r,e,o){throw new p(c.ENOTSUP)},it.prototype.open=function(t,r,e,o){var a=this,u=function(h,S){if(h)switch(r.pathNotExistsAction()){case A.CREATE_FILE:return a.stat(w.dirname(t),!1,function(x,O){x?o(x):O&&!O.isDirectory()?o(p.ENOTDIR(w.dirname(t))):a.createFile(t,r,e,o)});case A.THROW_EXCEPTION:return o(p.ENOENT(t));default:return o(new p(c.EINVAL,"Invalid FileFlag object."))}else{if(S&&S.isDirectory())return o(p.EISDIR(t));switch(r.pathExistsAction()){case A.THROW_EXCEPTION:return o(p.EEXIST(t));case A.TRUNCATE_FILE:return a.openFile(t,r,function(x,O){x?o(x):O?O.truncate(0,function(){O.sync(function(){o(null,O)})}):P()});case A.NOP:return a.openFile(t,r,o);default:return o(new p(c.EINVAL,"Invalid FileFlag object."))}}};this.stat(t,!1,u)},it.prototype.rename=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.renameSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.stat=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.statSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.openFileSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.createFileSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.openSync=function(t,r,e){var o;try{o=this.statSync(t,!1)}catch{switch(r.pathNotExistsAction()){case A.CREATE_FILE:var a=this.statSync(w.dirname(t),!1);if(!a.isDirectory())throw p.ENOTDIR(w.dirname(t));return this.createFileSync(t,r,e);case A.THROW_EXCEPTION:throw p.ENOENT(t);default:throw new p(c.EINVAL,"Invalid FileFlag object.")}}if(o.isDirectory())throw p.EISDIR(t);switch(r.pathExistsAction()){case A.THROW_EXCEPTION:throw p.EEXIST(t);case A.TRUNCATE_FILE:return this.unlinkSync(t),this.createFileSync(t,r,o.mode);case A.NOP:return this.openFileSync(t,r,e);default:throw new p(c.EINVAL,"Invalid FileFlag object.")}},it.prototype.unlink=function(t,r){r(new p(c.ENOTSUP))},it.prototype.unlinkSync=function(t){throw new p(c.ENOTSUP)},it.prototype.rmdir=function(t,r){r(new p(c.ENOTSUP))},it.prototype.rmdirSync=function(t){throw new p(c.ENOTSUP)},it.prototype.mkdir=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.mkdirSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.readdir=function(t,r){r(new p(c.ENOTSUP))},it.prototype.readdirSync=function(t){throw new p(c.ENOTSUP)},it.prototype.exists=function(t,r){this.stat(t,null,function(e){r(!e)})},it.prototype.existsSync=function(t){try{return this.statSync(t,!0),!0}catch{return!1}},it.prototype.realpath=function(t,r,e){if(this.supportsLinks())for(var o=t.split(w.sep),a=0;a<o.length;a++){var u=o.slice(0,a+1);o[a]=w.join.apply(null,u)}else this.exists(t,function(h){h?e(null,t):e(p.ENOENT(t))})},it.prototype.realpathSync=function(t,r){if(this.supportsLinks()){for(var e=t.split(w.sep),o=0;o<e.length;o++){var a=e.slice(0,o+1);e[o]=w.join.apply(w,a)}return e.join(w.sep)}else{if(this.existsSync(t))return t;throw p.ENOENT(t)}},it.prototype.truncate=function(t,r,e){this.open(t,b.getFileFlag("r+"),420,function(o,a){if(o)return e(o);a.truncate(r,function(u){a.close(function(h){e(u||h)})})})},it.prototype.truncateSync=function(t,r){var e=this.openSync(t,b.getFileFlag("r+"),420);try{e.truncateSync(r)}catch(o){throw o}finally{e.closeSync()}},it.prototype.readFile=function(t,r,e,o){var a=o;this.open(t,e,420,function(u,h){if(u)return o(u);o=function(S,x){h.close(function(O){return S||(S=O),a(S,x)})},h.stat(function(S,x){if(S)return o(S);var O=f.alloc(x.size);h.read(O,0,x.size,0,function(D){if(D)return o(D);if(r===null)return o(D,O);try{o(null,O.toString(r))}catch(V){o(V)}})})})},it.prototype.readFileSync=function(t,r,e){var o=this.openSync(t,e,420);try{var a=o.statSync(),u=f.alloc(a.size);return o.readSync(u,0,a.size,0),o.closeSync(),r===null?u:u.toString(r)}finally{o.closeSync()}},it.prototype.writeFile=function(t,r,e,o,a,u){var h=u;this.open(t,o,420,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){h(O||D)})};try{typeof r=="string"&&(r=f.from(r,e))}catch(O){return u(O)}x.write(r,0,r.length,0,u)})},it.prototype.writeFileSync=function(t,r,e,o,a){var u=this.openSync(t,o,a);try{typeof r=="string"&&(r=f.from(r,e)),u.writeSync(r,0,r.length,0)}finally{u.closeSync()}},it.prototype.appendFile=function(t,r,e,o,a,u){var h=u;this.open(t,o,a,function(S,x){if(S)return u(S);u=function(O){x.close(function(D){h(O||D)})},typeof r=="string"&&(r=f.from(r,e)),x.write(r,0,r.length,null,u)})},it.prototype.appendFileSync=function(t,r,e,o,a){var u=this.openSync(t,o,a);try{typeof r=="string"&&(r=f.from(r,e)),u.writeSync(r,0,r.length,null)}finally{u.closeSync()}},it.prototype.chmod=function(t,r,e,o){o(new p(c.ENOTSUP))},it.prototype.chmodSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.chown=function(t,r,e,o,a){a(new p(c.ENOTSUP))},it.prototype.chownSync=function(t,r,e,o){throw new p(c.ENOTSUP)},it.prototype.utimes=function(t,r,e,o){o(new p(c.ENOTSUP))},it.prototype.utimesSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.link=function(t,r,e){e(new p(c.ENOTSUP))},it.prototype.linkSync=function(t,r){throw new p(c.ENOTSUP)},it.prototype.symlink=function(t,r,e,o){o(new p(c.ENOTSUP))},it.prototype.symlinkSync=function(t,r,e){throw new p(c.ENOTSUP)},it.prototype.readlink=function(t,r){r(new p(c.ENOTSUP))},it.prototype.readlinkSync=function(t){throw new p(c.ENOTSUP)};var _t=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.supportsSynch=function(){return!0},t.prototype.rename=function(e,o,a){try{this.renameSync(e,o),a()}catch(u){a(u)}},t.prototype.stat=function(e,o,a){try{a(null,this.statSync(e,o))}catch(u){a(u)}},t.prototype.open=function(e,o,a,u){try{u(null,this.openSync(e,o,a))}catch(h){u(h)}},t.prototype.unlink=function(e,o){try{this.unlinkSync(e),o()}catch(a){o(a)}},t.prototype.rmdir=function(e,o){try{this.rmdirSync(e),o()}catch(a){o(a)}},t.prototype.mkdir=function(e,o,a){try{this.mkdirSync(e,o),a()}catch(u){a(u)}},t.prototype.readdir=function(e,o){try{o(null,this.readdirSync(e))}catch(a){o(a)}},t.prototype.chmod=function(e,o,a,u){try{this.chmodSync(e,o,a),u()}catch(h){u(h)}},t.prototype.chown=function(e,o,a,u,h){try{this.chownSync(e,o,a,u),h()}catch(S){h(S)}},t.prototype.utimes=function(e,o,a,u){try{this.utimesSync(e,o,a),u()}catch(h){u(h)}},t.prototype.link=function(e,o,a){try{this.linkSync(e,o),a()}catch(u){a(u)}},t.prototype.symlink=function(e,o,a,u){try{this.symlinkSync(e,o,a),u()}catch(h){u(h)}},t.prototype.readlink=function(e,o){try{o(null,this.readlinkSync(e))}catch(a){o(a)}},t}(it),gt=function(){};gt.prototype.sync=function(t){t(new p(c.ENOTSUP))},gt.prototype.syncSync=function(){throw new p(c.ENOTSUP)},gt.prototype.datasync=function(t){this.sync(t)},gt.prototype.datasyncSync=function(){return this.syncSync()},gt.prototype.chown=function(t,r,e){e(new p(c.ENOTSUP))},gt.prototype.chownSync=function(t,r){throw new p(c.ENOTSUP)},gt.prototype.chmod=function(t,r){r(new p(c.ENOTSUP))},gt.prototype.chmodSync=function(t){throw new p(c.ENOTSUP)},gt.prototype.utimes=function(t,r,e){e(new p(c.ENOTSUP))},gt.prototype.utimesSync=function(t,r){throw new p(c.ENOTSUP)};var Yt=function(i){function t(r,e,o,a,u){if(i.call(this),this._pos=0,this._dirty=!1,this._fs=r,this._path=e,this._flag=o,this._stat=a,u?this._buffer=u:this._buffer=Ct(),this._stat.size!==this._buffer.length&&this._flag.isReadable())throw new Error("Invalid buffer: Buffer is "+this._buffer.length+" long, yet Stats object specifies that file is "+this._stat.size+" long.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStats=function(){return this._stat},t.prototype.getFlag=function(){return this._flag},t.prototype.getPath=function(){return this._path},t.prototype.getPos=function(){return this._flag.isAppendable()?this._stat.size:this._pos},t.prototype.advancePos=function(e){return this._pos+=e},t.prototype.setPos=function(e){return this._pos=e},t.prototype.sync=function(e){try{this.syncSync(),e()}catch(o){e(o)}},t.prototype.syncSync=function(){throw new p(c.ENOTSUP)},t.prototype.close=function(e){try{this.closeSync(),e()}catch(o){e(o)}},t.prototype.closeSync=function(){throw new p(c.ENOTSUP)},t.prototype.stat=function(e){try{e(null,this._stat.clone())}catch(o){e(o)}},t.prototype.statSync=function(){return this._stat.clone()},t.prototype.truncate=function(e,o){try{this.truncateSync(e),this._flag.isSynchronous()&&!ct.getRootFS().supportsSynch()&&this.sync(o),o()}catch(a){return o(a)}},t.prototype.truncateSync=function(e){if(this._dirty=!0,!this._flag.isWriteable())throw new p(c.EPERM,"File not opened with a writeable mode.");if(this._stat.mtime=new Date,e>this._buffer.length){var o=f.alloc(e-this._buffer.length,0);this.writeSync(o,0,o.length,this._buffer.length),this._flag.isSynchronous()&&ct.getRootFS().supportsSynch()&&this.syncSync();return}this._stat.size=e;var a=f.alloc(e);this._buffer.copy(a,0,0,e),this._buffer=a,this._flag.isSynchronous()&&ct.getRootFS().supportsSynch()&&this.syncSync()},t.prototype.write=function(e,o,a,u,h){try{h(null,this.writeSync(e,o,a,u),e)}catch(S){h(S)}},t.prototype.writeSync=function(e,o,a,u){if(this._dirty=!0,u==null&&(u=this.getPos()),!this._flag.isWriteable())throw new p(c.EPERM,"File not opened with a writeable mode.");var h=u+a;if(h>this._stat.size&&(this._stat.size=h,h>this._buffer.length)){var S=f.alloc(h);this._buffer.copy(S),this._buffer=S}var x=e.copy(this._buffer,u,o,o+a);return this._stat.mtime=new Date,this._flag.isSynchronous()?(this.syncSync(),x):(this.setPos(u+x),x)},t.prototype.read=function(e,o,a,u,h){try{h(null,this.readSync(e,o,a,u),e)}catch(S){h(S)}},t.prototype.readSync=function(e,o,a,u){if(!this._flag.isReadable())throw new p(c.EPERM,"File not opened with a readable mode.");u==null&&(u=this.getPos());var h=u+a;h>this._stat.size&&(a=this._stat.size-u);var S=this._buffer.copy(e,o,u,u+a);return this._stat.atime=new Date,this._pos=u+a,S},t.prototype.chmod=function(e,o){try{this.chmodSync(e),o()}catch(a){o(a)}},t.prototype.chmodSync=function(e){if(!this._fs.supportsProps())throw new p(c.ENOTSUP);this._dirty=!0,this._stat.chmod(e),this.syncSync()},t.prototype.isDirty=function(){return this._dirty},t.prototype.resetDirty=function(){this._dirty=!1},t}(gt),ue=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.close=function(e){e()},t.prototype.closeSync=function(){},t}(Yt),Fe=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),I=function(i){function t(r,e,o){if(o===void 0&&(o=!0),i.call(this),this._queue=[],this._queueRunning=!1,this._isInitialized=!1,this._initializeCallbacks=[],this._sync=r,this._async=e,!r.supportsSynch())throw new Error("The first argument to AsyncMirror needs to be a synchronous file system.");kt(o,t.Name,{sync:"sync file system instance",async:"async file system instance"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){try{var a=new t(e.sync,e.async,!1);a.initialize(function(u){u?o(u):o(null,a)},!1)}catch(u){o(u)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){return t.Name},t.prototype._syncSync=function(e){this._sync.writeFileSync(e.getPath(),e.getBuffer(),null,b.getFileFlag("w"),e.getStats().mode),this.enqueueOp({apiMethod:"writeFile",arguments:[e.getPath(),e.getBuffer(),null,e.getFlag(),e.getStats().mode]})},t.prototype.initialize=function(e,o){var a=this;o===void 0&&(o=!0),o&&console.warn("[AsyncMirror] AsyncMirror.initialize() is deprecated and will be removed in the next major version. Please use 'AsyncMirror.Create({ sync: (sync file system instance), async: (async file system instance)}, cb)' to create and initialize AsyncMirror instances.");var u=this._initializeCallbacks,h=function(D){a._isInitialized=!D,a._initializeCallbacks=[],u.forEach(function(V){return V(D)})};if(this._isInitialized)e();else if(u.push(e)===1){var S=function(D,V,$){D!=="/"&&a._sync.mkdirSync(D,V),a._async.readdir(D,function(rt,ft){var yt=0;function Ft(Vt){Vt?$(Vt):yt<ft.length?(O(w.join(D,ft[yt]),Ft),yt++):$()}rt?$(rt):Ft()})},x=function(D,V,$){a._async.readFile(D,null,b.getFileFlag("r"),function(rt,ft){if(rt)$(rt);else try{a._sync.writeFileSync(D,ft,null,b.getFileFlag("w"),V)}catch(yt){rt=yt}finally{$(rt)}})},O=function(D,V){a._async.stat(D,!1,function($,rt){$?V($):rt.isDirectory()?S(D,rt.mode,V):x(D,rt.mode,V)})};S("/",0,h)}},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._sync.supportsProps()&&this._async.supportsProps()},t.prototype.renameSync=function(e,o){this.checkInitialized(),this._sync.renameSync(e,o),this.enqueueOp({apiMethod:"rename",arguments:[e,o]})},t.prototype.statSync=function(e,o){return this.checkInitialized(),this._sync.statSync(e,o)},t.prototype.openSync=function(e,o,a){this.checkInitialized();var u=this._sync.openSync(e,o,a);return u.closeSync(),new Fe(this,e,o,this._sync.statSync(e,!1),this._sync.readFileSync(e,null,b.getFileFlag("r")))},t.prototype.unlinkSync=function(e){this.checkInitialized(),this._sync.unlinkSync(e),this.enqueueOp({apiMethod:"unlink",arguments:[e]})},t.prototype.rmdirSync=function(e){this.checkInitialized(),this._sync.rmdirSync(e),this.enqueueOp({apiMethod:"rmdir",arguments:[e]})},t.prototype.mkdirSync=function(e,o){this.checkInitialized(),this._sync.mkdirSync(e,o),this.enqueueOp({apiMethod:"mkdir",arguments:[e,o]})},t.prototype.readdirSync=function(e){return this.checkInitialized(),this._sync.readdirSync(e)},t.prototype.existsSync=function(e){return this.checkInitialized(),this._sync.existsSync(e)},t.prototype.chmodSync=function(e,o,a){this.checkInitialized(),this._sync.chmodSync(e,o,a),this.enqueueOp({apiMethod:"chmod",arguments:[e,o,a]})},t.prototype.chownSync=function(e,o,a,u){this.checkInitialized(),this._sync.chownSync(e,o,a,u),this.enqueueOp({apiMethod:"chown",arguments:[e,o,a,u]})},t.prototype.utimesSync=function(e,o,a){this.checkInitialized(),this._sync.utimesSync(e,o,a),this.enqueueOp({apiMethod:"utimes",arguments:[e,o,a]})},t.prototype.checkInitialized=function(){if(!this._isInitialized)throw new p(c.EPERM,"AsyncMirrorFS is not initialized. Please initialize AsyncMirrorFS using its initialize() method before using it.")},t.prototype.enqueueOp=function(e){var o=this;if(this._queue.push(e),!this._queueRunning){this._queueRunning=!0;var a=function(u){if(u&&console.error("WARNING: File system has desynchronized. Received following error: "+u+`
$`),o._queue.length>0){var h=o._queue.shift(),S=h.arguments;S.push(a),o._async[h.apiMethod].apply(o._async,S)}else o._queueRunning=!1};a()}},t}(_t);I.Name="AsyncMirror",I.Options={sync:{type:"object",description:"The synchronous file system to mirror the asynchronous file system to."},async:{type:"object",description:"The asynchronous file system to mirror."}};function g(i,t,r){switch(r.length){case 0:return i.call(t);case 1:return i.call(t,r[0]);case 2:return i.call(t,r[0],r[1]);case 3:return i.call(t,r[0],r[1],r[2])}return i.apply(t,r)}var v=Math.max;function k(i,t,r){return t=v(t===void 0?i.length-1:t,0),function(){for(var e=arguments,o=-1,a=v(e.length-t,0),u=Array(a);++o<a;)u[o]=e[t+o];o=-1;for(var h=Array(t+1);++o<t;)h[o]=e[o];return h[t]=r(u),g(i,this,h)}}function B(i){return i}function Z(i,t){return k(i,t,B)}var J=function(i){return Z(function(t){var r=t.pop();i.call(this,t,r)})};function bt(i){return Z(function(t,r){var e=J(function(o,a){var u=this;return i(t,function(h,S){h.apply(u,o.concat(S))},a)});return r.length?e.apply(this,r):e})}var At=typeof y=="object"&&y&&y.Object===Object&&y,Bt=typeof self=="object"&&self&&self.Object===Object&&self,Gt=At||Bt||Function("return this")(),Dt=Gt.Symbol,Ie=Object.prototype,nr=Ie.hasOwnProperty,Ve=Ie.toString,Ze=Dt?Dt.toStringTag:void 0;function si(i){var t=nr.call(i,Ze),r=i[Ze];try{i[Ze]=void 0;var e=!0}catch{}var o=Ve.call(i);return e&&(t?i[Ze]=r:delete i[Ze]),o}var ai=Object.prototype,ui=ai.toString;function j(i){return ui.call(i)}var ot="[object Null]",F="[object Undefined]",at=Dt?Dt.toStringTag:void 0;function Ut(i){return i==null?i===void 0?F:ot:at&&at in Object(i)?si(i):j(i)}function nt(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var fe="[object AsyncFunction]",st="[object Function]",Jt="[object GeneratorFunction]",X="[object Proxy]";function q(i){if(!nt(i))return!1;var t=Ut(i);return t==st||t==Jt||t==fe||t==X}var or=9007199254740991;function Mt(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=or}function lt(i){return i!=null&&Mt(i.length)&&!q(i)}var qe={};function De(){}function Wt(i){return function(){if(i!==null){var t=i;i=null,t.apply(this,arguments)}}}var Tt=typeof Symbol=="function"&&Symbol.iterator,re=function(i){return Tt&&i[Tt]&&i[Tt]()};function ae(i,t){for(var r=-1,e=Array(i);++r<i;)e[r]=t(r);return e}function ie(i){return i!=null&&typeof i=="object"}var sr="[object Arguments]";function Xe(i){return ie(i)&&Ut(i)==sr}var Zt=Object.prototype,ce=Zt.hasOwnProperty,ee=Zt.propertyIsEnumerable,be=Xe(function(){return arguments}())?Xe:function(i){return ie(i)&&ce.call(i,"callee")&&!ee.call(i,"callee")},Se=Array.isArray;function Pr(){return!1}var ji=typeof n=="object"&&n&&!n.nodeType&&n,Wi=ji&&typeof d=="object"&&d&&!d.nodeType&&d,Go=Wi&&Wi.exports===ji,Hi=Go?Gt.Buffer:void 0,Jo=Hi?Hi.isBuffer:void 0,Ko=Jo||Pr,Qo=9007199254740991,$o=/^(?:0|[1-9]\d*)$/;function ts(i,t){return t=t??Qo,!!t&&(typeof i=="number"||$o.test(i))&&i>-1&&i%1==0&&i<t}var es="[object Arguments]",rs="[object Array]",is="[object Boolean]",ns="[object Date]",os="[object Error]",ss="[object Function]",as="[object Map]",us="[object Number]",cs="[object Object]",ls="[object RegExp]",hs="[object Set]",ps="[object String]",ds="[object WeakMap]",ys="[object ArrayBuffer]",gs="[object DataView]",vs="[object Float32Array]",ms="[object Float64Array]",ws="[object Int8Array]",Ss="[object Int16Array]",Es="[object Int32Array]",_s="[object Uint8Array]",xs="[object Uint8ClampedArray]",Fs="[object Uint16Array]",Is="[object Uint32Array]",Pt={};Pt[vs]=Pt[ms]=Pt[ws]=Pt[Ss]=Pt[Es]=Pt[_s]=Pt[xs]=Pt[Fs]=Pt[Is]=!0,Pt[es]=Pt[rs]=Pt[ys]=Pt[is]=Pt[gs]=Pt[ns]=Pt[os]=Pt[ss]=Pt[as]=Pt[us]=Pt[cs]=Pt[ls]=Pt[hs]=Pt[ps]=Pt[ds]=!1;function bs(i){return ie(i)&&Mt(i.length)&&!!Pt[Ut(i)]}function ks(i){return function(t){return i(t)}}var Vi=typeof n=="object"&&n&&!n.nodeType&&n,Zi=Vi&&typeof d=="object"&&d&&!d.nodeType&&d,Rs=Zi&&Zi.exports===Vi,fi=Rs&&At.process,qi=function(){try{return fi&&fi.binding&&fi.binding("util")}catch{}}(),Xi=qi&&qi.isTypedArray,Ns=Xi?ks(Xi):bs,Ts=Object.prototype,Os=Ts.hasOwnProperty;function As(i,t){var r=Se(i),e=!r&&be(i),o=!r&&!e&&Ko(i),a=!r&&!e&&!o&&Ns(i),u=r||e||o||a,h=u?ae(i.length,String):[],S=h.length;for(var x in i)(t||Os.call(i,x))&&!(u&&(x=="length"||o&&(x=="offset"||x=="parent")||a&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||ts(x,S)))&&h.push(x);return h}var Ls=Object.prototype;function Ds(i){var t=i&&i.constructor,r=typeof t=="function"&&t.prototype||Ls;return i===r}function Cs(i,t){return function(r){return i(t(r))}}var Bs=Cs(Object.keys,Object),Us=Object.prototype,Ms=Us.hasOwnProperty;function Ps(i){if(!Ds(i))return Bs(i);var t=[];for(var r in Object(i))Ms.call(i,r)&&r!="constructor"&&t.push(r);return t}function Yi(i){return lt(i)?As(i):Ps(i)}function zs(i){var t=-1,r=i.length;return function(){return++t<r?{value:i[t],key:t}:null}}function js(i){var t=-1;return function(){var e=i.next();return e.done?null:(t++,{value:e.value,key:t})}}function Ws(i){var t=Yi(i),r=-1,e=t.length;return function(){var a=t[++r];return r<e?{value:i[a],key:a}:null}}function Hs(i){if(lt(i))return zs(i);var t=re(i);return t?js(t):Ws(i)}function Gi(i){return function(){if(i===null)throw new Error("Callback was already called.");var t=i;i=null,t.apply(this,arguments)}}function Ji(i){return function(t,r,e){if(e=Wt(e||De),i<=0||!t)return e(null);var o=Hs(t),a=!1,u=0;function h(x,O){if(u-=1,x)a=!0,e(x);else{if(O===qe||a&&u<=0)return a=!0,e(null);S()}}function S(){for(;u<i&&!a;){var x=o();if(x===null){a=!0,u<=0&&e(null);return}u+=1,r(x.value,x.key,Gi(h))}}S()}}function Ki(i,t,r,e){Ji(t)(i,r,e)}function ci(i,t){return function(r,e,o){return i(r,t,e,o)}}function Vs(i,t,r){r=Wt(r||De);var e=0,o=0,a=i.length;a===0&&r(null);function u(h,S){h?r(h):(++o===a||S===qe)&&r(null)}for(;e<a;e++)t(i[e],e,Gi(u))}var Zs=ci(Ki,1/0),Qi=function(i,t,r){var e=lt(i)?Vs:Zs;e(i,t,r)};function qs(i){return function(t,r,e){return i(Qi,t,r,e)}}function $i(i,t,r,e){e=e||De,t=t||[];var o=[],a=0;i(t,function(u,h,S){var x=a++;r(u,function(O,D){o[x]=D,S(O)})},function(u){e(u,o)})}var Xs=qs($i);bt(Xs);function Ys(i){return function(t,r,e,o){return i(Ji(r),t,e,o)}}var Gs=Ys($i),Js=ci(Gs,1);bt(Js),Z(function(i,t){return Z(function(r){return i.apply(null,t.concat(r))})});function Ks(i,t){for(var r=-1,e=i==null?0:i.length;++r<e&&t(i[r],r,i)!==!1;);return i}function Qs(i){return function(t,r,e){for(var o=-1,a=Object(t),u=e(t),h=u.length;h--;){var S=u[i?h:++o];if(r(a[S],S,a)===!1)break}return t}}var $s=Qs();function Qu(i,t){return i&&$s(i,t,Yi)}function ta(i,t,r,e){for(var o=i.length,a=r+(e?1:-1);e?a--:++a<o;)if(t(i[a],a,i))return a;return-1}function ea(i){return i!==i}function ra(i,t,r){for(var e=r-1,o=i.length;++e<o;)if(i[e]===t)return e;return-1}function $u(i,t,r){return t===t?ra(i,t,r):ta(i,ea,r)}var tn="\\ud800-\\udfff",ia="\\u0300-\\u036f",na="\\ufe20-\\ufe2f",oa="\\u20d0-\\u20ff",sa=ia+na+oa,aa="\\ufe0e\\ufe0f",ua="["+tn+"]",li="["+sa+"]",fa="\\ud83c[\\udffb-\\udfff]",ca="(?:"+li+"|"+fa+")",en="[^"+tn+"]",rn="(?:\\ud83c[\\udde6-\\uddff]){2}",nn="[\\ud800-\\udbff][\\udc00-\\udfff]",la="\\u200d",on=ca+"?",sn="["+aa+"]?",ha="(?:"+la+"(?:"+[en,rn,nn].join("|")+")"+sn+on+")*",tf=sn+on+ha,ef="(?:"+[en+li+"?",li,rn,nn,ua].join("|")+")",an=typeof setImmediate=="function"&&setImmediate,un=typeof m=="object"&&typeof m.nextTick=="function";function fn(i){setTimeout(i,0)}function cn(i){return Z(function(t,r){i(function(){t.apply(null,r)})})}var zr;an?zr=setImmediate:un?zr=m.nextTick:zr=fn,cn(zr);var pa=ci(Ki,1);function da(i,t,r,e){e=Wt(e||De),pa(i,function(o,a,u){r(t,o,function(h,S){t=S,u(h)})},function(o){e(o,t)})}var ya=Z(function(t){return Z(function(r){var e=this,o=r[r.length-1];typeof o=="function"?r.pop():o=De,da(t,r,function(a,u,h){u.apply(e,a.concat(Z(function(S,x){h(S,x)})))},function(a,u){o.apply(e,[a].concat(u))})})});Z(function(i){return ya.apply(null,i.reverse())}),Z(function(i){var t=[null].concat(i);return J(function(r,e){return e.apply(this,t)})});function ln(i){return Z(function(t,r){t.apply(null,r.concat(Z(function(e,o){typeof console=="object"&&(e?console.error&&console.error(e):console[i]&&Ks(o,function(a){console[i](a)}))})))})}ln("dir");function ga(i){return function(t,r,e){return i(t,e)}}function hn(i,t,r){Qi(i,ga(t),r)}ln("log");var jr;un?jr=m.nextTick:an?jr=setImmediate:jr=fn,cn(jr);var rf=Math.ceil,nf=Math.max,le;function va(){le||(le={},le[Dropbox.ApiError.NETWORK_ERROR]=c.EIO,le[Dropbox.ApiError.INVALID_PARAM]=c.EINVAL,le[Dropbox.ApiError.INVALID_TOKEN]=c.EPERM,le[Dropbox.ApiError.OAUTH_ERROR]=c.EPERM,le[Dropbox.ApiError.NOT_FOUND]=c.ENOENT,le[Dropbox.ApiError.INVALID_METHOD]=c.EINVAL,le[Dropbox.ApiError.NOT_ACCEPTABLE]=c.EINVAL,le[Dropbox.ApiError.CONFLICT]=c.EINVAL,le[Dropbox.ApiError.RATE_LIMITED]=c.EBUSY,le[Dropbox.ApiError.SERVER_ERROR]=c.EBUSY,le[Dropbox.ApiError.OVER_QUOTA]=c.ENOSPC)}function ma(i){return i&&i.stat.isFile}function wa(i){return i&&i.stat.isFolder}function Sa(i){return i==null||typeof i=="object"&&typeof i.byteLength=="number"}var oe=function(t){this._cache={},this._client=t};oe.prototype.readdir=function(t,r){var e=this,o=this.getCachedDirInfo(t);this._wrap(function(a){o!==null&&o.contents?e._client.readdir(t,{contentHash:o.stat.contentHash},a):e._client.readdir(t,a)},function(a,u,h,S){a?a.status===Dropbox.ApiError.NO_CONTENT&&o!==null?r(null,o.contents.slice(0)):r(a):(e.updateCachedDirInfo(t,h,u.slice(0)),S.forEach(function(x){e.updateCachedInfo(w.join(t,x.name),x)}),r(null,u))})},oe.prototype.remove=function(t,r){var e=this;this._wrap(function(o){e._client.remove(t,o)},function(o,a){o||e.updateCachedInfo(t,a),r(o)})},oe.prototype.move=function(t,r,e){var o=this;this._wrap(function(a){o._client.move(t,r,a)},function(a,u){a||(o.deleteCachedInfo(t),o.updateCachedInfo(r,u)),e(a)})},oe.prototype.stat=function(t,r){var e=this;this._wrap(function(o){e._client.stat(t,o)},function(o,a){o||e.updateCachedInfo(t,a),r(o,a)})},oe.prototype.readFile=function(t,r){var e=this,o=this.getCachedFileInfo(t);o!==null&&o.contents!==null?this.stat(t,function(a,u){a?r(a):u.contentHash===o.stat.contentHash?r(a,o.contents.slice(0),o.stat):e.readFile(t,r)}):this._wrap(function(a){e._client.readFile(t,{arrayBuffer:!0},a)},function(a,u,h){a||e.updateCachedInfo(t,h,u.slice(0)),r(a,u,h)})},oe.prototype.writeFile=function(t,r,e){var o=this;this._wrap(function(a){o._client.writeFile(t,r,a)},function(a,u){a||o.updateCachedInfo(t,u,r.slice(0)),e(a,u)})},oe.prototype.mkdir=function(t,r){var e=this;this._wrap(function(o){e._client.mkdir(t,o)},function(o,a){o||e.updateCachedInfo(t,a,[]),r(o)})},oe.prototype._wrap=function(t,r){var e=0,o=function(a){var u=2;if(a&&3>++e)switch(a.status){case Dropbox.ApiError.SERVER_ERROR:case Dropbox.ApiError.NETWORK_ERROR:case Dropbox.ApiError.RATE_LIMITED:setTimeout(function(){t(o)},u*1e3);break;default:r.apply(null,arguments);break}else r.apply(null,arguments)};t(o)},oe.prototype.getCachedInfo=function(t){return this._cache[t.toLowerCase()]},oe.prototype.putCachedInfo=function(t,r){this._cache[t.toLowerCase()]=r},oe.prototype.deleteCachedInfo=function(t){delete this._cache[t.toLowerCase()]},oe.prototype.getCachedDirInfo=function(t){var r=this.getCachedInfo(t);return wa(r)?r:null},oe.prototype.getCachedFileInfo=function(t){var r=this.getCachedInfo(t);return ma(r)?r:null},oe.prototype.updateCachedDirInfo=function(t,r,e){e===void 0&&(e=null);var o=this.getCachedInfo(t);r.contentHash!==null&&(o===void 0||o.stat.contentHash!==r.contentHash)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedFileInfo=function(t,r,e){e===void 0&&(e=null);var o=this.getCachedInfo(t);r.versionTag!==null&&(o===void 0||o.stat.versionTag!==r.versionTag)&&this.putCachedInfo(t,{stat:r,contents:e})},oe.prototype.updateCachedInfo=function(t,r,e){e===void 0&&(e=null),r.isFile&&Sa(e)?this.updateCachedFileInfo(t,r,e):r.isFolder&&Array.isArray(e)&&this.updateCachedDirInfo(t,r,e)};var Ea=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var o=this;if(this.isDirty()){var a=this.getBuffer(),u=K(a);this._fs._writeFileStrict(this.getPath(),u,function(h){h||o.resetDirty(),e(h)})}else e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),Wr=function(i){function t(r,e){e===void 0&&(e=!0),i.call(this),this._client=new oe(r),kt(e,t.Name,{client:"authenticated dropbox client instance"}),va()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){o(null,new t(e.client,!1))},t.isAvailable=function(){return typeof Dropbox<"u"},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var o=this;this._client.readdir("/",function(a,u){if(a)e(o.convert(a,"/"));else{var h=function(x,O){var D=w.join("/",x);o._client.remove(D,function(V){O(V?o.convert(V,D):null)})},S=function(x){x?e(x):e()};hn(u,h,S)}})},t.prototype.rename=function(e,o,a){var u=this;this._client.move(e,o,function(h){h?u._client.stat(o,function(S,x){if(S||x.isFolder){var O=h.response.error.indexOf(e)>-1?e:o;a(u.convert(h,O))}else u._client.remove(o,function(D){D?a(u.convert(D,o)):u.rename(e,o,a)})}):a()})},t.prototype.stat=function(e,o,a){var u=this;this._client.stat(e,function(h,S){if(h)a(u.convert(h,e));else if(S&&S.isRemoved)a(p.FileError(c.ENOENT,e));else{var x=new C(u._statType(S),S.size);return a(null,x)}})},t.prototype.open=function(e,o,a,u){var h=this;this._client.readFile(e,function(S,x,O){if(S)if(o.isReadable())u(h.convert(S,e));else switch(S.status){case Dropbox.ApiError.NOT_FOUND:var D=new ArrayBuffer(0);return h._writeFileStrict(e,D,function(rt,ft){if(rt)u(rt);else{var yt=h._makeFile(e,o,ft,xt(D));u(null,yt)}});default:return u(h.convert(S,e))}else{var V;x===null?V=Ct():V=xt(x);var $=h._makeFile(e,o,O,V);return u(null,$)}})},t.prototype._writeFileStrict=function(e,o,a){var u=this,h=w.dirname(e);this.stat(h,!1,function(S,x){S?a(p.FileError(c.ENOENT,h)):u._client.writeFile(e,o,function(O,D){O?a(u.convert(O,e)):a(null,D)})})},t.prototype._statType=function(e){return e.isFile?L.FILE:L.DIRECTORY},t.prototype._makeFile=function(e,o,a,u){var h=this._statType(a),S=new C(h,a.size);return new Ea(this,e,o,S,u)},t.prototype._remove=function(e,o,a){var u=this;this._client.stat(e,function(h,S){h?o(u.convert(h,e)):S.isFile&&!a?o(p.FileError(c.ENOTDIR,e)):!S.isFile&&a?o(p.FileError(c.EISDIR,e)):u._client.remove(e,function(x){o(x?u.convert(x,e):null)})})},t.prototype.unlink=function(e,o){this._remove(e,o,!0)},t.prototype.rmdir=function(e,o){this._remove(e,o,!1)},t.prototype.mkdir=function(e,o,a){var u=this,h=w.dirname(e);this._client.stat(h,function(S,x){S?a(u.convert(S,h)):u._client.mkdir(e,function(O){a(O?p.FileError(c.EEXIST,e):null)})})},t.prototype.readdir=function(e,o){var a=this;this._client.readdir(e,function(u,h){return u?o(a.convert(u)):o(null,h)})},t.prototype.convert=function(e,o){o===void 0&&(o=null);var a=le[e.status];return a===void 0&&(a=c.EIO),o?p.FileError(a,o):new p(a)},t}(it);Wr.Name="Dropbox",Wr.Options={client:{type:"object",description:"An *authenticated* Dropbox client. Must be from the 0.10 JS SDK.",validator:function(i,t){i.isAuthenticated&&i.isAuthenticated()?t():t(new p(c.EINVAL,"'client' option must be an authenticated Dropbox client from the v0.10 JS SDK."))}}};function qt(i,t){t===void 0&&(t="");for(var r=i.errno,e=i.node,o=[];e&&(o.unshift(e.name),e!==e.parent);)e=e.parent;return new p(r,_[r],o.length>0?"/"+o.join("/"):t)}var _a=function(i){function t(r,e,o,a){i.call(this),this._fs=r,this._FS=e,this._path=o,this._stream=a}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getPos=function(){},t.prototype.close=function(e){var o=null;try{this.closeSync()}catch(a){o=a}finally{e(o)}},t.prototype.closeSync=function(){try{this._FS.close(this._stream)}catch(e){throw qt(e,this._path)}},t.prototype.stat=function(e){try{e(null,this.statSync())}catch(o){e(o)}},t.prototype.statSync=function(){try{return this._fs.statSync(this._path,!1)}catch(e){throw qt(e,this._path)}},t.prototype.truncate=function(e,o){var a=null;try{this.truncateSync(e)}catch(u){a=u}finally{o(a)}},t.prototype.truncateSync=function(e){try{this._FS.ftruncate(this._stream.fd,e)}catch(o){throw qt(o,this._path)}},t.prototype.write=function(e,o,a,u,h){try{h(null,this.writeSync(e,o,a,u),e)}catch(S){h(S)}},t.prototype.writeSync=function(e,o,a,u){try{var h=ut(e),S=u===null?void 0:u;return this._FS.write(this._stream,h,o,a,S)}catch(x){throw qt(x,this._path)}},t.prototype.read=function(e,o,a,u,h){try{h(null,this.readSync(e,o,a,u),e)}catch(S){h(S)}},t.prototype.readSync=function(e,o,a,u){try{var h=ut(e),S=u===null?void 0:u;return this._FS.read(this._stream,h,o,a,S)}catch(x){throw qt(x,this._path)}},t.prototype.sync=function(e){e()},t.prototype.syncSync=function(){},t.prototype.chown=function(e,o,a){var u=null;try{this.chownSync(e,o)}catch(h){u=h}finally{a(u)}},t.prototype.chownSync=function(e,o){try{this._FS.fchown(this._stream.fd,e,o)}catch(a){throw qt(a,this._path)}},t.prototype.chmod=function(e,o){var a=null;try{this.chmodSync(e)}catch(u){a=u}finally{o(a)}},t.prototype.chmodSync=function(e){try{this._FS.fchmod(this._stream.fd,e)}catch(o){throw qt(o,this._path)}},t.prototype.utimes=function(e,o,a){var u=null;try{this.utimesSync(e,o)}catch(h){u=h}finally{a(u)}},t.prototype.utimesSync=function(e,o){this._fs.utimesSync(this._path,e,o)},t}(gt),Hr=function(i){function t(r){i.call(this),this._FS=r}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){o(null,new t(e.FS))},t.isAvailable=function(){return!0},t.prototype.getName=function(){return this._FS.DB_NAME()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!0},t.prototype.supportsProps=function(){return!0},t.prototype.supportsSynch=function(){return!0},t.prototype.renameSync=function(e,o){try{this._FS.rename(e,o)}catch(a){throw a.errno===c.ENOENT?qt(a,this.existsSync(e)?o:e):qt(a)}},t.prototype.statSync=function(e,o){try{var a=o?this._FS.lstat(e):this._FS.stat(e),u=this.modeToFileType(a.mode);return new C(u,a.size,a.mode,a.atime,a.mtime,a.ctime)}catch(h){throw qt(h,e)}},t.prototype.openSync=function(e,o,a){try{var u=this._FS.open(e,o.getFlagString(),a);if(this._FS.isDir(u.node.mode))throw this._FS.close(u),p.EISDIR(e);return new _a(this,this._FS,e,u)}catch(h){throw qt(h,e)}},t.prototype.unlinkSync=function(e){try{this._FS.unlink(e)}catch(o){throw qt(o,e)}},t.prototype.rmdirSync=function(e){try{this._FS.rmdir(e)}catch(o){throw qt(o,e)}},t.prototype.mkdirSync=function(e,o){try{this._FS.mkdir(e,o)}catch(a){throw qt(a,e)}},t.prototype.readdirSync=function(e){try{return this._FS.readdir(e).filter(function(o){return o!=="."&&o!==".."})}catch(o){throw qt(o,e)}},t.prototype.truncateSync=function(e,o){try{this._FS.truncate(e,o)}catch(a){throw qt(a,e)}},t.prototype.readFileSync=function(e,o,a){try{var u=this._FS.readFile(e,{flags:a.getFlagString()}),h=vt(u);return o?h.toString(o):h}catch(S){throw qt(S,e)}},t.prototype.writeFileSync=function(e,o,a,u,h){try{a&&(o=f.from(o,a));var S=ut(o);this._FS.writeFile(e,S,{flags:u.getFlagString(),encoding:"binary"}),this._FS.chmod(e,h)}catch(x){throw qt(x,e)}},t.prototype.chmodSync=function(e,o,a){try{o?this._FS.lchmod(e,a):this._FS.chmod(e,a)}catch(u){throw qt(u,e)}},t.prototype.chownSync=function(e,o,a,u){try{o?this._FS.lchown(e,a,u):this._FS.chown(e,a,u)}catch(h){throw qt(h,e)}},t.prototype.symlinkSync=function(e,o,a){try{this._FS.symlink(e,o)}catch(u){throw qt(u)}},t.prototype.readlinkSync=function(e){try{return this._FS.readlink(e)}catch(o){throw qt(o,e)}},t.prototype.utimesSync=function(e,o,a){try{this._FS.utime(e,o.getTime(),a.getTime())}catch(u){throw qt(u,e)}},t.prototype.modeToFileType=function(e){if(this._FS.isDir(e))return L.DIRECTORY;if(this._FS.isFile(e))return L.FILE;if(this._FS.isLink(e))return L.SYMLINK;throw p.EPERM("Invalid mode: "+e)},t}(_t);Hr.Name="EmscriptenFileSystem",Hr.Options={FS:{type:"object",description:"The Emscripten file system to use (the `FS` variable)"}};var ar=function(i){function t(r,e){i.call(this),this._folder=r,this._wrapped=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){o(null,new t(e.folder,e.wrapped))},t.isAvailable=function(){return!0},t.prototype.initialize=function(e){var o=this;this._wrapped.exists(this._folder,function(a){a?e():o._wrapped.isReadOnly()?e(p.ENOENT(o._folder)):o._wrapped.mkdir(o._folder,511,e)})},t.prototype.getName=function(){return this._wrapped.getName()},t.prototype.isReadOnly=function(){return this._wrapped.isReadOnly()},t.prototype.supportsProps=function(){return this._wrapped.supportsProps()},t.prototype.supportsSynch=function(){return this._wrapped.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t}(it);ar.Name="FolderAdapter",ar.Options={folder:{type:"string",description:"The folder to use as the root directory"},wrapped:{type:"object",description:"The file system to wrap"}};function pn(i,t){if(t!==null&&typeof t=="object"){var r=t,e=r.path;e&&(e="/"+w.relative(i,e),r.message=r.message.replace(r.path,e),r.path=e)}return t}function xa(i,t){return typeof t=="function"?function(r){arguments.length>0&&(arguments[0]=pn(i,r)),t.apply(null,arguments)}:t}function dn(i,t,r){return i.slice(i.length-4)!=="Sync"?function(){return arguments.length>0&&(t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),arguments[arguments.length-1]=xa(this._folder,arguments[arguments.length-1])),this._wrapped[i].apply(this._wrapped,arguments)}:function(){try{return t&&(arguments[0]=w.join(this._folder,arguments[0])),r&&(arguments[1]=w.join(this._folder,arguments[1])),this._wrapped[i].apply(this._wrapped,arguments)}catch(e){throw pn(this._folder,e)}}}["diskSpace","stat","statSync","open","openSync","unlink","unlinkSync","rmdir","rmdirSync","mkdir","mkdirSync","readdir","readdirSync","exists","existsSync","realpath","realpathSync","truncate","truncateSync","readFile","readFileSync","writeFile","writeFileSync","appendFile","appendFileSync","chmod","chmodSync","chown","chownSync","utimes","utimesSync","readlink","readlinkSync"].forEach(function(i){ar.prototype[i]=dn(i,!0,!1)}),["rename","renameSync","link","linkSync","symlink","symlinkSync"].forEach(function(i){ar.prototype[i]=dn(i,!0,!0)});var Vr;typeof window<"u"?Vr=window:typeof self<"u"?Vr=self:Vr=y;var Kt=Vr;function Fa(i){return i.isDirectory}var hi=Kt.webkitRequestFileSystem||Kt.requestFileSystem||null;function Ia(i,t,r,e){if(typeof navigator.webkitPersistentStorage<"u")switch(i){case Kt.PERSISTENT:navigator.webkitPersistentStorage.requestQuota(t,r,e);break;case Kt.TEMPORARY:navigator.webkitTemporaryStorage.requestQuota(t,r,e);break;default:e(new TypeError("Invalid storage type: "+i));break}else Kt.webkitStorageInfo.requestQuota(i,t,r,e)}function ba(i){return Array.prototype.slice.call(i||[],0)}function ke(i,t,r){switch(i.name){case"PathExistsError":return p.EEXIST(t);case"QuotaExceededError":return p.FileError(c.ENOSPC,t);case"NotFoundError":return p.ENOENT(t);case"SecurityError":return p.FileError(c.EACCES,t);case"InvalidModificationError":return p.FileError(c.EPERM,t);case"TypeMismatchError":return p.FileError(r?c.ENOTDIR:c.EISDIR,t);case"EncodingError":case"InvalidStateError":case"NoModificationAllowedError":default:return p.FileError(c.EINVAL,t)}}var ka=function(i){function t(r,e,o,a,u,h){i.call(this,r,o,a,u,h),this._entry=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var o=this;if(!this.isDirty())return e();this._entry.createWriter(function(a){var u=o.getBuffer(),h=new Blob([K(u)]),S=h.size;a.onwriteend=function(x){a.onwriteend=null,a.onerror=null,a.truncate(S),o.resetDirty(),e()},a.onerror=function(x){e(ke(x,o.getPath(),!1))},a.write(h)})},t.prototype.close=function(e){this.sync(e)},t}(Yt),Zr=function(i){function t(r,e,o){r===void 0&&(r=5),e===void 0&&(e=Kt.PERSISTENT),o===void 0&&(o=!0),i.call(this),this.size=1024*1024*r,this.type=e,kt(o,t.Name,{size:r,type:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){var a=new t(e.size,e.type,!1);a.allocate(function(u){return u?o(u):o(null,a)},!1)},t.isAvailable=function(){return!!hi},t.prototype.getName=function(){return t.Name},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.allocate=function(e,o){var a=this;e===void 0&&(e=function(){}),o===void 0&&(o=!0),o&&console.warn("[HTML5FS] HTML5FS.allocate() is deprecated and will be removed in the next major release. Please use 'HTML5FS.Create({type: "+this.type+", size: "+this.size+"}, cb)' to create and allocate HTML5FS instances.");var u=function(S){a.fs=S,e()},h=function(S){e(ke(S,"/",!0))};this.type===Kt.PERSISTENT?Ia(this.type,this.size,function(S){hi(a.type,S,u,h)},h):hi(this.type,this.size,u,h)},t.prototype.empty=function(e){this._readdir("/",function(o,a){if(o)console.error("Failed to empty FS"),e(o);else{var u=function(S){o?(console.error("Failed to empty FS"),e(o)):e()},h=function(S,x){var O=function(){x()},D=function(V){x(ke(V,S.fullPath,!S.isDirectory))};Fa(S)?S.removeRecursively(O,D):S.remove(O,D)};hn(a,h,u)}})},t.prototype.rename=function(e,o,a){var u=this,h=2,S=0,x=this.fs.root,O=e,D=function($){--h<=0&&a(ke($,O,!1))},V=function($){if(++S===2)return a(new p(c.EINVAL,"Something was identified as both a file and a directory. This should never happen."));if(e===o)return a();O=w.dirname(o),x.getDirectory(O,{},function(rt){O=w.basename(o),$.moveTo(rt,O,function(ft){a()},function(ft){$.isDirectory?(O=o,u.unlink(o,function(yt){yt?D(ft):u.rename(e,o,a)})):D(ft)})},D)};x.getFile(e,{},V,D),x.getDirectory(e,{},V,D)},t.prototype.stat=function(e,o,a){var u=this,h={create:!1},S=function(V){var $=function(rt){var ft=new C(L.FILE,rt.size);a(null,ft)};V.file($,O)},x=function(V){var $=4096,rt=new C(L.DIRECTORY,$);a(null,rt)},O=function(V){a(ke(V,e,!1))},D=function(){u.fs.root.getDirectory(e,h,x,O)};this.fs.root.getFile(e,h,S,D)},t.prototype.open=function(e,o,a,u){var h=this,S=function(x){x.name==="InvalidModificationError"&&o.isExclusive()?u(p.EEXIST(e)):u(ke(x,e,!1))};this.fs.root.getFile(e,{create:o.pathNotExistsAction()===A.CREATE_FILE,exclusive:o.isExclusive()},function(x){x.file(function(O){var D=new FileReader;D.onloadend=function(V){var $=h._makeFile(e,x,o,O,D.result);u(null,$)},D.onerror=function(V){S(D.error)},D.readAsArrayBuffer(O)},S)},S)},t.prototype.unlink=function(e,o){this._remove(e,o,!0)},t.prototype.rmdir=function(e,o){var a=this;this.readdir(e,function(u,h){u?o(u):h.length>0?o(p.ENOTEMPTY(e)):a._remove(e,o,!1)})},t.prototype.mkdir=function(e,o,a){var u={create:!0,exclusive:!0},h=function(x){a()},S=function(x){a(ke(x,e,!0))};this.fs.root.getDirectory(e,u,h,S)},t.prototype.readdir=function(e,o){this._readdir(e,function(a,u){if(u){for(var h=[],S=0,x=u;S<x.length;S+=1){var O=x[S];h.push(O.name)}o(null,h)}else return o(a)})},t.prototype._makeFile=function(e,o,a,u,h){h===void 0&&(h=new ArrayBuffer(0));var S=new C(L.FILE,u.size),x=xt(h);return new ka(this,o,e,a,S,x)},t.prototype._readdir=function(e,o){var a=function(u){o(ke(u,e,!0))};this.fs.root.getDirectory(e,{create:!1},function(u){var h=u.createReader(),S=[],x=function(){h.readEntries(function(O){O.length?(S=S.concat(ba(O)),x()):o(null,S)},a)};x()},a)},t.prototype._remove=function(e,o,a){var u=function(x){var O=function(){o()},D=function(V){o(ke(V,e,!a))};x.remove(O,D)},h=function(x){o(ke(x,e,!a))},S={create:!1};a?this.fs.root.getFile(e,S,u,h):this.fs.root.getDirectory(e,S,u,h)},t}(it);Zr.Name="HTML5FS",Zr.Options={size:{type:"number",optional:!0,description:"Storage quota to request, in megabytes. Allocated value may be less. Defaults to 5."},type:{type:"number",optional:!0,description:"window.PERSISTENT or window.TEMPORARY. Defaults to PERSISTENT."}};var he=function(t,r,e,o,a,u){this.id=t,this.size=r,this.mode=e,this.atime=o,this.mtime=a,this.ctime=u};he.fromBuffer=function(t){if(t===void 0)throw new Error("NO");return new he(t.toString("ascii",30),t.readUInt32LE(0),t.readUInt16LE(4),t.readDoubleLE(6),t.readDoubleLE(14),t.readDoubleLE(22))},he.prototype.toStats=function(){return new C((this.mode&61440)===L.DIRECTORY?L.DIRECTORY:L.FILE,this.size,this.mode,new Date(this.atime),new Date(this.mtime),new Date(this.ctime))},he.prototype.getSize=function(){return 30+this.id.length},he.prototype.toBuffer=function(t){return t===void 0&&(t=f.alloc(this.getSize())),t.writeUInt32LE(this.size,0),t.writeUInt16LE(this.mode,4),t.writeDoubleLE(this.atime,6),t.writeDoubleLE(this.mtime,14),t.writeDoubleLE(this.ctime,22),t.write(this.id,30,this.id.length,"ascii"),t},he.prototype.update=function(t){var r=!1;this.size!==t.size&&(this.size=t.size,r=!0),this.mode!==t.mode&&(this.mode=t.mode,r=!0);var e=t.atime.getTime();this.atime!==e&&(this.atime=e,r=!0);var o=t.mtime.getTime();this.mtime!==o&&(this.mtime=o,r=!0);var a=t.ctime.getTime();return this.ctime!==a&&(this.ctime=a,r=!0),r},he.prototype.isFile=function(){return(this.mode&61440)===L.FILE},he.prototype.isDirectory=function(){return(this.mode&61440)===L.DIRECTORY};var je="/",pi=null;function yn(){return pi||(pi=f.from("{}"))}function qr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=Math.random()*16|0,r=i==="x"?t:t&3|8;return r.toString(16)})}function ge(i,t){return i?(t(i),!1):!0}function $t(i,t,r){return i?(t.abort(function(){r(i)}),!1):!0}var Ce=function(t){this.store=t,this.originalData={},this.modifiedKeys=[]};Ce.prototype.get=function(t){var r=this.store.get(t);return this.stashOldValue(t,r),r},Ce.prototype.put=function(t,r,e){return this.markModified(t),this.store.put(t,r,e)},Ce.prototype.del=function(t){this.markModified(t),this.store.del(t)},Ce.prototype.commit=function(){},Ce.prototype.abort=function(){for(var t=this,r=0,e=t.modifiedKeys;r<e.length;r+=1){var o=e[r],a=t.originalData[o];a?t.store.put(o,a,!0):t.store.del(o)}},Ce.prototype.stashOldValue=function(t,r){this.originalData.hasOwnProperty(t)||(this.originalData[t]=r)},Ce.prototype.markModified=function(t){this.modifiedKeys.indexOf(t)===-1&&(this.modifiedKeys.push(t),this.originalData.hasOwnProperty(t)||(this.originalData[t]=this.store.get(t)))};var gn=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this.getPath(),this.getBuffer(),this.getStats()),this.resetDirty())},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),vn=function(i){function t(r){i.call(this),this.store=r.store,this.makeRootDirectory()}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.empty=function(){this.store.clear(),this.makeRootDirectory()},t.prototype.renameSync=function(e,o){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),h=w.basename(e),S=w.dirname(o),x=w.basename(o),O=this.findINode(a,u),D=this.getDirListing(a,u,O);if(!D[h])throw p.ENOENT(e);var V=D[h];if(delete D[h],(S+"/").indexOf(e+"/")===0)throw new p(c.EBUSY,u);var $,rt;if(S===u?($=O,rt=D):($=this.findINode(a,S),rt=this.getDirListing(a,S,$)),rt[x]){var ft=this.getINode(a,o,rt[x]);if(ft.isFile())try{a.del(ft.id),a.del(rt[x])}catch(yt){throw a.abort(),yt}else throw p.EPERM(o)}rt[x]=V;try{a.put(O.id,f.from(JSON.stringify(D)),!0),a.put($.id,f.from(JSON.stringify(rt)),!0)}catch(yt){throw a.abort(),yt}a.commit()},t.prototype.statSync=function(e,o){return this.findINode(this.store.beginTransaction("readonly"),e).toStats()},t.prototype.createFileSync=function(e,o,a){var u=this.store.beginTransaction("readwrite"),h=Ct(),S=this.commitNewFile(u,e,L.FILE,a,h);return new gn(this,e,o,S.toStats(),h)},t.prototype.openFileSync=function(e,o){var a=this.store.beginTransaction("readonly"),u=this.findINode(a,e),h=a.get(u.id);if(h===void 0)throw p.ENOENT(e);return new gn(this,e,o,u.toStats(),h)},t.prototype.unlinkSync=function(e){this.removeEntry(e,!1)},t.prototype.rmdirSync=function(e){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.removeEntry(e,!0)},t.prototype.mkdirSync=function(e,o){var a=this.store.beginTransaction("readwrite"),u=f.from("{}");this.commitNewFile(a,e,L.DIRECTORY,o,u)},t.prototype.readdirSync=function(e){var o=this.store.beginTransaction("readonly");return Object.keys(this.getDirListing(o,e,this.findINode(o,e)))},t.prototype._syncSync=function(e,o,a){var u=this.store.beginTransaction("readwrite"),h=this._findINode(u,w.dirname(e),w.basename(e)),S=this.getINode(u,e,h),x=S.update(a);try{u.put(S.id,o,!0),x&&u.put(h,S.toBuffer(),!0)}catch(O){throw u.abort(),O}u.commit()},t.prototype.makeRootDirectory=function(){var e=this.store.beginTransaction("readwrite");if(e.get(je)===void 0){var o=new Date().getTime(),a=new he(qr(),4096,511|L.DIRECTORY,o,o,o);e.put(a.id,yn(),!1),e.put(je,a.toBuffer(),!1),e.commit()}},t.prototype._findINode=function(e,o,a){var u=this,h=function(S){var x=u.getDirListing(e,o,S);if(x[a])return x[a];throw p.ENOENT(w.resolve(o,a))};return o==="/"?a===""?je:h(this.getINode(e,o,je)):h(this.getINode(e,o+w.sep+a,this._findINode(e,w.dirname(o),w.basename(o))))},t.prototype.findINode=function(e,o){return this.getINode(e,o,this._findINode(e,w.dirname(o),w.basename(o)))},t.prototype.getINode=function(e,o,a){var u=e.get(a);if(u===void 0)throw p.ENOENT(o);return he.fromBuffer(u)},t.prototype.getDirListing=function(e,o,a){if(!a.isDirectory())throw p.ENOTDIR(o);var u=e.get(a.id);if(u===void 0)throw p.ENOENT(o);return JSON.parse(u.toString())},t.prototype.addNewNode=function(e,o){for(var a=0,u;a<5;)try{return u=qr(),e.put(u,o,!1),u}catch{}throw new p(c.EIO,"Unable to commit data to key-value store.")},t.prototype.commitNewFile=function(e,o,a,u,h){var S=w.dirname(o),x=w.basename(o),O=this.findINode(e,S),D=this.getDirListing(e,S,O),V=new Date().getTime();if(o==="/"||D[x])throw p.EEXIST(o);var $;try{var rt=this.addNewNode(e,h);$=new he(rt,h.length,u|a,V,V,V);var ft=this.addNewNode(e,$.toBuffer());D[x]=ft,e.put(O.id,f.from(JSON.stringify(D)),!0)}catch(yt){throw e.abort(),yt}return e.commit(),$},t.prototype.removeEntry=function(e,o){var a=this.store.beginTransaction("readwrite"),u=w.dirname(e),h=this.findINode(a,u),S=this.getDirListing(a,u,h),x=w.basename(e);if(!S[x])throw p.ENOENT(e);var O=S[x];delete S[x];var D=this.getINode(a,e,O);if(!o&&D.isDirectory())throw p.EISDIR(e);if(o&&!D.isDirectory())throw p.ENOTDIR(e);try{a.del(D.id),a.del(O),a.put(h.id,f.from(JSON.stringify(S)),!0)}catch(V){throw a.abort(),V}a.commit()},t}(_t),mn=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var o=this;this.isDirty()?this._fs._sync(this.getPath(),this.getBuffer(),this.getStats(),function(a){a||o.resetDirty(),e(a)}):e()},t.prototype.close=function(e){this.sync(e)},t}(Yt),Ra=function(i){function t(){i.apply(this,arguments)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.init=function(e,o){this.store=e,this.makeRootDirectory(o)},t.prototype.getName=function(){return this.store.name()},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSymlinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!1},t.prototype.empty=function(e){var o=this;this.store.clear(function(a){ge(a,e)&&o.makeRootDirectory(e)})},t.prototype.rename=function(e,o,a){var u=this,h=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e),O=w.dirname(o),D=w.basename(o),V={},$={},rt=!1;if((O+"/").indexOf(e+"/")===0)return a(new p(c.EBUSY,S));var ft=function(){if(!(rt||!$.hasOwnProperty(S)||!$.hasOwnProperty(O))){var Ft=$[S],Vt=V[S],se=$[O],Te=V[O];if(!Ft[x])a(p.ENOENT(e));else{var Oe=Ft[x];delete Ft[x];var dr=function(){se[D]=Oe,h.put(Vt.id,f.from(JSON.stringify(Ft)),!0,function(Me){$t(Me,h,a)&&(S===O?h.commit(a):h.put(Te.id,f.from(JSON.stringify(se)),!0,function(Pe){$t(Pe,h,a)&&h.commit(a)}))})};se[D]?u.getINode(h,o,se[D],function(Me,Pe){$t(Me,h,a)&&(Pe.isFile()?h.del(Pe.id,function(ao){$t(ao,h,a)&&h.del(se[D],function(ru){$t(ru,h,a)&&dr()})}):h.abort(function(ao){a(p.EPERM(o))}))}):dr()}}},yt=function(Ft){u.findINodeAndDirListing(h,Ft,function(Vt,se,Te){Vt?rt||(rt=!0,h.abort(function(){a(Vt)})):(V[Ft]=se,$[Ft]=Te,ft())})};yt(S),S!==O&&yt(O)},t.prototype.stat=function(e,o,a){var u=this.store.beginTransaction("readonly");this.findINode(u,e,function(h,S){ge(h,a)&&a(null,S.toStats())})},t.prototype.createFile=function(e,o,a,u){var h=this,S=this.store.beginTransaction("readwrite"),x=Ct();this.commitNewFile(S,e,L.FILE,a,x,function(O,D){ge(O,u)&&u(null,new mn(h,e,o,D.toStats(),x))})},t.prototype.openFile=function(e,o,a){var u=this,h=this.store.beginTransaction("readonly");this.findINode(h,e,function(S,x){ge(S,a)&&h.get(x.id,function(O,D){ge(O,a)&&(D===void 0?a(p.ENOENT(e)):a(null,new mn(u,e,o,x.toStats(),D)))})})},t.prototype.unlink=function(e,o){this.removeEntry(e,!1,o)},t.prototype.rmdir=function(e,o){var a=this;this.readdir(e,function(u,h){u?o(u):h.length>0?o(p.ENOTEMPTY(e)):a.removeEntry(e,!0,o)})},t.prototype.mkdir=function(e,o,a){var u=this.store.beginTransaction("readwrite"),h=f.from("{}");this.commitNewFile(u,e,L.DIRECTORY,o,h,a)},t.prototype.readdir=function(e,o){var a=this,u=this.store.beginTransaction("readonly");this.findINode(u,e,function(h,S){ge(h,o)&&a.getDirListing(u,e,S,function(x,O){ge(x,o)&&o(null,Object.keys(O))})})},t.prototype._sync=function(e,o,a,u){var h=this,S=this.store.beginTransaction("readwrite");this._findINode(S,w.dirname(e),w.basename(e),function(x,O){$t(x,S,u)&&h.getINode(S,e,O,function(D,V){if($t(D,S,u)){var $=V.update(a);S.put(V.id,o,!0,function(rt){$t(rt,S,u)&&($?S.put(O,V.toBuffer(),!0,function(ft){$t(ft,S,u)&&S.commit(u)}):S.commit(u))})}})})},t.prototype.makeRootDirectory=function(e){var o=this.store.beginTransaction("readwrite");o.get(je,function(a,u){if(a||u===void 0){var h=new Date().getTime(),S=new he(qr(),4096,511|L.DIRECTORY,h,h,h);o.put(S.id,yn(),!1,function(x){$t(x,o,e)&&o.put(je,S.toBuffer(),!1,function(O){O?o.abort(function(){e(O)}):o.commit(e)})})}else o.commit(e)})},t.prototype._findINode=function(e,o,a,u){var h=this,S=function(x,O,D){x?u(x):D[a]?u(null,D[a]):u(p.ENOENT(w.resolve(o,a)))};o==="/"?a===""?u(null,je):this.getINode(e,o,je,function(x,O){ge(x,u)&&h.getDirListing(e,o,O,function(D,V){S(D,O,V)})}):this.findINodeAndDirListing(e,o,S)},t.prototype.findINode=function(e,o,a){var u=this;this._findINode(e,w.dirname(o),w.basename(o),function(h,S){ge(h,a)&&u.getINode(e,o,S,a)})},t.prototype.getINode=function(e,o,a,u){e.get(a,function(h,S){ge(h,u)&&(S===void 0?u(p.ENOENT(o)):u(null,he.fromBuffer(S)))})},t.prototype.getDirListing=function(e,o,a,u){a.isDirectory()?e.get(a.id,function(h,S){if(ge(h,u))try{u(null,JSON.parse(S.toString()))}catch{u(p.ENOENT(o))}}):u(p.ENOTDIR(o))},t.prototype.findINodeAndDirListing=function(e,o,a){var u=this;this.findINode(e,o,function(h,S){ge(h,a)&&u.getDirListing(e,o,S,function(x,O){ge(x,a)&&a(null,S,O)})})},t.prototype.addNewNode=function(e,o,a){var u=0,h,S=function(){++u===5?a(new p(c.EIO,"Unable to commit data to key-value store.")):(h=qr(),e.put(h,o,!1,function(x,O){x||!O?S():a(null,h)}))};S()},t.prototype.commitNewFile=function(e,o,a,u,h,S){var x=this,O=w.dirname(o),D=w.basename(o),V=new Date().getTime();if(o==="/")return S(p.EEXIST(o));this.findINodeAndDirListing(e,O,function($,rt,ft){$t($,e,S)&&(ft[D]?e.abort(function(){S(p.EEXIST(o))}):x.addNewNode(e,h,function(yt,Ft){if($t(yt,e,S)){var Vt=new he(Ft,h.length,u|a,V,V,V);x.addNewNode(e,Vt.toBuffer(),function(se,Te){$t(se,e,S)&&(ft[D]=Te,e.put(rt.id,f.from(JSON.stringify(ft)),!0,function(Oe){$t(Oe,e,S)&&e.commit(function(dr){$t(dr,e,S)&&S(null,Vt)})}))})}}))})},t.prototype.removeEntry=function(e,o,a){var u=this,h=this.store.beginTransaction("readwrite"),S=w.dirname(e),x=w.basename(e);this.findINodeAndDirListing(h,S,function(O,D,V){if($t(O,h,a))if(!V[x])h.abort(function(){a(p.ENOENT(e))});else{var $=V[x];delete V[x],u.getINode(h,e,$,function(rt,ft){$t(rt,h,a)&&(!o&&ft.isDirectory()?h.abort(function(){a(p.EISDIR(e))}):o&&!ft.isDirectory()?h.abort(function(){a(p.ENOTDIR(e))}):h.del(ft.id,function(yt){$t(yt,h,a)&&h.del($,function(Ft){$t(Ft,h,a)&&h.put(D.id,f.from(JSON.stringify(V)),!0,function(Vt){$t(Vt,h,a)&&h.commit(a)})})}))})}})},t}(it),Ye=function(){this.store={}};Ye.prototype.name=function(){return ur.Name},Ye.prototype.clear=function(){this.store={}},Ye.prototype.beginTransaction=function(t){return new Ce(this)},Ye.prototype.get=function(t){return this.store[t]},Ye.prototype.put=function(t,r,e){return!e&&this.store.hasOwnProperty(t)?!1:(this.store[t]=r,!0)},Ye.prototype.del=function(t){delete this.store[t]};var ur=function(i){function t(){i.call(this,{store:new Ye})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){o(null,new t)},t}(vn);ur.Name="InMemory",ur.Options={};var di=Kt.indexedDB||Kt.mozIndexedDB||Kt.webkitIndexedDB||Kt.msIndexedDB;function _r(i,t){switch(t===void 0&&(t=i.toString()),i.name){case"NotFoundError":return new p(c.ENOENT,t);case"QuotaExceededError":return new p(c.ENOSPC,t);default:return new p(c.EIO,t)}}function xr(i,t,r){return t===void 0&&(t=c.EIO),r===void 0&&(r=null),function(e){e.preventDefault(),i(new p(t,r!==null?r:void 0))}}var yi=function(t,r){this.tx=t,this.store=r};yi.prototype.get=function(t,r){try{var e=this.store.get(t);e.onerror=xr(r),e.onsuccess=function(o){var a=o.target.result;a===void 0?r(null,a):r(null,xt(a))}}catch(o){r(_r(o))}};var Na=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.put=function(e,o,a,u){try{var h=K(o),S;a?S=this.store.put(h,e):S=this.store.add(h,e),S.onerror=xr(u),S.onsuccess=function(x){u(null,!0)}}catch(x){u(_r(x))}},t.prototype.del=function(e,o){try{var a=this.store.delete(e);a.onerror=xr(o),a.onsuccess=function(u){o()}}catch(u){o(_r(u))}},t.prototype.commit=function(e){setTimeout(e,0)},t.prototype.abort=function(e){var o=null;try{this.tx.abort()}catch(a){o=_r(a)}finally{e(o)}},t}(yi),Xr=function(t,r){var e=this;r===void 0&&(r="browserfs"),this.storeName=r;var o=di.open(this.storeName,1);o.onupgradeneeded=function(a){var u=a.target.result;u.objectStoreNames.contains(e.storeName)&&u.deleteObjectStore(e.storeName),u.createObjectStore(e.storeName)},o.onsuccess=function(a){e.db=a.target.result,t(null,e)},o.onerror=xr(t,c.EACCES)};Xr.prototype.name=function(){return Fr.Name+" - "+this.storeName},Xr.prototype.clear=function(t){try{var r=this.db.transaction(this.storeName,"readwrite"),e=r.objectStore(this.storeName),o=e.clear();o.onsuccess=function(a){setTimeout(t,0)},o.onerror=xr(t)}catch(a){t(_r(a))}},Xr.prototype.beginTransaction=function(t){t===void 0&&(t="readonly");var r=this.db.transaction(this.storeName,t),e=r.objectStore(this.storeName);if(t==="readwrite")return new Na(r,e);if(t==="readonly")return new yi(r,e);throw new p(c.EINVAL,"Invalid transaction type.")};var Fr=function(i){function t(r,e,o){var a=this;o===void 0&&(o=!0),i.call(this),this.store=new Xr(function(u){u?r(u):a.init(a.store,function(h){r(h,a)})},e),kt(o,t.Name,{storeName:e})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){new t(o,e.storeName,!1)},t.isAvailable=function(){try{return typeof di<"u"&&di.open("__browserfs_test__")!==null}catch{return!1}},t}(Ra);Fr.Name="IndexedDB",Fr.Options={storeName:{type:"string",optional:!0,description:"The name of this file system. You can have multiple IndexedDB file systems operating at once, but each must have a different name."}};var gi=!1,Ir;try{Kt.localStorage.setItem("__test__",String.fromCharCode(55296)),gi=Kt.localStorage.getItem("__test__")===String.fromCharCode(55296)}catch{gi=!1}Ir=gi?"binary_string":"binary_string_ie",f.isEncoding(Ir)||(Ir="base64");var Ge=function(){};Ge.prototype.name=function(){return br.Name},Ge.prototype.clear=function(){Kt.localStorage.clear()},Ge.prototype.beginTransaction=function(t){return new Ce(this)},Ge.prototype.get=function(t){try{var r=Kt.localStorage.getItem(t);if(r!==null)return f.from(r,Ir)}catch{}},Ge.prototype.put=function(t,r,e){try{return!e&&Kt.localStorage.getItem(t)!==null?!1:(Kt.localStorage.setItem(t,r.toString(Ir)),!0)}catch{throw new p(c.ENOSPC,"LocalStorage is full.")}},Ge.prototype.del=function(t){try{Kt.localStorage.removeItem(t)}catch(r){throw new p(c.EIO,"Unable to delete key "+t+": "+r)}};var br=function(i){function t(){i.call(this,{store:new Ge})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){o(null,new t)},t.isAvailable=function(){return typeof Kt.localStorage<"u"},t}(vn);br.Name="LocalStorage",br.Options={};var fr=function(i){function t(){i.call(this),this.mountList=[],this.mntMap={},this.rootFs=new ur}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){var a=new t;Object.keys(e).forEach(function(u){a.mount(u,e[u])}),o(null,a)},t.isAvailable=function(){return!0},t.prototype.mount=function(e,o){if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),this.mntMap[e])throw new p(c.EINVAL,"Mount point "+e+" is already taken.");z(e,511,this.rootFs),this.mntMap[e]=o,this.mountList.push(e),this.mountList=this.mountList.sort(function(a,u){return u.length-a.length})},t.prototype.umount=function(e){var o=this;if(e[0]!=="/"&&(e="/"+e),e=w.resolve(e),!this.mntMap[e])throw new p(c.EINVAL,"Mount point "+e+" is already unmounted.");for(delete this.mntMap[e],this.mountList.splice(this.mountList.indexOf(e),1);e!=="/"&&o.rootFs.readdirSync(e).length===0;)o.rootFs.rmdirSync(e),e=w.dirname(e)},t.prototype._getFs=function(e){for(var o=this,a=this.mountList,u=a.length,h=0;h<u;h++){var S=a[h];if(S.length<=e.length&&e.indexOf(S)===0)return e=e.substr(S.length>1?S.length:0),e===""&&(e="/"),{fs:o.mntMap[S],path:e}}return{fs:this.rootFs,path:e}},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,o){o(0,0)},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.standardizeError=function(e,o,a){var u=e.message.indexOf(o);return u!==-1&&(e.message=e.message.substr(0,u)+a+e.message.substr(u+o.length),e.path=a),e},t.prototype.rename=function(e,o,a){var u=this,h=this._getFs(e),S=this._getFs(o);return h.fs===S.fs?h.fs.rename(h.path,S.path,function(x){x&&u.standardizeError(u.standardizeError(x,h.path,e),S.path,o),a(x)}):ct.readFile(e,function(x,O){if(x)return a(x);ct.writeFile(o,O,function(D){if(D)return a(D);ct.unlink(e,a)})})},t.prototype.renameSync=function(e,o){var a=this._getFs(e),u=this._getFs(o);if(a.fs===u.fs)try{return a.fs.renameSync(a.path,u.path)}catch(S){throw this.standardizeError(this.standardizeError(S,a.path,e),u.path,o),S}var h=ct.readFileSync(e);return ct.writeFileSync(o,h),ct.unlinkSync(e)},t.prototype.readdirSync=function(e){var o=this._getFs(e),a=null;if(o.fs!==this.rootFs)try{a=this.rootFs.readdirSync(e)}catch{}try{var u=o.fs.readdirSync(o.path);return a===null?u:u.concat(a.filter(function(h){return u.indexOf(h)===-1}))}catch(h){if(a===null)throw this.standardizeError(h,o.path,e);return a}},t.prototype.readdir=function(e,o){var a=this,u=this._getFs(e);u.fs.readdir(u.path,function(h,S){if(u.fs!==a.rootFs)try{var x=a.rootFs.readdirSync(e);S?S=S.concat(x.filter(function(O){return S.indexOf(O)===-1})):S=x}catch{if(h)return o(a.standardizeError(h,u.path,e))}else if(h)return o(a.standardizeError(h,u.path,e));o(null,S)})},t.prototype.rmdirSync=function(e){var o=this._getFs(e);if(this._containsMountPt(e))throw p.ENOTEMPTY(e);try{o.fs.rmdirSync(o.path)}catch(a){throw this.standardizeError(a,o.path,e)}},t.prototype.rmdir=function(e,o){var a=this,u=this._getFs(e);this._containsMountPt(e)?o(p.ENOTEMPTY(e)):u.fs.rmdir(u.path,function(h){o(h?a.standardizeError(h,u.path,e):null)})},t.prototype._containsMountPt=function(e){for(var o=this.mountList,a=o.length,u=0;u<a;u++){var h=o[u];if(h.length>=e.length&&h.slice(0,e.length)===e)return!0}return!1},t}(it);fr.Name="MountableFileSystem",fr.Options={};function wn(i,t,r){return t?function(){for(var e=[],o=arguments.length;o--;)e[o]=arguments[o];var a=e[0],u=this._getFs(a);e[0]=u.path;try{return u.fs[i].apply(u.fs,e)}catch(h){throw this.standardizeError(h,u.path,a),h}}:function(){for(var e=this,o=[],a=arguments.length;a--;)o[a]=arguments[a];var u=o[0],h=this._getFs(u);if(o[0]=h.path,typeof o[o.length-1]=="function"){var S=o[o.length-1];o[o.length-1]=function(){for(var x=[],O=arguments.length;O--;)x[O]=arguments[O];x.length>0&&x[0]instanceof p&&e.standardizeError(x[0],h.path,u),S.apply(null,x)}}return h.fs[i].apply(h.fs,o)}}for(var Sn=[["exists","unlink","readlink"],["stat","mkdir","realpath","truncate"],["open","readFile","chmod","utimes"],["chown"],["writeFile","appendFile"]],kr=0;kr<Sn.length;kr++)for(var Ta=Sn[kr],vi=0,En=Ta;vi<En.length;vi+=1){var Yr=En[vi];fr.prototype[Yr]=wn(Yr,!1,kr+1),fr.prototype[Yr+"Sync"]=wn(Yr+"Sync",!0,kr+1)}var Rr;if(typeof setImmediate<"u")Rr=setImmediate;else{var Ee=Kt,cr=[],_n="zero-timeout-message",Oa=function(){if(typeof Ee.importScripts<"u"||!Ee.postMessage)return!1;var i=!0,t=Ee.onmessage;return Ee.onmessage=function(){i=!1},Ee.postMessage("","*"),Ee.onmessage=t,i};if(Oa()){Rr=function(i){cr.push(i),Ee.postMessage(_n,"*")};var xn=function(i){if(i.source===self&&i.data===_n&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,cr.length>0)){var t=cr.shift();return t()}};Ee.addEventListener?Ee.addEventListener("message",xn,!0):Ee.attachEvent("onmessage",xn)}else if(Ee.MessageChannel){var Fn=new Ee.MessageChannel;Fn.port1.onmessage=function(i){if(cr.length>0)return cr.shift()()},Rr=function(i){cr.push(i),Fn.port2.postMessage("")}}else Rr=function(i){return setTimeout(i,0)}}var mi=Rr,Nr=function(){this._locked=!1,this._waiters=[]};Nr.prototype.lock=function(t){if(this._locked){this._waiters.push(t);return}this._locked=!0,t()},Nr.prototype.unlock=function(){if(!this._locked)throw new Error("unlock of a non-locked mutex");var t=this._waiters.shift();if(t){mi(t);return}this._locked=!1},Nr.prototype.tryLock=function(){return this._locked?!1:(this._locked=!0,!0)},Nr.prototype.isLocked=function(){return this._locked};var mt=function(t){this._fs=t,this._mu=new Nr};mt.prototype.getName=function(){return"LockedFS<"+this._fs.getName()+">"},mt.prototype.getFSUnlocked=function(){return this._fs},mt.prototype.initialize=function(t){this._fs.initialize(t)},mt.prototype.diskSpace=function(t,r){this._fs.diskSpace(t,r)},mt.prototype.isReadOnly=function(){return this._fs.isReadOnly()},mt.prototype.supportsLinks=function(){return this._fs.supportsLinks()},mt.prototype.supportsProps=function(){return this._fs.supportsProps()},mt.prototype.supportsSynch=function(){return this._fs.supportsSynch()},mt.prototype.rename=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.rename(t,r,function(a){o._mu.unlock(),e(a)})})},mt.prototype.renameSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.renameSync(t,r)},mt.prototype.stat=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.stat(t,r,function(a,u){o._mu.unlock(),e(a,u)})})},mt.prototype.statSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.statSync(t,r)},mt.prototype.open=function(t,r,e,o){var a=this;this._mu.lock(function(){a._fs.open(t,r,e,function(u,h){a._mu.unlock(),o(u,h)})})},mt.prototype.openSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.openSync(t,r,e)},mt.prototype.unlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.unlink(t,function(o){e._mu.unlock(),r(o)})})},mt.prototype.unlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.unlinkSync(t)},mt.prototype.rmdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.rmdir(t,function(o){e._mu.unlock(),r(o)})})},mt.prototype.rmdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.rmdirSync(t)},mt.prototype.mkdir=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.mkdir(t,r,function(a){o._mu.unlock(),e(a)})})},mt.prototype.mkdirSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.mkdirSync(t,r)},mt.prototype.readdir=function(t,r){var e=this;this._mu.lock(function(){e._fs.readdir(t,function(o,a){e._mu.unlock(),r(o,a)})})},mt.prototype.readdirSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readdirSync(t)},mt.prototype.exists=function(t,r){var e=this;this._mu.lock(function(){e._fs.exists(t,function(o){e._mu.unlock(),r(o)})})},mt.prototype.existsSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.existsSync(t)},mt.prototype.realpath=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.realpath(t,r,function(a,u){o._mu.unlock(),e(a,u)})})},mt.prototype.realpathSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.realpathSync(t,r)},mt.prototype.truncate=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.truncate(t,r,function(a){o._mu.unlock(),e(a)})})},mt.prototype.truncateSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.truncateSync(t,r)},mt.prototype.readFile=function(t,r,e,o){var a=this;this._mu.lock(function(){a._fs.readFile(t,r,e,function(u,h){a._mu.unlock(),o(u,h)})})},mt.prototype.readFileSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readFileSync(t,r,e)},mt.prototype.writeFile=function(t,r,e,o,a,u){var h=this;this._mu.lock(function(){h._fs.writeFile(t,r,e,o,a,function(S){h._mu.unlock(),u(S)})})},mt.prototype.writeFileSync=function(t,r,e,o,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.writeFileSync(t,r,e,o,a)},mt.prototype.appendFile=function(t,r,e,o,a,u){var h=this;this._mu.lock(function(){h._fs.appendFile(t,r,e,o,a,function(S){h._mu.unlock(),u(S)})})},mt.prototype.appendFileSync=function(t,r,e,o,a){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.appendFileSync(t,r,e,o,a)},mt.prototype.chmod=function(t,r,e,o){var a=this;this._mu.lock(function(){a._fs.chmod(t,r,e,function(u){a._mu.unlock(),o(u)})})},mt.prototype.chmodSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chmodSync(t,r,e)},mt.prototype.chown=function(t,r,e,o,a){var u=this;this._mu.lock(function(){u._fs.chown(t,r,e,o,function(h){u._mu.unlock(),a(h)})})},mt.prototype.chownSync=function(t,r,e,o){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.chownSync(t,r,e,o)},mt.prototype.utimes=function(t,r,e,o){var a=this;this._mu.lock(function(){a._fs.utimes(t,r,e,function(u){a._mu.unlock(),o(u)})})},mt.prototype.utimesSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.utimesSync(t,r,e)},mt.prototype.link=function(t,r,e){var o=this;this._mu.lock(function(){o._fs.link(t,r,function(a){o._mu.unlock(),e(a)})})},mt.prototype.linkSync=function(t,r){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.linkSync(t,r)},mt.prototype.symlink=function(t,r,e,o){var a=this;this._mu.lock(function(){a._fs.symlink(t,r,e,function(u){a._mu.unlock(),o(u)})})},mt.prototype.symlinkSync=function(t,r,e){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.symlinkSync(t,r,e)},mt.prototype.readlink=function(t,r){var e=this;this._mu.lock(function(){e._fs.readlink(t,function(o,a){e._mu.unlock(),r(o,a)})})},mt.prototype.readlinkSync=function(t){if(this._mu.isLocked())throw new Error("invalid sync call");return this._fs.readlinkSync(t)};var Be="/.deletedFiles.log";function In(i){return 146|i}function ve(i){return b.getFileFlag(i)}var bn=function(i){function t(r,e,o,a,u){i.call(this,r,e,o,a,u)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.sync=function(e){var o=this;if(!this.isDirty()){e(null);return}this._fs._syncAsync(this,function(a){o.resetDirty(),e(a)})},t.prototype.syncSync=function(){this.isDirty()&&(this._fs._syncSync(this),this.resetDirty())},t.prototype.close=function(e){this.sync(e)},t.prototype.closeSync=function(){this.syncSync()},t}(Yt),kn=function(i){function t(r,e){if(i.call(this),this._isInitialized=!1,this._initializeCallbacks=[],this._deletedFiles={},this._deleteLog="",this._deleteLogUpdatePending=!1,this._deleteLogUpdateNeeded=!1,this._deleteLogError=null,this._writable=r,this._readable=e,this._writable.isReadOnly())throw new p(c.EINVAL,"Writable file system must be writable.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.isAvailable=function(){return!0},t.prototype.getOverlayedFileSystems=function(){return{readable:this._readable,writable:this._writable}},t.prototype._syncAsync=function(e,o){var a=this;this.createParentDirectoriesAsync(e.getPath(),function(u){if(u)return o(u);a._writable.writeFile(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode,o)})},t.prototype._syncSync=function(e){this.createParentDirectories(e.getPath()),this._writable.writeFileSync(e.getPath(),e.getBuffer(),null,ve("w"),e.getStats().mode)},t.prototype.getName=function(){return Tr.Name},t.prototype.initialize=function(e){var o=this,a=this._initializeCallbacks,u=function(h){o._isInitialized=!h,o._initializeCallbacks=[],a.forEach(function(S){return S(h)})};if(this._isInitialized)return e();a.push(e),a.length===1&&this._writable.readFile(Be,"utf8",ve("r"),function(h,S){if(h){if(h.errno!==c.ENOENT)return u(h)}else o._deleteLog=S;o._reparseDeletionLog(),u()})},t.prototype.isReadOnly=function(){return!1},t.prototype.supportsSynch=function(){return this._readable.supportsSynch()&&this._writable.supportsSynch()},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return this._readable.supportsProps()&&this._writable.supportsProps()},t.prototype.getDeletionLog=function(){return this._deleteLog},t.prototype.restoreDeletionLog=function(e){this._deleteLog=e,this._reparseDeletionLog(),this.updateLog("")},t.prototype.rename=function(e,o,a){var u=this;if(!(!this.checkInitAsync(a)||this.checkPathAsync(e,a)||this.checkPathAsync(o,a))){if(e===Be||o===Be)return a(p.EPERM("Cannot rename deletion log."));if(e===o)return a();this.stat(e,!1,function(h,S){return h?a(h):u.stat(o,!1,function(x,O){var D=u;function V(rt){var ft=rt.shift();if(!ft)return a();var yt=w.resolve(e,ft),Ft=w.resolve(o,ft);D.rename(yt,Ft,function(Vt){if(Vt)return a(Vt);V(rt)})}var $=511;if(S.isDirectory()){if(x)return x.errno!==c.ENOENT?a(x):u._writable.exists(e,function(rt){if(rt)return u._writable.rename(e,o,a);u._writable.mkdir(o,$,function(ft){if(ft)return a(ft);u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})});if($=O.mode,!O.isDirectory())return a(p.ENOTDIR(o));u.readdir(o,function(rt,ft){if(ft&&ft.length)return a(p.ENOTEMPTY(o));u._readable.readdir(e,function(yt,Ft){if(yt)return a();V(Ft)})})}if(O&&O.isDirectory())return a(p.EISDIR(o));u.readFile(e,null,ve("r"),function(rt,ft){return rt?a(rt):u.writeFile(o,ft,null,ve("w"),S.mode,function(yt){return yt?a(yt):u.unlink(e,a)})})})})}},t.prototype.renameSync=function(e,o){var a=this;if(this.checkInitialized(),this.checkPath(e),this.checkPath(o),e===Be||o===Be)throw p.EPERM("Cannot rename deletion log.");var u=this.statSync(e,!1);if(u.isDirectory()){if(e===o)return;var h=511;if(this.existsSync(o)){var S=this.statSync(o,!1);if(h=S.mode,S.isDirectory()){if(this.readdirSync(o).length>0)throw p.ENOTEMPTY(o)}else throw p.ENOTDIR(o)}this._writable.existsSync(e)?this._writable.renameSync(e,o):this._writable.existsSync(o)||this._writable.mkdirSync(o,h),this._readable.existsSync(e)&&this._readable.readdirSync(e).forEach(function(x){a.renameSync(w.resolve(e,x),w.resolve(o,x))})}else{if(this.existsSync(o)&&this.statSync(o,!1).isDirectory())throw p.EISDIR(o);this.writeFileSync(o,this.readFileSync(e,null,ve("r")),null,ve("w"),u.mode)}e!==o&&this.existsSync(e)&&this.unlinkSync(e)},t.prototype.stat=function(e,o,a){var u=this;!this.checkInitAsync(a)||this._writable.stat(e,o,function(h,S){h&&h.errno===c.ENOENT?(u._deletedFiles[e]&&a(p.ENOENT(e)),u._readable.stat(e,o,function(x,O){O&&(O=O.clone(),O.mode=In(O.mode)),a(x,O)})):a(h,S)})},t.prototype.statSync=function(e,o){this.checkInitialized();try{return this._writable.statSync(e,o)}catch{if(this._deletedFiles[e])throw p.ENOENT(e);var a=this._readable.statSync(e,o).clone();return a.mode=In(a.mode),a}},t.prototype.open=function(e,o,a,u){var h=this;!this.checkInitAsync(u)||this.checkPathAsync(e,u)||this.stat(e,!1,function(S,x){if(x)switch(o.pathExistsAction()){case A.TRUNCATE_FILE:return h.createParentDirectoriesAsync(e,function(O){if(O)return u(O);h._writable.open(e,o,a,u)});case A.NOP:return h._writable.exists(e,function(O){O?h._writable.open(e,o,a,u):(x=x.clone(),x.mode=a,h._readable.readFile(e,null,ve("r"),function(D,V){if(D)return u(D);x.size===-1&&(x.size=V.length);var $=new bn(h,e,o,x,V);u(null,$)}))});default:return u(p.EEXIST(e))}else switch(o.pathNotExistsAction()){case A.CREATE_FILE:return h.createParentDirectoriesAsync(e,function(O){return O?u(O):h._writable.open(e,o,a,u)});default:return u(p.ENOENT(e))}})},t.prototype.openSync=function(e,o,a){if(this.checkInitialized(),this.checkPath(e),e===Be)throw p.EPERM("Cannot open deletion log.");if(this.existsSync(e))switch(o.pathExistsAction()){case A.TRUNCATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,o,a);case A.NOP:if(this._writable.existsSync(e))return this._writable.openSync(e,o,a);var u=this._readable.readFileSync(e,null,ve("r")),h=this._readable.statSync(e,!1).clone();return h.mode=a,new bn(this,e,o,h,u);default:throw p.EEXIST(e)}else switch(o.pathNotExistsAction()){case A.CREATE_FILE:return this.createParentDirectories(e),this._writable.openSync(e,o,a);default:throw p.ENOENT(e)}},t.prototype.unlink=function(e,o){var a=this;!this.checkInitAsync(o)||this.checkPathAsync(e,o)||this.exists(e,function(u){if(!u)return o(p.ENOENT(e));a._writable.exists(e,function(h){if(h)return a._writable.unlink(e,function(S){if(S)return o(S);a.exists(e,function(x){x&&a.deletePath(e),o(null)})});a.deletePath(e),o(null)})})},t.prototype.unlinkSync=function(e){if(this.checkInitialized(),this.checkPath(e),this.existsSync(e))this._writable.existsSync(e)&&this._writable.unlinkSync(e),this.existsSync(e)&&this.deletePath(e);else throw p.ENOENT(e)},t.prototype.rmdir=function(e,o){var a=this;if(!!this.checkInitAsync(o)){var u=function(){a.readdir(e,function(h,S){if(h)return o(h);if(S.length)return o(p.ENOTEMPTY(e));a.deletePath(e),o(null)})};this.exists(e,function(h){if(!h)return o(p.ENOENT(e));a._writable.exists(e,function(S){S?a._writable.rmdir(e,function(x){if(x)return o(x);a._readable.exists(e,function(O){O?u():o()})}):u()})})}},t.prototype.rmdirSync=function(e){if(this.checkInitialized(),this.existsSync(e)){if(this._writable.existsSync(e)&&this._writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length>0)throw p.ENOTEMPTY(e);this.deletePath(e)}}else throw p.ENOENT(e)},t.prototype.mkdir=function(e,o,a){var u=this;!this.checkInitAsync(a)||this.exists(e,function(h){if(h)return a(p.EEXIST(e));u.createParentDirectoriesAsync(e,function(S){if(S)return a(S);u._writable.mkdir(e,o,a)})})},t.prototype.mkdirSync=function(e,o){if(this.checkInitialized(),this.existsSync(e))throw p.EEXIST(e);this.createParentDirectories(e),this._writable.mkdirSync(e,o)},t.prototype.readdir=function(e,o){var a=this;!this.checkInitAsync(o)||this.stat(e,!1,function(u,h){if(u)return o(u);if(!h.isDirectory())return o(p.ENOTDIR(e));a._writable.readdir(e,function(S,x){if(S&&S.code!=="ENOENT")return o(S);(S||!x)&&(x=[]),a._readable.readdir(e,function(O,D){(O||!D)&&(D=[]);var V={},$=x.concat(D.filter(function(rt){return!a._deletedFiles[e+"/"+rt]})).filter(function(rt){var ft=!V[rt];return V[rt]=!0,ft});o(null,$)})})})},t.prototype.readdirSync=function(e){var o=this;this.checkInitialized();var a=this.statSync(e,!1);if(!a.isDirectory())throw p.ENOTDIR(e);var u=[];try{u=u.concat(this._writable.readdirSync(e))}catch{}try{u=u.concat(this._readable.readdirSync(e).filter(function(S){return!o._deletedFiles[e+"/"+S]}))}catch{}var h={};return u.filter(function(S){var x=!h[S];return h[S]=!0,x})},t.prototype.exists=function(e,o){var a=this;this.checkInitialized(),this._writable.exists(e,function(u){if(u)return o(!0);a._readable.exists(e,function(h){o(h&&a._deletedFiles[e]!==!0)})})},t.prototype.existsSync=function(e){return this.checkInitialized(),this._writable.existsSync(e)||this._readable.existsSync(e)&&this._deletedFiles[e]!==!0},t.prototype.chmod=function(e,o,a,u){var h=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);h._writable.chmod(e,o,a,u)})},t.prototype.chmodSync=function(e,o,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.chmodSync(e,o,a)})},t.prototype.chown=function(e,o,a,u,h){var S=this;!this.checkInitAsync(h)||this.operateOnWritableAsync(e,function(x){if(x)return h(x);S._writable.chown(e,o,a,u,h)})},t.prototype.chownSync=function(e,o,a,u){var h=this;this.checkInitialized(),this.operateOnWritable(e,function(){h._writable.chownSync(e,o,a,u)})},t.prototype.utimes=function(e,o,a,u){var h=this;!this.checkInitAsync(u)||this.operateOnWritableAsync(e,function(S){if(S)return u(S);h._writable.utimes(e,o,a,u)})},t.prototype.utimesSync=function(e,o,a){var u=this;this.checkInitialized(),this.operateOnWritable(e,function(){u._writable.utimesSync(e,o,a)})},t.prototype.deletePath=function(e){this._deletedFiles[e]=!0,this.updateLog("d"+e+`
`)},t.prototype.updateLog=function(e){var o=this;this._deleteLog+=e,this._deleteLogUpdatePending?this._deleteLogUpdateNeeded=!0:(this._deleteLogUpdatePending=!0,this._writable.writeFile(Be,this._deleteLog,"utf8",b.getFileFlag("w"),420,function(a){o._deleteLogUpdatePending=!1,a?o._deleteLogError=a:o._deleteLogUpdateNeeded&&(o._deleteLogUpdateNeeded=!1,o.updateLog(""))}))},t.prototype._reparseDeletionLog=function(){var e=this;this._deletedFiles={},this._deleteLog.split(`
`).forEach(function(o){e._deletedFiles[o.slice(1)]=o.slice(0,1)==="d"})},t.prototype.checkInitialized=function(){if(this._isInitialized){if(this._deleteLogError!==null){var e=this._deleteLogError;throw this._deleteLogError=null,e}}else throw new p(c.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")},t.prototype.checkInitAsync=function(e){if(this._isInitialized){if(this._deleteLogError!==null){var o=this._deleteLogError;return this._deleteLogError=null,e(o),!1}}else return e(new p(c.EPERM,"OverlayFS is not initialized. Please initialize OverlayFS using its initialize() method before using it.")),!1;return!0},t.prototype.checkPath=function(e){if(e===Be)throw p.EPERM(e)},t.prototype.checkPathAsync=function(e,o){return e===Be?(o(p.EPERM(e)),!0):!1},t.prototype.createParentDirectoriesAsync=function(e,o){var a=w.dirname(e),u=[],h=this;this._writable.stat(a,!1,S);function S(O,D){O?(u.push(a),a=w.dirname(a),h._writable.stat(a,!1,S)):x()}function x(){if(!u.length)return o();var O=u.pop();h._readable.stat(O,!1,function(D,V){if(!V)return o();h._writable.mkdir(O,V.mode,function($){if($)return o($);x()})})}},t.prototype.createParentDirectories=function(e){for(var o=this,a=w.dirname(e),u=[];!this._writable.existsSync(a);)u.push(a),a=w.dirname(a);u=u.reverse(),u.forEach(function(h){o._writable.mkdirSync(h,o.statSync(h,!1).mode)})},t.prototype.operateOnWritable=function(e,o){if(this.existsSync(e))this._writable.existsSync(e)||this.copyToWritable(e),o();else throw p.ENOENT(e)},t.prototype.operateOnWritableAsync=function(e,o){var a=this;this.exists(e,function(u){if(!u)return o(p.ENOENT(e));a._writable.exists(e,function(h){if(h)o();else return a.copyToWritableAsync(e,o)})})},t.prototype.copyToWritable=function(e){var o=this.statSync(e,!1);o.isDirectory()?this._writable.mkdirSync(e,o.mode):this.writeFileSync(e,this._readable.readFileSync(e,null,ve("r")),null,ve("w"),this.statSync(e,!1).mode)},t.prototype.copyToWritableAsync=function(e,o){var a=this;this.stat(e,!1,function(u,h){if(u)return o(u);if(h.isDirectory())return a._writable.mkdir(e,h.mode,o);a._readable.readFile(e,null,ve("r"),function(S,x){if(S)return o(S);a.writeFile(e,x,null,ve("w"),h.mode,o)})})},t}(it),Tr=function(i){function t(r,e,o){o===void 0&&(o=!0),i.call(this,new kn(r,e)),kt(o,t.Name,{readable:"readable file system",writable:"writable file system"})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){try{var a=new t(e.writable,e.readable,!1);a.initialize(function(u){o(u,a)},!1)}catch(u){o(u)}},t.isAvailable=function(){return kn.isAvailable()},t.prototype.initialize=function(e,o){o===void 0&&(o=!0),o&&console.warn("[OverlayFS] OverlayFS.initialize() is deprecated and will be removed in the next major release. Please use 'OverlayFS.Create({readable: readable file system instance, writable: writable file system instance}, cb)' to create and initialize OverlayFS instances."),i.prototype.initialize.call(this,e)},t.prototype.getOverlayedFileSystems=function(){return i.prototype.getFSUnlocked.call(this).getOverlayedFileSystems()},t.prototype.unwrap=function(){return i.prototype.getFSUnlocked.call(this)},t}(mt);Tr.Name="OverlayFS",Tr.Options={writable:{type:"object",description:"The file system to write modified files to."},readable:{type:"object",description:"The file system that initially populates this file system."}};var Ht;(function(i){i[i.CB=0]="CB",i[i.FD=1]="FD",i[i.API_ERROR=2]="API_ERROR",i[i.STATS=3]="STATS",i[i.PROBE=4]="PROBE",i[i.FILEFLAG=5]="FILEFLAG",i[i.BUFFER=6]="BUFFER",i[i.ERROR=7]="ERROR"})(Ht||(Ht={}));var wi=function(){this._callbacks={},this._nextId=0};wi.prototype.toRemoteArg=function(t){var r=this._nextId++;return this._callbacks[r]=t,{type:Ht.CB,id:r}},wi.prototype.toLocalArg=function(t){var r=this._callbacks[t];return delete this._callbacks[t],r};var Gr=function(){this._fileDescriptors={},this._nextId=0};Gr.prototype.toRemoteArg=function(t,r,e,o){var a=this._nextId++,u,h;this._fileDescriptors[a]=t,t.stat(function(S,x){S?o(S):(h=Je(x.toBuffer()),e.isReadable()?t.read(f.alloc(x.size),0,x.size,0,function(O,D,V){O?o(O):(u=Je(V),o(null,{type:Ht.FD,id:a,data:u,stat:h,path:r,flag:e.getFlagString()}))}):o(null,{type:Ht.FD,id:a,data:new ArrayBuffer(0),stat:h,path:r,flag:e.getFlagString()}))})},Gr.prototype.applyFdAPIRequest=function(t,r){var e=this,o=t.args[0];this._applyFdChanges(o,function(a,u){a?r(a):u[t.method](function(h){t.method==="close"&&delete e._fileDescriptors[o.id],r(h)})})},Gr.prototype._applyFdChanges=function(t,r){var e=this._fileDescriptors[t.id],o=Ke(t.data),a=C.fromBuffer(Ke(t.stat)),u=b.getFileFlag(t.flag);u.isWriteable()?e.write(o,0,o.length,u.isAppendable()?e.getPos():0,function(h){function S(){e.stat(function(x,O){x?r(x):O.mode!==a.mode?e.chmod(a.mode,function(D){r(D,e)}):r(x,e)})}h?r(h):u.isAppendable()?S():e.truncate(o.length,function(){S()})}):r(null,e)};function Jr(i){return{type:Ht.API_ERROR,errorData:Je(i.writeToBuffer())}}function Rn(i){return p.fromBuffer(Ke(i.errorData))}function Nn(i){return{type:Ht.ERROR,name:i.name,message:i.message,stack:i.stack}}function Tn(i){var t=Kt[i.name];typeof t!="function"&&(t=Error);var r=new t(i.message);return r.stack=i.stack,r}function On(i){return{type:Ht.STATS,statsData:Je(i.toBuffer())}}function An(i){return C.fromBuffer(Ke(i.statsData))}function Ln(i){return{type:Ht.FILEFLAG,flagStr:i.getFlagString()}}function Dn(i){return b.getFileFlag(i.flagStr)}function Je(i){return K(i)}function Ke(i){return xt(i)}function Cn(i){return{type:Ht.BUFFER,data:Je(i)}}function Bn(i){return Ke(i.data)}function Aa(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}function La(i){return i&&typeof i=="object"&&i.hasOwnProperty("browserfsMessage")&&i.browserfsMessage}var Un=function(i){function t(r,e,o,a,u,h){i.call(this,r,e,o,a,h),this._remoteFdId=u}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.getRemoteFdId=function(){return this._remoteFdId},t.prototype.toRemoteArg=function(){return{type:Ht.FD,id:this._remoteFdId,data:Je(this.getBuffer()),stat:Je(this.getStats().toBuffer()),path:this.getPath(),flag:this.getFlag().getFlagString()}},t.prototype.sync=function(e){this._syncClose("sync",e)},t.prototype.close=function(e){this._syncClose("close",e)},t.prototype._syncClose=function(e,o){var a=this;this.isDirty()?this._fs.syncClose(e,this,function(u){u||a.resetDirty(),o(u)}):o()},t}(Yt),Kr=function(i){function t(r,e){var o=this;e===void 0&&(e=!0),i.call(this),this._callbackConverter=new wi,this._isInitialized=!1,this._isReadOnly=!1,this._supportLinks=!1,this._supportProps=!1,this._worker=r,kt(e,t.Name,{worker:"Web Worker instance"}),this._worker.addEventListener("message",function(a){var u=a.data;if(La(u)){var h,S=u.args,x=new Array(S.length);for(h=0;h<x.length;h++)x[h]=o._argRemote2Local(S[h]);o._callbackConverter.toLocalArg(u.cbId).apply(null,x)}})}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){var a=new t(e.worker,!1);a.initialize(function(){o(null,a)})},t.isAvailable=function(){return typeof importScripts<"u"||typeof Worker<"u"},t.attachRemoteListener=function(e){var o=new Gr;function a(h,S,x){switch(typeof h){case"object":h instanceof C?x(null,On(h)):h instanceof p?x(null,Jr(h)):h instanceof gt?x(null,o.toRemoteArg(h,S[0],S[1],x)):h instanceof b?x(null,Ln(h)):h instanceof f?x(null,Cn(h)):h instanceof Error?x(null,Nn(h)):x(null,h);break;default:x(null,h);break}}function u(h,S){if(!h)return h;switch(typeof h){case"object":if(typeof h.type=="number"){var x=h;switch(x.type){case Ht.CB:var O=h.id;return function(){var D=arguments,V,$=new Array(arguments.length),rt,ft=arguments.length;function yt(Ft){ft>0&&(ft=-1,rt={browserfsMessage:!0,cbId:O,args:[Jr(Ft)]},e.postMessage(rt))}for(V=0;V<arguments.length;V++)(function(Ft,Vt){a(Vt,S,function(se,Te){$[Ft]=Te,se?yt(se):--ft===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))})})(V,D[V]);arguments.length===0&&(rt={browserfsMessage:!0,cbId:O,args:$},e.postMessage(rt))};case Ht.API_ERROR:return Rn(x);case Ht.STATS:return An(x);case Ht.FILEFLAG:return Dn(x);case Ht.BUFFER:return Bn(x);case Ht.ERROR:return Tn(x);default:return h}}else return h;default:return h}}e.addEventListener("message",function(h){var S=h.data;if(Aa(S)){var x=S.args,O=new Array(x.length);switch(S.method){case"close":case"sync":(function(){var $=x[1];o.applyFdAPIRequest(S,function(rt){var ft={browserfsMessage:!0,cbId:$.id,args:rt?[Jr(rt)]:[]};e.postMessage(ft)})})();break;case"probe":(function(){var $=ct.getRootFS(),rt=x[1],ft={type:Ht.PROBE,isReadOnly:$.isReadOnly(),supportsLinks:$.supportsLinks(),supportsProps:$.supportsProps()},yt={browserfsMessage:!0,cbId:rt.id,args:[ft]};e.postMessage(yt)})();break;default:for(var D=0;D<x.length;D++)O[D]=u(x[D],O);var V=ct.getRootFS();V[S.method].apply(V,O);break}}})},t.prototype.getName=function(){return t.Name},t.prototype.initialize=function(e){var o=this;if(this._isInitialized)e();else{var a={browserfsMessage:!0,method:"probe",args:[this._argLocal2Remote(Ct()),this._callbackConverter.toRemoteArg(function(u){o._isInitialized=!0,o._isReadOnly=u.isReadOnly,o._supportLinks=u.supportsLinks,o._supportProps=u.supportsProps,e()})]};this._worker.postMessage(a)}},t.prototype.isReadOnly=function(){return this._isReadOnly},t.prototype.supportsSynch=function(){return!1},t.prototype.supportsLinks=function(){return this._supportLinks},t.prototype.supportsProps=function(){return this._supportProps},t.prototype.rename=function(e,o,a){this._rpc("rename",arguments)},t.prototype.stat=function(e,o,a){this._rpc("stat",arguments)},t.prototype.open=function(e,o,a,u){this._rpc("open",arguments)},t.prototype.unlink=function(e,o){this._rpc("unlink",arguments)},t.prototype.rmdir=function(e,o){this._rpc("rmdir",arguments)},t.prototype.mkdir=function(e,o,a){this._rpc("mkdir",arguments)},t.prototype.readdir=function(e,o){this._rpc("readdir",arguments)},t.prototype.exists=function(e,o){this._rpc("exists",arguments)},t.prototype.realpath=function(e,o,a){this._rpc("realpath",arguments)},t.prototype.truncate=function(e,o,a){this._rpc("truncate",arguments)},t.prototype.readFile=function(e,o,a,u){this._rpc("readFile",arguments)},t.prototype.writeFile=function(e,o,a,u,h,S){this._rpc("writeFile",arguments)},t.prototype.appendFile=function(e,o,a,u,h,S){this._rpc("appendFile",arguments)},t.prototype.chmod=function(e,o,a,u){this._rpc("chmod",arguments)},t.prototype.chown=function(e,o,a,u,h){this._rpc("chown",arguments)},t.prototype.utimes=function(e,o,a,u){this._rpc("utimes",arguments)},t.prototype.link=function(e,o,a){this._rpc("link",arguments)},t.prototype.symlink=function(e,o,a,u){this._rpc("symlink",arguments)},t.prototype.readlink=function(e,o){this._rpc("readlink",arguments)},t.prototype.syncClose=function(e,o,a){this._worker.postMessage({browserfsMessage:!0,method:e,args:[o.toRemoteArg(),this._callbackConverter.toRemoteArg(a)]})},t.prototype._argRemote2Local=function(e){if(!e)return e;switch(typeof e){case"object":if(typeof e.type=="number"){var o=e;switch(o.type){case Ht.API_ERROR:return Rn(o);case Ht.FD:var a=o;return new Un(this,a.path,b.getFileFlag(a.flag),C.fromBuffer(Ke(a.stat)),a.id,Ke(a.data));case Ht.STATS:return An(o);case Ht.FILEFLAG:return Dn(o);case Ht.BUFFER:return Bn(o);case Ht.ERROR:return Tn(o);default:return e}}else return e;default:return e}},t.prototype._rpc=function(e,o){for(var a=this,u=new Array(o.length),h=0;h<o.length;h++)u[h]=a._argLocal2Remote(o[h]);var S={browserfsMessage:!0,method:e,args:u};this._worker.postMessage(S)},t.prototype._argLocal2Remote=function(e){if(!e)return e;switch(typeof e){case"object":return e instanceof C?On(e):e instanceof p?Jr(e):e instanceof Un?e.toRemoteArg():e instanceof b?Ln(e):e instanceof f?Cn(e):e instanceof Error?Nn(e):"Unknown argument";case"function":return this._callbackConverter.toRemoteArg(e);default:return e}},t}(it);Kr.Name="WorkerFS",Kr.Options={worker:{type:"object",description:"The target worker that you want to connect to, or the current worker if in a worker context.",validator:function(i,t){i.postMessage?t():t(new p(c.EINVAL,"option must be a Web Worker instance."))}}};function Da(i,t,r){var e=new XMLHttpRequest;e.open("GET",i,!0);var o=!0;switch(t){case"buffer":e.responseType="arraybuffer";break;case"json":try{e.responseType="json",o=e.responseType==="json"}catch{o=!1}break;default:return r(new p(c.EINVAL,"Invalid download type: "+t))}e.onreadystatechange=function(a){if(e.readyState===4)if(e.status===200)switch(t){case"buffer":return r(null,e.response?f.from(e.response):Ct());case"json":return o?r(null,e.response):r(null,JSON.parse(e.responseText))}else return r(new p(e.status,"XHR error."))},e.send()}function Ca(i,t){var r=new XMLHttpRequest;r.open("GET",i,!1);var e=null,o=null;if(r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":var u=r.responseText;e=f.alloc(u.length);for(var h=0;h<u.length;h++)e[h]=u.charCodeAt(h);return;case"json":e=JSON.parse(r.responseText);return}else{o=new p(r.status,"XHR error.");return}},r.send(),o)throw o;return e}function Ba(i,t){var r=new XMLHttpRequest;switch(r.open("GET",i,!1),t){case"buffer":r.responseType="arraybuffer";break;case"json":break;default:throw new p(c.EINVAL,"Invalid download type: "+t)}var e,o;if(r.onreadystatechange=function(a){if(r.readyState===4)if(r.status===200)switch(t){case"buffer":e=f.from(r.response);break;case"json":e=JSON.parse(r.response);break}else o=new p(r.status,"XHR error.")},r.send(),o)throw o;return e}function Mn(i,t,r){var e=new XMLHttpRequest;e.open("HEAD",t,i),e.onreadystatechange=function(o){if(e.readyState===4)if(e.status===200)try{return r(null,parseInt(e.getResponseHeader("Content-Length")||"-1",10))}catch{return r(new p(c.EIO,"XHR HEAD error: Could not read content-length."))}else return r(new p(e.status,"XHR HEAD error."))},e.send()}var Pn=Da,Ua=St&&typeof Blob<"u"?Ba:Ca;function Ma(i){var t=-1;return Mn(!1,i,function(r,e){if(r)throw r;t=e}),t}function Pa(i,t){Mn(!0,i,t)}var _e=function(){this._index={},this.addPath("/",new pe)};_e.fromListing=function(t){var r=new _e,e=new pe;r._index["/"]=e;for(var o=[["",t,e]];o.length>0;){var a=void 0,u=o.pop(),h=u[0],S=u[1],x=u[2];for(var O in S)if(S.hasOwnProperty(O)){var D=S[O],V=h+"/"+O;D?(r._index[V]=a=new pe,o.push([V,D,a])):a=new lr(new C(L.FILE,-1,365)),x&&(x._ls[O]=a)}}return r},_e.prototype.fileIterator=function(t){var r=this;for(var e in r._index)if(r._index.hasOwnProperty(e))for(var o=r._index[e],a=o.getListing(),u=0,h=a;u<h.length;u+=1){var S=h[u],x=o.getItem(S);Ue(x)&&t(x.getData())}},_e.prototype.addPath=function(t,r){if(!r)throw new Error("Inode must be specified");if(t[0]!=="/")throw new Error("Path must be absolute, got: "+t);if(this._index.hasOwnProperty(t))return this._index[t]===r;var e=this._split_path(t),o=e[0],a=e[1],u=this._index[o];return u===void 0&&t!=="/"&&(u=new pe,!this.addPath(o,u))||t!=="/"&&!u.addItem(a,r)?!1:(We(r)&&(this._index[t]=r),!0)},_e.prototype.addPathFast=function(t,r){var e=t.lastIndexOf("/"),o=e===0?"/":t.substring(0,e),a=t.substring(e+1),u=this._index[o];return u===void 0&&(u=new pe,this.addPathFast(o,u)),u.addItem(a,r)?(r.isDir()&&(this._index[t]=r),!0):!1},_e.prototype.removePath=function(t){var r=this,e=this._split_path(t),o=e[0],a=e[1],u=this._index[o];if(u===void 0)return null;var h=u.remItem(a);if(h===null)return null;if(We(h)){for(var S=h.getListing(),x=0,O=S;x<O.length;x+=1){var D=O[x];r.removePath(t+"/"+D)}t!=="/"&&delete this._index[t]}return h},_e.prototype.ls=function(t){var r=this._index[t];return r===void 0?null:r.getListing()},_e.prototype.getInode=function(t){var r=this._split_path(t),e=r[0],o=r[1],a=this._index[e];return a===void 0?null:e===t?a:a.getItem(o)},_e.prototype._split_path=function(t){var r=w.dirname(t),e=t.substr(r.length+(r==="/"?0:1));return[r,e]};var lr=function(t){this.data=t};lr.prototype.isFile=function(){return!0},lr.prototype.isDir=function(){return!1},lr.prototype.getData=function(){return this.data},lr.prototype.setData=function(t){this.data=t};var pe=function(t){t===void 0&&(t=null),this.data=t,this._ls={}};pe.prototype.isFile=function(){return!1},pe.prototype.isDir=function(){return!0},pe.prototype.getData=function(){return this.data},pe.prototype.getStats=function(){return new C(L.DIRECTORY,4096,365)},pe.prototype.getListing=function(){return Object.keys(this._ls)},pe.prototype.getItem=function(t){var r=this._ls[t];return r||null},pe.prototype.addItem=function(t,r){return t in this._ls?!1:(this._ls[t]=r,!0)},pe.prototype.remItem=function(t){var r=this._ls[t];return r===void 0?null:(delete this._ls[t],r)};function Ue(i){return!!i&&i.isFile()}function We(i){return!!i&&i.isDir()}function za(i,t,r){try{r(null,i.toString(t))}catch(e){r(e)}}var Qr=function(i){function t(r,e,o){e===void 0&&(e=""),o===void 0&&(o=!0),i.call(this),r||(r="index.json"),e.length>0&&e.charAt(e.length-1)!=="/"&&(e=e+"/"),this.prefixUrl=e;var a=null;if(typeof r=="string"){if(a=this._requestFileSync(r,"json"),!a)throw new Error("Unable to find listing at URL: ${listingUrlOrObj}")}else a=r;kt(o,t.Name,{index:typeof r=="string"?r:"file index as an object",baseUrl:e}),this._index=_e.fromListing(a)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){e.index===void 0&&(e.index="index.json"),typeof e.index=="string"?t.FromURL(e.index,o,e.baseUrl,!1):o(null,new t(e.index,e.baseUrl,!1))},t.isAvailable=function(){return typeof XMLHttpRequest<"u"&&XMLHttpRequest!==null},t.FromURL=function(e,o,a,u){a===void 0&&(a=e.slice(0,e.lastIndexOf("/")+1)),u===void 0&&(u=!0),u&&console.warn(`[XmlHttpRequest] XmlHttpRequest.FromURL() is deprecated and will be removed in the next major release. Please use 'XmlHttpRequest.Create({ index: "`+e+'", baseUrl: "'+a+`" }, cb)' instead.`),Pn(e,"json",function(h,S){h?o(h):o(null,new t(S,a,!1))})},t.prototype.empty=function(){this._index.fileIterator(function(e){e.fileData=null})},t.prototype.getName=function(){return t.Name},t.prototype.diskSpace=function(e,o){o(0,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.preloadFile=function(e,o){var a=this._index.getInode(e);if(Ue(a)){if(a===null)throw p.ENOENT(e);var u=a.getData();u.size=o.length,u.fileData=o}else throw p.EISDIR(e)},t.prototype.stat=function(e,o,a){var u=this._index.getInode(e);if(u===null)return a(p.ENOENT(e));var h;Ue(u)?(h=u.getData(),h.size<0?this._requestFileSizeAsync(e,function(S,x){if(S)return a(S);h.size=x,a(null,h.clone())}):a(null,h.clone())):We(u)?(h=u.getStats(),a(null,h)):a(p.FileError(c.EINVAL,e))},t.prototype.statSync=function(e,o){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Ue(a))u=a.getData(),u.size<0&&(u.size=this._requestFileSizeSync(e));else if(We(a))u=a.getStats();else throw p.FileError(c.EINVAL,e);return u},t.prototype.open=function(e,o,a,u){if(o.isWriteable())return u(new p(c.EPERM,e));var h=this,S=this._index.getInode(e);if(S===null)return u(p.ENOENT(e));if(Ue(S)){var x=S.getData();switch(o.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:return u(p.EEXIST(e));case A.NOP:if(x.fileData)return u(null,new ue(h,e,o,x.clone(),x.fileData));this._requestFileAsync(e,"buffer",function(O,D){return O?u(O):(x.size=D.length,x.fileData=D,u(null,new ue(h,e,o,x.clone(),D)))});break;default:return u(new p(c.EINVAL,"Invalid FileMode object."))}}else return u(p.EISDIR(e))},t.prototype.openSync=function(e,o,a){if(o.isWriteable())throw new p(c.EPERM,e);var u=this._index.getInode(e);if(u===null)throw p.ENOENT(e);if(Ue(u)){var h=u.getData();switch(o.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:if(h.fileData)return new ue(this,e,o,h.clone(),h.fileData);var S=this._requestFileSync(e,"buffer");return h.size=S.length,h.fileData=S,new ue(this,e,o,h.clone(),S);default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e)},t.prototype.readdir=function(e,o){try{o(null,this.readdirSync(e))}catch(a){o(a)}},t.prototype.readdirSync=function(e){var o=this._index.getInode(e);if(o===null)throw p.ENOENT(e);if(We(o))return o.getListing();throw p.ENOTDIR(e)},t.prototype.readFile=function(e,o,a,u){var h=u;this.open(e,a,420,function(S,x){if(S)return u(S);u=function(V,$){x.close(function(rt){return V||(V=rt),h(V,$)})};var O=x,D=O.getBuffer();o===null?u(S,Nt(D)):za(D,o,u)})},t.prototype.readFileSync=function(e,o,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return o===null?Nt(S):S.toString(o)}finally{u.closeSync()}},t.prototype.getXhrPath=function(e){return e.charAt(0)==="/"&&(e=e.slice(1)),this.prefixUrl+e},t.prototype._requestFileAsync=function(e,o,a){Pn(this.getXhrPath(e),o,a)},t.prototype._requestFileSync=function(e,o){return Ua(this.getXhrPath(e),o)},t.prototype._requestFileSizeAsync=function(e,o){Pa(this.getXhrPath(e),o)},t.prototype._requestFileSizeSync=function(e){return Ma(this.getXhrPath(e))},t}(it);Qr.Name="XmlHttpRequest",Qr.Options={index:{type:["string","object"],optional:!0,description:"URL to a file index as a JSON file or the file index object itself, generated with the make_xhrfs_index script. Defaults to `index.json`."},baseUrl:{type:"string",optional:!0,description:"Used as the URL prefix for fetched files. Default: Fetch files relative to the index."}};var Qe=function(){};Qe.str2byte=function(t,r){for(var e=t.length>r.length?r.length:t.length,o=0;o<e;o++){var a=t.charCodeAt(o);if(a>127){var u=Qe.extendedChars.indexOf(t.charAt(o));u>-1&&(a=u+128)}r[a]=o}return e},Qe.byte2str=function(t){for(var r=new Array(t.length),e=0;e<t.length;e++){var o=t[e];o>127?r[e]=Qe.extendedChars[o-128]:r[e]=String.fromCharCode(o)}return r.join("")},Qe.byteLength=function(t){return t.length},Qe.extendedChars=["\xC7","\xFC","\xE9","\xE2","\xE4","\xE0","\xE5","\xE7","\xEA","\xEB","\xE8","\xEF","\xEE","\xEC","\xC4","\xC5","\xC9","\xE6","\xC6","\xF4","\xF6","\xF2","\xFB","\xF9","\xFF","\xD6","\xDC","\xF8","\xA3","\xD8","\xD7","\u0192","\xE1","\xED","\xF3","\xFA","\xF1","\xD1","\xAA","\xBA","\xBF","\xAE","\xAC","\xBD","\xBC","\xA1","\xAB","\xBB","_","_","_","\xA6","\xA6","\xC1","\xC2","\xC0","\xA9","\xA6","\xA6","+","+","\xA2","\xA5","+","+","-","-","+","-","+","\xE3","\xC3","+","+","-","-","\xA6","-","+","\xA4","\xF0","\xD0","\xCA","\xCB","\xC8","i","\xCD","\xCE","\xCF","+","+","_","_","\xA6","\xCC","_","\xD3","\xDF","\xD4","\xD2","\xF5","\xD5","\xB5","\xFE","\xDE","\xDA","\xDB","\xD9","\xFD","\xDD","\xAF","\xB4","\xAD","\xB1","_","\xBE","\xB6","\xA7","\xF7","\xB8","\xB0","\xA8","\xB7","\xB9","\xB3","\xB2","_"," "];var ja=s(31).inflateRaw,zn={},jn;(function(i){i[i.MSDOS=0]="MSDOS",i[i.AMIGA=1]="AMIGA",i[i.OPENVMS=2]="OPENVMS",i[i.UNIX=3]="UNIX",i[i.VM_CMS=4]="VM_CMS",i[i.ATARI_ST=5]="ATARI_ST",i[i.OS2_HPFS=6]="OS2_HPFS",i[i.MAC=7]="MAC",i[i.Z_SYSTEM=8]="Z_SYSTEM",i[i.CP_M=9]="CP_M",i[i.NTFS=10]="NTFS",i[i.MVS=11]="MVS",i[i.VSE=12]="VSE",i[i.ACORN_RISC=13]="ACORN_RISC",i[i.VFAT=14]="VFAT",i[i.ALT_MVS=15]="ALT_MVS",i[i.BEOS=16]="BEOS",i[i.TANDEM=17]="TANDEM",i[i.OS_400=18]="OS_400",i[i.OSX=19]="OSX"})(jn||(jn={}));var hr;(function(i){i[i.STORED=0]="STORED",i[i.SHRUNK=1]="SHRUNK",i[i.REDUCED_1=2]="REDUCED_1",i[i.REDUCED_2=3]="REDUCED_2",i[i.REDUCED_3=4]="REDUCED_3",i[i.REDUCED_4=5]="REDUCED_4",i[i.IMPLODE=6]="IMPLODE",i[i.DEFLATE=8]="DEFLATE",i[i.DEFLATE64=9]="DEFLATE64",i[i.TERSE_OLD=10]="TERSE_OLD",i[i.BZIP2=12]="BZIP2",i[i.LZMA=14]="LZMA",i[i.TERSE_NEW=18]="TERSE_NEW",i[i.LZ77=19]="LZ77",i[i.WAVPACK=97]="WAVPACK",i[i.PPMD=98]="PPMD"})(hr||(hr={}));function Wn(i,t){var r=t&31,e=(t>>5&15)-1,o=(t>>9)+1980,a=i&31,u=i>>5&63,h=i>>11;return new Date(o,e,r,h,u,a)}function $r(i,t,r,e){return e===0?"":t?i.toString("utf8",r,r+e):Qe.byte2str(i.slice(r,r+e))}var me=function(t){if(this.data=t,t.readUInt32LE(0)!==67324752)throw new p(c.EINVAL,"Invalid Zip file: Local file header has invalid signature: "+this.data.readUInt32LE(0))};me.prototype.versionNeeded=function(){return this.data.readUInt16LE(4)},me.prototype.flags=function(){return this.data.readUInt16LE(6)},me.prototype.compressionMethod=function(){return this.data.readUInt16LE(8)},me.prototype.lastModFileTime=function(){return Wn(this.data.readUInt16LE(10),this.data.readUInt16LE(12))},me.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(10)},me.prototype.crc32=function(){return this.data.readUInt32LE(14)},me.prototype.fileNameLength=function(){return this.data.readUInt16LE(26)},me.prototype.extraFieldLength=function(){return this.data.readUInt16LE(28)},me.prototype.fileName=function(){return $r(this.data,this.useUTF8(),30,this.fileNameLength())},me.prototype.extraField=function(){var t=30+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},me.prototype.totalSize=function(){return 30+this.fileNameLength()+this.extraFieldLength()},me.prototype.useUTF8=function(){return(this.flags()&2048)===2048};var Or=function(t,r,e){this.header=t,this.record=r,this.data=e};Or.prototype.decompress=function(){var t=this.header.compressionMethod(),r=zn[t];if(r)return r(this.data,this.record.compressedSize(),this.record.uncompressedSize(),this.record.flag());var e=hr[t];throw e||(e="Unknown: "+t),new p(c.EINVAL,"Invalid compression method on file '"+this.header.fileName()+"': "+e)},Or.prototype.getHeader=function(){return this.header},Or.prototype.getRecord=function(){return this.record},Or.prototype.getRawData=function(){return this.data};var Si=function(t){this.data=t};Si.prototype.crc32=function(){return this.data.readUInt32LE(0)},Si.prototype.compressedSize=function(){return this.data.readUInt32LE(4)},Si.prototype.uncompressedSize=function(){return this.data.readUInt32LE(8)};var Hn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==134630224)throw new p(c.EINVAL,"Invalid archive extra data record signature: "+this.data.readUInt32LE(0))};Hn.prototype.length=function(){return this.data.readUInt32LE(4)},Hn.prototype.extraFieldData=function(){return this.data.slice(8,8+this.length())};var Vn=function(t){if(this.data=t,this.data.readUInt32LE(0)!==84233040)throw new p(c.EINVAL,"Invalid digital signature signature: "+this.data.readUInt32LE(0))};Vn.prototype.size=function(){return this.data.readUInt16LE(4)},Vn.prototype.signatureData=function(){return this.data.slice(6,6+this.size())};var Ot=function(t,r){if(this.zipData=t,this.data=r,this.data.readUInt32LE(0)!==33639248)throw new p(c.EINVAL,"Invalid Zip file: Central directory record has invalid signature: "+this.data.readUInt32LE(0));this._filename=this.produceFilename()};Ot.prototype.versionMadeBy=function(){return this.data.readUInt16LE(4)},Ot.prototype.versionNeeded=function(){return this.data.readUInt16LE(6)},Ot.prototype.flag=function(){return this.data.readUInt16LE(8)},Ot.prototype.compressionMethod=function(){return this.data.readUInt16LE(10)},Ot.prototype.lastModFileTime=function(){return Wn(this.data.readUInt16LE(12),this.data.readUInt16LE(14))},Ot.prototype.rawLastModFileTime=function(){return this.data.readUInt32LE(12)},Ot.prototype.crc32=function(){return this.data.readUInt32LE(16)},Ot.prototype.compressedSize=function(){return this.data.readUInt32LE(20)},Ot.prototype.uncompressedSize=function(){return this.data.readUInt32LE(24)},Ot.prototype.fileNameLength=function(){return this.data.readUInt16LE(28)},Ot.prototype.extraFieldLength=function(){return this.data.readUInt16LE(30)},Ot.prototype.fileCommentLength=function(){return this.data.readUInt16LE(32)},Ot.prototype.diskNumberStart=function(){return this.data.readUInt16LE(34)},Ot.prototype.internalAttributes=function(){return this.data.readUInt16LE(36)},Ot.prototype.externalAttributes=function(){return this.data.readUInt32LE(38)},Ot.prototype.headerRelativeOffset=function(){return this.data.readUInt32LE(42)},Ot.prototype.produceFilename=function(){var t=$r(this.data,this.useUTF8(),46,this.fileNameLength());return t.replace(/\\/g,"/")},Ot.prototype.fileName=function(){return this._filename},Ot.prototype.rawFileName=function(){return this.data.slice(46,46+this.fileNameLength())},Ot.prototype.extraField=function(){var t=44+this.fileNameLength();return this.data.slice(t,t+this.extraFieldLength())},Ot.prototype.fileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return $r(this.data,this.useUTF8(),t,this.fileCommentLength())},Ot.prototype.rawFileComment=function(){var t=46+this.fileNameLength()+this.extraFieldLength();return this.data.slice(t,t+this.fileCommentLength())},Ot.prototype.totalSize=function(){return 46+this.fileNameLength()+this.extraFieldLength()+this.fileCommentLength()},Ot.prototype.isDirectory=function(){var t=this.fileName();return!!(this.externalAttributes()&16)||t.charAt(t.length-1)==="/"},Ot.prototype.isFile=function(){return!this.isDirectory()},Ot.prototype.useUTF8=function(){return(this.flag()&2048)===2048},Ot.prototype.isEncrypted=function(){return(this.flag()&1)===1},Ot.prototype.getFileData=function(){var t=this.headerRelativeOffset(),r=new me(this.zipData.slice(t));return new Or(r,this,this.zipData.slice(t+r.totalSize()))},Ot.prototype.getData=function(){return this.getFileData().decompress()},Ot.prototype.getRawData=function(){return this.getFileData().getRawData()},Ot.prototype.getStats=function(){return new C(L.FILE,this.uncompressedSize(),365,new Date,this.lastModFileTime())};var Re=function(t){if(this.data=t,this.data.readUInt32LE(0)!==101010256)throw new p(c.EINVAL,"Invalid Zip file: End of central directory record has invalid signature: "+this.data.readUInt32LE(0))};Re.prototype.diskNumber=function(){return this.data.readUInt16LE(4)},Re.prototype.cdDiskNumber=function(){return this.data.readUInt16LE(6)},Re.prototype.cdDiskEntryCount=function(){return this.data.readUInt16LE(8)},Re.prototype.cdTotalEntryCount=function(){return this.data.readUInt16LE(10)},Re.prototype.cdSize=function(){return this.data.readUInt32LE(12)},Re.prototype.cdOffset=function(){return this.data.readUInt32LE(16)},Re.prototype.cdZipCommentLength=function(){return this.data.readUInt16LE(20)},Re.prototype.cdZipComment=function(){return $r(this.data,!0,22,this.cdZipCommentLength())},Re.prototype.rawCdZipComment=function(){return this.data.slice(22,22+this.cdZipCommentLength())};var Zn=function(t,r,e,o){this.index=t,this.directoryEntries=r,this.eocd=e,this.data=o},$e=function(i){function t(r,e,o){e===void 0&&(e=""),o===void 0&&(o=!0),i.call(this),this.name=e,this._index=new _e,this._directoryEntries=[],this._eocd=null,kt(o,t.Name,{zipData:"zip data as a Buffer",name:e}),r instanceof Zn?(this._index=r.index,this._directoryEntries=r.directoryEntries,this._eocd=r.eocd,this.data=r.data):(this.data=r,this.populateIndex())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){try{t.computeIndex(e.zipData,function(a){var u=new t(a,e.name,!1);o(null,u)},!1)}catch(a){o(a)}},t.isAvailable=function(){return!0},t.RegisterDecompressionMethod=function(e,o){zn[e]=o},t.computeIndex=function(e,o,a){a===void 0&&(a=!0),a&&console.warn("[ZipFS] ZipFS.computeIndex is now deprecated, and will be removed in the next major release. Please update your code to use 'ZipFS.Create({ zipData: zip file as a Buffer}, cb)' instead.");var u=new _e,h=t.getEOCD(e);if(h.diskNumber()!==h.cdDiskNumber())throw new p(c.EINVAL,"ZipFS does not support spanned zip files.");var S=h.cdOffset();if(S===4294967295)throw new p(c.EINVAL,"ZipFS does not support Zip64.");var x=S+h.cdSize();t.computeIndexResponsive(e,u,S,x,o,[],h)},t.getEOCD=function(e){for(var o=22,a=Math.min(o+65535,e.length-1),u=o;u<a;u++)if(e.readUInt32LE(e.length-u)===101010256)return new Re(e.slice(e.length-u));throw new p(c.EINVAL,"Invalid ZIP file: Could not locate End of Central Directory signature.")},t.addToIndex=function(e,o){var a=e.fileName();if(a.charAt(0)==="/")throw new Error("WHY IS THIS ABSOLUTE");a.charAt(a.length-1)==="/"&&(a=a.substr(0,a.length-1)),e.isDirectory()?o.addPathFast("/"+a,new pe(e)):o.addPathFast("/"+a,new lr(e))},t.computeIndexResponsive=function(e,o,a,u,h,S,x){if(a<u){for(var O=0;O++<200&&a<u;){var D=new Ot(e,e.slice(a));t.addToIndex(D,o),a+=D.totalSize(),S.push(D)}mi(function(){t.computeIndexResponsive(e,o,a,u,h,S,x)})}else h(new Zn(o,S,x,e))},t.prototype.getName=function(){return t.Name+(this.name!==""?" "+this.name:"")},t.prototype.getCentralDirectoryEntry=function(e){var o=this._index.getInode(e);if(o===null)throw p.ENOENT(e);if(Ue(o))return o.getData();if(We(o))return o.getData();throw p.EPERM("Invalid inode: "+o)},t.prototype.getCentralDirectoryEntryAt=function(e){var o=this._directoryEntries[e];if(!o)throw new RangeError("Invalid directory index: "+e+".");return o},t.prototype.getNumberOfCentralDirectoryEntries=function(){return this._directoryEntries.length},t.prototype.getEndOfCentralDirectory=function(){return this._eocd},t.prototype.diskSpace=function(e,o){o(this.data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,o){var a=this._index.getInode(e);if(a===null)throw p.ENOENT(e);var u;if(Ue(a))u=a.getData().getStats();else if(We(a))u=a.getStats();else throw new p(c.EINVAL,"Invalid inode.");return u},t.prototype.openSync=function(e,o,a){if(o.isWriteable())throw new p(c.EPERM,e);var u=this._index.getInode(e);if(u)if(Ue(u)){var h=u.getData(),S=h.getStats();switch(o.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,o,S,h.getData());default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.EISDIR(e);else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var o=this._index.getInode(e);if(o){if(We(o))return o.getListing();throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,o,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return o===null?Nt(S):S.toString(o)}finally{u.closeSync()}},t.prototype.populateIndex=function(){var e=this,o=this._eocd=t.getEOCD(this.data);if(o.diskNumber()!==o.cdDiskNumber())throw new p(c.EINVAL,"ZipFS does not support spanned zip files.");var a=o.cdOffset();if(a===4294967295)throw new p(c.EINVAL,"ZipFS does not support Zip64.");for(var u=a+o.cdSize();a<u;){var h=new Ot(e.data,e.data.slice(a));a+=h.totalSize(),t.addToIndex(h,e._index),e._directoryEntries.push(h)}},t}(_t);$e.Name="ZipFS",$e.Options={zipData:{type:"object",description:"The zip file as a Buffer object.",validator:te},name:{type:"string",optional:!0,description:"The name of the zip file (optional)."}},$e.CompressionMethod=hr,$e.RegisterDecompressionMethod(hr.DEFLATE,function(i,t,r){return It(ja(i.slice(0,t),{chunkSize:r}))}),$e.RegisterDecompressionMethod(hr.STORED,function(i,t,r){return Nt(i,0,r)});var Wa="IEEE_P1282";function de(i,t,r){return i.toString("ascii",t,t+r).trim()}function Ei(i,t,r){if(r===1)return String.fromCharCode(i[t]);for(var e=Math.floor(r/2),o=new Array(e),a=0;a<e;a++){var u=t+(a<<1);o[a]=String.fromCharCode(i[u+1]|i[u]<<8)}return o.join("")}function Ne(i,t){var r=parseInt(de(i,t,4),10),e=parseInt(de(i,t+4,2),10),o=parseInt(de(i,t+6,2),10),a=parseInt(de(i,t+8,2),10),u=parseInt(de(i,t+10,2),10),h=parseInt(de(i,t+12,2),10),S=parseInt(de(i,t+14,2),10);return new Date(r,e,o,a,u,h,S*100)}function tr(i,t){var r=i[t],e=i[t+1],o=i[t+2],a=i[t+3],u=i[t+4],h=i[t+5];return new Date(r,e-1,o,a,u,h)}function Ha(i,t){var r=i.slice(t),e=new Qt(r);switch(e.signatureWord()){case 17221:return new Jn(r);case 20548:return new qa(r);case 21328:return new Kn(r);case 21332:return new Qn(r);case 17746:return new $n(r);case 17747:return new Xa(r);case 20568:return new eo(r);case 20558:return new Ya(r);case 21324:return new _i(r);case 20045:return new ro(r);case 17228:return new xi(r);case 20556:return new Ga(r);case 21061:return new io(r);case 21574:return new no(r);case 21318:return new Ja(r);case 21074:return new to(r);default:return e}}function qn(i,t,r,e){r=r-4;for(var o=new Array;t<r;){var a=Ha(i,t),u=a.length();if(u===0)return o;if(t+=u,a instanceof Qn)break;a instanceof Jn?o=o.concat(a.getEntries(e)):o.push(a)}return o}var pr=function(t){this._data=t};pr.prototype.type=function(){return this._data[0]},pr.prototype.standardIdentifier=function(){return de(this._data,1,5)},pr.prototype.version=function(){return this._data[6]},pr.prototype.data=function(){return this._data.slice(7,2048)};var Xn=function(i){function t(r){i.call(this,r),this._root=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.systemIdentifier=function(){return this._getString32(8)},t.prototype.volumeIdentifier=function(){return this._getString32(40)},t.prototype.volumeSpaceSize=function(){return this._data.readUInt32LE(80)},t.prototype.volumeSetSize=function(){return this._data.readUInt16LE(120)},t.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(124)},t.prototype.logicalBlockSize=function(){return this._data.readUInt16LE(128)},t.prototype.pathTableSize=function(){return this._data.readUInt32LE(132)},t.prototype.locationOfTypeLPathTable=function(){return this._data.readUInt32LE(140)},t.prototype.locationOfOptionalTypeLPathTable=function(){return this._data.readUInt32LE(144)},t.prototype.locationOfTypeMPathTable=function(){return this._data.readUInt32BE(148)},t.prototype.locationOfOptionalTypeMPathTable=function(){return this._data.readUInt32BE(152)},t.prototype.rootDirectoryEntry=function(e){return this._root===null&&(this._root=this._constructRootDirectoryRecord(this._data.slice(156)),this._root.rootCheckForRockRidge(e)),this._root},t.prototype.volumeSetIdentifier=function(){return this._getString(190,128)},t.prototype.publisherIdentifier=function(){return this._getString(318,128)},t.prototype.dataPreparerIdentifier=function(){return this._getString(446,128)},t.prototype.applicationIdentifier=function(){return this._getString(574,128)},t.prototype.copyrightFileIdentifier=function(){return this._getString(702,38)},t.prototype.abstractFileIdentifier=function(){return this._getString(740,36)},t.prototype.bibliographicFileIdentifier=function(){return this._getString(776,37)},t.prototype.volumeCreationDate=function(){return Ne(this._data,813)},t.prototype.volumeModificationDate=function(){return Ne(this._data,830)},t.prototype.volumeExpirationDate=function(){return Ne(this._data,847)},t.prototype.volumeEffectiveDate=function(){return Ne(this._data,864)},t.prototype.fileStructureVersion=function(){return this._data[881]},t.prototype.applicationUsed=function(){return this._data.slice(883,883+512)},t.prototype.reserved=function(){return this._data.slice(1395,1395+653)},t.prototype._getString32=function(e){return this._getString(e,32)},t}(pr),Va=function(i){function t(r){if(i.call(this,r),this.type()!==1)throw new p(c.EIO,"Invalid primary volume descriptor.")}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"ISO9660"},t.prototype._constructRootDirectoryRecord=function(e){return new Yn(e,-1)},t.prototype._getString=function(e,o){return this._getString(e,o)},t}(Xn),Za=function(i){function t(r){if(i.call(this,r),this.type()!==2)throw new p(c.EIO,"Invalid supplementary volume descriptor.");var e=this.escapeSequence(),o=e[2];if(e[0]!==37||e[1]!==47||o!==64&&o!==67&&o!==69)throw new p(c.EIO,"Unrecognized escape sequence for SupplementaryVolumeDescriptor: "+e.toString())}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.name=function(){return"Joliet"},t.prototype.escapeSequence=function(){return this._data.slice(88,120)},t.prototype._constructRootDirectoryRecord=function(e){return new Gn(e,-1)},t.prototype._getString=function(e,o){return Ei(this._data,e,o)},t}(Xn),zt=function(t,r){this._suEntries=null,this._fileOrDir=null,this._data=t,this._rockRidgeOffset=r};zt.prototype.hasRockRidge=function(){return this._rockRidgeOffset>-1},zt.prototype.getRockRidgeOffset=function(){return this._rockRidgeOffset},zt.prototype.rootCheckForRockRidge=function(t){var r=this.getDirectory(t);this._rockRidgeOffset=r.getDotEntry(t)._getRockRidgeOffset(t),this._rockRidgeOffset>-1&&(this._fileOrDir=null)},zt.prototype.length=function(){return this._data[0]},zt.prototype.extendedAttributeRecordLength=function(){return this._data[1]},zt.prototype.lba=function(){return this._data.readUInt32LE(2)*2048},zt.prototype.dataLength=function(){return this._data.readUInt32LE(10)},zt.prototype.recordingDate=function(){return tr(this._data,18)},zt.prototype.fileFlags=function(){return this._data[25]},zt.prototype.fileUnitSize=function(){return this._data[26]},zt.prototype.interleaveGapSize=function(){return this._data[27]},zt.prototype.volumeSequenceNumber=function(){return this._data.readUInt16LE(28)},zt.prototype.identifier=function(){return this._getString(33,this._data[32])},zt.prototype.fileName=function(t){if(this.hasRockRidge()){var r=this._rockRidgeFilename(t);if(r!==null)return r}var e=this.identifier();if(this.isDirectory(t))return e;var o=e.indexOf(";");return o===-1?e:e[o-1]==="."?e.slice(0,o-1):e.slice(0,o)},zt.prototype.isDirectory=function(t){var r=!!(this.fileFlags()&2);return!r&&this.hasRockRidge()&&(r=this.getSUEntries(t).filter(function(e){return e instanceof xi}).length>0),r},zt.prototype.isSymlink=function(t){return this.hasRockRidge()&&this.getSUEntries(t).filter(function(r){return r instanceof _i}).length>0},zt.prototype.getSymlinkPath=function(t){for(var r="",e=this.getSUEntries(t),o=this._getGetString(),a=0,u=e;a<u.length;a+=1){var h=u[a];if(h instanceof _i){for(var S=h.componentRecords(),x=0,O=S;x<O.length;x+=1){var D=O[x],V=D.flags();V&2?r+="./":V&4?r+="../":V&8?r+="/":(r+=D.content(o),V&1||(r+="/"))}if(!h.continueFlag())break}}return r.length>1&&r[r.length-1]==="/"?r.slice(0,r.length-1):r},zt.prototype.getFile=function(t){if(this.isDirectory(t))throw new Error("Tried to get a File from a directory.");return this._fileOrDir===null&&(this._fileOrDir=t.slice(this.lba(),this.lba()+this.dataLength())),this._fileOrDir},zt.prototype.getDirectory=function(t){if(!this.isDirectory(t))throw new Error("Tried to get a Directory from a file.");return this._fileOrDir===null&&(this._fileOrDir=this._constructDirectory(t)),this._fileOrDir},zt.prototype.getSUEntries=function(t){return this._suEntries||this._constructSUEntries(t),this._suEntries},zt.prototype._rockRidgeFilename=function(t){var r=this.getSUEntries(t).filter(function(S){return S instanceof ro});if(r.length===0||r[0].flags()&6)return null;for(var e="",o=this._getGetString(),a=0,u=r;a<u.length;a+=1){var h=u[a];if(e+=h.name(o),!(h.flags()&1))break}return e},zt.prototype._constructSUEntries=function(t){var r=33+this._data[32];r%2===1&&r++,r+=this._rockRidgeOffset,this._suEntries=qn(this._data,r,this.length(),t)},zt.prototype._getRockRidgeOffset=function(t){this._rockRidgeOffset=0;var r=this.getSUEntries(t);if(r.length>0){var e=r[0];if(e instanceof Kn&&e.checkBytesPass())for(var o=1;o<r.length;o++){var a=r[o];if(a instanceof to||a instanceof $n&&a.extensionIdentifier()===Wa)return e.bytesSkipped()}}return this._rockRidgeOffset=-1,-1};var Yn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,o){return de(this._data,e,o)},t.prototype._constructDirectory=function(e){return new Ka(this,e)},t.prototype._getGetString=function(){return de},t}(zt),Gn=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._getString=function(e,o){return Ei(this._data,e,o)},t.prototype._constructDirectory=function(e){return new Qa(this,e)},t.prototype._getGetString=function(){return Ei},t}(zt),Qt=function(t){this._data=t};Qt.prototype.signatureWord=function(){return this._data.readUInt16BE(0)},Qt.prototype.signatureWordString=function(){return de(this._data,0,2)},Qt.prototype.length=function(){return this._data[2]},Qt.prototype.suVersion=function(){return this._data[3]};var Jn=function(i){function t(r){i.call(this,r),this._entries=null}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.continuationLba=function(){return this._data.readUInt32LE(4)},t.prototype.continuationLbaOffset=function(){return this._data.readUInt32LE(12)},t.prototype.continuationLength=function(){return this._data.readUInt32LE(20)},t.prototype.getEntries=function(e){if(!this._entries){var o=this.continuationLba()*2048+this.continuationLbaOffset();this._entries=qn(e,o,this.continuationLength(),e)}return this._entries},t}(Qt),qa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),Kn=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.checkBytesPass=function(){return this._data[4]===190&&this._data[5]===239},t.prototype.bytesSkipped=function(){return this._data[6]},t}(Qt),Qn=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),$n=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.identifierLength=function(){return this._data[4]},t.prototype.descriptorLength=function(){return this._data[5]},t.prototype.sourceLength=function(){return this._data[6]},t.prototype.extensionVersion=function(){return this._data[7]},t.prototype.extensionIdentifier=function(){return de(this._data,8,this.identifierLength())},t.prototype.extensionDescriptor=function(){return de(this._data,8+this.identifierLength(),this.descriptorLength())},t.prototype.extensionSource=function(){return de(this._data,8+this.identifierLength()+this.descriptorLength(),this.sourceLength())},t}(Qt),Xa=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.extensionSequence=function(){return this._data[4]},t}(Qt),to=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),eo=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.mode=function(){return this._data.readUInt32LE(4)},t.prototype.fileLinks=function(){return this._data.readUInt32LE(12)},t.prototype.uid=function(){return this._data.readUInt32LE(20)},t.prototype.gid=function(){return this._data.readUInt32LE(28)},t.prototype.inode=function(){return this._data.readUInt32LE(36)},t}(Qt),Ya=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.devTHigh=function(){return this._data.readUInt32LE(4)},t.prototype.devTLow=function(){return this._data.readUInt32LE(12)},t}(Qt),_i=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.continueFlag=function(){return this.flags()&1},t.prototype.componentRecords=function(){for(var e=this,o=new Array,a=5;a<this.length();){var u=new Ar(e._data.slice(a));o.push(u),a+=u.length()}return o},t}(Qt),Ar=function(t){this._data=t};Ar.prototype.flags=function(){return this._data[0]},Ar.prototype.length=function(){return 2+this.componentLength()},Ar.prototype.componentLength=function(){return this._data[1]},Ar.prototype.content=function(t){return t(this._data,2,this.componentLength())};var ro=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.name=function(e){return e(this._data,5,this.length()-5)},t}(Qt),xi=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.childDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),Ga=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.parentDirectoryLba=function(){return this._data.readUInt32LE(4)},t}(Qt),io=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t}(Qt),no=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.flags=function(){return this._data[4]},t.prototype.creation=function(){return this.flags()&1?this._longFormDates()?Ne(this._data,5):tr(this._data,5):null},t.prototype.modify=function(){if(this.flags()&2){var e=this.flags()&1?1:0;return this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.access=function(){if(this.flags()&4){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.backup=function(){if(this.flags()&16){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.expiration=function(){if(this.flags()&32){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype.effective=function(){if(this.flags()&64){var e=this.flags()&1?1:0;return e+=this.flags()&2?1:0,e+=this.flags()&4?1:0,e+=this.flags()&16?1:0,e+=this.flags()&32?1:0,this._longFormDates?Ne(this._data,5+e*17):tr(this._data,5+e*7)}else return null},t.prototype._longFormDates=function(){return!!this.flags()},t}(Qt),Ja=function(i){function t(r){i.call(this,r)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype.virtualSizeHigh=function(){return this._data.readUInt32LE(4)},t.prototype.virtualSizeLow=function(){return this._data.readUInt32LE(12)},t.prototype.tableDepth=function(){return this._data[20]},t}(Qt),Lr=function(t,r){var e=this;this._fileList=[],this._fileMap={},this._record=t;var o=t.lba(),a=o+t.dataLength();if(!(t.fileFlags()&2)){var u=t.getSUEntries(r).filter(function(O){return O instanceof xi})[0];o=u.childDirectoryLba()*2048,a=1/0}for(;o<a;){var h=r[o];if(h===0){o++;continue}var S=e._constructDirectoryRecord(r.slice(o)),x=S.fileName(r);x!=="\0"&&x!==""?(!S.hasRockRidge()||S.getSUEntries(r).filter(function(O){return O instanceof io}).length===0)&&(e._fileMap[x]=S,e._fileList.push(x)):a===1/0&&(a=o+S.dataLength()),o+=S.length()}};Lr.prototype.getRecord=function(t){return this._fileMap[t]},Lr.prototype.getFileList=function(){return this._fileList},Lr.prototype.getDotEntry=function(t){return this._constructDirectoryRecord(t.slice(this._record.lba()))};var Ka=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Yn(e,this._record.getRockRidgeOffset())},t}(Lr),Qa=function(i){function t(r,e){i.call(this,r,e)}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.prototype._constructDirectoryRecord=function(e){return new Gn(e,this._record.getRockRidgeOffset())},t}(Lr),ti=function(i){function t(r,e,o){var a=this;e===void 0&&(e=""),o===void 0&&(o=!0),i.call(this),this._data=r,kt(o,t.Name,{data:"ISO data as a Buffer",name:e});for(var u=!1,h=16*2048,S=new Array;!u;){var x=r.slice(h),O=new pr(x);switch(O.type()){case 1:S.push(new Va(x));break;case 2:S.push(new Za(x));break;case 255:u=!0;break}h+=2048}if(S.length===0)throw new p(c.EIO,"Unable to find a suitable volume descriptor.");S.forEach(function(D){(!a._pvd||a._pvd.type()!==2)&&(a._pvd=D)}),this._root=this._pvd.rootDirectoryEntry(r),this._name=e}return i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t,t.Create=function(e,o){var a,u;try{a=new t(e.data,e.name,!1)}catch(h){h=h}finally{o(u,a)}},t.isAvailable=function(){return!0},t.prototype.getName=function(){var e="IsoFS"+this._name+(this._pvd?"-"+this._pvd.name():"");return this._root&&this._root.hasRockRidge()&&(e+="-RockRidge"),e},t.prototype.diskSpace=function(e,o){o(this._data.length,0)},t.prototype.isReadOnly=function(){return!0},t.prototype.supportsLinks=function(){return!1},t.prototype.supportsProps=function(){return!1},t.prototype.supportsSynch=function(){return!0},t.prototype.statSync=function(e,o){var a=this._getDirectoryRecord(e);if(a===null)throw p.ENOENT(e);return this._getStats(e,a)},t.prototype.openSync=function(e,o,a){if(o.isWriteable())throw new p(c.EPERM,e);var u=this._getDirectoryRecord(e);if(u){if(u.isSymlink(this._data))return this.openSync(w.resolve(e,u.getSymlinkPath(this._data)),o,a);if(u.isDirectory(this._data))throw p.EISDIR(e);var h=u.getFile(this._data),S=this._getStats(e,u);switch(o.pathExistsAction()){case A.THROW_EXCEPTION:case A.TRUNCATE_FILE:throw p.EEXIST(e);case A.NOP:return new ue(this,e,o,S,h);default:throw new p(c.EINVAL,"Invalid FileMode object.")}}else throw p.ENOENT(e)},t.prototype.readdirSync=function(e){var o=this._getDirectoryRecord(e);if(o){if(o.isDirectory(this._data))return o.getDirectory(this._data).getFileList().slice(0);throw p.ENOTDIR(e)}else throw p.ENOENT(e)},t.prototype.readFileSync=function(e,o,a){var u=this.openSync(e,a,420);try{var h=u,S=h.getBuffer();return o===null?Nt(S):S.toString(o)}finally{u.closeSync()}},t.prototype._getDirectoryRecord=function(e){var o=this;if(e==="/")return this._root;for(var a=e.split("/").slice(1),u=this._root,h=0,S=a;h<S.length;h+=1){var x=S[h];if(u.isDirectory(o._data)){if(u=u.getDirectory(o._data).getRecord(x),!u)return null}else return null}return u},t.prototype._getStats=function(e,o){if(o.isSymlink(this._data)){var a=w.resolve(e,o.getSymlinkPath(this._data)),u=this._getDirectoryRecord(a);return u?this._getStats(a,u):null}else{var h=o.dataLength(),S=365,x=o.recordingDate(),O=x,D=x,V=x;if(o.hasRockRidge())for(var $=o.getSUEntries(this._data),rt=0,ft=$;rt<ft.length;rt+=1){var yt=ft[rt];if(yt instanceof eo)S=yt.mode();else if(yt instanceof no){var Ft=yt.flags();Ft&4&&(O=yt.access()),Ft&2&&(D=yt.modify()),Ft&1&&(V=yt.creation())}}return S=S&365,new C(o.isDirectory(this._data)?L.DIRECTORY:L.FILE,h,S,O,D,V)}},t}(_t);ti.Name="IsoFS",ti.Options={data:{type:"object",description:"The ISO file in a buffer",validator:te}},[I,Wr,Hr,ar,Zr,ur,Fr,ti,br,fr,Tr,Kr,Qr,$e].forEach(function(i){var t=i.Create;i.Create=function(r,e){var o=typeof r=="function",a=o?r:e,u=o?{}:r;function h(S){S?a(S):t.call(i,u,a)}R(i,u,h)}});var ei={AsyncMirror:I,Dropbox:Wr,Emscripten:Hr,FolderAdapter:ar,HTML5FS:Zr,InMemory:ur,IndexedDB:Fr,IsoFS:ti,LocalStorage:br,MountableFileSystem:fr,OverlayFS:Tr,WorkerFS:Kr,XmlHttpRequest:Qr,ZipFS:$e};m.initializeTTYs&&m.initializeTTYs();function $a(i){i.Buffer=f,i.process=m;var t=i.require?i.require:null;i.require=function(r){var e=oo(r);return e||t.apply(null,Array.prototype.slice.call(arguments,0))}}function tu(i,t){ei[i]=t}function oo(i){switch(i){case"fs":return ct;case"path":return w;case"buffer":return E;case"process":return m;case"bfs_utils":return N;default:return ei[i]}}function so(i){return ct.initialize(i)}function eu(i,t){Fi(i,function(r,e){e?(so(e),t()):t(r)})}function Fi(i,t){var r=i.fs;if(!r)return t(new p(c.EPERM,'Missing "fs" property on configuration object.'));var e=i.options,o=0,a=!1;function u(){if(!a){a=!0;var x=ei[r];x?x.Create(e,t):t(new p(c.EPERM,"File system "+r+" is not available in BrowserFS."))}}if(e!==null&&typeof e=="object"){var h=!1,S=Object.keys(e).filter(function(x){return x!=="fs"});S.forEach(function(x){var O=e[x];O!==null&&typeof O=="object"&&O.fs&&(o++,Fi(O,function(D,V){if(o--,D){if(a)return;a=!0,t(D)}else e[x]=V,o===0&&h&&u()}))}),h=!0}o===0&&u()}"ab".substr(-1)!=="b"&&(String.prototype.substr=function(i){return function(t,r){return t<0&&(t=this.length+t),i.call(this,t,r)}}(String.prototype.substr)),typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&(Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(i,t){i===void 0&&(i=0),t===void 0&&(t=this.length);var r=this;return i<0&&(i=this.length+i,i<0&&(i=0)),t<0&&(t=this.length+t,t<0&&(t=0)),t<i&&(t=i),new Uint8Array(r.buffer,r.byteOffset+i,t-i)})),n.install=$a,n.registerFileSystem=tu,n.BFSRequire=oo,n.initialize=so,n.configure=eu,n.getFileSystem=Fi,n.EmscriptenFS=ht,n.FileSystem=ei,n.Errors=T,n.setImmediate=mi}).call(n,s(1),function(){return this}(),s(5)(l),s(6))},function(l,n,s){l.exports=s(2).Buffer},function(l,n,s){(function(c){"use strict";var y=s(3),d=s(4);n.Buffer=c,n.SlowBuffer=U,n.INSPECT_MAX_BYTES=50;var m=2147483647;n.kMaxLength=m,c.TYPED_ARRAY_SUPPORT=E(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function E(){try{var I=new Uint8Array(1);return I.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},I.foo()===42}catch{return!1}}function w(I){if(I>m)throw new RangeError("Invalid typed array length");var g=new Uint8Array(I);return g.__proto__=c.prototype,g}function c(I,g,v){if(typeof I=="number"){if(typeof g=="string")throw new Error("If encoding is specified then the first argument must be a string");return A(I)}return _(I,g,v)}typeof Symbol<"u"&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192;function _(I,g,v){if(typeof I=="number")throw new TypeError('"value" argument must not be a number');return Yt(I)?C(I,g,v):typeof I=="string"?b(I,g):G(I)}c.from=function(I,g,v){return _(I,g,v)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array;function p(I){if(typeof I!="number")throw new TypeError('"size" argument must be a number');if(I<0)throw new RangeError('"size" argument must not be negative')}function T(I,g,v){return p(I),I<=0?w(I):g!==void 0?typeof v=="string"?w(I).fill(g,v):w(I).fill(g):w(I)}c.alloc=function(I,g,v){return T(I,g,v)};function A(I){return p(I),w(I<0?0:W(I)|0)}c.allocUnsafe=function(I){return A(I)},c.allocUnsafeSlow=function(I){return A(I)};function b(I,g){if((typeof g!="string"||g==="")&&(g="utf8"),!c.isEncoding(g))throw new TypeError('"encoding" must be a valid string encoding');var v=Et(I,g)|0,k=w(v),B=k.write(I,g);return B!==v&&(k=k.slice(0,B)),k}function L(I){for(var g=I.length<0?0:W(I.length)|0,v=w(g),k=0;k<g;k+=1)v[k]=I[k]&255;return v}function C(I,g,v){if(g<0||I.byteLength<g)throw new RangeError("'offset' is out of bounds");if(I.byteLength<g+(v||0))throw new RangeError("'length' is out of bounds");var k;return g===void 0&&v===void 0?k=new Uint8Array(I):v===void 0?k=new Uint8Array(I,g):k=new Uint8Array(I,g,v),k.__proto__=c.prototype,k}function G(I){if(c.isBuffer(I)){var g=W(I.length)|0,v=w(g);return v.length===0||I.copy(v,0,0,g),v}if(I){if(ue(I)||"length"in I)return typeof I.length!="number"||Fe(I.length)?w(0):L(I);if(I.type==="Buffer"&&Array.isArray(I.data))return L(I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function W(I){if(I>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return I|0}function U(I){return+I!=I&&(I=0),c.alloc(+I)}c.isBuffer=function(g){return g!=null&&g._isBuffer===!0},c.compare=function(g,v){if(!c.isBuffer(g)||!c.isBuffer(v))throw new TypeError("Arguments must be Buffers");if(g===v)return 0;for(var k=g.length,B=v.length,Z=0,J=Math.min(k,B);Z<J;++Z)if(g[Z]!==v[Z]){k=g[Z],B=v[Z];break}return k<B?-1:B<k?1:0},c.isEncoding=function(g){switch(String(g).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(g,v){if(!Array.isArray(g))throw new TypeError('"list" argument must be an Array of Buffers');if(g.length===0)return c.alloc(0);var k;if(v===void 0)for(v=0,k=0;k<g.length;++k)v+=g[k].length;var B=c.allocUnsafe(v),Z=0;for(k=0;k<g.length;++k){var J=g[k];if(!c.isBuffer(J))throw new TypeError('"list" argument must be an Array of Buffers');J.copy(B,Z),Z+=J.length}return B};function Et(I,g){if(c.isBuffer(I))return I.length;if(ue(I)||Yt(I))return I.byteLength;typeof I!="string"&&(I=""+I);var v=I.length;if(v===0)return 0;for(var k=!1;;)switch(g){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":case void 0:return Q(I).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return _t(I).length;default:if(k)return Q(I).length;g=(""+g).toLowerCase(),k=!0}}c.byteLength=Et;function et(I,g,v){var k=!1;if((g===void 0||g<0)&&(g=0),g>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,g>>>=0,v<=g))return"";for(I||(I="utf8");;)switch(I){case"hex":return It(this,g,v);case"utf8":case"utf-8":return Xt(this,g,v);case"ascii":return K(this,g,v);case"latin1":case"binary":return ut(this,g,v);case"base64":return St(this,g,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vt(this,g,v);default:if(k)throw new TypeError("Unknown encoding: "+I);I=(I+"").toLowerCase(),k=!0}}c.prototype._isBuffer=!0;function wt(I,g,v){var k=I[g];I[g]=I[v],I[v]=k}c.prototype.swap16=function(){var g=this.length;if(g%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var v=0;v<g;v+=2)wt(this,v,v+1);return this},c.prototype.swap32=function(){var g=this.length;if(g%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var v=0;v<g;v+=4)wt(this,v,v+3),wt(this,v+1,v+2);return this},c.prototype.swap64=function(){var g=this.length;if(g%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var v=0;v<g;v+=8)wt(this,v,v+7),wt(this,v+1,v+6),wt(this,v+2,v+5),wt(this,v+3,v+4);return this},c.prototype.toString=function(){var g=this.length;return g===0?"":arguments.length===0?Xt(this,0,g):et.apply(this,arguments)},c.prototype.equals=function(g){if(!c.isBuffer(g))throw new TypeError("Argument must be a Buffer");return this===g?!0:c.compare(this,g)===0},c.prototype.inspect=function(){var g="",v=n.INSPECT_MAX_BYTES;return this.length>0&&(g=this.toString("hex",0,v).match(/.{2}/g).join(" "),this.length>v&&(g+=" ... ")),"<Buffer "+g+">"},c.prototype.compare=function(g,v,k,B,Z){if(!c.isBuffer(g))throw new TypeError("Argument must be a Buffer");if(v===void 0&&(v=0),k===void 0&&(k=g?g.length:0),B===void 0&&(B=0),Z===void 0&&(Z=this.length),v<0||k>g.length||B<0||Z>this.length)throw new RangeError("out of range index");if(B>=Z&&v>=k)return 0;if(B>=Z)return-1;if(v>=k)return 1;if(v>>>=0,k>>>=0,B>>>=0,Z>>>=0,this===g)return 0;for(var J=Z-B,bt=k-v,At=Math.min(J,bt),Bt=this.slice(B,Z),Gt=g.slice(v,k),Dt=0;Dt<At;++Dt)if(Bt[Dt]!==Gt[Dt]){J=Bt[Dt],bt=Gt[Dt];break}return J<bt?-1:bt<J?1:0};function pt(I,g,v,k,B){if(I.length===0)return-1;if(typeof v=="string"?(k=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,Fe(v)&&(v=B?0:I.length-1),v<0&&(v=I.length+v),v>=I.length){if(B)return-1;v=I.length-1}else if(v<0)if(B)v=0;else return-1;if(typeof g=="string"&&(g=c.from(g,k)),c.isBuffer(g))return g.length===0?-1:M(I,g,v,k,B);if(typeof g=="number")return g=g&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(I,g,v):Uint8Array.prototype.lastIndexOf.call(I,g,v):M(I,[g],v,k,B);throw new TypeError("val must be string, number or Buffer")}function M(I,g,v,k,B){var Z=1,J=I.length,bt=g.length;if(k!==void 0&&(k=String(k).toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(I.length<2||g.length<2)return-1;Z=2,J/=2,bt/=2,v/=2}function At(nr,Ve){return Z===1?nr[Ve]:nr.readUInt16BE(Ve*Z)}var Bt;if(B){var Gt=-1;for(Bt=v;Bt<J;Bt++)if(At(I,Bt)===At(g,Gt===-1?0:Bt-Gt)){if(Gt===-1&&(Gt=Bt),Bt-Gt+1===bt)return Gt*Z}else Gt!==-1&&(Bt-=Bt-Gt),Gt=-1}else for(v+bt>J&&(v=J-bt),Bt=v;Bt>=0;Bt--){for(var Dt=!0,Ie=0;Ie<bt;Ie++)if(At(I,Bt+Ie)!==At(g,Ie)){Dt=!1;break}if(Dt)return Bt}return-1}c.prototype.includes=function(g,v,k){return this.indexOf(g,v,k)!==-1},c.prototype.indexOf=function(g,v,k){return pt(this,g,v,k,!0)},c.prototype.lastIndexOf=function(g,v,k){return pt(this,g,v,k,!1)};function tt(I,g,v,k){v=Number(v)||0;var B=I.length-v;k?(k=Number(k),k>B&&(k=B)):k=B;var Z=g.length;if(Z%2!==0)throw new TypeError("Invalid hex string");k>Z/2&&(k=Z/2);for(var J=0;J<k;++J){var bt=parseInt(g.substr(J*2,2),16);if(Fe(bt))return J;I[v+J]=bt}return J}function ct(I,g,v,k){return gt(Q(g,I.length-v),I,v,k)}function Rt(I,g,v,k){return gt(ht(g),I,v,k)}function dt(I,g,v,k){return Rt(I,g,v,k)}function Lt(I,g,v,k){return gt(_t(g),I,v,k)}function kt(I,g,v,k){return gt(it(g,I.length-v),I,v,k)}c.prototype.write=function(g,v,k,B){if(v===void 0)B="utf8",k=this.length,v=0;else if(k===void 0&&typeof v=="string")B=v,k=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(k)?(k=k>>>0,B===void 0&&(B="utf8")):(B=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Z=this.length-v;if((k===void 0||k>Z)&&(k=Z),g.length>0&&(k<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");for(var J=!1;;)switch(B){case"hex":return tt(this,g,v,k);case"utf8":case"utf-8":return ct(this,g,v,k);case"ascii":return Rt(this,g,v,k);case"latin1":case"binary":return dt(this,g,v,k);case"base64":return Lt(this,g,v,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return kt(this,g,v,k);default:if(J)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),J=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function St(I,g,v){return g===0&&v===I.length?y.fromByteArray(I):y.fromByteArray(I.slice(g,v))}function Xt(I,g,v){v=Math.min(I.length,v);for(var k=[],B=g;B<v;){var Z=I[B],J=null,bt=Z>239?4:Z>223?3:Z>191?2:1;if(B+bt<=v){var At,Bt,Gt,Dt;switch(bt){case 1:Z<128&&(J=Z);break;case 2:At=I[B+1],(At&192)===128&&(Dt=(Z&31)<<6|At&63,Dt>127&&(J=Dt));break;case 3:At=I[B+1],Bt=I[B+2],(At&192)===128&&(Bt&192)===128&&(Dt=(Z&15)<<12|(At&63)<<6|Bt&63,Dt>2047&&(Dt<55296||Dt>57343)&&(J=Dt));break;case 4:At=I[B+1],Bt=I[B+2],Gt=I[B+3],(At&192)===128&&(Bt&192)===128&&(Gt&192)===128&&(Dt=(Z&15)<<18|(At&63)<<12|(Bt&63)<<6|Gt&63,Dt>65535&&Dt<1114112&&(J=Dt))}}J===null?(J=65533,bt=1):J>65535&&(J-=65536,k.push(J>>>10&1023|55296),J=56320|J&1023),k.push(J),B+=bt}return z(k)}var P=4096;function z(I){var g=I.length;if(g<=P)return String.fromCharCode.apply(String,I);for(var v="",k=0;k<g;)v+=String.fromCharCode.apply(String,I.slice(k,k+=P));return v}function K(I,g,v){var k="";v=Math.min(I.length,v);for(var B=g;B<v;++B)k+=String.fromCharCode(I[B]&127);return k}function ut(I,g,v){var k="";v=Math.min(I.length,v);for(var B=g;B<v;++B)k+=String.fromCharCode(I[B]);return k}function It(I,g,v){var k=I.length;(!g||g<0)&&(g=0),(!v||v<0||v>k)&&(v=k);for(var B="",Z=g;Z<v;++Z)B+=Y(I[Z]);return B}function vt(I,g,v){for(var k=I.slice(g,v),B="",Z=0;Z<k.length;Z+=2)B+=String.fromCharCode(k[Z]+k[Z+1]*256);return B}c.prototype.slice=function(g,v){var k=this.length;g=~~g,v=v===void 0?k:~~v,g<0?(g+=k,g<0&&(g=0)):g>k&&(g=k),v<0?(v+=k,v<0&&(v=0)):v>k&&(v=k),v<g&&(v=g);var B=this.subarray(g,v);return B.__proto__=c.prototype,B};function xt(I,g,v){if(I%1!==0||I<0)throw new RangeError("offset is not uint");if(I+g>v)throw new RangeError("Trying to access beyond buffer length")}c.prototype.readUIntLE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g],Z=1,J=0;++J<v&&(Z*=256);)B+=this[g+J]*Z;return B},c.prototype.readUIntBE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g+--v],Z=1;v>0&&(Z*=256);)B+=this[g+--v]*Z;return B},c.prototype.readUInt8=function(g,v){return g=g>>>0,v||xt(g,1,this.length),this[g]},c.prototype.readUInt16LE=function(g,v){return g=g>>>0,v||xt(g,2,this.length),this[g]|this[g+1]<<8},c.prototype.readUInt16BE=function(g,v){return g=g>>>0,v||xt(g,2,this.length),this[g]<<8|this[g+1]},c.prototype.readUInt32LE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),(this[g]|this[g+1]<<8|this[g+2]<<16)+this[g+3]*16777216},c.prototype.readUInt32BE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]*16777216+(this[g+1]<<16|this[g+2]<<8|this[g+3])},c.prototype.readIntLE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=this[g],Z=1,J=0;++J<v&&(Z*=256);)B+=this[g+J]*Z;return Z*=128,B>=Z&&(B-=Math.pow(2,8*v)),B},c.prototype.readIntBE=function(g,v,k){g=g>>>0,v=v>>>0,k||xt(g,v,this.length);for(var B=v,Z=1,J=this[g+--B];B>0&&(Z*=256);)J+=this[g+--B]*Z;return Z*=128,J>=Z&&(J-=Math.pow(2,8*v)),J},c.prototype.readInt8=function(g,v){return g=g>>>0,v||xt(g,1,this.length),this[g]&128?(255-this[g]+1)*-1:this[g]},c.prototype.readInt16LE=function(g,v){g=g>>>0,v||xt(g,2,this.length);var k=this[g]|this[g+1]<<8;return k&32768?k|4294901760:k},c.prototype.readInt16BE=function(g,v){g=g>>>0,v||xt(g,2,this.length);var k=this[g+1]|this[g]<<8;return k&32768?k|4294901760:k},c.prototype.readInt32LE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]|this[g+1]<<8|this[g+2]<<16|this[g+3]<<24},c.prototype.readInt32BE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),this[g]<<24|this[g+1]<<16|this[g+2]<<8|this[g+3]},c.prototype.readFloatLE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),d.read(this,g,!0,23,4)},c.prototype.readFloatBE=function(g,v){return g=g>>>0,v||xt(g,4,this.length),d.read(this,g,!1,23,4)},c.prototype.readDoubleLE=function(g,v){return g=g>>>0,v||xt(g,8,this.length),d.read(this,g,!0,52,8)},c.prototype.readDoubleBE=function(g,v){return g=g>>>0,v||xt(g,8,this.length),d.read(this,g,!1,52,8)};function Nt(I,g,v,k,B,Z){if(!c.isBuffer(I))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>B||g<Z)throw new RangeError('"value" argument is out of bounds');if(v+k>I.length)throw new RangeError("Index out of range")}c.prototype.writeUIntLE=function(g,v,k,B){if(g=+g,v=v>>>0,k=k>>>0,!B){var Z=Math.pow(2,8*k)-1;Nt(this,g,v,k,Z,0)}var J=1,bt=0;for(this[v]=g&255;++bt<k&&(J*=256);)this[v+bt]=g/J&255;return v+k},c.prototype.writeUIntBE=function(g,v,k,B){if(g=+g,v=v>>>0,k=k>>>0,!B){var Z=Math.pow(2,8*k)-1;Nt(this,g,v,k,Z,0)}var J=k-1,bt=1;for(this[v+J]=g&255;--J>=0&&(bt*=256);)this[v+J]=g/bt&255;return v+k},c.prototype.writeUInt8=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,1,255,0),this[v]=g&255,v+1},c.prototype.writeUInt16LE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,2,65535,0),this[v]=g&255,this[v+1]=g>>>8,v+2},c.prototype.writeUInt16BE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,2,65535,0),this[v]=g>>>8,this[v+1]=g&255,v+2},c.prototype.writeUInt32LE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,4,4294967295,0),this[v+3]=g>>>24,this[v+2]=g>>>16,this[v+1]=g>>>8,this[v]=g&255,v+4},c.prototype.writeUInt32BE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,4,4294967295,0),this[v]=g>>>24,this[v+1]=g>>>16,this[v+2]=g>>>8,this[v+3]=g&255,v+4},c.prototype.writeIntLE=function(g,v,k,B){if(g=+g,v=v>>>0,!B){var Z=Math.pow(2,8*k-1);Nt(this,g,v,k,Z-1,-Z)}var J=0,bt=1,At=0;for(this[v]=g&255;++J<k&&(bt*=256);)g<0&&At===0&&this[v+J-1]!==0&&(At=1),this[v+J]=(g/bt>>0)-At&255;return v+k},c.prototype.writeIntBE=function(g,v,k,B){if(g=+g,v=v>>>0,!B){var Z=Math.pow(2,8*k-1);Nt(this,g,v,k,Z-1,-Z)}var J=k-1,bt=1,At=0;for(this[v+J]=g&255;--J>=0&&(bt*=256);)g<0&&At===0&&this[v+J+1]!==0&&(At=1),this[v+J]=(g/bt>>0)-At&255;return v+k},c.prototype.writeInt8=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,1,127,-128),g<0&&(g=255+g+1),this[v]=g&255,v+1},c.prototype.writeInt16LE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,2,32767,-32768),this[v]=g&255,this[v+1]=g>>>8,v+2},c.prototype.writeInt16BE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,2,32767,-32768),this[v]=g>>>8,this[v+1]=g&255,v+2},c.prototype.writeInt32LE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,4,2147483647,-2147483648),this[v]=g&255,this[v+1]=g>>>8,this[v+2]=g>>>16,this[v+3]=g>>>24,v+4},c.prototype.writeInt32BE=function(g,v,k){return g=+g,v=v>>>0,k||Nt(this,g,v,4,2147483647,-2147483648),g<0&&(g=4294967295+g+1),this[v]=g>>>24,this[v+1]=g>>>16,this[v+2]=g>>>8,this[v+3]=g&255,v+4};function jt(I,g,v,k,B,Z){if(v+k>I.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function Ct(I,g,v,k,B){return g=+g,v=v>>>0,B||jt(I,g,v,4,34028234663852886e22,-34028234663852886e22),d.write(I,g,v,k,23,4),v+4}c.prototype.writeFloatLE=function(g,v,k){return Ct(this,g,v,!0,k)},c.prototype.writeFloatBE=function(g,v,k){return Ct(this,g,v,!1,k)};function te(I,g,v,k,B){return g=+g,v=v>>>0,B||jt(I,g,v,8,17976931348623157e292,-17976931348623157e292),d.write(I,g,v,k,52,8),v+8}c.prototype.writeDoubleLE=function(g,v,k){return te(this,g,v,!0,k)},c.prototype.writeDoubleBE=function(g,v,k){return te(this,g,v,!1,k)},c.prototype.copy=function(g,v,k,B){if(k||(k=0),!B&&B!==0&&(B=this.length),v>=g.length&&(v=g.length),v||(v=0),B>0&&B<k&&(B=k),B===k||g.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("sourceStart out of bounds");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),g.length-v<B-k&&(B=g.length-v+k);var Z=B-k,J;if(this===g&&k<v&&v<B)for(J=Z-1;J>=0;--J)g[J+v]=this[J+k];else if(Z<1e3)for(J=0;J<Z;++J)g[J+v]=this[J+k];else Uint8Array.prototype.set.call(g,this.subarray(k,k+Z),v);return Z},c.prototype.fill=function(g,v,k,B){if(typeof g=="string"){if(typeof v=="string"?(B=v,v=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),g.length===1){var Z=g.charCodeAt(0);Z<256&&(g=Z)}if(B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!c.isEncoding(B))throw new TypeError("Unknown encoding: "+B)}else typeof g=="number"&&(g=g&255);if(v<0||this.length<v||this.length<k)throw new RangeError("Out of range index");if(k<=v)return this;v=v>>>0,k=k===void 0?this.length:k>>>0,g||(g=0);var J;if(typeof g=="number")for(J=v;J<k;++J)this[J]=g;else{var bt=c.isBuffer(g)?g:new c(g,B),At=bt.length;for(J=0;J<k-v;++J)this[J+v]=bt[J%At]}return this};var R=/[^+/0-9A-Za-z-_]/g;function N(I){if(I=I.trim().replace(R,""),I.length<2)return"";for(;I.length%4!==0;)I=I+"=";return I}function Y(I){return I<16?"0"+I.toString(16):I.toString(16)}function Q(I,g){g=g||1/0;for(var v,k=I.length,B=null,Z=[],J=0;J<k;++J){if(v=I.charCodeAt(J),v>55295&&v<57344){if(!B){if(v>56319){(g-=3)>-1&&Z.push(239,191,189);continue}else if(J+1===k){(g-=3)>-1&&Z.push(239,191,189);continue}B=v;continue}if(v<56320){(g-=3)>-1&&Z.push(239,191,189),B=v;continue}v=(B-55296<<10|v-56320)+65536}else B&&(g-=3)>-1&&Z.push(239,191,189);if(B=null,v<128){if((g-=1)<0)break;Z.push(v)}else if(v<2048){if((g-=2)<0)break;Z.push(v>>6|192,v&63|128)}else if(v<65536){if((g-=3)<0)break;Z.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((g-=4)<0)break;Z.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return Z}function ht(I){for(var g=[],v=0;v<I.length;++v)g.push(I.charCodeAt(v)&255);return g}function it(I,g){for(var v,k,B,Z=[],J=0;J<I.length&&!((g-=2)<0);++J)v=I.charCodeAt(J),k=v>>8,B=v%256,Z.push(B),Z.push(k);return Z}function _t(I){return y.toByteArray(N(I))}function gt(I,g,v,k){for(var B=0;B<k&&!(B+v>=g.length||B>=I.length);++B)g[B+v]=I[B];return B}function Yt(I){return I instanceof ArrayBuffer||I!=null&&I.constructor!=null&&I.constructor.name==="ArrayBuffer"&&typeof I.byteLength=="number"}function ue(I){return typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(I)}function Fe(I){return I!==I}}).call(n,s(1))},function(l,n){"use strict";n.byteLength=c,n.toByteArray=_,n.fromByteArray=A;for(var s=[],f=[],y=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,E=d.length;m<E;++m)s[m]=d[m],f[d.charCodeAt(m)]=m;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63;function w(b){var L=b.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return b[L-2]==="="?2:b[L-1]==="="?1:0}function c(b){return b.length*3/4-w(b)}function _(b){var L,C,G,W,U,Et,et=b.length;U=w(b),Et=new y(et*3/4-U),G=U>0?et-4:et;var wt=0;for(L=0,C=0;L<G;L+=4,C+=3)W=f[b.charCodeAt(L)]<<18|f[b.charCodeAt(L+1)]<<12|f[b.charCodeAt(L+2)]<<6|f[b.charCodeAt(L+3)],Et[wt++]=W>>16&255,Et[wt++]=W>>8&255,Et[wt++]=W&255;return U===2?(W=f[b.charCodeAt(L)]<<2|f[b.charCodeAt(L+1)]>>4,Et[wt++]=W&255):U===1&&(W=f[b.charCodeAt(L)]<<10|f[b.charCodeAt(L+1)]<<4|f[b.charCodeAt(L+2)]>>2,Et[wt++]=W>>8&255,Et[wt++]=W&255),Et}function p(b){return s[b>>18&63]+s[b>>12&63]+s[b>>6&63]+s[b&63]}function T(b,L,C){for(var G,W=[],U=L;U<C;U+=3)G=(b[U]<<16)+(b[U+1]<<8)+b[U+2],W.push(p(G));return W.join("")}function A(b){for(var L,C=b.length,G=C%3,W="",U=[],Et=16383,et=0,wt=C-G;et<wt;et+=Et)U.push(T(b,et,et+Et>wt?wt:et+Et));return G===1?(L=b[C-1],W+=s[L>>2],W+=s[L<<4&63],W+="=="):G===2&&(L=(b[C-2]<<8)+b[C-1],W+=s[L>>10],W+=s[L>>4&63],W+=s[L<<2&63],W+="="),U.push(W),U.join("")}},function(l,n){n.read=function(s,f,y,d,m){var E,w,c=m*8-d-1,_=(1<<c)-1,p=_>>1,T=-7,A=y?m-1:0,b=y?-1:1,L=s[f+A];for(A+=b,E=L&(1<<-T)-1,L>>=-T,T+=c;T>0;E=E*256+s[f+A],A+=b,T-=8);for(w=E&(1<<-T)-1,E>>=-T,T+=d;T>0;w=w*256+s[f+A],A+=b,T-=8);if(E===0)E=1-p;else{if(E===_)return w?NaN:(L?-1:1)*(1/0);w=w+Math.pow(2,d),E=E-p}return(L?-1:1)*w*Math.pow(2,E-d)},n.write=function(s,f,y,d,m,E){var w,c,_,p=E*8-m-1,T=(1<<p)-1,A=T>>1,b=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,L=d?0:E-1,C=d?1:-1,G=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(c=isNaN(f)?1:0,w=T):(w=Math.floor(Math.log(f)/Math.LN2),f*(_=Math.pow(2,-w))<1&&(w--,_*=2),w+A>=1?f+=b/_:f+=b*Math.pow(2,1-A),f*_>=2&&(w++,_/=2),w+A>=T?(c=0,w=T):w+A>=1?(c=(f*_-1)*Math.pow(2,m),w=w+A):(c=f*Math.pow(2,A-1)*Math.pow(2,m),w=0));m>=8;s[y+L]=c&255,L+=C,c/=256,m-=8);for(w=w<<m|c,p+=m;p>0;s[y+L]=w&255,L+=C,w/=256,p-=8);s[y+L-C]|=G*128}},function(l,n){l.exports=function(s){return s.webpackPolyfill||(s.deprecate=function(){},s.paths=[],s.children=[],s.webpackPolyfill=1),s}},function(l,n,s){"use strict";var f=s(7),y=new f,d={};function m(w){d[w]||(typeof y[w]=="function"?d[w]=function(){return y[w].apply(y,arguments)}:d[w]=y[w])}for(var E in y)m(E);d.initializeTTYs=function(){y.stdin===null&&(y.initializeTTYs(),d.stdin=y.stdin,d.stdout=y.stdout,d.stderr=y.stderr)},y.nextTick(function(){d.initializeTTYs()}),l.exports=d},function(l,n,s){(function(f){"use strict";var y=this&&this.__extends||function(_,p){for(var T in p)p.hasOwnProperty(T)&&(_[T]=p[T]);function A(){this.constructor=_}_.prototype=p===null?Object.create(p):(A.prototype=p.prototype,new A)},d=s(8),m=null,E=function(){function _(p,T){this.fun=p,this.array=T}return _.prototype.run=function(){this.fun.apply(null,this.array)},_}(),w=function(){function _(){this._queue=[],this._draining=!1,this._currentQueue=null,this._queueIndex=-1}return _.prototype.push=function(p){var T=this;this._queue.push(p)===1&&!this._draining&&setTimeout(function(){return T._drainQueue()},0)},_.prototype._cleanUpNextTick=function(){this._draining=!1,this._currentQueue&&this._currentQueue.length?this._queue=this._currentQueue.concat(this._queue):this._queueIndex=-1,this._queue.length&&this._drainQueue()},_.prototype._drainQueue=function(){var p=this;if(!this._draining){var T=setTimeout(function(){return p._cleanUpNextTick()});this._draining=!0;for(var A=this._queue.length;A;){for(this._currentQueue=this._queue,this._queue=[];++this._queueIndex<A;)this._currentQueue&&this._currentQueue[this._queueIndex].run();this._queueIndex=-1,A=this._queue.length}this._currentQueue=null,this._draining=!1,clearTimeout(T)}},_}(),c=function(_){y(p,_);function p(){_.apply(this,arguments),this.startTime=Date.now(),this._cwd="/",this.platform="browser",this.argv=[],this.execArgv=[],this.stdout=null,this.stderr=null,this.stdin=null,this.domain=null,this._queue=new w,this.execPath=f,this.env={},this.exitCode=0,this._gid=1,this._uid=1,this.version="v5.0",this.versions={http_parser:"0.0",node:"5.0",v8:"0.0",uv:"0.0",zlib:"0.0",ares:"0.0",icu:"0.0",modules:"0",openssl:"0.0"},this.config={target_defaults:{cflags:[],default_configuration:"Release",defines:[],include_dirs:[],libraries:[]},variables:{clang:0,host_arch:"x32",node_install_npm:!1,node_install_waf:!1,node_prefix:"",node_shared_cares:!1,node_shared_http_parser:!1,node_shared_libuv:!1,node_shared_zlib:!1,node_shared_v8:!1,node_use_dtrace:!1,node_use_etw:!1,node_use_openssl:!1,node_shared_openssl:!1,strict_aliasing:!1,target_arch:"x32",v8_use_snapshot:!1,v8_no_strict_aliasing:0,visibility:""}},this.pid=Math.random()*1e3|0,this.title="node",this.arch="x32",this._mask=18,this.connected=void 0}return p.prototype.chdir=function(T){m===null&&(m=s(9)),this._cwd=m.resolve(T)},p.prototype.cwd=function(){return this._cwd},p.prototype.uptime=function(){return(Date.now()-this.startTime)/1e3|0},p.prototype.nextTick=function(T){for(var A=[],b=1;b<arguments.length;b++)A[b-1]=arguments[b];this._queue.push(new E(T,A))},p.prototype.abort=function(){this.emit("abort")},p.prototype.exit=function(T){this.exitCode=T,this.emit("exit",[T])},p.prototype.getgid=function(){return this._gid},p.prototype.setgid=function(T){typeof T=="number"?this._gid=T:this._gid=1},p.prototype.getuid=function(){return this._uid},p.prototype.setuid=function(T){typeof T=="number"?this._uid=T:this._uid=1},p.prototype.kill=function(T,A){this.emit("kill",[T,A])},p.prototype.memoryUsage=function(){return{rss:0,heapTotal:0,heapUsed:0}},p.prototype.umask=function(T){T===void 0&&(T=this._mask);var A=this._mask;return this._mask=T,this.emit("umask",[T]),A},p.prototype.hrtime=function(){var T;typeof performance<"u"?T=performance.now():Date.now?T=Date.now():T=new Date().getTime();var A=T/1e3|0;return T-=A*1e3,T=T*1e6|0,[A,T]},p.prototype.initializeTTYs=function(){if(this.stdout===null){var T=s(10);this.stdout=new T,this.stderr=new T,this.stdin=new T}},p.prototype.disconnect=function(){},p}(d.EventEmitter);l.exports=c}).call(n,"/")},function(l,n){function s(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}l.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._maxListeners=void 0,s.defaultMaxListeners=10,s.prototype.setMaxListeners=function(E){if(!y(E)||E<0||isNaN(E))throw TypeError("n must be a positive number");return this._maxListeners=E,this},s.prototype.emit=function(E){var w,c,_,p,T,A;if(this._events||(this._events={}),E==="error"&&(!this._events.error||d(this._events.error)&&!this._events.error.length)){if(w=arguments[1],w instanceof Error)throw w;var b=new Error('Uncaught, unspecified "error" event. ('+w+")");throw b.context=w,b}if(c=this._events[E],m(c))return!1;if(f(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:p=Array.prototype.slice.call(arguments,1),c.apply(this,p)}else if(d(c))for(p=Array.prototype.slice.call(arguments,1),A=c.slice(),_=A.length,T=0;T<_;T++)A[T].apply(this,p);return!0},s.prototype.addListener=function(E,w){var c;if(!f(w))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",E,f(w.listener)?w.listener:w),this._events[E]?d(this._events[E])?this._events[E].push(w):this._events[E]=[this._events[E],w]:this._events[E]=w,d(this._events[E])&&!this._events[E].warned&&(m(this._maxListeners)?c=s.defaultMaxListeners:c=this._maxListeners,c&&c>0&&this._events[E].length>c&&(this._events[E].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[E].length),typeof console.trace=="function"&&console.trace())),this},s.prototype.on=s.prototype.addListener,s.prototype.once=function(E,w){if(!f(w))throw TypeError("listener must be a function");var c=!1;function _(){this.removeListener(E,_),c||(c=!0,w.apply(this,arguments))}return _.listener=w,this.on(E,_),this},s.prototype.removeListener=function(E,w){var c,_,p,T;if(!f(w))throw TypeError("listener must be a function");if(!this._events||!this._events[E])return this;if(c=this._events[E],p=c.length,_=-1,c===w||f(c.listener)&&c.listener===w)delete this._events[E],this._events.removeListener&&this.emit("removeListener",E,w);else if(d(c)){for(T=p;T-- >0;)if(c[T]===w||c[T].listener&&c[T].listener===w){_=T;break}if(_<0)return this;c.length===1?(c.length=0,delete this._events[E]):c.splice(_,1),this._events.removeListener&&this.emit("removeListener",E,w)}return this},s.prototype.removeAllListeners=function(E){var w,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[E]&&delete this._events[E],this;if(arguments.length===0){for(w in this._events)w!=="removeListener"&&this.removeAllListeners(w);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[E],f(c))this.removeListener(E,c);else if(c)for(;c.length;)this.removeListener(E,c[c.length-1]);return delete this._events[E],this},s.prototype.listeners=function(E){var w;return!this._events||!this._events[E]?w=[]:f(this._events[E])?w=[this._events[E]]:w=this._events[E].slice(),w},s.prototype.listenerCount=function(E){if(this._events){var w=this._events[E];if(f(w))return 1;if(w)return w.length}return 0},s.listenerCount=function(E,w){return E.listenerCount(w)};function f(E){return typeof E=="function"}function y(E){return typeof E=="number"}function d(E){return typeof E=="object"&&E!==null}function m(E){return E===void 0}},function(l,n,s){(function(f){"use strict";var y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function d(w){var c=y.exec(w);return c.shift(),c}var m=function(){function w(){}return w.normalize=function(c){c===""&&(c=".");var _=c.charAt(0)===w.sep;c=w._removeDuplicateSeps(c);for(var p=c.split(w.sep),T=[],A=0;A<p.length;A++){var b=p[A];b!=="."&&(b===".."&&(_||!_&&T.length>0&&T[0]!=="..")?T.pop():T.push(b))}if(!_&&T.length<2)switch(T.length){case 1:T[0]===""&&T.unshift(".");break;default:T.push(".")}return c=T.join(w.sep),_&&c.charAt(0)!==w.sep&&(c=w.sep+c),c},w.join=function(){for(var c=[],_=0;_<arguments.length;_++)c[_-0]=arguments[_];for(var p=[],T=0;T<c.length;T++){var A=c[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&p.push(A)}return w.normalize(p.join(w.sep))},w.resolve=function(){for(var c=[],_=0;_<arguments.length;_++)c[_-0]=arguments[_];for(var p=[],T=0;T<c.length;T++){var A=c[T];if(typeof A!="string")throw new TypeError("Invalid argument type to path.join: "+typeof A);A!==""&&(A.charAt(0)===w.sep&&(p=[]),p.push(A))}var b=w.normalize(p.join(w.sep));if(b.length>1&&b.charAt(b.length-1)===w.sep)return b.substr(0,b.length-1);if(b.charAt(0)!==w.sep){b.charAt(0)==="."&&(b.length===1||b.charAt(1)===w.sep)&&(b=b.length===1?"":b.substr(2));var L=f.cwd();b!==""?b=this.normalize(L+(L!=="/"?w.sep:"")+b):b=L}return b},w.relative=function(c,_){var p;c=w.resolve(c),_=w.resolve(_);var T=c.split(w.sep),A=_.split(w.sep);A.shift(),T.shift();var b=0,L=[];for(p=0;p<T.length;p++){var C=T[p];if(C!==A[p]){b=T.length-p;break}}L=A.slice(p),T.length===1&&T[0]===""&&(b=0),b>T.length&&(b=T.length);var G="";for(p=0;p<b;p++)G+="../";return G+=L.join(w.sep),G.length>1&&G.charAt(G.length-1)===w.sep&&(G=G.substr(0,G.length-1)),G},w.dirname=function(c){c=w._removeDuplicateSeps(c);var _=c.charAt(0)===w.sep,p=c.split(w.sep);return p.pop()===""&&p.length>0&&p.pop(),p.length>1||p.length===1&&!_?p.join(w.sep):_?w.sep:"."},w.basename=function(c,_){if(_===void 0&&(_=""),c==="")return c;c=w.normalize(c);var p=c.split(w.sep),T=p[p.length-1];if(T===""&&p.length>1)return p[p.length-2];if(_.length>0){var A=T.substr(T.length-_.length);if(A===_)return T.substr(0,T.length-_.length)}return T},w.extname=function(c){c=w.normalize(c);var _=c.split(w.sep);if(c=_.pop(),c===""&&_.length>0&&(c=_.pop()),c==="..")return"";var p=c.lastIndexOf(".");return p===-1||p===0?"":c.substr(p)},w.isAbsolute=function(c){return c.length>0&&c.charAt(0)===w.sep},w._makeLong=function(c){return c},w.parse=function(c){var _=d(c);return{root:_[0],dir:_[0]+_[1].slice(0,-1),base:_[2],ext:_[3],name:_[2].slice(0,_[2].length-_[3].length)}},w.format=function(c){if(c===null||typeof c!="object")throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof c);var _=c.root||"";if(typeof _!="string")throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof c.root);var p=c.dir?c.dir+w.sep:"",T=c.base||"";return p+T},w._removeDuplicateSeps=function(c){return c=c.replace(this._replaceRegex,this.sep),c},w.sep="/",w._replaceRegex=new RegExp("//+","g"),w.delimiter=":",w.posix=w,w.win32=w,w}(),E=m;l.exports=m}).call(n,s(6))},function(l,n,s){(function(f){"use strict";var y=this&&this.__extends||function(E,w){for(var c in w)w.hasOwnProperty(c)&&(E[c]=w[c]);function _(){this.constructor=E}E.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)},d=s(11),m=function(E){y(w,E);function w(){E.call(this),this.isRaw=!1,this.columns=80,this.rows=120,this.isTTY=!0,this._bufferedWrites=[],this._waitingForWrites=!1}return w.prototype.setRawMode=function(c){this.isRaw!==c&&(this.isRaw=c,this.emit("modeChange"))},w.prototype.changeColumns=function(c){c!==this.columns&&(this.columns=c,this.emit("resize"))},w.prototype.changeRows=function(c){c!==this.rows&&(this.rows=c,this.emit("resize"))},w.isatty=function(c){return c&&c instanceof w},w.prototype._write=function(c,_,p){var T;try{var A;typeof c=="string"?A=new f(c,_):A=c,this._bufferedWrites.push(A),this._waitingForWrites&&this._read(1024)}catch(b){T=b}finally{p(T)}},w.prototype._read=function(c){if(this._bufferedWrites.length===0)this._waitingForWrites=!0;else for(;this._bufferedWrites.length>0&&(this._waitingForWrites=this.push(this._bufferedWrites.shift()),!!this._waitingForWrites););},w}(d.Duplex);l.exports=m}).call(n,s(1))},function(l,n,s){l.exports=d;var f=s(8).EventEmitter,y=s(12);y(d,f),d.Readable=s(13),d.Writable=s(27),d.Duplex=s(28),d.Transform=s(29),d.PassThrough=s(30),d.Stream=d;function d(){f.call(this)}d.prototype.pipe=function(m,E){var w=this;function c(C){m.writable&&m.write(C)===!1&&w.pause&&w.pause()}w.on("data",c);function _(){w.readable&&w.resume&&w.resume()}m.on("drain",_),!m._isStdio&&(!E||E.end!==!1)&&(w.on("end",T),w.on("close",A));var p=!1;function T(){p||(p=!0,m.end())}function A(){p||(p=!0,typeof m.destroy=="function"&&m.destroy())}function b(C){if(L(),f.listenerCount(this,"error")===0)throw C}w.on("error",b),m.on("error",b);function L(){w.removeListener("data",c),m.removeListener("drain",_),w.removeListener("end",T),w.removeListener("close",A),w.removeListener("error",b),m.removeListener("error",b),w.removeListener("end",L),w.removeListener("close",L),m.removeListener("close",L)}return w.on("end",L),w.on("close",L),m.on("close",L),m.emit("pipe",w),m}},function(l,n){typeof Object.create=="function"?l.exports=function(f,y){f.super_=y,f.prototype=Object.create(y.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:l.exports=function(f,y){f.super_=y;var d=function(){};d.prototype=y.prototype,f.prototype=new d,f.prototype.constructor=f}},function(l,n,s){(function(f){var y=function(){try{return s(11)}catch{}}();n=l.exports=s(14),n.Stream=y||n,n.Readable=n,n.Writable=s(22),n.Duplex=s(21),n.Transform=s(25),n.PassThrough=s(26),!f.browser&&f.env.READABLE_STREAM==="disable"&&y&&(l.exports=y)}).call(n,s(6))},function(l,n,s){(function(f){"use strict";l.exports=U;var y=s(15),d=s(16),m;U.ReadableState=W;var E=s(8).EventEmitter,w=function(R,N){return R.listeners(N).length},c;(function(){try{c=s(11)}catch{}finally{c||(c=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17),T=s(18);T.inherits=s(12);var A=s(19),b=void 0;A&&A.debuglog?b=A.debuglog("stream"):b=function(){};var L=s(20),C;T.inherits(U,c);function G(R,N,Y){if(typeof R.prependListener=="function")return R.prependListener(N,Y);!R._events||!R._events[N]?R.on(N,Y):d(R._events[N])?R._events[N].unshift(Y):R._events[N]=[Y,R._events[N]]}function W(R,N){m=m||s(21),R=R||{},this.objectMode=!!R.objectMode,N instanceof m&&(this.objectMode=this.objectMode||!!R.readableObjectMode);var Y=R.highWaterMark,Q=this.objectMode?16:16*1024;this.highWaterMark=Y||Y===0?Y:Q,this.highWaterMark=~~this.highWaterMark,this.buffer=new L,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=R.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,R.encoding&&(C||(C=s(24).StringDecoder),this.decoder=new C(R.encoding),this.encoding=R.encoding)}function U(R){if(m=m||s(21),!(this instanceof U))return new U(R);this._readableState=new W(R,this),this.readable=!0,R&&typeof R.read=="function"&&(this._read=R.read),c.call(this)}U.prototype.push=function(R,N){var Y=this._readableState;return!Y.objectMode&&typeof R=="string"&&(N=N||Y.defaultEncoding,N!==Y.encoding&&(R=p.from(R,N),N="")),Et(this,Y,R,N,!1)},U.prototype.unshift=function(R){var N=this._readableState;return Et(this,N,R,"",!0)},U.prototype.isPaused=function(){return this._readableState.flowing===!1};function Et(R,N,Y,Q,ht){var it=tt(N,Y);if(it)R.emit("error",it);else if(Y===null)N.reading=!1,ct(R,N);else if(N.objectMode||Y&&Y.length>0)if(N.ended&&!ht){var _t=new Error("stream.push() after EOF");R.emit("error",_t)}else if(N.endEmitted&&ht){var gt=new Error("stream.unshift() after end event");R.emit("error",gt)}else{var Yt;N.decoder&&!ht&&!Q&&(Y=N.decoder.write(Y),Yt=!N.objectMode&&Y.length===0),ht||(N.reading=!1),Yt||(N.flowing&&N.length===0&&!N.sync?(R.emit("data",Y),R.read(0)):(N.length+=N.objectMode?1:Y.length,ht?N.buffer.unshift(Y):N.buffer.push(Y),N.needReadable&&Rt(R))),Lt(R,N)}else ht||(N.reading=!1);return et(N)}function et(R){return!R.ended&&(R.needReadable||R.length<R.highWaterMark||R.length===0)}U.prototype.setEncoding=function(R){return C||(C=s(24).StringDecoder),this._readableState.decoder=new C(R),this._readableState.encoding=R,this};var wt=8388608;function pt(R){return R>=wt?R=wt:(R--,R|=R>>>1,R|=R>>>2,R|=R>>>4,R|=R>>>8,R|=R>>>16,R++),R}function M(R,N){return R<=0||N.length===0&&N.ended?0:N.objectMode?1:R!==R?N.flowing&&N.length?N.buffer.head.data.length:N.length:(R>N.highWaterMark&&(N.highWaterMark=pt(R)),R<=N.length?R:N.ended?N.length:(N.needReadable=!0,0))}U.prototype.read=function(R){b("read",R),R=parseInt(R,10);var N=this._readableState,Y=R;if(R!==0&&(N.emittedReadable=!1),R===0&&N.needReadable&&(N.length>=N.highWaterMark||N.ended))return b("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?Nt(this):Rt(this),null;if(R=M(R,N),R===0&&N.ended)return N.length===0&&Nt(this),null;var Q=N.needReadable;b("need readable",Q),(N.length===0||N.length-R<N.highWaterMark)&&(Q=!0,b("length less than watermark",Q)),N.ended||N.reading?(Q=!1,b("reading or ended",Q)):Q&&(b("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(R=M(Y,N)));var ht;return R>0?ht=ut(R,N):ht=null,ht===null?(N.needReadable=!0,R=0):N.length-=R,N.length===0&&(N.ended||(N.needReadable=!0),Y!==R&&N.ended&&Nt(this)),ht!==null&&this.emit("data",ht),ht};function tt(R,N){var Y=null;return!_.isBuffer(N)&&typeof N!="string"&&N!==null&&N!==void 0&&!R.objectMode&&(Y=new TypeError("Invalid non-string/buffer chunk")),Y}function ct(R,N){if(!N.ended){if(N.decoder){var Y=N.decoder.end();Y&&Y.length&&(N.buffer.push(Y),N.length+=N.objectMode?1:Y.length)}N.ended=!0,Rt(R)}}function Rt(R){var N=R._readableState;N.needReadable=!1,N.emittedReadable||(b("emitReadable",N.flowing),N.emittedReadable=!0,N.sync?y(dt,R):dt(R))}function dt(R){b("emit readable"),R.emit("readable"),K(R)}function Lt(R,N){N.readingMore||(N.readingMore=!0,y(kt,R,N))}function kt(R,N){for(var Y=N.length;!N.reading&&!N.flowing&&!N.ended&&N.length<N.highWaterMark&&(b("maybeReadMore read 0"),R.read(0),Y!==N.length);)Y=N.length;N.readingMore=!1}U.prototype._read=function(R){this.emit("error",new Error("_read() is not implemented"))},U.prototype.pipe=function(R,N){var Y=this,Q=this._readableState;switch(Q.pipesCount){case 0:Q.pipes=R;break;case 1:Q.pipes=[Q.pipes,R];break;default:Q.pipes.push(R);break}Q.pipesCount+=1,b("pipe count=%d opts=%j",Q.pipesCount,N);var ht=(!N||N.end!==!1)&&R!==f.stdout&&R!==f.stderr,it=ht?gt:Fe;Q.endEmitted?y(it):Y.once("end",it),R.on("unpipe",_t);function _t(J){b("onunpipe"),J===Y&&Fe()}function gt(){b("onend"),R.end()}var Yt=St(Y);R.on("drain",Yt);var ue=!1;function Fe(){b("cleanup"),R.removeListener("close",k),R.removeListener("finish",B),R.removeListener("drain",Yt),R.removeListener("error",v),R.removeListener("unpipe",_t),Y.removeListener("end",gt),Y.removeListener("end",Fe),Y.removeListener("data",g),ue=!0,Q.awaitDrain&&(!R._writableState||R._writableState.needDrain)&&Yt()}var I=!1;Y.on("data",g);function g(J){b("ondata"),I=!1;var bt=R.write(J);bt===!1&&!I&&((Q.pipesCount===1&&Q.pipes===R||Q.pipesCount>1&&te(Q.pipes,R)!==-1)&&!ue&&(b("false write response, pause",Y._readableState.awaitDrain),Y._readableState.awaitDrain++,I=!0),Y.pause())}function v(J){b("onerror",J),Z(),R.removeListener("error",v),w(R,"error")===0&&R.emit("error",J)}G(R,"error",v);function k(){R.removeListener("finish",B),Z()}R.once("close",k);function B(){b("onfinish"),R.removeListener("close",k),Z()}R.once("finish",B);function Z(){b("unpipe"),Y.unpipe(R)}return R.emit("pipe",Y),Q.flowing||(b("pipe resume"),Y.resume()),R};function St(R){return function(){var N=R._readableState;b("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&w(R,"data")&&(N.flowing=!0,K(R))}}U.prototype.unpipe=function(R){var N=this._readableState;if(N.pipesCount===0)return this;if(N.pipesCount===1)return R&&R!==N.pipes?this:(R||(R=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,R&&R.emit("unpipe",this),this);if(!R){var Y=N.pipes,Q=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var ht=0;ht<Q;ht++)Y[ht].emit("unpipe",this);return this}var it=te(N.pipes,R);return it===-1?this:(N.pipes.splice(it,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),R.emit("unpipe",this),this)},U.prototype.on=function(R,N){var Y=c.prototype.on.call(this,R,N);if(R==="data")this._readableState.flowing!==!1&&this.resume();else if(R==="readable"){var Q=this._readableState;!Q.endEmitted&&!Q.readableListening&&(Q.readableListening=Q.needReadable=!0,Q.emittedReadable=!1,Q.reading?Q.length&&Rt(this,Q):y(Xt,this))}return Y},U.prototype.addListener=U.prototype.on;function Xt(R){b("readable nexttick read 0"),R.read(0)}U.prototype.resume=function(){var R=this._readableState;return R.flowing||(b("resume"),R.flowing=!0,P(this,R)),this};function P(R,N){N.resumeScheduled||(N.resumeScheduled=!0,y(z,R,N))}function z(R,N){N.reading||(b("resume read 0"),R.read(0)),N.resumeScheduled=!1,N.awaitDrain=0,R.emit("resume"),K(R),N.flowing&&!N.reading&&R.read(0)}U.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function K(R){var N=R._readableState;for(b("flow",N.flowing);N.flowing&&R.read()!==null;);}U.prototype.wrap=function(R){var N=this._readableState,Y=!1,Q=this;R.on("end",function(){if(b("wrapped end"),N.decoder&&!N.ended){var _t=N.decoder.end();_t&&_t.length&&Q.push(_t)}Q.push(null)}),R.on("data",function(_t){if(b("wrapped data"),N.decoder&&(_t=N.decoder.write(_t)),!(N.objectMode&&_t==null)&&!(!N.objectMode&&(!_t||!_t.length))){var gt=Q.push(_t);gt||(Y=!0,R.pause())}});for(var ht in R)this[ht]===void 0&&typeof R[ht]=="function"&&(this[ht]=function(_t){return function(){return R[_t].apply(R,arguments)}}(ht));var it=["error","close","destroy","pause","resume"];return Ct(it,function(_t){R.on(_t,Q.emit.bind(Q,_t))}),Q._read=function(_t){b("wrapped _read",_t),Y&&(Y=!1,R.resume())},Q},U._fromList=ut;function ut(R,N){if(N.length===0)return null;var Y;return N.objectMode?Y=N.buffer.shift():!R||R>=N.length?(N.decoder?Y=N.buffer.join(""):N.buffer.length===1?Y=N.buffer.head.data:Y=N.buffer.concat(N.length),N.buffer.clear()):Y=It(R,N.buffer,N.decoder),Y}function It(R,N,Y){var Q;return R<N.head.data.length?(Q=N.head.data.slice(0,R),N.head.data=N.head.data.slice(R)):R===N.head.data.length?Q=N.shift():Q=Y?vt(R,N):xt(R,N),Q}function vt(R,N){var Y=N.head,Q=1,ht=Y.data;for(R-=ht.length;Y=Y.next;){var it=Y.data,_t=R>it.length?it.length:R;if(_t===it.length?ht+=it:ht+=it.slice(0,R),R-=_t,R===0){_t===it.length?(++Q,Y.next?N.head=Y.next:N.head=N.tail=null):(N.head=Y,Y.data=it.slice(_t));break}++Q}return N.length-=Q,ht}function xt(R,N){var Y=p.allocUnsafe(R),Q=N.head,ht=1;for(Q.data.copy(Y),R-=Q.data.length;Q=Q.next;){var it=Q.data,_t=R>it.length?it.length:R;if(it.copy(Y,Y.length-R,0,_t),R-=_t,R===0){_t===it.length?(++ht,Q.next?N.head=Q.next:N.head=N.tail=null):(N.head=Q,Q.data=it.slice(_t));break}++ht}return N.length-=ht,Y}function Nt(R){var N=R._readableState;if(N.length>0)throw new Error('"endReadable()" called on non-empty stream');N.endEmitted||(N.ended=!0,y(jt,N,R))}function jt(R,N){!R.endEmitted&&R.length===0&&(R.endEmitted=!0,N.readable=!1,N.emit("end"))}function Ct(R,N){for(var Y=0,Q=R.length;Y<Q;Y++)N(R[Y],Y)}function te(R,N){for(var Y=0,Q=R.length;Y<Q;Y++)if(R[Y]===N)return Y;return-1}}).call(n,s(6))},function(l,n,s){(function(f){"use strict";!f.version||f.version.indexOf("v0.")===0||f.version.indexOf("v1.")===0&&f.version.indexOf("v1.8.")!==0?l.exports=y:l.exports=f.nextTick;function y(d,m,E,w){if(typeof d!="function")throw new TypeError('"callback" argument must be a function');var c=arguments.length,_,p;switch(c){case 0:case 1:return f.nextTick(d);case 2:return f.nextTick(function(){d.call(null,m)});case 3:return f.nextTick(function(){d.call(null,m,E)});case 4:return f.nextTick(function(){d.call(null,m,E,w)});default:for(_=new Array(c-1),p=0;p<_.length;)_[p++]=arguments[p];return f.nextTick(function(){d.apply(null,_)})}}}).call(n,s(6))},function(l,n){var s={}.toString;l.exports=Array.isArray||function(f){return s.call(f)=="[object Array]"}},function(l,n,s){(function(f){"use strict";var y=s(2),d=y.Buffer,m=y.SlowBuffer,E=y.kMaxLength||2147483647;n.alloc=function(c,_,p){if(typeof d.alloc=="function")return d.alloc(c,_,p);if(typeof p=="number")throw new TypeError("encoding must not be number");if(typeof c!="number")throw new TypeError("size must be a number");if(c>E)throw new RangeError("size is too large");var T=p,A=_;A===void 0&&(T=void 0,A=0);var b=new d(c);if(typeof A=="string")for(var L=new d(A,T),C=L.length,G=-1;++G<c;)b[G]=L[G%C];else b.fill(A);return b},n.allocUnsafe=function(c){if(typeof d.allocUnsafe=="function")return d.allocUnsafe(c);if(typeof c!="number")throw new TypeError("size must be a number");if(c>E)throw new RangeError("size is too large");return new d(c)},n.from=function(c,_,p){if(typeof d.from=="function"&&(!f.Uint8Array||Uint8Array.from!==d.from))return d.from(c,_,p);if(typeof c=="number")throw new TypeError('"value" argument must not be a number');if(typeof c=="string")return new d(c,_);if(typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer){var T=_;if(arguments.length===1)return new d(c);typeof T>"u"&&(T=0);var A=p;if(typeof A>"u"&&(A=c.byteLength-T),T>=c.byteLength)throw new RangeError("'offset' is out of bounds");if(A>c.byteLength-T)throw new RangeError("'length' is out of bounds");return new d(c.slice(T,T+A))}if(d.isBuffer(c)){var b=new d(c.length);return c.copy(b,0,0,c.length),b}if(c){if(Array.isArray(c)||typeof ArrayBuffer<"u"&&c.buffer instanceof ArrayBuffer||"length"in c)return new d(c);if(c.type==="Buffer"&&Array.isArray(c.data))return new d(c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},n.allocUnsafeSlow=function(c){if(typeof d.allocUnsafeSlow=="function")return d.allocUnsafeSlow(c);if(typeof c!="number")throw new TypeError("size must be a number");if(c>=E)throw new RangeError("size is too large");return new m(c)}}).call(n,function(){return this}())},function(l,n,s){(function(f){function y(U){return Array.isArray?Array.isArray(U):W(U)==="[object Array]"}n.isArray=y;function d(U){return typeof U=="boolean"}n.isBoolean=d;function m(U){return U===null}n.isNull=m;function E(U){return U==null}n.isNullOrUndefined=E;function w(U){return typeof U=="number"}n.isNumber=w;function c(U){return typeof U=="string"}n.isString=c;function _(U){return typeof U=="symbol"}n.isSymbol=_;function p(U){return U===void 0}n.isUndefined=p;function T(U){return W(U)==="[object RegExp]"}n.isRegExp=T;function A(U){return typeof U=="object"&&U!==null}n.isObject=A;function b(U){return W(U)==="[object Date]"}n.isDate=b;function L(U){return W(U)==="[object Error]"||U instanceof Error}n.isError=L;function C(U){return typeof U=="function"}n.isFunction=C;function G(U){return U===null||typeof U=="boolean"||typeof U=="number"||typeof U=="string"||typeof U=="symbol"||typeof U>"u"}n.isPrimitive=G,n.isBuffer=f.isBuffer;function W(U){return Object.prototype.toString.call(U)}}).call(n,s(1))},function(l,n){},function(l,n,s){"use strict";var f=s(2).Buffer,y=s(17);l.exports=d;function d(){this.head=null,this.tail=null,this.length=0}d.prototype.push=function(m){var E={data:m,next:null};this.length>0?this.tail.next=E:this.head=E,this.tail=E,++this.length},d.prototype.unshift=function(m){var E={data:m,next:this.head};this.length===0&&(this.tail=E),this.head=E,++this.length},d.prototype.shift=function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}},d.prototype.clear=function(){this.head=this.tail=null,this.length=0},d.prototype.join=function(m){if(this.length===0)return"";for(var E=this.head,w=""+E.data;E=E.next;)w+=m+E.data;return w},d.prototype.concat=function(m){if(this.length===0)return y.alloc(0);if(this.length===1)return this.head.data;for(var E=y.allocUnsafe(m>>>0),w=this.head,c=0;w;)w.data.copy(E,c),c+=w.data.length,w=w.next;return E}},function(l,n,s){"use strict";var f=Object.keys||function(L){var C=[];for(var G in L)C.push(G);return C};l.exports=p;var y=s(15),d=s(18);d.inherits=s(12);var m=s(14),E=s(22);d.inherits(p,m);for(var w=f(E.prototype),c=0;c<w.length;c++){var _=w[c];p.prototype[_]||(p.prototype[_]=E.prototype[_])}function p(L){if(!(this instanceof p))return new p(L);m.call(this,L),E.call(this,L),L&&L.readable===!1&&(this.readable=!1),L&&L.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,L&&L.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",T)}function T(){this.allowHalfOpen||this._writableState.ended||y(A,this)}function A(L){L.end()}function b(L,C){for(var G=0,W=L.length;G<W;G++)C(L[G],G)}},function(l,n,s){(function(f){"use strict";l.exports=C;var y=s(15),d=!f.browser&&["v0.10","v0.9."].indexOf(f.version.slice(0,5))>-1?setImmediate:y,m;C.WritableState=b;var E=s(18);E.inherits=s(12);var w={deprecate:s(23)},c;(function(){try{c=s(11)}catch{}finally{c||(c=s(8).EventEmitter)}})();var _=s(2).Buffer,p=s(17);E.inherits(C,c);function T(){}function A(P,z,K){this.chunk=P,this.encoding=z,this.callback=K,this.next=null}function b(P,z){m=m||s(21),P=P||{},this.objectMode=!!P.objectMode,z instanceof m&&(this.objectMode=this.objectMode||!!P.writableObjectMode);var K=P.highWaterMark,ut=this.objectMode?16:16*1024;this.highWaterMark=K||K===0?K:ut,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var It=P.decodeStrings===!1;this.decodeStrings=!It,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(vt){M(z,vt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Xt(this)}b.prototype.getBuffer=function(){for(var z=this.bufferedRequest,K=[];z;)K.push(z),z=z.next;return K},function(){try{Object.defineProperty(b.prototype,"buffer",{get:w.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(P){return L.call(this,P)?!0:P&&P._writableState instanceof b}})):L=function(P){return P instanceof this};function C(P){if(m=m||s(21),!L.call(C,this)&&!(this instanceof m))return new C(P);this._writableState=new b(P,this),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev)),c.call(this)}C.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function G(P,z){var K=new Error("write after end");P.emit("error",K),y(z,K)}function W(P,z,K,ut){var It=!0,vt=!1;return K===null?vt=new TypeError("May not write null values to stream"):typeof K!="string"&&K!==void 0&&!z.objectMode&&(vt=new TypeError("Invalid non-string/buffer chunk")),vt&&(P.emit("error",vt),y(ut,vt),It=!1),It}C.prototype.write=function(P,z,K){var ut=this._writableState,It=!1,vt=_.isBuffer(P);return typeof z=="function"&&(K=z,z=null),vt?z="buffer":z||(z=ut.defaultEncoding),typeof K!="function"&&(K=T),ut.ended?G(this,K):(vt||W(this,ut,P,K))&&(ut.pendingcb++,It=Et(this,ut,vt,P,z,K)),It},C.prototype.cork=function(){var P=this._writableState;P.corked++},C.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,!P.writing&&!P.corked&&!P.finished&&!P.bufferProcessing&&P.bufferedRequest&&Rt(this,P))},C.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+z);return this._writableState.defaultEncoding=z,this};function U(P,z,K){return!P.objectMode&&P.decodeStrings!==!1&&typeof z=="string"&&(z=p.from(z,K)),z}function Et(P,z,K,ut,It,vt){K||(ut=U(z,ut,It),_.isBuffer(ut)&&(It="buffer"));var xt=z.objectMode?1:ut.length;z.length+=xt;var Nt=z.length<z.highWaterMark;if(Nt||(z.needDrain=!0),z.writing||z.corked){var jt=z.lastBufferedRequest;z.lastBufferedRequest=new A(ut,It,vt),jt?jt.next=z.lastBufferedRequest:z.bufferedRequest=z.lastBufferedRequest,z.bufferedRequestCount+=1}else et(P,z,!1,xt,ut,It,vt);return Nt}function et(P,z,K,ut,It,vt,xt){z.writelen=ut,z.writecb=xt,z.writing=!0,z.sync=!0,K?P._writev(It,z.onwrite):P._write(It,vt,z.onwrite),z.sync=!1}function wt(P,z,K,ut,It){--z.pendingcb,K?y(It,ut):It(ut),P._writableState.errorEmitted=!0,P.emit("error",ut)}function pt(P){P.writing=!1,P.writecb=null,P.length-=P.writelen,P.writelen=0}function M(P,z){var K=P._writableState,ut=K.sync,It=K.writecb;if(pt(K),z)wt(P,K,ut,z,It);else{var vt=dt(K);!vt&&!K.corked&&!K.bufferProcessing&&K.bufferedRequest&&Rt(P,K),ut?d(tt,P,K,vt,It):tt(P,K,vt,It)}}function tt(P,z,K,ut){K||ct(P,z),z.pendingcb--,ut(),kt(P,z)}function ct(P,z){z.length===0&&z.needDrain&&(z.needDrain=!1,P.emit("drain"))}function Rt(P,z){z.bufferProcessing=!0;var K=z.bufferedRequest;if(P._writev&&K&&K.next){var ut=z.bufferedRequestCount,It=new Array(ut),vt=z.corkedRequestsFree;vt.entry=K;for(var xt=0;K;)It[xt]=K,K=K.next,xt+=1;et(P,z,!0,z.length,It,"",vt.finish),z.pendingcb++,z.lastBufferedRequest=null,vt.next?(z.corkedRequestsFree=vt.next,vt.next=null):z.corkedRequestsFree=new Xt(z)}else{for(;K;){var Nt=K.chunk,jt=K.encoding,Ct=K.callback,te=z.objectMode?1:Nt.length;if(et(P,z,!1,te,Nt,jt,Ct),K=K.next,z.writing)break}K===null&&(z.lastBufferedRequest=null)}z.bufferedRequestCount=0,z.bufferedRequest=K,z.bufferProcessing=!1}C.prototype._write=function(P,z,K){K(new Error("_write() is not implemented"))},C.prototype._writev=null,C.prototype.end=function(P,z,K){var ut=this._writableState;typeof P=="function"?(K=P,P=null,z=null):typeof z=="function"&&(K=z,z=null),P!=null&&this.write(P,z),ut.corked&&(ut.corked=1,this.uncork()),!ut.ending&&!ut.finished&&St(this,ut,K)};function dt(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function Lt(P,z){z.prefinished||(z.prefinished=!0,P.emit("prefinish"))}function kt(P,z){var K=dt(z);return K&&(z.pendingcb===0?(Lt(P,z),z.finished=!0,P.emit("finish")):Lt(P,z)),K}function St(P,z,K){z.ending=!0,kt(P,z),K&&(z.finished?y(K):P.once("finish",K)),z.ended=!0,P.writable=!1}function Xt(P){var z=this;this.next=null,this.entry=null,this.finish=function(K){var ut=z.entry;for(z.entry=null;ut;){var It=ut.callback;P.pendingcb--,It(K),ut=ut.next}P.corkedRequestsFree?P.corkedRequestsFree.next=z:P.corkedRequestsFree=z}}}).call(n,s(6))},function(l,n){(function(s){l.exports=f;function f(d,m){if(y("noDeprecation"))return d;var E=!1;function w(){if(!E){if(y("throwDeprecation"))throw new Error(m);y("traceDeprecation")?console.trace(m):console.warn(m),E=!0}return d.apply(this,arguments)}return w}function y(d){try{if(!s.localStorage)return!1}catch{return!1}var m=s.localStorage[d];return m==null?!1:String(m).toLowerCase()==="true"}}).call(n,function(){return this}())},function(l,n,s){var f=s(2).Buffer,y=f.isEncoding||function(_){switch(_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function d(_){if(_&&!y(_))throw new Error("Unknown encoding: "+_)}var m=n.StringDecoder=function(_){switch(this.encoding=(_||"utf8").toLowerCase().replace(/[-_]/,""),d(_),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=w;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=c;break;default:this.write=E;return}this.charBuffer=new f(6),this.charReceived=0,this.charLength=0};m.prototype.write=function(_){for(var p="";this.charLength;){var T=_.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:_.length;if(_.copy(this.charBuffer,this.charReceived,0,T),this.charReceived+=T,this.charReceived<this.charLength)return"";_=_.slice(T,_.length),p=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var b=p.charCodeAt(p.length-1);if(b>=55296&&b<=56319){this.charLength+=this.surrogateSize,p="";continue}if(this.charReceived=this.charLength=0,_.length===0)return p;break}this.detectIncompleteChar(_);var A=_.length;this.charLength&&(_.copy(this.charBuffer,0,_.length-this.charReceived,A),A-=this.charReceived),p+=_.toString(this.encoding,0,A);var A=p.length-1,b=p.charCodeAt(A);if(b>=55296&&b<=56319){var L=this.surrogateSize;return this.charLength+=L,this.charReceived+=L,this.charBuffer.copy(this.charBuffer,L,0,L),_.copy(this.charBuffer,0,0,L),p.substring(0,A)}return p},m.prototype.detectIncompleteChar=function(_){for(var p=_.length>=3?3:_.length;p>0;p--){var T=_[_.length-p];if(p==1&&T>>5==6){this.charLength=2;break}if(p<=2&&T>>4==14){this.charLength=3;break}if(p<=3&&T>>3==30){this.charLength=4;break}}this.charReceived=p},m.prototype.end=function(_){var p="";if(_&&_.length&&(p=this.write(_)),this.charReceived){var T=this.charReceived,A=this.charBuffer,b=this.encoding;p+=A.slice(0,T).toString(b)}return p};function E(_){return _.toString(this.encoding)}function w(_){this.charReceived=_.length%2,this.charLength=this.charReceived?2:0}function c(_){this.charReceived=_.length%3,this.charLength=this.charReceived?3:0}},function(l,n,s){"use strict";l.exports=E;var f=s(21),y=s(18);y.inherits=s(12),y.inherits(E,f);function d(c){this.afterTransform=function(_,p){return m(c,_,p)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function m(c,_,p){var T=c._transformState;T.transforming=!1;var A=T.writecb;if(!A)return c.emit("error",new Error("no writecb in Transform class"));T.writechunk=null,T.writecb=null,p!=null&&c.push(p),A(_);var b=c._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&c._read(b.highWaterMark)}function E(c){if(!(this instanceof E))return new E(c);f.call(this,c),this._transformState=new d(this);var _=this;this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(p,T){w(_,p,T)}):w(_)})}E.prototype.push=function(c,_){return this._transformState.needTransform=!1,f.prototype.push.call(this,c,_)},E.prototype._transform=function(c,_,p){throw new Error("_transform() is not implemented")},E.prototype._write=function(c,_,p){var T=this._transformState;if(T.writecb=p,T.writechunk=c,T.writeencoding=_,!T.transforming){var A=this._readableState;(T.needTransform||A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}},E.prototype._read=function(c){var _=this._transformState;_.writechunk!==null&&_.writecb&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0};function w(c,_,p){if(_)return c.emit("error",_);p!=null&&c.push(p);var T=c._writableState,A=c._transformState;if(T.length)throw new Error("Calling transform done when ws.length != 0");if(A.transforming)throw new Error("Calling transform done when still transforming");return c.push(null)}},function(l,n,s){"use strict";l.exports=d;var f=s(25),y=s(18);y.inherits=s(12),y.inherits(d,f);function d(m){if(!(this instanceof d))return new d(m);f.call(this,m)}d.prototype._transform=function(m,E,w){w(null,m)}},function(l,n,s){l.exports=s(22)},function(l,n,s){l.exports=s(21)},function(l,n,s){l.exports=s(25)},function(l,n,s){l.exports=s(26)},function(l,n,s){"use strict";var f=s(32),y=s(33),d=s(38),m=s(39),E=s(40),w=s(41),c=s(42),_=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=y.assign({chunkSize:16384,windowBits:0,to:""},b||{});var L=this.options;L.raw&&L.windowBits>=0&&L.windowBits<16&&(L.windowBits=-L.windowBits,L.windowBits===0&&(L.windowBits=-15)),L.windowBits>=0&&L.windowBits<16&&!(b&&b.windowBits)&&(L.windowBits+=32),L.windowBits>15&&L.windowBits<48&&(L.windowBits&15)===0&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var C=f.inflateInit2(this.strm,L.windowBits);if(C!==m.Z_OK)throw new Error(E[C]);this.header=new c,f.inflateGetHeader(this.strm,this.header)}p.prototype.push=function(b,L){var C=this.strm,G=this.options.chunkSize,W=this.options.dictionary,U,Et,et,wt,pt,M,tt=!1;if(this.ended)return!1;Et=L===~~L?L:L===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof b=="string"?C.input=d.binstring2buf(b):_.call(b)==="[object ArrayBuffer]"?C.input=new Uint8Array(b):C.input=b,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new y.Buf8(G),C.next_out=0,C.avail_out=G),U=f.inflate(C,m.Z_NO_FLUSH),U===m.Z_NEED_DICT&&W&&(typeof W=="string"?M=d.string2buf(W):_.call(W)==="[object ArrayBuffer]"?M=new Uint8Array(W):M=W,U=f.inflateSetDictionary(this.strm,M)),U===m.Z_BUF_ERROR&&tt===!0&&(U=m.Z_OK,tt=!1),U!==m.Z_STREAM_END&&U!==m.Z_OK)return this.onEnd(U),this.ended=!0,!1;C.next_out&&(C.avail_out===0||U===m.Z_STREAM_END||C.avail_in===0&&(Et===m.Z_FINISH||Et===m.Z_SYNC_FLUSH))&&(this.options.to==="string"?(et=d.utf8border(C.output,C.next_out),wt=C.next_out-et,pt=d.buf2string(C.output,et),C.next_out=wt,C.avail_out=G-wt,wt&&y.arraySet(C.output,C.output,et,wt,0),this.onData(pt)):this.onData(y.shrinkBuf(C.output,C.next_out))),C.avail_in===0&&C.avail_out===0&&(tt=!0)}while((C.avail_in>0||C.avail_out===0)&&U!==m.Z_STREAM_END);return U===m.Z_STREAM_END&&(Et=m.Z_FINISH),Et===m.Z_FINISH?(U=f.inflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===m.Z_OK):(Et===m.Z_SYNC_FLUSH&&(this.onEnd(m.Z_OK),C.avail_out=0),!0)},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function T(b,L){var C=new p(L);if(C.push(b,!0),C.err)throw C.msg||E[C.err];return C.result}function A(b,L){return L=L||{},L.raw=!0,T(b,L)}n.Inflate=p,n.inflate=T,n.inflateRaw=A,n.ungzip=T},function(l,n,s){"use strict";var f=s(33),y=s(34),d=s(35),m=s(36),E=s(37),w=0,c=1,_=2,p=4,T=5,A=6,b=0,L=1,C=2,G=-2,W=-3,U=-4,Et=-5,et=8,wt=1,pt=2,M=3,tt=4,ct=5,Rt=6,dt=7,Lt=8,kt=9,St=10,Xt=11,P=12,z=13,K=14,ut=15,It=16,vt=17,xt=18,Nt=19,jt=20,Ct=21,te=22,R=23,N=24,Y=25,Q=26,ht=27,it=28,_t=29,gt=30,Yt=31,ue=32,Fe=852,I=592,g=15,v=g;function k(j){return(j>>>24&255)+(j>>>8&65280)+((j&65280)<<8)+((j&255)<<24)}function B(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Z(j){var ot;return!j||!j.state?G:(ot=j.state,j.total_in=j.total_out=ot.total=0,j.msg="",ot.wrap&&(j.adler=ot.wrap&1),ot.mode=wt,ot.last=0,ot.havedict=0,ot.dmax=32768,ot.head=null,ot.hold=0,ot.bits=0,ot.lencode=ot.lendyn=new f.Buf32(Fe),ot.distcode=ot.distdyn=new f.Buf32(I),ot.sane=1,ot.back=-1,b)}function J(j){var ot;return!j||!j.state?G:(ot=j.state,ot.wsize=0,ot.whave=0,ot.wnext=0,Z(j))}function bt(j,ot){var F,at;return!j||!j.state||(at=j.state,ot<0?(F=0,ot=-ot):(F=(ot>>4)+1,ot<48&&(ot&=15)),ot&&(ot<8||ot>15))?G:(at.window!==null&&at.wbits!==ot&&(at.window=null),at.wrap=F,at.wbits=ot,J(j))}function At(j,ot){var F,at;return j?(at=new B,j.state=at,at.window=null,F=bt(j,ot),F!==b&&(j.state=null),F):G}function Bt(j){return At(j,v)}var Gt=!0,Dt,Ie;function nr(j){if(Gt){var ot;for(Dt=new f.Buf32(512),Ie=new f.Buf32(32),ot=0;ot<144;)j.lens[ot++]=8;for(;ot<256;)j.lens[ot++]=9;for(;ot<280;)j.lens[ot++]=7;for(;ot<288;)j.lens[ot++]=8;for(E(c,j.lens,0,288,Dt,0,j.work,{bits:9}),ot=0;ot<32;)j.lens[ot++]=5;E(_,j.lens,0,32,Ie,0,j.work,{bits:5}),Gt=!1}j.lencode=Dt,j.lenbits=9,j.distcode=Ie,j.distbits=5}function Ve(j,ot,F,at){var Ut,nt=j.state;return nt.window===null&&(nt.wsize=1<<nt.wbits,nt.wnext=0,nt.whave=0,nt.window=new f.Buf8(nt.wsize)),at>=nt.wsize?(f.arraySet(nt.window,ot,F-nt.wsize,nt.wsize,0),nt.wnext=0,nt.whave=nt.wsize):(Ut=nt.wsize-nt.wnext,Ut>at&&(Ut=at),f.arraySet(nt.window,ot,F-at,Ut,nt.wnext),at-=Ut,at?(f.arraySet(nt.window,ot,F-at,at,0),nt.wnext=at,nt.whave=nt.wsize):(nt.wnext+=Ut,nt.wnext===nt.wsize&&(nt.wnext=0),nt.whave<nt.wsize&&(nt.whave+=Ut))),0}function Ze(j,ot){var F,at,Ut,nt,fe,st,Jt,X,q,or,Mt,lt,qe,De,Wt=0,Tt,re,ae,ie,sr,Xe,Zt,ce,ee=new f.Buf8(4),be,Se,Pr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return G;F=j.state,F.mode===P&&(F.mode=z),fe=j.next_out,Ut=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,q=F.bits,or=st,Mt=Jt,ce=b;t:for(;;)switch(F.mode){case wt:if(F.wrap===0){F.mode=z;break}for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.wrap&2&&X===35615){F.check=0,ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0),X=0,q=0,F.mode=pt;break}if(F.flags=0,F.head&&(F.head.done=!1),!(F.wrap&1)||(((X&255)<<8)+(X>>8))%31){j.msg="incorrect header check",F.mode=gt;break}if((X&15)!==et){j.msg="unknown compression method",F.mode=gt;break}if(X>>>=4,q-=4,Zt=(X&15)+8,F.wbits===0)F.wbits=Zt;else if(Zt>F.wbits){j.msg="invalid window size",F.mode=gt;break}F.dmax=1<<Zt,j.adler=F.check=1,F.mode=X&512?St:P,X=0,q=0;break;case pt:for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.flags=X,(F.flags&255)!==et){j.msg="unknown compression method",F.mode=gt;break}if(F.flags&57344){j.msg="unknown header flags set",F.mode=gt;break}F.head&&(F.head.text=X>>8&1),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0,F.mode=M;case M:for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.head&&(F.head.time=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,ee[2]=X>>>16&255,ee[3]=X>>>24&255,F.check=d(F.check,ee,4,0)),X=0,q=0,F.mode=tt;case tt:for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.head&&(F.head.xflags=X&255,F.head.os=X>>8),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0,F.mode=ct;case ct:if(F.flags&1024){for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.length=X,F.head&&(F.head.extra_len=X),F.flags&512&&(ee[0]=X&255,ee[1]=X>>>8&255,F.check=d(F.check,ee,2,0)),X=0,q=0}else F.head&&(F.head.extra=null);F.mode=Rt;case Rt:if(F.flags&1024&&(lt=F.length,lt>st&&(lt=st),lt&&(F.head&&(Zt=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),f.arraySet(F.head.extra,at,nt,lt,Zt)),F.flags&512&&(F.check=d(F.check,at,lt,nt)),st-=lt,nt+=lt,F.length-=lt),F.length))break t;F.length=0,F.mode=dt;case dt:if(F.flags&2048){if(st===0)break t;lt=0;do Zt=at[nt+lt++],F.head&&Zt&&F.length<65536&&(F.head.name+=String.fromCharCode(Zt));while(Zt&&lt<st);if(F.flags&512&&(F.check=d(F.check,at,lt,nt)),st-=lt,nt+=lt,Zt)break t}else F.head&&(F.head.name=null);F.length=0,F.mode=Lt;case Lt:if(F.flags&4096){if(st===0)break t;lt=0;do Zt=at[nt+lt++],F.head&&Zt&&F.length<65536&&(F.head.comment+=String.fromCharCode(Zt));while(Zt&&lt<st);if(F.flags&512&&(F.check=d(F.check,at,lt,nt)),st-=lt,nt+=lt,Zt)break t}else F.head&&(F.head.comment=null);F.mode=kt;case kt:if(F.flags&512){for(;q<16;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X!==(F.check&65535)){j.msg="header crc mismatch",F.mode=gt;break}X=0,q=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),j.adler=F.check=0,F.mode=P;break;case St:for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}j.adler=F.check=k(X),X=0,q=0,F.mode=Xt;case Xt:if(F.havedict===0)return j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,C;j.adler=F.check=1,F.mode=P;case P:if(ot===T||ot===A)break t;case z:if(F.last){X>>>=q&7,q-=q&7,F.mode=ht;break}for(;q<3;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}switch(F.last=X&1,X>>>=1,q-=1,X&3){case 0:F.mode=K;break;case 1:if(nr(F),F.mode=jt,ot===A){X>>>=2,q-=2;break t}break;case 2:F.mode=vt;break;case 3:j.msg="invalid block type",F.mode=gt}X>>>=2,q-=2;break;case K:for(X>>>=q&7,q-=q&7;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if((X&65535)!==(X>>>16^65535)){j.msg="invalid stored block lengths",F.mode=gt;break}if(F.length=X&65535,X=0,q=0,F.mode=ut,ot===A)break t;case ut:F.mode=It;case It:if(lt=F.length,lt){if(lt>st&&(lt=st),lt>Jt&&(lt=Jt),lt===0)break t;f.arraySet(Ut,at,nt,lt,fe),st-=lt,nt+=lt,Jt-=lt,fe+=lt,F.length-=lt;break}F.mode=P;break;case vt:for(;q<14;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(F.nlen=(X&31)+257,X>>>=5,q-=5,F.ndist=(X&31)+1,X>>>=5,q-=5,F.ncode=(X&15)+4,X>>>=4,q-=4,F.nlen>286||F.ndist>30){j.msg="too many length or distance symbols",F.mode=gt;break}F.have=0,F.mode=xt;case xt:for(;F.have<F.ncode;){for(;q<3;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.lens[Pr[F.have++]]=X&7,X>>>=3,q-=3}for(;F.have<19;)F.lens[Pr[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,be={bits:F.lenbits},ce=E(w,F.lens,0,19,F.lencode,0,F.work,be),F.lenbits=be.bits,ce){j.msg="invalid code lengths set",F.mode=gt;break}F.have=0,F.mode=Nt;case Nt:for(;F.have<F.nlen+F.ndist;){for(;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(ae<16)X>>>=Tt,q-=Tt,F.lens[F.have++]=ae;else{if(ae===16){for(Se=Tt+2;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X>>>=Tt,q-=Tt,F.have===0){j.msg="invalid bit length repeat",F.mode=gt;break}Zt=F.lens[F.have-1],lt=3+(X&3),X>>>=2,q-=2}else if(ae===17){for(Se=Tt+3;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=Tt,q-=Tt,Zt=0,lt=3+(X&7),X>>>=3,q-=3}else{for(Se=Tt+7;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=Tt,q-=Tt,Zt=0,lt=11+(X&127),X>>>=7,q-=7}if(F.have+lt>F.nlen+F.ndist){j.msg="invalid bit length repeat",F.mode=gt;break}for(;lt--;)F.lens[F.have++]=Zt}}if(F.mode===gt)break;if(F.lens[256]===0){j.msg="invalid code -- missing end-of-block",F.mode=gt;break}if(F.lenbits=9,be={bits:F.lenbits},ce=E(c,F.lens,0,F.nlen,F.lencode,0,F.work,be),F.lenbits=be.bits,ce){j.msg="invalid literal/lengths set",F.mode=gt;break}if(F.distbits=6,F.distcode=F.distdyn,be={bits:F.distbits},ce=E(_,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,be),F.distbits=be.bits,ce){j.msg="invalid distances set",F.mode=gt;break}if(F.mode=jt,ot===A)break t;case jt:F.mode=Ct;case Ct:if(st>=6&&Jt>=258){j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,m(j,Mt),fe=j.next_out,Ut=j.output,Jt=j.avail_out,nt=j.next_in,at=j.input,st=j.avail_in,X=F.hold,q=F.bits,F.mode===P&&(F.back=-1);break}for(F.back=0;Wt=F.lencode[X&(1<<F.lenbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(re&&(re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.lencode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=ie,q-=ie,F.back+=ie}if(X>>>=Tt,q-=Tt,F.back+=Tt,F.length=ae,re===0){F.mode=Q;break}if(re&32){F.back=-1,F.mode=P;break}if(re&64){j.msg="invalid literal/length code",F.mode=gt;break}F.extra=re&15,F.mode=te;case te:if(F.extra){for(Se=F.extra;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.length+=X&(1<<F.extra)-1,X>>>=F.extra,q-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=R;case R:for(;Wt=F.distcode[X&(1<<F.distbits)-1],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if((re&240)===0){for(ie=Tt,sr=re,Xe=ae;Wt=F.distcode[Xe+((X&(1<<ie+sr)-1)>>ie)],Tt=Wt>>>24,re=Wt>>>16&255,ae=Wt&65535,!(ie+Tt<=q);){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}X>>>=ie,q-=ie,F.back+=ie}if(X>>>=Tt,q-=Tt,F.back+=Tt,re&64){j.msg="invalid distance code",F.mode=gt;break}F.offset=ae,F.extra=re&15,F.mode=N;case N:if(F.extra){for(Se=F.extra;q<Se;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}F.offset+=X&(1<<F.extra)-1,X>>>=F.extra,q-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){j.msg="invalid distance too far back",F.mode=gt;break}F.mode=Y;case Y:if(Jt===0)break t;if(lt=Mt-Jt,F.offset>lt){if(lt=F.offset-lt,lt>F.whave&&F.sane){j.msg="invalid distance too far back",F.mode=gt;break}lt>F.wnext?(lt-=F.wnext,qe=F.wsize-lt):qe=F.wnext-lt,lt>F.length&&(lt=F.length),De=F.window}else De=Ut,qe=fe-F.offset,lt=F.length;lt>Jt&&(lt=Jt),Jt-=lt,F.length-=lt;do Ut[fe++]=De[qe++];while(--lt);F.length===0&&(F.mode=Ct);break;case Q:if(Jt===0)break t;Ut[fe++]=F.length,Jt--,F.mode=Ct;break;case ht:if(F.wrap){for(;q<32;){if(st===0)break t;st--,X|=at[nt++]<<q,q+=8}if(Mt-=Jt,j.total_out+=Mt,F.total+=Mt,Mt&&(j.adler=F.check=F.flags?d(F.check,Ut,Mt,fe-Mt):y(F.check,Ut,Mt,fe-Mt)),Mt=Jt,(F.flags?X:k(X))!==F.check){j.msg="incorrect data check",F.mode=gt;break}X=0,q=0}F.mode=it;case it:if(F.wrap&&F.flags){for(;q<32;){if(st===0)break t;st--,X+=at[nt++]<<q,q+=8}if(X!==(F.total&4294967295)){j.msg="incorrect length check",F.mode=gt;break}X=0,q=0}F.mode=_t;case _t:ce=L;break t;case gt:ce=W;break t;case Yt:return U;case ue:default:return G}return j.next_out=fe,j.avail_out=Jt,j.next_in=nt,j.avail_in=st,F.hold=X,F.bits=q,(F.wsize||Mt!==j.avail_out&&F.mode<gt&&(F.mode<ht||ot!==p))&&Ve(j,j.output,j.next_out,Mt-j.avail_out)?(F.mode=Yt,U):(or-=j.avail_in,Mt-=j.avail_out,j.total_in+=or,j.total_out+=Mt,F.total+=Mt,F.wrap&&Mt&&(j.adler=F.check=F.flags?d(F.check,Ut,Mt,j.next_out-Mt):y(F.check,Ut,Mt,j.next_out-Mt)),j.data_type=F.bits+(F.last?64:0)+(F.mode===P?128:0)+(F.mode===jt||F.mode===ut?256:0),(or===0&&Mt===0||ot===p)&&ce===b&&(ce=Et),ce)}function si(j){if(!j||!j.state)return G;var ot=j.state;return ot.window&&(ot.window=null),j.state=null,b}function ai(j,ot){var F;return!j||!j.state||(F=j.state,(F.wrap&2)===0)?G:(F.head=ot,ot.done=!1,b)}function ui(j,ot){var F=ot.length,at,Ut,nt;return!j||!j.state||(at=j.state,at.wrap!==0&&at.mode!==Xt)?G:at.mode===Xt&&(Ut=1,Ut=y(Ut,ot,F,0),Ut!==at.check)?W:(nt=Ve(j,ot,F,F),nt?(at.mode=Yt,U):(at.havedict=1,b))}n.inflateReset=J,n.inflateReset2=bt,n.inflateResetKeep=Z,n.inflateInit=Bt,n.inflateInit2=At,n.inflate=Ze,n.inflateEnd=si,n.inflateGetHeader=ai,n.inflateSetDictionary=ui,n.inflateInfo="pako inflate (from Nodeca project)"},function(l,n){"use strict";var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(d){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var E=m.shift();if(!!E){if(typeof E!="object")throw new TypeError(E+"must be non-object");for(var w in E)E.hasOwnProperty(w)&&(d[w]=E[w])}}return d},n.shrinkBuf=function(d,m){return d.length===m?d:d.subarray?d.subarray(0,m):(d.length=m,d)};var f={arraySet:function(d,m,E,w,c){if(m.subarray&&d.subarray){d.set(m.subarray(E,E+w),c);return}for(var _=0;_<w;_++)d[c+_]=m[E+_]},flattenChunks:function(d){var m,E,w,c,_,p;for(w=0,m=0,E=d.length;m<E;m++)w+=d[m].length;for(p=new Uint8Array(w),c=0,m=0,E=d.length;m<E;m++)_=d[m],p.set(_,c),c+=_.length;return p}},y={arraySet:function(d,m,E,w,c){for(var _=0;_<w;_++)d[c+_]=m[E+_]},flattenChunks:function(d){return[].concat.apply([],d)}};n.setTyped=function(d){d?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,f)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,y))},n.setTyped(s)},function(l,n){"use strict";function s(f,y,d,m){for(var E=f&65535|0,w=f>>>16&65535|0,c=0;d!==0;){c=d>2e3?2e3:d,d-=c;do E=E+y[m++]|0,w=w+E|0;while(--c);E%=65521,w%=65521}return E|w<<16|0}l.exports=s},function(l,n){"use strict";function s(){for(var d,m=[],E=0;E<256;E++){d=E;for(var w=0;w<8;w++)d=d&1?3988292384^d>>>1:d>>>1;m[E]=d}return m}var f=s();function y(d,m,E,w){var c=f,_=w+E;d^=-1;for(var p=w;p<_;p++)d=d>>>8^c[(d^m[p])&255];return d^-1}l.exports=y},function(l,n){"use strict";var s=30,f=12;l.exports=function(d,m){var E,w,c,_,p,T,A,b,L,C,G,W,U,Et,et,wt,pt,M,tt,ct,Rt,dt,Lt,kt,St;E=d.state,w=d.next_in,kt=d.input,c=w+(d.avail_in-5),_=d.next_out,St=d.output,p=_-(m-d.avail_out),T=_+(d.avail_out-257),A=E.dmax,b=E.wsize,L=E.whave,C=E.wnext,G=E.window,W=E.hold,U=E.bits,Et=E.lencode,et=E.distcode,wt=(1<<E.lenbits)-1,pt=(1<<E.distbits)-1;t:do{U<15&&(W+=kt[w++]<<U,U+=8,W+=kt[w++]<<U,U+=8),M=Et[W&wt];e:for(;;){if(tt=M>>>24,W>>>=tt,U-=tt,tt=M>>>16&255,tt===0)St[_++]=M&65535;else if(tt&16){ct=M&65535,tt&=15,tt&&(U<tt&&(W+=kt[w++]<<U,U+=8),ct+=W&(1<<tt)-1,W>>>=tt,U-=tt),U<15&&(W+=kt[w++]<<U,U+=8,W+=kt[w++]<<U,U+=8),M=et[W&pt];r:for(;;){if(tt=M>>>24,W>>>=tt,U-=tt,tt=M>>>16&255,tt&16){if(Rt=M&65535,tt&=15,U<tt&&(W+=kt[w++]<<U,U+=8,U<tt&&(W+=kt[w++]<<U,U+=8)),Rt+=W&(1<<tt)-1,Rt>A){d.msg="invalid distance too far back",E.mode=s;break t}if(W>>>=tt,U-=tt,tt=_-p,Rt>tt){if(tt=Rt-tt,tt>L&&E.sane){d.msg="invalid distance too far back",E.mode=s;break t}if(dt=0,Lt=G,C===0){if(dt+=b-tt,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}}else if(C<tt){if(dt+=b+C-tt,tt-=C,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);if(dt=0,C<ct){tt=C,ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}}}else if(dt+=C-tt,tt<ct){ct-=tt;do St[_++]=G[dt++];while(--tt);dt=_-Rt,Lt=St}for(;ct>2;)St[_++]=Lt[dt++],St[_++]=Lt[dt++],St[_++]=Lt[dt++],ct-=3;ct&&(St[_++]=Lt[dt++],ct>1&&(St[_++]=Lt[dt++]))}else{dt=_-Rt;do St[_++]=St[dt++],St[_++]=St[dt++],St[_++]=St[dt++],ct-=3;while(ct>2);ct&&(St[_++]=St[dt++],ct>1&&(St[_++]=St[dt++]))}}else if((tt&64)===0){M=et[(M&65535)+(W&(1<<tt)-1)];continue r}else{d.msg="invalid distance code",E.mode=s;break t}break}}else if((tt&64)===0){M=Et[(M&65535)+(W&(1<<tt)-1)];continue e}else if(tt&32){E.mode=f;break t}else{d.msg="invalid literal/length code",E.mode=s;break t}break}}while(w<c&&_<T);ct=U>>3,w-=ct,U-=ct<<3,W&=(1<<U)-1,d.next_in=w,d.next_out=_,d.avail_in=w<c?5+(c-w):5-(w-c),d.avail_out=_<T?257+(T-_):257-(_-T),E.hold=W,E.bits=U}},function(l,n,s){"use strict";var f=s(33),y=15,d=852,m=592,E=0,w=1,c=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],A=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];l.exports=function(L,C,G,W,U,Et,et,wt){var pt=wt.bits,M=0,tt=0,ct=0,Rt=0,dt=0,Lt=0,kt=0,St=0,Xt=0,P=0,z,K,ut,It,vt,xt=null,Nt=0,jt,Ct=new f.Buf16(y+1),te=new f.Buf16(y+1),R=null,N=0,Y,Q,ht;for(M=0;M<=y;M++)Ct[M]=0;for(tt=0;tt<W;tt++)Ct[C[G+tt]]++;for(dt=pt,Rt=y;Rt>=1&&Ct[Rt]===0;Rt--);if(dt>Rt&&(dt=Rt),Rt===0)return U[Et++]=1<<24|64<<16|0,U[Et++]=1<<24|64<<16|0,wt.bits=1,0;for(ct=1;ct<Rt&&Ct[ct]===0;ct++);for(dt<ct&&(dt=ct),St=1,M=1;M<=y;M++)if(St<<=1,St-=Ct[M],St<0)return-1;if(St>0&&(L===E||Rt!==1))return-1;for(te[1]=0,M=1;M<y;M++)te[M+1]=te[M]+Ct[M];for(tt=0;tt<W;tt++)C[G+tt]!==0&&(et[te[C[G+tt]]++]=tt);if(L===E?(xt=R=et,jt=19):L===w?(xt=_,Nt-=257,R=p,N-=257,jt=256):(xt=T,R=A,jt=-1),P=0,tt=0,M=ct,vt=Et,Lt=dt,kt=0,ut=-1,Xt=1<<dt,It=Xt-1,L===w&&Xt>d||L===c&&Xt>m)return 1;for(;;){Y=M-kt,et[tt]<jt?(Q=0,ht=et[tt]):et[tt]>jt?(Q=R[N+et[tt]],ht=xt[Nt+et[tt]]):(Q=32+64,ht=0),z=1<<M-kt,K=1<<Lt,ct=K;do K-=z,U[vt+(P>>kt)+K]=Y<<24|Q<<16|ht|0;while(K!==0);for(z=1<<M-1;P&z;)z>>=1;if(z!==0?(P&=z-1,P+=z):P=0,tt++,--Ct[M]===0){if(M===Rt)break;M=C[G+et[tt]]}if(M>dt&&(P&It)!==ut){for(kt===0&&(kt=dt),vt+=ct,Lt=M-kt,St=1<<Lt;Lt+kt<Rt&&(St-=Ct[Lt+kt],!(St<=0));)Lt++,St<<=1;if(Xt+=1<<Lt,L===w&&Xt>d||L===c&&Xt>m)return 1;ut=P&It,U[ut]=dt<<24|Lt<<16|vt-Et|0}}return P!==0&&(U[vt+P]=M-kt<<24|64<<16|0),wt.bits=dt,0}},function(l,n,s){"use strict";var f=s(33),y=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var m=new f.Buf8(256),E=0;E<256;E++)m[E]=E>=252?6:E>=248?5:E>=240?4:E>=224?3:E>=192?2:1;m[254]=m[254]=1,n.string2buf=function(c){var _,p,T,A,b,L=c.length,C=0;for(A=0;A<L;A++)p=c.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=c.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),C+=p<128?1:p<2048?2:p<65536?3:4;for(_=new f.Buf8(C),b=0,A=0;b<C;A++)p=c.charCodeAt(A),(p&64512)===55296&&A+1<L&&(T=c.charCodeAt(A+1),(T&64512)===56320&&(p=65536+(p-55296<<10)+(T-56320),A++)),p<128?_[b++]=p:p<2048?(_[b++]=192|p>>>6,_[b++]=128|p&63):p<65536?(_[b++]=224|p>>>12,_[b++]=128|p>>>6&63,_[b++]=128|p&63):(_[b++]=240|p>>>18,_[b++]=128|p>>>12&63,_[b++]=128|p>>>6&63,_[b++]=128|p&63);return _};function w(c,_){if(_<65537&&(c.subarray&&d||!c.subarray&&y))return String.fromCharCode.apply(null,f.shrinkBuf(c,_));for(var p="",T=0;T<_;T++)p+=String.fromCharCode(c[T]);return p}n.buf2binstring=function(c){return w(c,c.length)},n.binstring2buf=function(c){for(var _=new f.Buf8(c.length),p=0,T=_.length;p<T;p++)_[p]=c.charCodeAt(p);return _},n.buf2string=function(c,_){var p,T,A,b,L=_||c.length,C=new Array(L*2);for(T=0,p=0;p<L;){if(A=c[p++],A<128){C[T++]=A;continue}if(b=m[A],b>4){C[T++]=65533,p+=b-1;continue}for(A&=b===2?31:b===3?15:7;b>1&&p<L;)A=A<<6|c[p++]&63,b--;if(b>1){C[T++]=65533;continue}A<65536?C[T++]=A:(A-=65536,C[T++]=55296|A>>10&1023,C[T++]=56320|A&1023)}return w(C,T)},n.utf8border=function(c,_){var p;for(_=_||c.length,_>c.length&&(_=c.length),p=_-1;p>=0&&(c[p]&192)===128;)p--;return p<0||p===0?_:p+m[c[p]]>_?p:_}},function(l,n){"use strict";l.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(l,n){"use strict";l.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(l,n){"use strict";function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}l.exports=s},function(l,n){"use strict";function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}l.exports=s}])})});var vo=yr(ri=>{"use strict";ri.byteLength=lu;ri.toByteArray=pu;ri.fromByteArray=gu;var Ae=[],xe=[],cu=typeof Uint8Array<"u"?Uint8Array:Array,ki="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(rr=0,yo=ki.length;rr<yo;++rr)Ae[rr]=ki[rr],xe[ki.charCodeAt(rr)]=rr;var rr,yo;xe["-".charCodeAt(0)]=62;xe["_".charCodeAt(0)]=63;function go(l){var n=l.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=l.indexOf("=");s===-1&&(s=n);var f=s===n?0:4-s%4;return[s,f]}function lu(l){var n=go(l),s=n[0],f=n[1];return(s+f)*3/4-f}function hu(l,n,s){return(n+s)*3/4-s}function pu(l){var n,s=go(l),f=s[0],y=s[1],d=new cu(hu(l,f,y)),m=0,E=y>0?f-4:f,w;for(w=0;w<E;w+=4)n=xe[l.charCodeAt(w)]<<18|xe[l.charCodeAt(w+1)]<<12|xe[l.charCodeAt(w+2)]<<6|xe[l.charCodeAt(w+3)],d[m++]=n>>16&255,d[m++]=n>>8&255,d[m++]=n&255;return y===2&&(n=xe[l.charCodeAt(w)]<<2|xe[l.charCodeAt(w+1)]>>4,d[m++]=n&255),y===1&&(n=xe[l.charCodeAt(w)]<<10|xe[l.charCodeAt(w+1)]<<4|xe[l.charCodeAt(w+2)]>>2,d[m++]=n>>8&255,d[m++]=n&255),d}function du(l){return Ae[l>>18&63]+Ae[l>>12&63]+Ae[l>>6&63]+Ae[l&63]}function yu(l,n,s){for(var f,y=[],d=n;d<s;d+=3)f=(l[d]<<16&16711680)+(l[d+1]<<8&65280)+(l[d+2]&255),y.push(du(f));return y.join("")}function gu(l){for(var n,s=l.length,f=s%3,y=[],d=16383,m=0,E=s-f;m<E;m+=d)y.push(yu(l,m,m+d>E?E:m+d));return f===1?(n=l[s-1],y.push(Ae[n>>2]+Ae[n<<4&63]+"==")):f===2&&(n=(l[s-2]<<8)+l[s-1],y.push(Ae[n>>10]+Ae[n>>4&63]+Ae[n<<2&63]+"=")),y.join("")}});var mo=yr(Ri=>{Ri.read=function(l,n,s,f,y){var d,m,E=y*8-f-1,w=(1<<E)-1,c=w>>1,_=-7,p=s?y-1:0,T=s?-1:1,A=l[n+p];for(p+=T,d=A&(1<<-_)-1,A>>=-_,_+=E;_>0;d=d*256+l[n+p],p+=T,_-=8);for(m=d&(1<<-_)-1,d>>=-_,_+=f;_>0;m=m*256+l[n+p],p+=T,_-=8);if(d===0)d=1-c;else{if(d===w)return m?NaN:(A?-1:1)*(1/0);m=m+Math.pow(2,f),d=d-c}return(A?-1:1)*m*Math.pow(2,d-f)};Ri.write=function(l,n,s,f,y,d){var m,E,w,c=d*8-y-1,_=(1<<c)-1,p=_>>1,T=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=f?0:d-1,b=f?1:-1,L=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,m=_):(m=Math.floor(Math.log(n)/Math.LN2),n*(w=Math.pow(2,-m))<1&&(m--,w*=2),m+p>=1?n+=T/w:n+=T*Math.pow(2,1-p),n*w>=2&&(m++,w/=2),m+p>=_?(E=0,m=_):m+p>=1?(E=(n*w-1)*Math.pow(2,y),m=m+p):(E=n*Math.pow(2,p-1)*Math.pow(2,y),m=0));y>=8;l[s+A]=E&255,A+=b,E/=256,y-=8);for(m=m<<y|E,c+=y;c>0;l[s+A]=m&255,A+=b,m/=256,c-=8);l[s+A-b]|=L*128}});var Co=yr(Sr=>{"use strict";var Ni=vo(),mr=mo(),wo=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Sr.Buffer=H;Sr.SlowBuffer=_u;Sr.INSPECT_MAX_BYTES=50;var ii=2147483647;Sr.kMaxLength=ii;H.TYPED_ARRAY_SUPPORT=vu();!H.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function vu(){try{let l=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(l,n),l.foo()===42}catch{return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.byteOffset}});function ze(l){if(l>ii)throw new RangeError('The value "'+l+'" is invalid for option "size"');let n=new Uint8Array(l);return Object.setPrototypeOf(n,H.prototype),n}function H(l,n,s){if(typeof l=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Li(l)}return xo(l,n,s)}H.poolSize=8192;function xo(l,n,s){if(typeof l=="string")return wu(l,n);if(ArrayBuffer.isView(l))return Su(l);if(l==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l);if(Le(l,ArrayBuffer)||l&&Le(l.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Le(l,SharedArrayBuffer)||l&&Le(l.buffer,SharedArrayBuffer)))return Oi(l,n,s);if(typeof l=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let f=l.valueOf&&l.valueOf();if(f!=null&&f!==l)return H.from(f,n,s);let y=Eu(l);if(y)return y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof l[Symbol.toPrimitive]=="function")return H.from(l[Symbol.toPrimitive]("string"),n,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof l)}H.from=function(l,n,s){return xo(l,n,s)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function Fo(l){if(typeof l!="number")throw new TypeError('"size" argument must be of type number');if(l<0)throw new RangeError('The value "'+l+'" is invalid for option "size"')}function mu(l,n,s){return Fo(l),l<=0?ze(l):n!==void 0?typeof s=="string"?ze(l).fill(n,s):ze(l).fill(n):ze(l)}H.alloc=function(l,n,s){return mu(l,n,s)};function Li(l){return Fo(l),ze(l<0?0:Di(l)|0)}H.allocUnsafe=function(l){return Li(l)};H.allocUnsafeSlow=function(l){return Li(l)};function wu(l,n){if((typeof n!="string"||n==="")&&(n="utf8"),!H.isEncoding(n))throw new TypeError("Unknown encoding: "+n);let s=Io(l,n)|0,f=ze(s),y=f.write(l,n);return y!==s&&(f=f.slice(0,y)),f}function Ti(l){let n=l.length<0?0:Di(l.length)|0,s=ze(n);for(let f=0;f<n;f+=1)s[f]=l[f]&255;return s}function Su(l){if(Le(l,Uint8Array)){let n=new Uint8Array(l);return Oi(n.buffer,n.byteOffset,n.byteLength)}return Ti(l)}function Oi(l,n,s){if(n<0||l.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(l.byteLength<n+(s||0))throw new RangeError('"length" is outside of buffer bounds');let f;return n===void 0&&s===void 0?f=new Uint8Array(l):s===void 0?f=new Uint8Array(l,n):f=new Uint8Array(l,n,s),Object.setPrototypeOf(f,H.prototype),f}function Eu(l){if(H.isBuffer(l)){let n=Di(l.length)|0,s=ze(n);return s.length===0||l.copy(s,0,0,n),s}if(l.length!==void 0)return typeof l.length!="number"||Bi(l.length)?ze(0):Ti(l);if(l.type==="Buffer"&&Array.isArray(l.data))return Ti(l.data)}function Di(l){if(l>=ii)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ii.toString(16)+" bytes");return l|0}function _u(l){return+l!=l&&(l=0),H.alloc(+l)}H.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==H.prototype};H.compare=function(n,s){if(Le(n,Uint8Array)&&(n=H.from(n,n.offset,n.byteLength)),Le(s,Uint8Array)&&(s=H.from(s,s.offset,s.byteLength)),!H.isBuffer(n)||!H.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===s)return 0;let f=n.length,y=s.length;for(let d=0,m=Math.min(f,y);d<m;++d)if(n[d]!==s[d]){f=n[d],y=s[d];break}return f<y?-1:y<f?1:0};H.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(n,s){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return H.alloc(0);let f;if(s===void 0)for(s=0,f=0;f<n.length;++f)s+=n[f].length;let y=H.allocUnsafe(s),d=0;for(f=0;f<n.length;++f){let m=n[f];if(Le(m,Uint8Array))d+m.length>y.length?(H.isBuffer(m)||(m=H.from(m)),m.copy(y,d)):Uint8Array.prototype.set.call(y,m,d);else if(H.isBuffer(m))m.copy(y,d);else throw new TypeError('"list" argument must be an Array of Buffers');d+=m.length}return y};function Io(l,n){if(H.isBuffer(l))return l.length;if(ArrayBuffer.isView(l)||Le(l,ArrayBuffer))return l.byteLength;if(typeof l!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof l);let s=l.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&s===0)return 0;let y=!1;for(;;)switch(n){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return Ai(l).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return Do(l).length;default:if(y)return f?-1:Ai(l).length;n=(""+n).toLowerCase(),y=!0}}H.byteLength=Io;function xu(l,n,s){let f=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,n>>>=0,s<=n))return"";for(l||(l="utf8");;)switch(l){case"hex":return Lu(this,n,s);case"utf8":case"utf-8":return ko(this,n,s);case"ascii":return Ou(this,n,s);case"latin1":case"binary":return Au(this,n,s);case"base64":return Nu(this,n,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Du(this,n,s);default:if(f)throw new TypeError("Unknown encoding: "+l);l=(l+"").toLowerCase(),f=!0}}H.prototype._isBuffer=!0;function ir(l,n,s){let f=l[n];l[n]=l[s],l[s]=f}H.prototype.swap16=function(){let n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<n;s+=2)ir(this,s,s+1);return this};H.prototype.swap32=function(){let n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<n;s+=4)ir(this,s,s+3),ir(this,s+1,s+2);return this};H.prototype.swap64=function(){let n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<n;s+=8)ir(this,s,s+7),ir(this,s+1,s+6),ir(this,s+2,s+5),ir(this,s+3,s+4);return this};H.prototype.toString=function(){let n=this.length;return n===0?"":arguments.length===0?ko(this,0,n):xu.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(n){if(!H.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:H.compare(this,n)===0};H.prototype.inspect=function(){let n="",s=Sr.INSPECT_MAX_BYTES;return n=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(n+=" ... "),"<Buffer "+n+">"};wo&&(H.prototype[wo]=H.prototype.inspect);H.prototype.compare=function(n,s,f,y,d){if(Le(n,Uint8Array)&&(n=H.from(n,n.offset,n.byteLength)),!H.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(s===void 0&&(s=0),f===void 0&&(f=n?n.length:0),y===void 0&&(y=0),d===void 0&&(d=this.length),s<0||f>n.length||y<0||d>this.length)throw new RangeError("out of range index");if(y>=d&&s>=f)return 0;if(y>=d)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,y>>>=0,d>>>=0,this===n)return 0;let m=d-y,E=f-s,w=Math.min(m,E),c=this.slice(y,d),_=n.slice(s,f);for(let p=0;p<w;++p)if(c[p]!==_[p]){m=c[p],E=_[p];break}return m<E?-1:E<m?1:0};function bo(l,n,s,f,y){if(l.length===0)return-1;if(typeof s=="string"?(f=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,Bi(s)&&(s=y?0:l.length-1),s<0&&(s=l.length+s),s>=l.length){if(y)return-1;s=l.length-1}else if(s<0)if(y)s=0;else return-1;if(typeof n=="string"&&(n=H.from(n,f)),H.isBuffer(n))return n.length===0?-1:So(l,n,s,f,y);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?y?Uint8Array.prototype.indexOf.call(l,n,s):Uint8Array.prototype.lastIndexOf.call(l,n,s):So(l,[n],s,f,y);throw new TypeError("val must be string, number or Buffer")}function So(l,n,s,f,y){let d=1,m=l.length,E=n.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(l.length<2||n.length<2)return-1;d=2,m/=2,E/=2,s/=2}function w(_,p){return d===1?_[p]:_.readUInt16BE(p*d)}let c;if(y){let _=-1;for(c=s;c<m;c++)if(w(l,c)===w(n,_===-1?0:c-_)){if(_===-1&&(_=c),c-_+1===E)return _*d}else _!==-1&&(c-=c-_),_=-1}else for(s+E>m&&(s=m-E),c=s;c>=0;c--){let _=!0;for(let p=0;p<E;p++)if(w(l,c+p)!==w(n,p)){_=!1;break}if(_)return c}return-1}H.prototype.includes=function(n,s,f){return this.indexOf(n,s,f)!==-1};H.prototype.indexOf=function(n,s,f){return bo(this,n,s,f,!0)};H.prototype.lastIndexOf=function(n,s,f){return bo(this,n,s,f,!1)};function Fu(l,n,s,f){s=Number(s)||0;let y=l.length-s;f?(f=Number(f),f>y&&(f=y)):f=y;let d=n.length;f>d/2&&(f=d/2);let m;for(m=0;m<f;++m){let E=parseInt(n.substr(m*2,2),16);if(Bi(E))return m;l[s+m]=E}return m}function Iu(l,n,s,f){return ni(Ai(n,l.length-s),l,s,f)}function bu(l,n,s,f){return ni(Mu(n),l,s,f)}function ku(l,n,s,f){return ni(Do(n),l,s,f)}function Ru(l,n,s,f){return ni(Pu(n,l.length-s),l,s,f)}H.prototype.write=function(n,s,f,y){if(s===void 0)y="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")y=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,y===void 0&&(y="utf8")):(y=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-s;if((f===void 0||f>d)&&(f=d),n.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");y||(y="utf8");let m=!1;for(;;)switch(y){case"hex":return Fu(this,n,s,f);case"utf8":case"utf-8":return Iu(this,n,s,f);case"ascii":case"latin1":case"binary":return bu(this,n,s,f);case"base64":return ku(this,n,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ru(this,n,s,f);default:if(m)throw new TypeError("Unknown encoding: "+y);y=(""+y).toLowerCase(),m=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Nu(l,n,s){return n===0&&s===l.length?Ni.fromByteArray(l):Ni.fromByteArray(l.slice(n,s))}function ko(l,n,s){s=Math.min(l.length,s);let f=[],y=n;for(;y<s;){let d=l[y],m=null,E=d>239?4:d>223?3:d>191?2:1;if(y+E<=s){let w,c,_,p;switch(E){case 1:d<128&&(m=d);break;case 2:w=l[y+1],(w&192)===128&&(p=(d&31)<<6|w&63,p>127&&(m=p));break;case 3:w=l[y+1],c=l[y+2],(w&192)===128&&(c&192)===128&&(p=(d&15)<<12|(w&63)<<6|c&63,p>2047&&(p<55296||p>57343)&&(m=p));break;case 4:w=l[y+1],c=l[y+2],_=l[y+3],(w&192)===128&&(c&192)===128&&(_&192)===128&&(p=(d&15)<<18|(w&63)<<12|(c&63)<<6|_&63,p>65535&&p<1114112&&(m=p))}}m===null?(m=65533,E=1):m>65535&&(m-=65536,f.push(m>>>10&1023|55296),m=56320|m&1023),f.push(m),y+=E}return Tu(f)}var Eo=4096;function Tu(l){let n=l.length;if(n<=Eo)return String.fromCharCode.apply(String,l);let s="",f=0;for(;f<n;)s+=String.fromCharCode.apply(String,l.slice(f,f+=Eo));return s}function Ou(l,n,s){let f="";s=Math.min(l.length,s);for(let y=n;y<s;++y)f+=String.fromCharCode(l[y]&127);return f}function Au(l,n,s){let f="";s=Math.min(l.length,s);for(let y=n;y<s;++y)f+=String.fromCharCode(l[y]);return f}function Lu(l,n,s){let f=l.length;(!n||n<0)&&(n=0),(!s||s<0||s>f)&&(s=f);let y="";for(let d=n;d<s;++d)y+=zu[l[d]];return y}function Du(l,n,s){let f=l.slice(n,s),y="";for(let d=0;d<f.length-1;d+=2)y+=String.fromCharCode(f[d]+f[d+1]*256);return y}H.prototype.slice=function(n,s){let f=this.length;n=~~n,s=s===void 0?f:~~s,n<0?(n+=f,n<0&&(n=0)):n>f&&(n=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<n&&(s=n);let y=this.subarray(n,s);return Object.setPrototypeOf(y,H.prototype),y};function ne(l,n,s){if(l%1!==0||l<0)throw new RangeError("offset is not uint");if(l+n>s)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(n,s,f){n=n>>>0,s=s>>>0,f||ne(n,s,this.length);let y=this[n],d=1,m=0;for(;++m<s&&(d*=256);)y+=this[n+m]*d;return y};H.prototype.readUintBE=H.prototype.readUIntBE=function(n,s,f){n=n>>>0,s=s>>>0,f||ne(n,s,this.length);let y=this[n+--s],d=1;for(;s>0&&(d*=256);)y+=this[n+--s]*d;return y};H.prototype.readUint8=H.prototype.readUInt8=function(n,s){return n=n>>>0,s||ne(n,1,this.length),this[n]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(n,s){return n=n>>>0,s||ne(n,2,this.length),this[n]|this[n+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(n,s){return n=n>>>0,s||ne(n,2,this.length),this[n]<<8|this[n+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])};H.prototype.readBigUInt64LE=He(function(n){n=n>>>0,wr(n,"offset");let s=this[n],f=this[n+7];(s===void 0||f===void 0)&&Br(n,this.length-8);let y=s+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24,d=this[++n]+this[++n]*2**8+this[++n]*2**16+f*2**24;return BigInt(y)+(BigInt(d)<<BigInt(32))});H.prototype.readBigUInt64BE=He(function(n){n=n>>>0,wr(n,"offset");let s=this[n],f=this[n+7];(s===void 0||f===void 0)&&Br(n,this.length-8);let y=s*2**24+this[++n]*2**16+this[++n]*2**8+this[++n],d=this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+f;return(BigInt(y)<<BigInt(32))+BigInt(d)});H.prototype.readIntLE=function(n,s,f){n=n>>>0,s=s>>>0,f||ne(n,s,this.length);let y=this[n],d=1,m=0;for(;++m<s&&(d*=256);)y+=this[n+m]*d;return d*=128,y>=d&&(y-=Math.pow(2,8*s)),y};H.prototype.readIntBE=function(n,s,f){n=n>>>0,s=s>>>0,f||ne(n,s,this.length);let y=s,d=1,m=this[n+--y];for(;y>0&&(d*=256);)m+=this[n+--y]*d;return d*=128,m>=d&&(m-=Math.pow(2,8*s)),m};H.prototype.readInt8=function(n,s){return n=n>>>0,s||ne(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]};H.prototype.readInt16LE=function(n,s){n=n>>>0,s||ne(n,2,this.length);let f=this[n]|this[n+1]<<8;return f&32768?f|4294901760:f};H.prototype.readInt16BE=function(n,s){n=n>>>0,s||ne(n,2,this.length);let f=this[n+1]|this[n]<<8;return f&32768?f|4294901760:f};H.prototype.readInt32LE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24};H.prototype.readInt32BE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]};H.prototype.readBigInt64LE=He(function(n){n=n>>>0,wr(n,"offset");let s=this[n],f=this[n+7];(s===void 0||f===void 0)&&Br(n,this.length-8);let y=this[n+4]+this[n+5]*2**8+this[n+6]*2**16+(f<<24);return(BigInt(y)<<BigInt(32))+BigInt(s+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24)});H.prototype.readBigInt64BE=He(function(n){n=n>>>0,wr(n,"offset");let s=this[n],f=this[n+7];(s===void 0||f===void 0)&&Br(n,this.length-8);let y=(s<<24)+this[++n]*2**16+this[++n]*2**8+this[++n];return(BigInt(y)<<BigInt(32))+BigInt(this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+f)});H.prototype.readFloatLE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),mr.read(this,n,!0,23,4)};H.prototype.readFloatBE=function(n,s){return n=n>>>0,s||ne(n,4,this.length),mr.read(this,n,!1,23,4)};H.prototype.readDoubleLE=function(n,s){return n=n>>>0,s||ne(n,8,this.length),mr.read(this,n,!0,52,8)};H.prototype.readDoubleBE=function(n,s){return n=n>>>0,s||ne(n,8,this.length),mr.read(this,n,!1,52,8)};function ye(l,n,s,f,y,d){if(!H.isBuffer(l))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>y||n<d)throw new RangeError('"value" argument is out of bounds');if(s+f>l.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(n,s,f,y){if(n=+n,s=s>>>0,f=f>>>0,!y){let E=Math.pow(2,8*f)-1;ye(this,n,s,f,E,0)}let d=1,m=0;for(this[s]=n&255;++m<f&&(d*=256);)this[s+m]=n/d&255;return s+f};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(n,s,f,y){if(n=+n,s=s>>>0,f=f>>>0,!y){let E=Math.pow(2,8*f)-1;ye(this,n,s,f,E,0)}let d=f-1,m=1;for(this[s+d]=n&255;--d>=0&&(m*=256);)this[s+d]=n/m&255;return s+f};H.prototype.writeUint8=H.prototype.writeUInt8=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,1,255,0),this[s]=n&255,s+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,2,65535,0),this[s]=n&255,this[s+1]=n>>>8,s+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,2,65535,0),this[s]=n>>>8,this[s+1]=n&255,s+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,4,4294967295,0),this[s+3]=n>>>24,this[s+2]=n>>>16,this[s+1]=n>>>8,this[s]=n&255,s+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,4,4294967295,0),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4};function Ro(l,n,s,f,y){Lo(n,f,y,l,s,7);let d=Number(n&BigInt(4294967295));l[s++]=d,d=d>>8,l[s++]=d,d=d>>8,l[s++]=d,d=d>>8,l[s++]=d;let m=Number(n>>BigInt(32)&BigInt(4294967295));return l[s++]=m,m=m>>8,l[s++]=m,m=m>>8,l[s++]=m,m=m>>8,l[s++]=m,s}function No(l,n,s,f,y){Lo(n,f,y,l,s,7);let d=Number(n&BigInt(4294967295));l[s+7]=d,d=d>>8,l[s+6]=d,d=d>>8,l[s+5]=d,d=d>>8,l[s+4]=d;let m=Number(n>>BigInt(32)&BigInt(4294967295));return l[s+3]=m,m=m>>8,l[s+2]=m,m=m>>8,l[s+1]=m,m=m>>8,l[s]=m,s+8}H.prototype.writeBigUInt64LE=He(function(n,s=0){return Ro(this,n,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=He(function(n,s=0){return No(this,n,s,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(n,s,f,y){if(n=+n,s=s>>>0,!y){let w=Math.pow(2,8*f-1);ye(this,n,s,f,w-1,-w)}let d=0,m=1,E=0;for(this[s]=n&255;++d<f&&(m*=256);)n<0&&E===0&&this[s+d-1]!==0&&(E=1),this[s+d]=(n/m>>0)-E&255;return s+f};H.prototype.writeIntBE=function(n,s,f,y){if(n=+n,s=s>>>0,!y){let w=Math.pow(2,8*f-1);ye(this,n,s,f,w-1,-w)}let d=f-1,m=1,E=0;for(this[s+d]=n&255;--d>=0&&(m*=256);)n<0&&E===0&&this[s+d+1]!==0&&(E=1),this[s+d]=(n/m>>0)-E&255;return s+f};H.prototype.writeInt8=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,1,127,-128),n<0&&(n=255+n+1),this[s]=n&255,s+1};H.prototype.writeInt16LE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,2,32767,-32768),this[s]=n&255,this[s+1]=n>>>8,s+2};H.prototype.writeInt16BE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,2,32767,-32768),this[s]=n>>>8,this[s+1]=n&255,s+2};H.prototype.writeInt32LE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,4,2147483647,-2147483648),this[s]=n&255,this[s+1]=n>>>8,this[s+2]=n>>>16,this[s+3]=n>>>24,s+4};H.prototype.writeInt32BE=function(n,s,f){return n=+n,s=s>>>0,f||ye(this,n,s,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[s]=n>>>24,this[s+1]=n>>>16,this[s+2]=n>>>8,this[s+3]=n&255,s+4};H.prototype.writeBigInt64LE=He(function(n,s=0){return Ro(this,n,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=He(function(n,s=0){return No(this,n,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function To(l,n,s,f,y,d){if(s+f>l.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function Oo(l,n,s,f,y){return n=+n,s=s>>>0,y||To(l,n,s,4,34028234663852886e22,-34028234663852886e22),mr.write(l,n,s,f,23,4),s+4}H.prototype.writeFloatLE=function(n,s,f){return Oo(this,n,s,!0,f)};H.prototype.writeFloatBE=function(n,s,f){return Oo(this,n,s,!1,f)};function Ao(l,n,s,f,y){return n=+n,s=s>>>0,y||To(l,n,s,8,17976931348623157e292,-17976931348623157e292),mr.write(l,n,s,f,52,8),s+8}H.prototype.writeDoubleLE=function(n,s,f){return Ao(this,n,s,!0,f)};H.prototype.writeDoubleBE=function(n,s,f){return Ao(this,n,s,!1,f)};H.prototype.copy=function(n,s,f,y){if(!H.isBuffer(n))throw new TypeError("argument should be a Buffer");if(f||(f=0),!y&&y!==0&&(y=this.length),s>=n.length&&(s=n.length),s||(s=0),y>0&&y<f&&(y=f),y===f||n.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("sourceEnd out of bounds");y>this.length&&(y=this.length),n.length-s<y-f&&(y=n.length-s+f);let d=y-f;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,y):Uint8Array.prototype.set.call(n,this.subarray(f,y),s),d};H.prototype.fill=function(n,s,f,y){if(typeof n=="string"){if(typeof s=="string"?(y=s,s=0,f=this.length):typeof f=="string"&&(y=f,f=this.length),y!==void 0&&typeof y!="string")throw new TypeError("encoding must be a string");if(typeof y=="string"&&!H.isEncoding(y))throw new TypeError("Unknown encoding: "+y);if(n.length===1){let m=n.charCodeAt(0);(y==="utf8"&&m<128||y==="latin1")&&(n=m)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,n||(n=0);let d;if(typeof n=="number")for(d=s;d<f;++d)this[d]=n;else{let m=H.isBuffer(n)?n:H.from(n,y),E=m.length;if(E===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(d=0;d<f-s;++d)this[d+s]=m[d%E]}return this};var vr={};function Ci(l,n,s){vr[l]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:n.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${l}]`,this.stack,delete this.name}get code(){return l}set code(y){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:y,writable:!0})}toString(){return`${this.name} [${l}]: ${this.message}`}}}Ci("ERR_BUFFER_OUT_OF_BOUNDS",function(l){return l?`${l} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Ci("ERR_INVALID_ARG_TYPE",function(l,n){return`The "${l}" argument must be of type number. Received type ${typeof n}`},TypeError);Ci("ERR_OUT_OF_RANGE",function(l,n,s){let f=`The value of "${l}" is out of range.`,y=s;return Number.isInteger(s)&&Math.abs(s)>2**32?y=_o(String(s)):typeof s=="bigint"&&(y=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(y=_o(y)),y+="n"),f+=` It must be ${n}. Received ${y}`,f},RangeError);function _o(l){let n="",s=l.length,f=l[0]==="-"?1:0;for(;s>=f+4;s-=3)n=`_${l.slice(s-3,s)}${n}`;return`${l.slice(0,s)}${n}`}function Cu(l,n,s){wr(n,"offset"),(l[n]===void 0||l[n+s]===void 0)&&Br(n,l.length-(s+1))}function Lo(l,n,s,f,y,d){if(l>s||l<n){let m=typeof n=="bigint"?"n":"",E;throw d>3?n===0||n===BigInt(0)?E=`>= 0${m} and < 2${m} ** ${(d+1)*8}${m}`:E=`>= -(2${m} ** ${(d+1)*8-1}${m}) and < 2 ** ${(d+1)*8-1}${m}`:E=`>= ${n}${m} and <= ${s}${m}`,new vr.ERR_OUT_OF_RANGE("value",E,l)}Cu(f,y,d)}function wr(l,n){if(typeof l!="number")throw new vr.ERR_INVALID_ARG_TYPE(n,"number",l)}function Br(l,n,s){throw Math.floor(l)!==l?(wr(l,s),new vr.ERR_OUT_OF_RANGE(s||"offset","an integer",l)):n<0?new vr.ERR_BUFFER_OUT_OF_BOUNDS:new vr.ERR_OUT_OF_RANGE(s||"offset",`>= ${s?1:0} and <= ${n}`,l)}var Bu=/[^+/0-9A-Za-z-_]/g;function Uu(l){if(l=l.split("=")[0],l=l.trim().replace(Bu,""),l.length<2)return"";for(;l.length%4!==0;)l=l+"=";return l}function Ai(l,n){n=n||1/0;let s,f=l.length,y=null,d=[];for(let m=0;m<f;++m){if(s=l.charCodeAt(m),s>55295&&s<57344){if(!y){if(s>56319){(n-=3)>-1&&d.push(239,191,189);continue}else if(m+1===f){(n-=3)>-1&&d.push(239,191,189);continue}y=s;continue}if(s<56320){(n-=3)>-1&&d.push(239,191,189),y=s;continue}s=(y-55296<<10|s-56320)+65536}else y&&(n-=3)>-1&&d.push(239,191,189);if(y=null,s<128){if((n-=1)<0)break;d.push(s)}else if(s<2048){if((n-=2)<0)break;d.push(s>>6|192,s&63|128)}else if(s<65536){if((n-=3)<0)break;d.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((n-=4)<0)break;d.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return d}function Mu(l){let n=[];for(let s=0;s<l.length;++s)n.push(l.charCodeAt(s)&255);return n}function Pu(l,n){let s,f,y,d=[];for(let m=0;m<l.length&&!((n-=2)<0);++m)s=l.charCodeAt(m),f=s>>8,y=s%256,d.push(y),d.push(f);return d}function Do(l){return Ni.toByteArray(Uu(l))}function ni(l,n,s,f){let y;for(y=0;y<f&&!(y+s>=n.length||y>=l.length);++y)n[y+s]=l[y];return y}function Le(l,n){return l instanceof n||l!=null&&l.constructor!=null&&l.constructor.name!=null&&l.constructor.name===n.name}function Bi(l){return l!==l}var zu=function(){let l="0123456789abcdef",n=new Array(256);for(let s=0;s<16;++s){let f=s*16;for(let y=0;y<16;++y)n[f+y]=l[s]+l[y]}return n}();function He(l){return typeof BigInt>"u"?ju:l}function ju(){throw new Error("BigInt not supported")}});var Xo=yr((Nf,Xu)=>{Xu.exports=""});var Yo=yr((Df,Gu)=>{Gu.exports=`\r
\r
\r
<!--\r
\r
<ImageOrVid><Result watched image>\r
<Menu>\r
<Result Spectrogram> <Compared Spectrogram> (can overlay)\r
<Res2>               <Comp2>\r
    ...                 ...\r
\r
todo:\r
\r
Concise menu, finish file loading\r
Result list + comparison\r
Result saving/loading files\r
mediarecorder on canvas result too for vod\r
webworkers probably good idea for processing image on secondary canvases\r
\r
frame buffering stuff cuz graphs\r
\r
\r
-->\r
\r
        <div id="pickerDiv" style="position: relative; display:flex; align-items:center;"> <!-- We want the source canvas to maintain the source image/video's aspect ratio so it looks correct, the capture can be stretched otherwise-->\r
            <img src="" style="position: absolute; z-index:1;" ></img>\r
            <video src="" style="position: absolute; display:none; z-index:2;" ></video>\r
            <canvas id="picker" style="position: absolute; z-index:3;" ></canvas>\r
        </div>\r
        <div id="captureDiv"><canvas id="capture" style="z-index:11; height:100%; width:100%;" height="100%" width="100%"></canvas></div>\r
        \r
        <button id="toggleMenu" style="display:none;">Toggle Menu</button>\r
\r
        <div id="menu">\r
            <button id="snip">Analyze</button>\r
            <div id="videomenu" style="display:none;">\r
                <button id="record">Record</button>\r
            </div>\r
            <button id="webcam">Use Webcam</button>\r
            <button id="image">Use Image</button>\r
            <button id="fileinput">Upload File</button>\r
            <button id="useurl">Use URL</button>\r
            <div id="imgmenu">\r
                <span style="color:white;">Preloaded Images:</span>\r
                <select id="imgselect"></select>\r
            </div>\r
            <div id="urlmenu" style="display:none;">\r
                <input type="url" id="urlinput" placeholder="Image or Video File URL"></input>\r
                <span style="color:white;">File type:</span>\r
                <select id="urlselect">\r
                    <option value="img" selected>Image</option>\r
                    <option value="video">Video</option>\r
                </select>\r
                <button id="seturl">Set URL</button>\r
            </div>\r
            <br>\r
            <button style="float:right;" id="help">Help</button>\r
            <div id="instructions" style="color:white; display:none;">\r
                Instructions: Click to draw a rectangle around the portion of the image or video you want to snip, \r
                then click Analyze to create a downloadable spectrogram you can compare with other results!\r
            </div>\r
            <br>\r
        <hr>\r
            </div>\r
        <div  id="compare" style="overflow-y:scroll;">\r
            Compare\r
        </div>\r
        <div id="captured" style="overflow-y:scroll;">\r
            Captured\r
        </div>\r
        <div id="saved" style="overflow-y:scroll;">\r
            Saved\r
        </div>`});var Dr=class{constructor(n=this.onOpen,s=null,f=null){this.onOpen=n,this.notes=[{idx:0,text:"comment"}],s!==null&&document.getElementById(s).addEventListener("click",this.saveCSV),f!==null&&document.getElementById(f).addEventListener("click",this.openCSV)}processArraysForCSV(n=["1|2|3","3|2|1"],s="|",f="a,b,c",y=!1){let d=f+`
`,m=0;return n.forEach((E,w)=>{n[w]==="string"&&s!==","?d+=E.split(s).join(","):csvData+=E.join(","),y===!0&&this.notes[m].idx===w&&(E+=this.notes[m].text,m++),E.indexOf(`
`)<0&&(d+=`
`)}),d}static saveCSV(n=`a,b,c
1,2,3
3,2,1
`,s=new Date().toISOString()){var f=document.createElement("a");f.href="data:text/csv;charset=utf-8,"+encodeURI(n),f.target="_blank",s!==""?f.download=s+".csv":f.download=Date().toISOString()+".csv",f.click()}static openCSV(n=",",s=(f,y,d)=>d){var f=document.createElement("input");f.accept=".csv",f.type="file",f.onchange=y=>{var d=y.target.files[0],m=new FileReader;m.onload=E=>{var w=E.target.result,c=w.split(`
`);let _=[];var p=[];c.pop(),c.forEach((T,A)=>{if(A==0)_=T.split(n);else{var b=T.split(n);p.push(b)}}),s(p,_,f.value),f.value=""},m.readAsText(d)},f.click()}static openCSVRaw(n=(s,f)=>f){var s=document.createElement("input");s.accept=".csv",s.type="file",s.onchange=f=>{var y=f.target.files[0],d=new FileReader;d.onload=m=>{var E=m.target.result;n(E,s.value),s.value=""},d.readAsText(y)},s.click()}onOpen(n=[],s=[]){console.log("CSV Opened!",s,n)}};var er=fo(co()),lo=!1,bi=er.BFSRequire("fs"),uf=er.BFSRequire("buffer").Buffer,ho=async(l=["data","projects","extensions","settings","plugins"],n=()=>{},s=()=>{})=>lo?!0:new Promise(f=>{let y=bi.getRootFS();er.FileSystem.IndexedDB.Create({},(d,m)=>{if(d)throw d;if(!m)throw s(),new Error("Error creating BrowserFS");er.initialize(m);let E=[];l.forEach(async w=>{E.push(fu(bi,w))}),Promise.all(E).then(w=>{n(),lo=!0,f(!0)})})});var po=async(l,n,s="data",f=y=>{})=>new Promise(y=>{bi.writeFile("/"+s+"/"+l,n,d=>{if(d)throw d;f(n),y(!0)})});var gr={},fu=async(l,n)=>new Promise(s=>{gr[n]==="exists"||gr[n]==="created"?s():l.exists(`/${n}`,f=>{f?(gr[n]="exists",console.log(`/${n} exists!`),s()):gr[n]==="creating"?(console.log(n+" is still being created."),s()):(console.log("creating "+n),gr[n]="creating",l.mkdir(n,y=>{if(y)throw y;gr[n]="created",setTimeout(s,500)}))})});var Ui=fo(Co());var Mi={getImageData:function(l){var n=l.width,s=l.height,f=l.getContext("2d").getImageData(0,0,n,s);return f},toArrayBuffer:function(l){var n=canvas.width,s=canvas.height,f=n*4,y=new Uint32Array(l.data.buffer),d=Math.floor((32*n+31)/32)*4,m=d*s,E=122+m,w=new ArrayBuffer(E),c=new DataView(w),_=0,p,T=0,A,b=0,L,C;for(G(19778),W(E),_+=4,W(122),W(108),W(n),W(-s>>>0),G(1),G(32),W(3),W(m),W(2835),W(2835),_+=8,W(16711680),W(65280),W(255),W(4278190080),W(1466527264);T<s;){for(A=122+T*d,p=0;p<f;)C=y[b++],L=C>>>24,c.setUint32(A+p,C<<8|L),p+=4;T++}return w;function G(U){c.setUint16(_,U,!0),_+=2}function W(U){c.setUint32(_,U,!0),_+=4}},toBlob:function(l){return new Blob([this.toArrayBuffer(this.getImageData(l))],{type:"image/bmp"})},ImageDatatoBlob:function(l){return new Blob([this.toArrayBuffer(l)],{type:"image/bmp"})},toDataURL:function(l){for(var n=new Uint8Array(this.toArrayBuffer(this.getImageData(l))),s="",f=0,y=n.length;f<y;)s+=String.fromCharCode(n[f++]);return"data:image/bmp;base64,"+Ui.Buffer.from(s,"base64").toString("ascii")},ImageDatatoDataURL:function(l){for(var n=new Uint8Array(this.toArrayBuffer(l)),s="",f=0,y=n.length;f<y;)s+=String.fromCharCode(n[f++]);return"data:image/bmp;base64,"+Ui.Buffer.from(s,"base64").toString("ascii")}};function Ur(l,n,s,f,y=0,d=0){if(l.naturalWidth)return{x:l.naturalWidth*(s-y)/n.width,y:l.naturalHeight*(f-d)/n.height};if(l.videoWidth)return{x:l.videoWidth*(s-y)/n.width,y:l.videoHeight*(f-d)/n.height};if(l.width)return{x:l.width*(s-y)/n.width,y:l.height*(f-d)/n.height}}function Wu(l){let n=Array.from(l.data),s=[],f=0;for(let c=0;c<n.length;c+=4)c/4%l.width===0&&(f=0),s[f]?(s[f].i+=parseFloat(n[c]+n[c+1]+n[c+2]),s[f].r+=parseFloat(n[c]),s[f].g+=parseFloat(n[c+1]),s[f].b+=parseFloat(n[c+2])):s[f]={i:parseFloat(n[c]+n[c+1]+n[c+2]),r:parseFloat(n[c]),g:parseFloat(n[c+1]),b:parseFloat(n[c+2])},f++;let y=Math.max(...s.map(c=>c.i)),d=Math.max(...s.map(c=>c.r)),m=Math.max(...s.map(c=>c.b)),E=Math.max(...s.map(c=>c.g)),w=Math.max(d,m,E);return{bitmap:l,width:l.width,height:l.height,bitarr:n,xrgbintensities:s,xintmax:y,xrintmax:d,xbintmax:m,xgintmax:E,xrgbmax:w}}async function Bo(l,n){let s=Object.assign({},l);delete s.bitmap;let f=JSON.stringify(s);return await po(n,f,"processed")}function Uo(l,n,s){return new ImageData(Uint8ClampedArray.from(l),n,s)}function Mo(l,n,s=0,f=0,y=n.width,d=n.height,m=0,E=0,w=l.canvas.width,c=l.canvas.height){return l.drawImage(n,s,f,y,d,m,E,w,c)}function Po(l,n,s=0,f=0,y=l.canvas.width,d=l.canvas.height){let m=Wu(n);l.fillStyle="white",l.strokeStyle="ghostwhite",l.lineWidth=1,l.beginPath();let E=m.xrgbintensities.length,w=y/E;return m.xrgbintensities.forEach((c,_)=>{_===0?l.moveTo(s,f+d*(1-c.i/m.xintmax)):l.lineTo(s+_*w,f+d*(1-c.i/m.xintmax))}),l.stroke(),l.strokeStyle="tomato",l.lineWidth=1,l.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?l.moveTo(s,f+d*(1-c.r/m.xintmax)):l.lineTo(s+_*w,f+d*(1-c.r/m.xintmax))}),l.stroke(),l.strokeStyle="#00b8f5",l.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?l.moveTo(s,f+d*(1-c.b/m.xintmax)):l.lineTo(s+_*w,f+d*(1-c.b/m.xintmax))}),l.stroke(),l.strokeStyle="chartreuse",l.beginPath(),m.xrgbintensities.forEach((c,_)=>{_===0?l.moveTo(s,f+d*(1-c.g/m.xintmax)):l.lineTo(s+_*w,f+d*(1-c.g/m.xintmax))}),l.stroke(),m}function zo(l,n=30,s=Hu){let f=l.captureStream(n),y=new MediaRecorder(f),d=[];return y.ondataavailable=function(m){d.push(m.data)},y.onstop=function(m){let E=new Blob(d,{type:"video/mp4"});d=[];let w=URL.createObjectURL(E);s(w)},y}function Hu(l,n=new Date().toISOString()){var s=document.createElement("a");s.href=l,s.target="_blank",n!==""?s.download=n+".mp4":s.download=new Date().toISOString()+".mp4",s.click()}function jo(l){var n=new DataView(l),s={};s.fileheader={},s.fileheader.bfType=n.getUint16(0,!0),s.fileheader.bfSize=n.getUint32(2,!0),s.fileheader.bfReserved1=n.getUint16(6,!0),s.fileheader.bfReserved2=n.getUint16(8,!0),s.fileheader.bfOffBits=n.getUint32(10,!0),s.infoheader={},s.infoheader.biSize=n.getUint32(14,!0),s.infoheader.biWidth=n.getUint32(18,!0),s.infoheader.biHeight=n.getUint32(22,!0),s.infoheader.biPlanes=n.getUint16(26,!0),s.infoheader.biBitCount=n.getUint16(28,!0),s.infoheader.biCompression=n.getUint32(30,!0),s.infoheader.biSizeImage=n.getUint32(34,!0),s.infoheader.biXPelsPerMeter=n.getUint32(38,!0),s.infoheader.biYPelsPerMeter=n.getUint32(42,!0),s.infoheader.biClrUsed=n.getUint32(46,!0),s.infoheader.biClrImportant=n.getUint32(50,!0);var f=s.fileheader.bfOffBits;return s.stride=Math.floor((s.infoheader.biBitCount*s.infoheader.biWidth+31)/32)*4,s.pixels=new Uint8Array(l,f),s}function Wo(l){canvas=document.createElement("canvas");var n=canvas.getContext("2d"),s=l.infoheader.biWidth,f=l.infoheader.biHeight;canvas.width=s,canvas.height=f;for(var y=n.createImageData(s,f),d=y.data,m=l.pixels,E=l.stride,w=0;w<f;++w)for(var c=0;c<s;++c){var _=(c+s*(f-w))*4,p=c*3+E*w;d[_]=m[p+2],d[_+1]=m[p+1],d[_+2]=m[p],d[_+3]=255}return n.putImageData(y,0,0),canvas.toDataURL("image/png")}function Ho(l,n){let s=`x,r,g,b,i
`,f="";l.forEach((d,m)=>{f+=`${m},${d.r},${d.g},${d.b},${d.i}
`});let y=s+f;Dr.saveCSV(y,n+"_"+new Date().toISOString())}async function Vo(l,n,s="320px",f="180px"){let y=`
    <div style='width:${s}; height:${f};'>
        <div>
            <input id='title' type='text' placeholder='name'>
            <button id='toggledisplay'>Toggle Display</button>
            <button id='savepng'>Save PNG</button>
            <button id='savebmp'>Save BMP</button>
            <button id='savecsv'>Save CSV</button>
            <button id='backup'>Backup</button>
            <button id='X'>X</button>
        </div>
        <canvas id='capturecanvas' style='width:100%; height:100%;'></canvas>
        <canvas id='graphcanvas' style='width:100%; height:100%;'></canvas>
    </div>`;if(typeof n=="string"&&(n=document.getElementById(n)),n){n.insertAdjacentHTML("afterbegin",y);let d=document.querySelector("#capturecanvas");d.width=l.width,d.height=l.height;let m=d.getContext("2d");m.drawImage(l,0,0);let E=document.querySelector("#title");console.log(l);let w=m.getImageData(0,0,d.width,d.height),c=document.querySelector("#graphcanvas"),_=Po(c.getContext("2d"),w),p={parentNode:n,width:l.width,height:l.height,canvas:d,input:E,mapped:_};return n.querySelector("#toggledisplay").onclick=()=>{d.style.display==""&&c.style.display==""?d.style.display="none":d.style.display=="none"?(d.style.display="",c.style.display="none"):c.style.display=="none"&&(c.style.display="")},n.querySelector("#backup").onclick=()=>{Bo(p.mapped,E.value+"_"+new Date().toISOString())},n.querySelector("#savepng").onclick=()=>{let T=new OffscreenCanvas(p.mapped.bitmap.width,p.mapped.bitmap.height);T.getContext("2d").drawImage(l,0,0);let A=new FileReader;A.addEventListener("load",function(){var b=document.createElement("a");b.href=A.result,b.target="_blank",E.value!==""?b.download=E.value+"_"+new Date().toISOString()+".png":b.download=new Date().toISOString()+".png",b.click()},!1),T.convertToBlob({type:"image/png"}).then(b=>{A.readAsDataURL(b)})},n.querySelector("#savebmp").onclick=()=>{let T=Mi.ImageDatatoDataURL(Uo(p.mapped.bitarr,p.mapped.width,p.mapped.height));var A=document.createElement("a");A.href=T,A.target="_blank",E.value!==""?A.download=E.value+"_"+new Date().toISOString()+".bmp":A.download=new Date().toISOString()+".bmp",A.click()},n.querySelector("#savecsv").onclick=()=>{Ho(p.mapped.xrgbintensities,E.value)},n.querySelector("#X").onclick=()=>{d.parentNode.parentNode.removeChild(d.parentNode)},p}return y}var oi=class extends HTMLElement{template=n=>`<div> Custom Fragment Props: ${JSON.stringify(n)} </div>`;props={test:!0};useShadow=!1;oncreate=void 0;onresize=void 0;ondelete=void 0;onchanged=void 0;FRAGMENT=void 0;attachedShadow=!1;obsAttributes=["props","options","onchanged","onresize","ondelete","oncreate","template"];get observedAttributes(){return this.obsAttributes}get obsAttributes(){return this.obsAttributes}set obsAttributes(n){typeof n=="string"?this.obsAttributes.push(n):Array.isArray(n)&&(this.obsAttributes=n)}static get tag(){return this.name.toLowerCase()+"-"}static addElement(n=this.tag,s=this,f=void 0){Vu(s,n,f)}attributeChangedCallback(n,s,f){if(n==="onchanged"){let y=f;if(typeof y=="string"&&(y=Er(y)),typeof y=="function"){this.onchanged=y,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged);let d=new CustomEvent("changed",{detail:{props:this.props}});this.state.subscribeTrigger("props",()=>{this.dispatchEvent(d)})}}else if(n==="onresize"){let y=f;if(typeof y=="string"&&(y=Er(y)),typeof y=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=d=>{this.onresize(this.props)},this.onresize=y,window.addEventListener("resize",this.ONRESIZE)}}else if(n==="ondelete"){let y=f;typeof y=="string"&&(y=Er(y)),typeof y=="function"&&(this.ondelete=()=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),y&&y(this.props)})}else if(n==="oncreate"){let y=f;typeof y=="string"&&(y=Er(y)),typeof y=="function"&&(this.oncreate=y)}else if(n==="props"){let y=f;typeof y=="string"&&(y=JSON.parse(y)),Object.assign(this.props,y),this.state.setState({props:this.props})}else if(n==="template"){let y=f;this.template=options.template,typeof y=="function"?this.templateString=this.template(this.props):this.templateString=y,this.render(this.props);let d=new CustomEvent("created",{detail:{props:this.props}});this.dispatchEvent(d)}else{let y=f;if(n.includes("eval_"))n=n.split("_"),n.shift(),n=n.join(),y=Er(f);else if(typeof f=="string")try{y=JSON.parse(f)}catch{y=f}this[n]=y,n!=="props"&&(this.props[n]=y)}}connectedCallback(){let n=this.getAttribute("props");typeof n=="string"&&(n=JSON.parse(n)),Object.assign(this.props,n),this.state.setState({props:this.props}),Array.from(this.attributes).forEach(m=>{let E=m.name,w=m.value;if(E.includes("eval_"))E=E.split("_"),E.shift(),E=E.join(),w=Er(m.value);else if(typeof m.value=="string")try{w=JSON.parse(m.value)}catch{w=m.value}this[E]||Object.defineProperties(this,m,{value:w,writable:!0,get(){return this[E]},set(c){this.setAttribute(E,c)}}),this[E]=w,E!=="props"&&(this.props[E]=w),this.obsAttributes.push(E)});let s=new CustomEvent("resized",{detail:{props:this.props}}),f=new CustomEvent("changed",{detail:{props:this.props}}),y=new CustomEvent("deleted",{detail:{props:this.props}}),d=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(d),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(f)}),typeof this.onresize=="function"){if(this.ONRESIZE)try{window.removeEventListener("resize",this.ONRESIZE)}catch{}this.ONRESIZE=m=>{this.onresize(this.props),this.dispatchEvent(s)},window.addEventListener("resize",this.ONRESIZE)}if(typeof this.ondelete=="function"){let m=this.ondelete;this.ondelete=(E=this.props)=>{this.ONRESIZE&&window.removeEventListener("resize",this.ONRESIZE),this.state.unsubscribeTrigger("props"),this.dispatchEvent(y),m(E)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}constructor(){super()}delete=()=>{this.remove(),typeof this.ondelete=="function"&&this.ondelete(this.props)};render=(n=this.props)=>{typeof this.template=="function"?this.templateString=this.template(n):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let f=s.content;this.FRAGMENT&&(this.useShadow?this.shadowRoot.removeChild(this.FRAGMENT):this.removeChild(this.FRAGMENT)),this.useShadow?(this.attachedShadow||this.attachShadow({mode:"open"}),this.shadowRoot.prepend(f),this.FRAGMENT=this.shadowRoot.childNodes[0]):this.prepend(f),this.FRAGMENT=this.childNodes[0],this.oncreate&&this.oncreate(n)};state={pushToState:{},data:{},triggers:{},setState(n){if(Object.assign(this.pushToState,n),Object.keys(this.triggers).length>0)for(let s of Object.getOwnPropertyNames(this.triggers))this.pushToState[s]&&(this.data[s]=this.pushToState[s],delete this.pushToState[s],this.triggers[s].forEach(f=>{f.onchanged(this.data[s])}));return this.pushToState},subscribeTrigger(n,s=f=>{}){if(n){this.triggers[n]||(this.triggers[n]=[]);let f=this.triggers[n].length;return this.triggers[n].push({idx:f,onchanged:s}),this.triggers[n].length-1}else return},unsubscribeTrigger(n,s){let f,y=this.triggers[n];if(y)if(!s)delete this.triggers[n];else return y.find(m=>{if(m.idx===s)return!0})&&y.splice(f,1),!0},subscribeTriggerOnce(n=void 0,s=f=>{}){let f,y=d=>{s(d),this.unsubscribeTrigger(n,f)};f=this.subscribeTrigger(n,y)}};get props(){return this.props}set props(n={}){this.setAttribute("props",n)}get template(){return this.template}set template(n){this.setAttribute("template",n)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(n){this.setAttribute("onchanged",n)}get onresize(){return this.props}set onresize(n){this.setAttribute("onresize",n)}get ondelete(){return this.props}set ondelete(n){this.setAttribute("ondelete",n)}get oncreate(){return this.oncreate}set oncreate(n){this.setAttribute("oncreated",n)}};function Vu(l,n,s=null){try{s?n?window.customElements.define(n,l,{extends:s}):window.customElements.define(l.name.toLowerCase()+"-",l,{extends:s}):n?window.customElements.define(n,l):window.customElements.define(l.name.toLowerCase()+"-",l)}catch{}}function xf(l=""){return l+Math.floor(Math.random()*1e15)}function Er(method){let getFunctionBody=l=>l.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=l=>{let n=l.indexOf(")");return l.slice(0,l.indexOf("{",n)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;try{if(newFuncHead.includes("function ")){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else try{newFunc=eval(newFuncHead+newFuncBody+"}")}catch(err){newFunc=eval(method)}}catch(l){}return newFunc}var qo={pushToState:{},data:{},triggers:{},setState(l){Object.assign(this.data,l);for(let n of Object.getOwnPropertyNames(l))this.triggers[n]&&this.triggers[n].forEach(s=>s.onchange(this.data[n]));return this.data},subscribeTrigger(l,n=s=>{}){if(l){this.triggers[l]||(this.triggers[l]=[]);let s=this.triggers[l].length;return this.triggers[l].push({idx:s,onchange:n}),this.triggers[l].length-1}else return},unsubscribeTrigger(l,n){let s,f=this.triggers[l];if(f)if(!n)delete this.triggers[l];else return f.find(d=>{if(d.idx===n)return!0})&&f.splice(s,1),!0},subscribeTriggerOnce(l=void 0,n=s=>{}){let s,f=y=>{n(y),this.unsubscribeTrigger(l,s)};s=this.subscribeTrigger(l,f)}},Zo=class{state=qo;nodes=new Map;nNodes=0;constructor(){}convertChildrenToNodes(n){n.convertChildrenToNodes(n)}addNode(n={}){return new we(n,void 0,this)}getNode(n){return this.nodes.get(n)}run(n,s,f){if(typeof n=="string"&&(n=this.nodes.get(n)),n)return n.run(s,n,f)}runNode=this.run;removeTree(n){if(typeof n=="string"&&(n=this.nodes.get(n)),n){let s=function(f){f.children&&(Array.isArray(f.children)?f.children.forEach(y=>{y.stopNode&&y.stopNode(),y.tag&&this.nodes.get(y.tag)&&this.nodes.delete(y.tag),this.nodes.forEach(d=>{d.nodes.get(y.tag)&&d.nodes.delete(y.tag)}),s(y)}):typeof f.children=="object"&&(f.stopNode&&f.stopNode(),f.tag&&this.nodes.get(f.tag)&&this.nodes.delete(f.tag),this.nodes.forEach(y=>{y.nodes.get(f.tag)&&y.nodes.delete(f.tag)}),s(f)))};n.stopNode&&n.stopNode(),n.tag&&(this.nodes.delete(n.tag),this.nodes.forEach(f=>{f.nodes.get(n.tag)&&f.nodes.delete(n.tag)}),s(n))}}removeNode(n){typeof n=="string"&&(n=this.nodes.get(n)),n?.tag&&this.nodes.delete(n.tag),n?.tag&&this.nodes.get(n.tag)&&(this.nodes.delete(n.tag),this.nodes.forEach(s=>{s.nodes.get(n.tag)&&s.nodes.delete(n.tag)}))}appendNode(n={},s){s.addChildren(n)}async callParent(n,s,f=n,y){if(n?.parent)return await n.callParent(s,n.parent,f,y)}async callChildren(n,s,f=n,y,d){if(n?.children)return await n.callChildren(s,f,y,d)}subscribe(n,s=f=>{}){return this.state.subscribeTrigger(n,s)}unsubscribe(n,s){this.state.unsubscribeTrigger(n,s)}subscribeNode(n,s){return this.state.subscribeTrigger(n.tag,f=>{this.run(s,f,this)})}create(n=(y,d,m,E)=>{},s,f){return Zu(n,s,f,this)}print(n,s=!0){if(typeof n=="object"&&n.operator)return n.print(n,s)}reconstruct(n="{}"){let s=Pi(n);s&&this.addNode(s)}},we=class{tag;parent;children;graph;state=qo;nodes=new Map;ANIMATE="animate";LOOP="loop";looper=void 0;animation=void 0;constructor(n={},s,f){!n.tag&&f?n.tag=`node${f.nNodes}`:n.tag||(n.tag=`node${Math.floor(Math.random()*1e10)}`),Object.assign(this,n),this.parent=s,this.graph=f,f&&(f.nNodes++,f.nodes.set(n.tag,this)),this.children&&this.convertChildrenToNodes(this)}operator(n,s=this,f,y){return n}runOp(n,s=this,f,y){let d=s.operator(n,s,f,y);return d instanceof Promise?d.then(m=>(this.state.setState({[s.tag]:m}),m)):this.state.setState({[s.tag]:d}),d}runNode(n,s,f){if(typeof n=="string"&&(n=this.nodes.get(n)),n)return n.run(s,n,f)}run(n,s=this,f){if(typeof s=="string"){let y;if(this.graph&&(y=this.graph.nodes.get(s)),y||(y=this.nodes.get(s)),s=y,!s)return}if(!(s.children&&s.forward||s.parent&&s.backward||s.repeat||s.delay||s.frame||s.recursive||s.operator.constructor.name==="AsyncFunction")){let y=s.runOp(s,n,f);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,n,s,f),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,n,s,f),y}return new Promise(async y=>{if(s){let d=(E,w,c=0)=>new Promise(async _=>{c++;let p=await E.runOp(w,E,f,c);if(typeof E.repeat=="number"){for(;c<E.repeat;){if(E.delay){setTimeout(async()=>{_(await d(E,w,c))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await d(E,w,c))});break}else p=await E.runOp(w,E,f,c);c++}if(c===E.repeat){_(p);return}}else if(typeof E.recursive=="number"){for(;c<E.recursive;){if(E.delay){setTimeout(async()=>{_(await d(E,p,c))},E.delay);break}else if(E.frame&&requestAnimationFrame){requestAnimationFrame(async()=>{_(await d(E,p,c))});break}else p=await E.runOp(p,E,f,c);c++}if(c===E.recursive){_(p);return}}else{_(p);return}}),m=async()=>{let E=await d(s,n);if(s.backward&&s.parent&&await this.runNode(s.parent,E,s),s.children&&s.forward)if(Array.isArray(s.children))for(let w=0;w<s.children.length;w++)await this.runNode(s.children[w],E,s);else await this.runNode(s.children,E,s);return s.animate&&!s.isAnimating&&this.runAnimation(this.animation,n,s,f),typeof s.loop=="number"&&!s.isLooping&&this.runLoop(this.looper,n,s,f),E};s.delay?setTimeout(async()=>{y(await m())},s.delay):s.frame&&requestAnimationFrame?requestAnimationFrame(async()=>{y(await m())}):y(await m())}else y(void 0)})}runAnimation(n=this.animation,s,f=this,y){if(this.animation=n,n||(this.animation=this.operator),f.animate&&!f.isAnimating){f.isAnimating=!0;let d=async()=>{if(f.isAnimating){let m=await this.animation(s,f,y,this.ANIMATE);if(this.tag&&typeof m<"u"&&(this.state.setState({[this.tag]:m}),f.backward&&f.parent&&await this.runNode(f.parent,m,f),f.children&&f.forward))if(Array.isArray(f.children))for(let E=0;E<f.children.length;E++)await this.runNode(f.children[E],m,f);else await this.runNode(f.children,m,f);requestAnimationFrame(async()=>{await d()})}};requestAnimationFrame(d)}}runLoop(n=this.looper,s,f=this,y){if(this.looper=n,n||(this.looper=this.operator),typeof f.loop=="number"&&!f.isLooping){f.isLooping=!0;let d=async()=>{if(f.looping){let m=await this.looper(s,f,y);if(this.tag&&typeof m<"u"&&(this.state.setState({[this.tag]:m}),f.backward&&f.parent&&await this.runNode(f.parent,m,f),f.children&&f.forward))if(Array.isArray(f.children))for(let E=0;E<f.children.length;E++)await this.runNode(f.children[E],m,f);else await this.runNode(f.children,m,f);setTimeout(async()=>{await d()},f.loop)}}}}setOperator(n=function(f,y=this,d,m){return f}){this.operator=n}setParent(n){this.parent=n}setChildren(n){this.children=n}removeTree(n){if(typeof n=="string"&&(n=this.nodes.get(n)),n){let s=function(f){f.children&&(Array.isArray(f.children)?f.children.forEach(y=>{y.stopNode&&y.stopNode(),y.tag&&this.nodes.get(y.tag)&&this.nodes.delete(y.tag),this.nodes.forEach(d=>{d.nodes.get(y.tag)&&d.nodes.delete(y.tag)}),s(y)}):typeof f.children=="object"&&(f.stopNode&&f.stopNode(),f.tag&&this.nodes.get(f.tag)&&this.nodes.delete(f.tag),this.nodes.forEach(y=>{y.nodes.get(f.tag)&&y.nodes.delete(f.tag)}),s(f)))};n.stopNode&&n.stopNode(),n.tag&&(this.nodes.delete(n.tag),this.nodes.forEach(f=>{f.nodes.get(n.tag)&&f.nodes.delete(n.tag)}),s(n),this.graph&&this.graph.nodes.removeTree(n))}}addNode(n={}){let s=new we(n,this,this.graph);return this.nodes.set(convertedtag,s),this.graph&&this.graph.nodes.set(s.tag,s),s}removeNode(n){typeof n=="string"&&(n=this.nodes.get(n)),n?.tag&&this.nodes.delete(n.tag),n?.tag&&this.nodes.get(n.tag)&&(this.nodes.delete(n.tag),this.graph&&this.graph.nodes.delete(n.tag),this.nodes.forEach(s=>{s.nodes.get(n.tag)&&s.nodes.delete(n.tag)}))}appendNode(n,s=this){typeof n=="string"&&(n=this.nodes.get(n)),n&&s.addChildren(n)}getNode(n){return this.nodes.get(n)}stopLooping(n=this){n.isLooping=!1}stopAnimating(n=this){n.isAnimating=!1}stopNode(n=this){n.stopAnimating(n),n.stopLooping(n)}addChildren(n){this.children||(this.children=[]),Array.isArray(this.children)?Array.isArray(n)?(this.children.push(...n),n.forEach(s=>{typeof s=="object"&&s.tag&&(this.nodes.set(s.tag,s),this.graph&&this.graph.nodes.set(s.tag,s))})):(this.children.push(n),typeof n=="object"&&n.tag&&(this.nodes.set(n.tag,n),this.graph&&this.graph.nodes.set(n.tag,n))):(this.children=[n],typeof n=="object"&&n.tag&&(this.nodes.set(n.tag,n),this.graph&&this.graph.nodes.set(n.tag,n)))}convertChildrenToNodes(n=this){if(n.children?.name==="GraphNode")this.graph?.nodes.get(n.tag)||this.graph.nodes.set(n.tag,n),this.nodes.get(n.tag)||this.nodes.set(n.tag,n);else if(Array.isArray(n.children))for(let s=0;s<n.children.length;s++)if(n.children[s].name==="GraphNode"){this.graph?.nodes.get(n.children[s].tag)||this.graph.nodes.set(n.children[s].tag,n.children[s]),this.nodes.get(n.children[s].tag)||this.nodes.set(n.children[s].tag,n.children[s]);continue}else typeof n.children[s]=="object"?(n.children[s]=new we(n.children[s],n,this.graph),this.nodes.set(n.children[s].tag,n.children[s]),this.convertChildrenToNodes(n.children[s])):typeof n.children[s]=="string"&&(this.graph&&(n.children[s]=this.graph.getNode(n.children[s]),this.nodes.get(n.children[s].tag)||this.nodes.set(n.children[s].tag,n.children[s])),n.children[s]||(n.children[s]=this.nodes.get(n.children[s])));else typeof n.children=="object"?(n.children=new we(n.children,n,this.graph),this.nodes.set(n.children.tag,n.children),this.convertChildrenToNodes(n.children)):typeof n.children=="string"&&(this.graph&&(n.children=this.graph.getNode(n.children),this.nodes.get(n.children.tag)||this.nodes.set(n.children.tag,n.children)),n.children||(n.children=this.nodes.get(n.children)));return n.children}async callParent(n,s=this,f){if(typeof this.parent?.operator=="function")return await this.parent.runOp(n,this.parent,s,f)}async callChildren(n,s=this,f,y){let d;if(Array.isArray(this.children))if(y)d=await this.children[y]?.runOp(n,this.children[y],s,f);else{d=[];for(let m=0;m<this.children.length;m++)d.push(await this.children[m]?.runOp(n,this.children[m],s,f))}else this.children&&(d=await this.children.runOp(n,this.children,s,f));return d}setProps(n={}){Object.assign(this,n)}subscribe(n=f=>{},s=this.tag){return typeof n=="object"?this.subscribeNode(n):this.state.subscribeTrigger(s,n)}unsubscribe(n,s=this.tag){this.state.unsubscribeTrigger(s,n)}subscribeNode(n,s=this.tag){return this.state.subscribeTrigger(s,f=>{this.runNode(n,f,this)})}print(n=this,s=!0,f=[]){let y=new we;f.push(n.tag);let d={tag:n.tag,operator:n.operator.toString()};n.parent&&(d.parent=n.parent.tag),n.children&&(Array.isArray(n.children)?n.children=n.children.map(m=>typeof m=="string"?m:f.includes(m.tag)?m.tag:s?m.print(m,s,f):m.tag):typeof n.children=="object"?(s||(d.children=[n.children.tag]),f.includes(n.children.tag)?d.children=[n.children.tag]:d.children=[n.children.print(n.children,s,f)]):typeof n.children=="string"&&(d.children=[n.children]));for(let m in n)m==="parent"||m==="children"||typeof y[m]>"u"&&(typeof n[m]=="function"?d[m]=n[m].toString():typeof n[m]=="object"?d[m]=JSON.stringifyWithCircularRefs(n[m]):d[m]=n[m]);return JSON.stringify(d)}reconstruct(n="{}"){let s=Pi(n);s&&this.addNode(s)}};function Zu(l,n,s,f){return typeof s=="object"?(s.operator=l,new we(s,n,f)):new we({operator:l},n,f)}function kf(l="{}",n,s){let f=Pi(l);if(f)return new we(f,n,s)}function Pi(l="{}"){try{let s=function(f){for(let y in f)if(typeof f[y]=="string"){let d=qu(f[y]);typeof d=="function"&&(f[y]=d)}else typeof f[y]=="object"&&s(f[y]);return f},n=JSON.parse(l);return s(n)}catch(n){console.error(n);return}}JSON.stringifyWithCircularRefs===void 0&&(JSON.stringifyWithCircularRefs=function(){let l=new Map,n=[],s=["this"];function f(){l.clear(),n.length=0,s.length=1}function y(m,E){var w=n.length-1,c=n[w];if(typeof c=="object")if(c[m]===E||w===0)s.push(m),n.push(E.pushed);else for(;w-->=0;){if(c=n[w],typeof c=="object"&&c[m]===E){w+=2,n.length=w,s.length=w,--w,n[w]=E,s[w]=m;break}w--}}function d(m,E){if(E!=null&&typeof E=="object"){m&&y(m,E);let w=l.get(E);if(w)return"[Circular Reference]"+w;l.set(E,s.join("."))}return E}return function(E,w){try{return n.push(E),JSON.stringify(E,d,w)}finally{f()}}}());function qu(method=""){let getFunctionBody=l=>l.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=l=>{let n=l.indexOf(")");return l.slice(0,l.indexOf("{",n)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let l=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(l,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var Yu=Xo(),Mr=class extends oi{props={operator:(n,s,f,y)=>(console.log(n),n),forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};input_delay=1;template=Yu;render=(n=this.props)=>{typeof this.template=="function"?this.templateString=this.template(n):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let f=s.content;this.fragment&&this.removeChild(this.fragment),this.fragment=f,this.appendChild(f),this.setupNode(this.props),this.props.input&&setTimeout(async()=>{this.props.node.runNode(this.props.node,this.props.input,this.props.graph)},this.input_delay),this.oncreate&&this.oncreate(n)};setupNode(n){let s=this.parentNode;if(s.props?.operator&&s.props?.node&&(n.parent=s.props.node),!n.graph){for(;!s.props?.nodes&&!(s.constructor.name==="HTMLBodyElement"||s.constructor.name==="HTMLHeadElement"||s.constructor.name==="HTMLHtmlElement"||s.constructor.name==="HTMLDocument");)s=s.parentNode;s.props?.nodes&&(n.graph=s.props.graph,n.input_delay=s.props.input_delay)}this.id&&!n.tag&&(n.tag=this.id),n.graph&&!n.node&&n.tag?n.node=n.graph.nodes.get(n.tag):n.graph&&typeof n.node=="string"&&(n.node=n.graph.nodes.get(n.node)),n.node||(n.node=new we(n,n.parent,n.graph)),n.tag=n.node.tag,this.id||(this.id=n.tag),n.parent&&n.parent.addChildren(n.node)}};Mr.addElement("graph-node");var Ju=Yo(),zi=class extends Mr{bitmap;bitslice;canvas;ctx;offscreen;offscreenctx;capture;capturectx;img;video;imgselect;captures={};loaded={};imgfiles={"Test Image":"src/assets/spectrum_full.png","Spectrum 1":"src/assets/spectrum1.png","Spectrum 2":"src/assets/spectrum2.jpg",Shrimp:"src/assets/shrimp.jpg","Chicken Fat":"src/assets/chickenfat.png","Chicken Breast":"src/assets/chickenbreast.png","Brown Beer Bottle":"src/assets/brownbeerbottle.png"};template=Ju;props={picking:0,picked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},imgpicked:{x0:void 0,x1:void 0,y0:void 0,y1:void 0},running:!1,mode:"img",animation:(n,s,f,y)=>{},operator:(n,s,f,y)=>{},forward:!0,backward:!1,children:void 0,parent:void 0,delay:!1,repeat:!1,recursive:!1,animate:!1,loop:void 0,tag:void 0,input:void 0,graph:void 0,node:void 0};oncreate=n=>{this.canvas=this.querySelector("#picker"),this.pickerDiv=this.querySelector("#pickerDiv"),this.captureDiv=this.querySelector("#captureDiv"),this.imgmenu=this.querySelector("#imgmenu"),this.videomenu=this.querySelector("#videomenu"),this.urlmenu=this.querySelector("#urlmenu"),this.imgselect=this.querySelector("#imgselect");for(let f in this.imgfiles){let y=`<option value="${this.imgfiles[f]}">${f}</option>`;this.imgselect.insertAdjacentHTML("beforeend",y)}this.imgselect.options[0].selected=!0,this.imgselect.oninput=this.useImage,this.querySelector("#useurl").onclick=()=>{this.urlmenu.style.display=="none"?this.urlmenu.style.display="":this.urlmenu.style.display="none"},this.querySelector("#help").onclick=()=>{let f=this.querySelector("#instructions");f.style.display=="none"?f.style.display="":f.style.display="none"},this.img=this.querySelector("img"),this.img.addEventListener("load",f=>{this.props.mode="img",this.props.picked.x0=0,this.props.picked.y0=0,this.props.picked.x1=this.canvas.width,this.props.picked.y1=this.canvas.height,this.videomenu.style.display="none",this.urlmenu.style.display="none",this.onresize()}),this.video=this.querySelector("video"),this.video.addEventListener("load",f=>{this.props.mode="video",this.imgmenu.style.display="none",this.urlmenu.style.display="none",this.onresize()}),this.select=this.querySelector("#imgselect"),this.capture=this.querySelector("#capture"),this.menu=this.querySelector("#menu"),this.toggleMenu=this.querySelector("#toggleMenu"),this.toggleMenu.onclick=()=>{this.menu.style.display==="none"?this.menu.style.display="":this.menu.style.display="none"},this.querySelector("#fileinput").onchange=this.handleFileInput,this.querySelector("#snip").onclick=f=>{this.props.picked.y1&&this.props.picked.x1&&this.canvasCapture(f)};let s=()=>{if(this.props.mode==="video"&&this.props.picked.y1&&this.props.picked.x1){this.props.running=!0;let f=zo(this.capture);this.querySelector("#record").innerHTML="Recording...",this.querySelector("#record").onclick=()=>{this.props.running=!1,f.stop(),this.querySelector("#record").innerHTML="Record",this.querySelector("#record").onclick=s}}};this.querySelector("#record").onclick=s,this.select.onchange=f=>{},this.querySelector("#webcam").onclick=this.useWebcam,this.querySelector("#image").onclick=this.useImage,this.querySelector("#seturl").onclick=()=>{this.querySelector("#urlselect").value==img?this.inputImgUrl():this.inputVideoSrc()},this.querySelector("#fileinput").onclick=this.loadFile,n.canvas=this.canvas,n.context?n.context=this.canvas.getContext(n.context):n.context=this.canvas.getContext("2d"),this.context=n.context,this.ctx=this.context,n.ctx=this.context,this.offscreen=new OffscreenCanvas(this.canvas.width,this.canvas.height),this.offscreenctx=this.offscreen.getContext("2d"),this.capturectx=this.capture.getContext("2d"),this.props.picked.x0=0,this.props.picked.y0=0,this.canvas.onclick=this.canvasClicked,setTimeout(()=>{n.animate&&n.node.runAnimation()},10);try{this.useImage()}catch(f){console.error(f)}this.img.width=0,setTimeout(()=>{this.onresize()},50)};useWebcam=()=>{this.props.running=!1,this.img.style.display="none",this.video.src&&(this.video.pause(),this.video.src=""),this.video.style.display="",navigator.getUserMedia&&navigator.getUserMedia({video:!0},n=>{this.video.srcObject=n,this.video.play(),this.props.mode="video"},console.error)};useImage=()=>{this.props.running=!1,this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=this.select.options[this.select.selectedIndex].value,this.img.style.display="",this.props.mode="img",this.onresize()};inputImgUrl(){this.props.running=!1;let n=this.querySelector("#urlinput").value;n&&(this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),this.img.src=n,this.img.style.display="",this.props.mode="img",this.onresize())}inputVideoSrc(){this.props.running=!1,this.img.style.display="none",this.video.style.display="";let n=this.querySelector("#urlinput").value;n&&(this.video.src=n,this.video.play(),this.props.mode="video",this.onresize())}loadFile=()=>{var n=document.createElement("input");n.accept=".mp4,.png,.bmp,.jpg",n.type="file",n.onchange=s=>{let f=s.target.files[0],y=URL.createObjectURL(f);if(this.loaded[n.value]=y,this.video.src&&(this.video.pause(),this.video.src="",this.video.style.display="none"),n.value.endsWith(".mp4"))this.props.mode="video",this.video.src=y,this.video.play();else if(this.props.mode="img",n.value.endsWith(".bmp")){var d=new FileReader;d.onload=m=>{var E=m.target.result,w=jo(E);let c=Wo(w);this.img.src=c},d.readAsArrayBuffer(f)}else this.img.src=y},n.click()};drawCircle(n,s,f,y="green",d=5,m="#003300",E=this.ctx){E.beginPath(),E.arc(n,s,f,0,2*Math.PI,!1),E.fillStyle=y,E.fill(),E.lineWidth=d,E.strokeStyle=m,E.closePath(),E.stroke()}drawLine(n={x:0,y:0},s={x:1,y:1},f=5,y="#003300",d=this.ctx){d.beginPath(),d.lineWidth=f,d.strokeStyle=y,d.moveTo(n.x,n.y),d.lineTo(s.x,s.y),d.stroke()}canvasClicked=n=>{if(this.props.running=!1,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.props.picking===0){this.props.picked.x0=n.pageX-this.canvas.offsetLeft,this.props.picked.y0=n.pageY-this.canvas.offsetTop,this.props.picked.x1=void 0,this.props.picked.y1=void 0;let s;this.props.mode==="img"?s=Ur(this.img,this.canvas,this.props.picked.x0,this.props.picked.y0):this.props.mode==="video"&&(s=Ur(this.video,this.canvas,this.props.picked.x0,this.props.picked.y0)),this.props.imgpicked.x0=s.x,this.props.imgpicked.y0=s.y,this.props.imgpicked.x1=void 0,this.props.imgpicked.y1=void 0,this.drawCircle(this.props.picked.x0,this.props.picked.y0,2.5,"orange",1,"orange"),this.props.picking=1}else{this.props.picked.x1=n.pageX-this.canvas.offsetLeft,this.props.picked.y1=n.pageY-this.canvas.offsetTop;let s;if(this.props.mode==="img"?s=Ur(this.img,this.canvas,this.props.picked.x1,this.props.picked.y1):this.props.mode==="video"&&(s=Ur(this.video,this.canvas,this.props.picked.x1,this.props.picked.y1)),this.props.imgpicked.x1=s.x,this.props.imgpicked.y1=s.y,this.props.picked.x1<this.props.picked.x0){let f=this.props.picked.x1;this.props.picked.x1=this.props.picked.x0,this.props.picked.x0=f,f=this.props.imgpicked.x1,this.props.imgpicked.x1=this.props.imgpicked.x0,this.props.imgpicked.x0=f}if(this.props.picked.y1<this.props.picked.y0){let f=this.props.picked.y1;this.props.picked.y1=this.props.picked.y0,this.props.picked.y0=f,f=this.props.imgpicked.y1,this.props.imgpicked.y1=this.props.imgpicked.y0,this.props.imgpicked.y0=f}this.props.picking=0,this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.strokeStyle="orange",this.ctx.rect(this.props.picked.x0,this.props.picked.y0,Math.abs(this.props.picked.x1-this.props.picked.x0),Math.abs(this.props.picked.y1-this.props.picked.y0)),this.ctx.stroke(),this.props.mode==="video"?this.continuousCapture(this.video):(this.capture.width=this.captureDiv.clientWidth,this.capture.height=this.captureDiv.clientHeight,Mo(this.capturectx,this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capture.width,this.capture.height))}};continuousCapture(n){this.props.imgpicked.x1&&this.props.imgpicked.x0&&this.props.imgpicked.y1&&this.props.imgpicked.y0&&(this.capturectx.drawImage(n,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0),0,0,this.capturectx.width,this.capturectx.height),setTimeout(()=>{requestAnimationFrame(()=>{this.continuousCapture(n)})},33.3333))}processCapture=n=>{Vo(n,this.querySelector("#captured"),"49.99%","200px")};canvasCapture(n){if(this.props.mode==="img"){if(!this.img.src)return;createImageBitmap(this.img,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}else if(this.props.mode==="video"){if(!this.video.src)return;createImageBitmap(this.video,this.props.imgpicked.x0,this.props.imgpicked.y0,Math.abs(this.props.imgpicked.x1-this.props.imgpicked.x0),Math.abs(this.props.imgpicked.y1-this.props.imgpicked.y0)).then(this.processCapture)}}correctForRatio=(n,s,f,y)=>{s*y>f?(n.height=f,n.width=n.height/y):(n.width=s,n.height=n.width*y)};onresize=n=>{let s,f=this.pickerDiv.clientWidth;this.props.mode==="img"?(s=this.img.naturalHeight/this.img.naturalWidth,this.correctForRatio(this.img,f,this.pickerDiv.clientHeight,s)):this.props.mode==="video"&&(s=this.video.videoHeight/this.video.videoWidth,this.correctForRatio(this.video,f,this.pickerDiv.clientHeight,s)),this.canvas&&(this.props.mode==="img"&&this.img?.naturalWidth>0?this.correctForRatio(this.canvas,f,this.pickerDiv.clientHeight,s):this.props.mode==="video"&&this.video&&this.video?.videoWidth>0?this.correctForRatio(this.canvas,f,this.pickerDiv.clientHeight,s):(this.canvas.width=this.canvas.parentNode.clientWidth,this.canvas.height=this.canvas.parentNode.clientHeight,this.canvas.style.width=this.canvas.parentNode.clientWidth,this.canvas.style.height=this.canvas.parentNode.clientHeight))}};zi.addElement("spectrometer-node");ho(["processed"]);var Ku=document.createElement("spectrometer-node");document.body.appendChild(Ku);})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
* The buffer module from node.js, for the browser.
*
* @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
* @license  MIT
*/
/*! canvas-to-bmp version 1.0 ALPHA https://stackoverflow.com/questions/29652307/canvas-unable-to-generate-bmp-image-dataurl-in-chrome
    (c) 2015 Ken "Epistemex" Fyrstenberg, modified by Josh Brewster 2022
    MIT License (this header required)
*/
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
